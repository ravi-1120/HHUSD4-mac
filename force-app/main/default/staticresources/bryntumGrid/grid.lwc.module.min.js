/*!
 *
 * Bryntum Grid 5.5.4
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).bryntum=e.bryntum||{},e.bryntum.grid={}))}(this,(function(e){"use strict";const t="grid",[n,r]=[self,self],{undefined:i}=n;var o;class s{static supportsPointerEvents=Boolean(r.PointerEvent||r.MSPointerEvent);static supportsPointerEventConstructor="undefined"!=typeof PointerEvent;static PointerEventConstructor=r.PointerEvent||r.CustomEvent;static isPhone=null===(o=r.matchMedia)||void 0===o?void 0:o.call(r,"(max-height:414px) or (max-width:414px)").matches;static cacheFlags(e=navigator.platform,t=navigator.userAgent){const n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isMobile=Boolean(t.match(/Mobile|Opera Mini|Opera Mobi|Puffin/)||"number"==typeof r.orientation),n._isWebkit=Boolean(t.match(/WebKit/)&&!t.match(/Edg/)),n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._safariVersion=n.getVersion(t,/Version\/(.*).Safari/),n._isAndroid=Boolean(t.match(/Android/g))}static get supportsOverflowClip(){if(null==this._supportsOverflowClip){const e=document.createElement("div");e.style.overflow="clip",e.style.display="none",document.documentElement.appendChild(e),this._supportsOverflowClip="clip"===e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("overflow"),e.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(e,t){const n=e.match(t);return n?parseFloat(n[1]):0}static get isTouchDevice(){return this._isTouchDevice===i&&(this._isTouchDevice=r.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return this._isHoverableDevice===i&&(this._isHoverableDevice=r.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return void 0!==n}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get isMobile(){return this._isMobile}static get platform(){const e=this;return e._isLinux?"linux":e._isMac?"mac":e._isWindows?"windows":e._isAndroid?"android":e._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(this._supportsRandomUUID===i)try{this._supportsRandomUUID=Boolean(r.crypto.randomUUID().length>0)}catch(e){this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}static setLocalStorageItem(e,t){this.storageAvailable&&localStorage.setItem(e,t)}static getLocalStorageItem(e){return this.storageAvailable&&localStorage.getItem(e)}static removeLocalStorageItem(e){this.storageAvailable&&localStorage.removeItem(e)}static searchParam(e,t=null,n=document.location.search){const r=new RegExp(`[?&]${e}=?([^&]*)`),i=n.match(r);return i&&i[1]||t}static getCookie(e){const t=encodeURIComponent(e)+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let r=n[e];for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return""}static download(e,t){const n=document.createElement("a");n.download=e,n.href=t||e,n.style.cssText="display:none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}static downloadBlob(e,t){const n=r.URL.createObjectURL(e);this.download(t,n),r.URL.revokeObjectURL(n)}static get queryString(){var e;const t=new URL(r.location.href).searchParams;return null===(e=Object.fromEntries)||void 0===e?void 0:e.call(Object,t.entries())}static copyToClipboard(e){let t=!0;const n=document.createElement("textarea");n.value=e,n.style.height=n.style.width=0,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){t=!1}return n.remove(),t}static isBryntumOnline(e){var t;return e=Array.isArray(e)?e:[e],Boolean(/^(www\.)?bryntum\.com/.test(r.location.host)||(null===(t=e)||void 0===t?void 0:t.some((e=>null!=this.queryString[e]))))}static get isCSP(){const{bryntum:e,document:t}=r;return null==e.CSP&&(e.CSP=Boolean(t.querySelector('meta[http-equiv="Content-Security-Policy"]'))),e.CSP}}s.isBrowserEnv&&s.cacheFlags(),s._$name="BrowserHelper";const{hasOwnProperty:l,toString:a}=Object.prototype,{isFrozen:c}=Object,d=/\s*<\s*/,u=/\s*>\s*/,h={},g={},p=Object.freeze({});class m{static assign(e,...t){for(let n,r,i=0;i<t.length;i++)if(n=t[i],n)for(r in n)e[r]=n[r];return e}static assignIf(e,...t){for(let n,r,o=0;o<t.length;o++)if(n=t[o],n)for(r in n)r in e&&e[r]!==i||(e[r]=n[r]);return e}static blend(e,t,n){n=n||h,e=e||{};const{clone:r=m.clone,merge:i=m.blend}=n;if(Array.isArray(t)){if(t.length>1)return t.forEach((t=>{e=m.blend(e,t,n)})),e;t=t[0]}if(t){let o,s,l;for(s in t)l=t[s],l&&m.isObject(l)&&(o=e[s],n.key=s,o&&m.isObject(o)?(c(o)&&(e[s]=o=r(o,n)),l=i(o,l,n)):l=c(l)?l:r(l,n)),e[s]=l}return e}static clone(e,t){let n,r=e;if(e&&"object"==typeof e){if(t&&"object"==typeof t&&t&&(t=null),m.isObject(e))if(e.skipClone)r=e;else for(n in r={},e)r[n]=m.clone(e[n]);else if(Array.isArray(e))for(r=[],n=e.length;n-- >0;)r[n]=m.clone(e[n]);else m.isDate(e)?r=new Date(e.getTime()):t&&(r=t(e))}return r}static createTruthyKeys(e){const t=A.split(e),n=t&&{};if(t)for(const e of t)e&&(n[e]=!0);return n}static getPath(e,t){return t.split(".").reduce(((e,t)=>(e||p)[t]),e)}static getPathDefault(e,t,n){const r=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],i=r.length-1;return r.reduce(((e,t,r)=>(n&&!(t in e)&&(e[t]=r===i?n:{}),(e||p)[t])),e)}static hasPath(e,t){return t.split(".").every((t=>!(!e||!(t in e))&&(e=e[t],!0)))}static getTruthyKeys(e){const t=[];for(const n in e)e[n]&&t.push(n);return t}static getTruthyValues(e){const t=[];for(const n in e)e[n]&&t.push(e[n]);return t}static isClass(e){var t;return"function"==typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}static isDate(e){return Boolean(null==e?void 0:e.getUTCDate)&&"date"===m.typeOf(e)}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||"function"==typeof(null==e?void 0:e.then);throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&"object"==typeof e)for(const t in e)return!1;return!0}static isObject(e){const t=null==e?void 0:e.constructor;return Boolean(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&"object"==typeof e)}static isInstantiated(e){return!!e&&("object"==typeof e&&!m.isObject(e))}static merge(e,...t){return m.blend(e,t)}static mergeItems(e,t,n){let r,i,o,s,l,a,c;n=n||h;const{merge:g=m.blend}=n;if(e=e||{},Array.isArray(t))t.forEach((t=>{e=m.mergeItems(e,t,n)}));else if(t)for(l in t)if(c=t[l],r=null,l.includes(">")?([l,r]=l.split(u),i=0):l.includes("<")&&([r,l]=l.split(d),i=1),l in e)c&&e[l]&&g&&(n.key=l,c=g(e[l],c,n)),e[l]=c;else if(r){if(!s){s=new Map,o=0;for(const t in e)s.set(t,o++)}if(o=s.get(r),e[l]=c,null==o&&i)o=s.size;else{a=a||[],o=(o||0)+i;for(const e of s){const[t,n]=e;o<=n&&(a&&(a[s.size-n-1]=t),s.set(t,n+1))}if(a)for(;a.length;){const t=a.pop(),n=e[t];delete e[t],e[t]=n}}s.set(l,o)}else{var p;e[l]=c,null===(p=s)||void 0===p||p.set(l,s.size)}return e}static setPath(e,t,n){return t.split(".").reduce(((e,t,r,i)=>r===i.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])),e),e}static typeOf(e){let t,n;return null===e?n="null":e!=e?n="nan":(n=typeof e,"object"===n?e.isBase?n="instance":Array.isArray(e)?n="array":(n=g[t=a.call(e)])||(g[t]=n=t.slice(8,-1).toLowerCase()):"function"===n&&e.isBase&&(n="class")),n}}let f,v,b,y;Object.defineProperty(m,"hasOwn",{value:Object.hasOwn||((e,t)=>l.call(e,t))}),m._$name="Objects";const C=/([a-z])([A-Z])/g,w=/[\n\r]/g,x=/[.*+?^${}()|[\]\\]/g,S=/[&<]/,E=/(^[^a-z]+[^\w]+)/gi,R=/\s+/,T=/^[^a-z]+|[^\w:.-]+/gi,D=(e,t)=>v[t.toLowerCase()]||String.fromCharCode(parseInt(t.substr(2),10)),M=(e,t)=>f[t],F=(e,t,n)=>`${t}-${n.toLowerCase()}`,I=(e,t,n)=>`${t} ${n.toLowerCase()}`,k=e=>e?`_x${[...e].map((e=>e.charCodeAt(0).toString(16))).join("")}`:"__blank__",O={},L={};class A{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=O[e];return t||(O[e]=e.replace(C,F))}static separate(e){const t=L[e];return t||(L[e]=this.capitalize(e.replace(C,I)))}static createId(e){return String(e).replace(E,k)}static makeValidDomId(e,t=""){return null==e?null:String(e).replace(T,t)}static escapeRegExp(e,t){let n=e.replace(x,"\\$&");return t!==i&&(n=new RegExp(n,t)),n}static decodeHtml(e){return e&&String(e).replace(y,D)}static encodeHtml(e=""){return e&&String(e).replace(b,M)}static encodeHtmlBR(e){var t;return null===(t=A.encodeHtml(e))||void 0===t?void 0:t.replace(w,"<br>")}static isHtml(e){return"string"==typeof e&&S.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);f=e,v=t.reduce(((t,n)=>(t[e[n]]=n,t)),{}),b=new RegExp(`([${t.map((e=>"[-]".includes(e)?"\\"+e:e)).join("")}])`,"g"),y=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}static safeJsonStringify(e,t=null,n=null){let r=null;try{r=JSON.stringify(e,t,n)}catch(e){}return r}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=R){let n=e;return"string"==typeof n&&(n=e.trim(),n=n?n.split(t):[]),n}static xss(e,...t){const n=[];let r=t.length;for(n[r]=e[r];r-- >0;)n[r]=e[r]+A.encodeHtml(t[r]);return n.join("")}static xssBR(e,...t){const n=[];let r=t.length;for(n[r]=e[r];r-- >0;)n[r]=e[r]+A.encodeHtmlBR(t[r]);return n.join("")}static toJavaScriptValue(e,t){const n=m.typeOf(e);if("boolean"===n||"string"===n||"number"===n||null===e)return A.safeJsonStringify(e);if(e===r)return"window";if("date"===n)return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if("array"===n)return`[${e.map((e=>A.toJavaScriptValue(e,t)))}]`;if("object"===n||"instance"===n)return this.toJavaScriptString(e,t);if("function"===n){let t=e.toString();return t.match(/^async (\w+?)\(/)?t=t.replace(/^async (\w+?)\(/,"async function("):!t.startsWith("async(")&&t.match(/^(\w+?)\(/)&&(t=t.replace(/^(\w+?)\(/,"function(")),t}return"class"===n?e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name:void 0}static toJavaScriptString(e,t={}){const n=t.level??0;return"{\n"+Object.keys(e).map((r=>" ".repeat(2*(n+1))+(r.match(/[- *]/)?`"${r}"`:r)+`: ${A.toJavaScriptValue(e[r],{...t,level:n+1})}`)).join(",\n")+"\n"+" ".repeat(2*n)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static fakeNodeUUIDIndex=0;static generateUUID(){var e;return s.supportsRandomUUID?r.crypto.randomUUID():null!==(e=r.crypto)&&void 0!==e&&e.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^r.crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))):`${Date.now()}-${++A.fakeNodeUUIDIndex}`}}A.initHtmlEntities(),A._$name="StringHelper";class P{static setVersion(e,n){e=e.toLowerCase(),_[e]={version:n,isNewerThan:e=>P.semanticCompareVersion(e,n,"<"),isOlderThan:e=>P.semanticCompareVersion(e,n,">")};let i="";i=t;const o=`${i}.${e}${n.replace(/\./g,"-")}`;if(s.isBrowserEnv&&!r.bryntum.silenceBundleException)if(!0===r.bryntum[o]){if(!this.isTestEnv){let t=i||e;"core"===t&&(t="grid");let n=A.capitalize(t);throw"schedulerpro"===t&&(n="SchedulerPro"),new Error(`The Bryntum ${n} bundle was loaded multiple times by the application.\n\nCommon reasons you are getting this error includes:\n\n* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)\n* Imports point to both sources and bundle\n* Imports do not use the shortest relative path, JS treats them as different files\n* Cache busters differ between imports, JS treats ${t}.module.js?1 and ${t}.module.js?2 as different files\n* Imports missing file type, verify they all end in .js\n\nSee https://bryntum.com/products/${t}/docs/guide/${n}/gettingstarted/es6bundle#troubleshooting for more information\n\n`)}r.BUNDLE_EXCEPTION=!0}else r.bryntum[o]=!0}static getVersion(e){if(e=e.toLowerCase(),!_[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return _[e].version}static semanticCompareVersion(e,t,n="="){t=t||"";const r=(e=e||"").split(/[-.]/),i=t.split(/[-.]/),o=n.includes("<"),s=(e,t)=>{const n=["rc","beta","alpha"],r=e.map((e=>{if(n.includes(e))return-n.indexOf(e)-2;const t=Number.parseInt(e);return Number.isNaN(t)?-n.length:t}));for(;r.length<t;)r.push(-1);return r},l=()=>{const e=Math.max(r.length,i.length),t=s(r,e),n=s(i,e);for(let r=0;r<e;r++)if(t[r]!==n[r])return o?t[r]<n[r]:t[r]>n[r];return!0};switch(n){case"=":return e===t;case"<=":case">=":return e===t||l();case"<":case">":return e!==t&&l()}return!1}static checkVersion(e,t,n){return P.semanticCompareVersion(_.getVersion(e),t,n)}static deprecate(e,t,n){if(!_.checkVersion(e,t,"<"))throw new Error(`Deprecated API use. ${n}`);console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${n}`)}static get isTestEnv(){var e;const t=Boolean(null===(e=r.bryntum)||void 0===e?void 0:e.isTestEnv);try{var n,i;return t||Boolean(null===(n=r.parent)||void 0===n||null===(i=n.bryntum)||void 0===i?void 0:i.isTestEnv)}catch(e){return t}}static get isDebug(){return!1}}const _=P;s.isBrowserEnv&&(_.isTestEnv&&(s._isHoverableDevice=!0),r.bryntum=Object.assign(r.bryntum||{},{getVersion:_.getVersion.bind(_),checkVersion:_.checkVersion.bind(_),deprecate:_.deprecate.bind(_),license:"40f0c78d-d041-11ec-9e5c-d094663d5c88"})),P._$name="VersionHelper";const $={constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1};class N{static apply(e){if(!e.target)throw new Error("Override must specify what it overrides, using static getter target");if(!e.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(e))return!1;const t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(e.prototype);return t.splice(t.indexOf("target"),1),this.internalOverrideAll(e.target.class,t,e),this.internalOverrideAll(e.target.class.prototype,n,e.prototype),!0}static internalOverrideAll(e,t,n){Reflect.ownKeys(n).forEach((r=>{if(t.includes(r)&&!$[r]){const t=Object.getOwnPropertyDescriptor(n,r);let i=e,o=null;for(;!o&&i;)o=Object.getOwnPropertyDescriptor(i,r),o||(i=Object.getPrototypeOf(i));o&&this.internalOverride(i,r,t,o)}}))}static internalOverride(e,t,n,r){(e._overridden=e._overridden||{})[t]=e[t],r.get?Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n.get}):e[t]=n.value}static shouldApplyOverride(e){const t=e.target;if(!t.maxVersion&&!t.minVersion)return!0;if(!t.product)throw new Error("Override must specify product when using versioning");return(!t.maxVersion||!P[t.product].isNewerThan(t.maxVersion))&&(!t.minVersion||!P[t.product].isOlderThan(t.minVersion))}}N._$name="Override";class H{static clean(e){return e.reduce(((e,t)=>(null===t||t===i||Array.isArray(t)&&0===t.length||""===t||e.push(t),e)),[])}static from(e,t,n){const r=[];if(e)for(const i of e)t&&!t(i)||r.push(n?n(i):i);return r}static remove(e,...t){let n,r,i=!1;t=t[0]instanceof Set?[...t[0]]:t;for(let o=0;o<t.length;o++)r=t[o],-1!==(n=e.indexOf(r))&&(e.splice(n,1),i=!0);return i}static findInsertionIndex(e,t,n=this.lexicalCompare,r){const i=t.length;let o,s;return r<i&&(o=r>0?n(t[r-1],e):0,s=r<i-1?n(e,t[r]):0,o<1&&s<1)?r:this.binarySearch(t,e,n)}static findLast(e,t,n){for(let{length:r}=e,i=r-1;i>=0;i--)if(t.call(n,e[i],i,e))return e[i]}static binarySearch(e,t,n=0,r=e.length,i=this.lexicalCompare){const o=e.length;let s,l;for(n instanceof Function?(i=n,n=0):r instanceof Function&&(i=r,r=o),--r;n<=r;)s=n+r>>1,l=i(t,e[s]),l>=0?n=s+1:l<0&&(r=s-1);return n}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}static fill(e,t={},n=null){const r=[],i=Array.isArray(t)?t:[t];for(let t=0;t<e;t++)for(const e of i){const i=Object.assign({},e);n&&n(i,t),r.push(i)}return r}static populate(e,t,n=!1){const r=[];for(let i=0;i<e;i++)r.push(t(i+(n?1:0)));return r}static include(e,...t){for(const n of t)e.includes(n)||e.push(n)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);const r=Number(t);return Number.isNaN(r)?Reflect.get(e,t,n):e[r<0?e.length+r:r]},set(e,t,n,r){if("string"!=typeof t)return Reflect.set(e,t,n,r);const i=Number(t);return Number.isNaN(i)?Reflect.set(e,t,n,r):(e[i<0?e.length+i:i]=n,!0)}})}static delta(e,t,n=!1){if(!t)return n?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const r=[],i=[],o=new Set,s=new Set(t);for(let t=0;t<e.length;t++){const n=e[t];s.has(n)?o.add(n):r.push(n)}for(let e=0;e<t.length;e++){const n=t[e];o.has(n)||i.push(n)}return n?{toAdd:r,toRemove:i,toKeep:o}:{onlyInA:r,onlyInB:i,inBoth:[...o]}}static asArray(e){return null==e?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,n=H.identity){const r="string"==typeof t?e=>null==e?void 0:e[t]:t,i="string"==typeof n?e=>null==e?void 0:e[n]:n;return e.reduce(((e,t)=>(e[r(t)]=i(t),e)),{})}static aggregate(e,t,n,r,i={}){const o=e.length,s=e[0].length,l=[];i.targetArray=l,i.arrays=e;for(let e=0;e<s;e++)i.entryIndex=e,l.push(r(e,i));for(let r=0;r<o;r++){const o=e[r];i.rowIndex=r;for(let e=0;e<s;e++){i.entryIndex=e;const s=t(o[e],i);l[e]=n(l[e],s,r,e,i)}}return l}static groupBy(e,t){const n="string"==typeof t?e=>null==e?void 0:e[t]:t;return e.reduce(((e,t)=>{const r=n(t);return(e[r]=e[r]||[]).push(t),e}),{})}}H._$name="ArrayHelper";class V{static animationFrame(){return new Promise((e=>{requestAnimationFrame(e)}))}static sleep(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}static yield(){return Promise.resolve()}}V._$name="AsyncHelper";const{defineProperty:B,getOwnPropertyDescriptor:z}=Reflect,{hasOwnProperty:W,toString:j}=Object.prototype,G=Symbol("instanceProperties"),U=Symbol("configuring"),Y=Symbol("lazyConfigValues"),q=j.call(new Date),K=/\s+/,X=(e,t)=>(e[t]=1,e);class J{static get(e,t){const{cache:n}=this,r=n[e]||(n[e]=new J(e));let i,o=r;return t&&(i=J.makeCacheKey(e,t),(o=i&&n[i])||(o=r.extend(t),i&&(n[i]=o))),o}constructor(e){const t=this,n=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=n,t.changer="change"+n,t.initializing="initializing"+n,t.updater="update"+n}get descriptor(){let e=this._descriptor;return e&&W.call(this,"_descriptor")||(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return e&&W.call(this,"_initDescriptor")||(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:n,merge:r}=e,{equalityMethods:i}=J;return"string"==typeof n&&(n.endsWith("[]")?t.equal=J.makeArrayEquals(i[n.substr(0,n.length-2)]):t.equal=i[n]),"string"==typeof r&&(t.merge=J.mergeMethods[r]),t}define(e){const t=z(e,this.name);let n=this.descriptor;t&&t.get&&(n=Object.assign({},n),n.get=t.get),B(e,this.name,n)}defineInitter(e,t){const{name:n}=this,r=e[G];let i,o;r[n]||!(o=z(e,n))||"value"in o||(r[n]=o),B(e,n,this.initDescriptor),this.lazy&&(i=e[Y]||(e[Y]=new Map),i.set(n,t))}static makeArrayEquals(e){return(t,n)=>{let r,i=t&&n&&t.length===(r=n.length);if(i&&Array.isArray(t)&&Array.isArray(n))if(e)for(;i&&r-- >0;)i=e(t[r],n[r]);else for(;i&&r-- >0;)i=t[r]===n[r];else i=e?e(t,n):t===n;return i}}static makeCacheKey(e,t){const n=Object.keys(t).sort();for(let e,r,i,o=n.length;o-- >0;)if(i=t[e=n[o]],null==i&&!1===i)n.splice(o,1);else{if(r=typeof i,"function"===r)return null;"string"===r?n[o]=`${e}:"${i}"`:"number"===r&&(n[o]=`${e}:${i}`)}return n.length?`${e}>${n.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:n,changer:r,updater:o,name:s}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var e;return null===(e=this.configObserver)||void 0===e||e.get(s,this),this[n]},set(t){const l=this;let a,c,d=l[n];if("string"==typeof t){let e=t;var u;if(t.startsWith("up."))e=null===(u=l.owner)||void 0===u?void 0:u.resolveProperty(t.substr(3));else t.startsWith("this.")&&(e=l.resolveProperty(t.substr(5)));e!==i&&"function"!=typeof e&&(t=e)}var h;(l[r]&&(a=(c=l[r](t,d))===i,a||(t=c,d=l[n])),a||(e.equal===Z?d===t:e.equal(d,t)))||(l[n]=t,a=!0,null===(h=l[o])||void 0===h||h.call(l,t,d));!a||l.isDestroyed||l.onConfigChange.$nullFn||l.onConfigChange({name:s,value:t,was:d,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:n}=e;return{configurable:!0,get(){const r=this;return e.removeInitter(r),r[t]=!0,r[n]=r[U][n],r[t]=!1,r.configDone[n]=!0,r[n]},set(t){e.removeInitter(this),this.configDone[n]=!0,this[n]=t}}}makeLazyInitter(){const e=this,{initializing:t,name:n}=e;return{configurable:!0,get(){const r=this,i=r[Y].get(n);return e.removeInitter(r),r.isDestroying||(r[t]=!0,r[n]=i,r[t]=!1),r[n]},set(t){e.removeInitter(this),this[n]=t}}}removeInitter(e){const{name:t}=this,n=e[G][t],r=e[Y];n?B(e,t,n):delete e[t],null!=r&&r.delete(t)&&!r.size&&delete e[Y]}setDefault(e,t){B(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&m.isObject(e)){if(t.isBase)return t.setConfig(e);m.isObject(t)&&(e=m.merge(m.clone(t),e))}return e}}const{prototype:Q}=J,{equal:Z}=Q;J.symbols={configuring:U,instanceProperties:G,lazyConfigs:Y},J.cache=Object.create(null),J.equalityMethods={array:J.makeArrayEquals(),date:(e,t)=>e===t||!(!e||!t||j.call(e)!==q||j.call(t)!==q)&&e.getTime()===t.getTime(),strict:J.equal=Z},J.mergeMethods={distinct(e,t){let n=t?t.slice():[];if(null!=e)if(m.isObject(e))if(t===i)n=e;else{let t,r;for(t in e)r=n.indexOf(t),e[t]?r<0&&n.push(t):r>-1&&n.splice(r,1)}else Array.isArray(e)?e.forEach((e=>!n.includes(e)&&n.push(e))):n.includes(e)||n.push(e);return n},merge:J.merge=Q.merge,classList(e,t){if("string"==typeof e){if(!e.length)return t;e=e.split(K)}return Array.isArray(e)&&(e=e.reduce(X,{})),J.merge(e,t)},objects:(e,t)=>!0===e?t||{}:J.merge(e,t),replace:e=>e,items:(e,t,n,r)=>r?m.mergeItems(t,e,{merge:(e,t)=>Q.merge(t,e)}):Q.merge(e,t)},Object.assign(Q,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),J._$name="Config";class ee{constructor(e){e&&Object.assign(this,e)}getInherited(e,t=!0){let n=this[e];var r;e in this||(n=null===(r=this.super)||void 0===r?void 0:r.getInherited(e,t),(n||t)&&(this[e]=n=Object.create(n||null)));return n}}const{getPrototypeOf:te}=Object,{hasOwn:ne}=m,{defineProperty:re}=Reflect,ie=Symbol("classMetaData"),oe=Symbol("mixinTag"),se=Symbol("originalConfig"),le=J.symbols.configuring,ae=J.symbols.instanceProperties,ce=J.symbols.lazyConfigs,de={merge:"replace",simple:!0},ue=()=>{},he=e=>new ee(e),ge={},pe=Object.freeze({}),me=Object.freeze([]);class fe{static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,n=t.constructor;t.$meta.class!==n&&n.$meta,t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return new this((e=e.filter((e=>e))).length>1?this.mergeConfigs(...e):e[0])}construct(...e){null!==e[0]&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=e=>{null!=e&&e.destroy?e.destroy():Array.isArray(e)&&e.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=ue,e.doDestroy(),Object.setPrototypeOf(e,null);for(const t in e)"destroy"!==t&&"isDestroying"!==t&&delete e[t];delete e[se],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return ne(this,"$name")&&this.$name||ne(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,n=me){const{handler:r,thisObj:i}=this.resolveCallback(e,"this"===t?this:t)||pe;return null==r?void 0:r.apply(i,n)}resolveProperty(e){let t=this;for(;t;){if(m.hasPath(t,e))return m.getPath(t,e);t=t.owner}return i}resolveCallback(e,t=this,n=!0){var r;if(null!==(r=e)&&void 0!==r&&r.substring){if(e.endsWith("?")&&(n=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!(t&&t instanceof Object))return;e=t[e]}if("function"==typeof e)return{handler:e,thisObj:t};if(n)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:n,thisObj:r}=this.resolveCallback(e,t);if(n)return n.bind(r)}}delay(e,t,n=e.name||e){e=this.setTimeout?e:e.bind(this);return(this.setTimeout?this:r)["number"==typeof t?"setTimeout":"requestAnimationFrame"](e,t,n)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let n=0;n<t.length;++n)null!=e[t[n].field]&&(e[t[n].name]=null)}destroyProperties(...e){const t=this;let n;for(n of e){var r,i,o;if(n in t&&(!t[le]||!t[le][n]))null===(r=t[n])||void 0===r||null===(i=(o=r).destroy)||void 0===i||i.call(o),delete t[n]}}configure(e={}){const t=this,n=t.$meta,{beforeConfigure:r}=e,i=n.configs,o=t.getDefaultConfiguration();let s,l,a;for(l in t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties()),e)a=e[l],s=i[l],o[l]=s?s.merge(a,o[l],null,n):a;r&&(delete o.beforeConfigure,r(t,o)),t.setConfig(t[se]=o,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){const n=this,r=n[le],i=r?n.configDone:n.configDone={},o=n.$meta.configs;let s,l;for(l in n[ae]={},n[le]=r?Object.setPrototypeOf(Object.assign({},e),r):e,e)null!=e[l]||ne(e,l)?(s=o[l]||J.get(l),s.defineInitter(n,e[l]),t||(i[l]=!1)):i[l]=!0;for(l in t&&n.startConfigure(e),e){var a;i[l]||null!==(a=o[l])&&void 0!==a&&a.lazy||(n[l]=e[l])}return r?n[le]=r:delete n[le],t&&n.finishConfigure(e),n}hasConfig(e){var t;const n=this,r=n[le];return Boolean(null!=n["_"+e]||null!=(null===(t=n[ce])||void 0===t?void 0:t.get(e))||!n.configDone[e]&&r&&(null!=r[e]||ne(r,e)))}peekConfig(e){const t=this,n=t[ce],r=t[le];if(null!=n&&n.has(e))return n.get(e);if(r&&e in r){if(t.configDone[e])return t[e];if(null!=r[e]||ne(r,e))return r[e]}}triggerConfig(e){const t=this,{configDone:n}=t,r=t[ce],i=t[le],o=null!=r&&r.has(e)||i&&(null!=i[e]||ne(i,e))?!n[e]:null;return o&&t.getConfig(e),o}triggerConfigs(e){const t=this,n=t.$meta.configs,r=t[ce],i=r?[...r.keys()].filter((t=>n[t].lazy===e)):me;for(const e of i)t.triggerConfig(e);return i.length?i:null}onConfigChange(){}get config(){const e={},t=this[se];for(const n in t)e[n]=t[n];return e}static processConfigValue(e,t){if(e===r)return r;if(Array.isArray(e))return e.map((e=>fe.processConfigValue(e,t)));if(e instanceof fe){if(t.visited.has(e))return;return e.getCurrentConfig(t)}if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if(m.isObject(e)){const n={};for(const r in e)"owner"!==r&&(n[r]=fe.processConfigValue(e[r],t));return n}return e}getConfigValue(e,t){var n;const r=this,i=r[ce];return null!==(n=r.$meta.configs[e])&&void 0!==n&&n.lazy?null!=i&&i.has(e)?fe.processConfigValue(i.get(e),t):void 0:fe.processConfigValue(r[e],t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const t=this,n="all"===e.configs?t.config:m.clone(t.initialConfig),r=e.visited||(e.visited=new Set),o=e.depth||(e.depth=0),s={};if(r.has(t))return i;r.add(t),this.preProcessCurrentConfigs(n);for(const r in n){const n=t.getConfigValue(r,{...e,depth:o+1});n!==i&&(s[r]=n)}return s}getConfigString(e={}){return A.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);s.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[ie];return ne(e,ie)||(e[ie]=t=he(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const n=this.$meta.configs,r=m.clone(e)||{};let i,o,s,l;for(o=0;o<t.length;++o)if(i=t[o],i)for(s in i)l=i[s],n[s]?l=n[s].merge(l,r[s]):r[s]&&l&&(l=J.merge(l,r[s])),r[s]=l;return r}static mixin(...e){let t,n=this;for(t=0;t<e.length;++t){const r=e[t],i=r[oe]||(r[oe]=Symbol("mixinTag"));n[i]||(n=r(n),n[i]=!0,ne(n,"onClassMixedIn")&&n.onClassMixedIn())}return n}static setupClass(e){var t;const n=e.class,r=te(n).$meta,i=n.$$name,o=r.names,s=n.prototype;if(re(s,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([...r.hierarchy,n]),names:o.includes(i)?o:Object.freeze([...o,i]),properties:r.properties,nullify:null===(t=r.nullify)||void 0===t?void 0:t.slice()}),o!==e.names){const e=`is${i}`,t=t=>{ne(t,e)||re(t,e,{get:()=>!0})};t(s),t(n)}for(let t,r,i=0;i<e.declarables.length;++i)t=e.declarables[i],ne(n,t)&&(r=ge[t]||(ge[t]=`setup${A.capitalize(t)}`),n[r](n,e))}static setupConfigs(e,t,n){const r=e.config,o=e.configs,s=e.class,l=e.super;let a,c,d,u,h,g,{nullify:p}=e;for(const f in t)h=t[f],n?(a=o[f])?h=a.merge(h,r[f],e,l):a=J.get(f,de):(c=d=u=i,h&&"object"==typeof h&&"$config"in h&&(d=h.$config,d&&!m.isObject(d)&&(d=m.createTruthyKeys(d)),u="default"in h,c=u?h.default:c,h=h.value),(a=o[f])?(g=a.nullify,d&&(a=a.extend(d)),h=a.merge(h,r[f],e,l)):(a=J.get(f,d),a.define(s.prototype),u=!(a.field in s.prototype),g=!1),u&&a.setDefault(s,c),a.nullify&&!g&&(p||(p=e.nullify||(e.nullify=[]))).push(a)),h&&(m.isObject(h)||Array.isArray(h))&&!Object.isFrozen(h)&&(e.forkConfigs=!0),o[f]=a,r[f]=h}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const n=e.declarable;let r,i,o=t.declarables;for(i=0;i<n.length;++i)o.includes(n[i])||(r||(t.declarables=r=o=o.slice()),o.push(n[i]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?fe.fork(e.config):Object.create(e.config);if(P.isTestEnv&&s.isBrowserEnv&&t.testConfig&&r.__applyTestConfigs)for(const e in t.testConfig)t[e]=t.testConfig[e];return t}static fork(e){let t,n,r=e;if(e&&m.isObject(e)&&!Object.isFrozen(e))for(t in r=Object.create(e),e)n=e[t],n&&(m.isObject(n)?r[t]=fe.fork(n):Array.isArray(n)&&(r[t]=n.slice()));return r}getProperties(){const e=this.$meta.properties,t={};for(let n=0;n<e.length;n++)Object.assign(t,e[n].properties);return t}static get superclass(){return te(this)}classHierarchy(e){const t=this.$meta.hierarchy,n=e?t.indexOf(e):0;return n>0?t.slice(n):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){var t;let n=this.$detachers;if(n=null===(t=n)||void 0===t?void 0:t[e],n)for(;n.length;)n.pop()()}trackDetacher(e,t){const n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const n in t){const r=t[n];for(let t=r.length;t-- >0;)r[t].eventer===e&&r.splice(t,1)}}}const ve=fe.prototype;ve.onConfigChange.$nullFn=ue.$nullFn=!0,fe[ie]=ve.$meta=he({class:fe,config:Object.freeze({}),configs:Object.create(null),declarables:fe.declarable,forkConfigs:!1,hierarchy:Object.freeze([fe]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(ve,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1}),fe.emptyFn=ue,P.setVersion("core","5.5.4"),fe._$name="Base";const be=/^(\w+)=(.*)$/;class ye{static DEFAULT_FETCH_OPTIONS={};static get(e,t){return this.fetch(e,t)}static post(e,t,n={}){return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},n))}static fetch(e,t){let n;if(t=m.merge({},ye.DEFAULT_FETCH_OPTIONS,t),"undefined"!=typeof AbortController&&(n=t.abortController=new AbortController,t.signal=n.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const n=Object.entries(t.queryParams);if(n.length){let r=!1;if(t.headers&&!0===t.addQueryParamsToBody){let e;switch(new Headers(t.headers).get("Content-Type")){case"application/x-www-form-urlencoded":e=URLSearchParams;break;case"multipart/form-data":e=FormData}if(e){const i=t.body||(t.body=new e);i instanceof e&&(n.forEach((([e,t])=>i.set(e,t))),r=!0)}}r||(e+=(e.includes("?")?"&":"?")+n.map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&"))}}const r=new Promise(((n,i)=>{fetch(e,t).then((e=>{t.parseJson?e.json().then((t=>{e.parsedJson=t,n(e)})).catch((t=>{e.parsedJson=null,e.error=t,i(e)})):n(e)})).catch((e=>{e.stack=r.stack,i(e)}))}));return r.stack=(new Error).stack,r.abort=function(){var e;null===(e=n)||void 0===e||e.abort()},r}static mockUrl(e,t){const n=this;(n.mockAjaxMap||(n.mockAjaxMap={}))[e]=t,ye.originalFetch||(ye.originalFetch=ye.fetch,ye.fetch=n.mockAjaxFetch.bind(n))}static async mockAjaxFetch(e,t){const n=e.split("?");let r=this.mockAjaxMap[n[0]],i=null;if(r){"function"==typeof r&&(r=await r(n[0],n[1]&&function(e){const t={},n=e.split("&");for(const e of n){const[n,r,i]=be.exec(e),o=decodeURIComponent(r),s=decodeURIComponent(i);if(n){let e=t[o];e?(Array.isArray(e)||(e=t[o]=[e]),e.push(s)):t[o]=s}}return t}(n[1]),t));try{i=(null==t?void 0:t.parseJson)&&JSON.parse(r.responseText)}catch(e){i=null,r.error=e}return r=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:i,text:()=>new Promise((e=>{e(r.responseText)})),json:()=>new Promise((e=>{e(i)}))},r),new Promise((function(e,t){r.synchronous?e(r):setTimeout((function(){e(r)}),"delay"in r?r.delay:100)}))}return ye.originalFetch(e,t)}}ye._$name="AjaxHelper";const Ce=/,\s*/,we=Symbol("decompiled"),xe=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,Se=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,Ee=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:Re}=Object.prototype;class Te{static after(e,t,n,r,o){const s="string"==typeof n,l=!1!==(null==o?void 0:o.return),a=(...t)=>{const o=a.$nextHook.call(e,...t),c=null!=r&&r.isDestroyed?i:l?s?r[n](o,...t):n.call(r,o,...t):s?r[n](...t):n.call(r,...t);return c===i?o:c};return Te.hookMethod(e,t,a)}static before(e,t,n,r){const i="string"==typeof n,o=(...t)=>{const s=null!=r&&r.isDestroyed?0:i?r[n](...t):n.call(r,...t);return!1===s?s:o.$nextHook.call(e,...t)};return Te.hookMethod(e,t,o)}static curry(e){return function t(...n){return n.length>=e.length?e.apply(this,n):function(...e){return t.apply(this,n.concat(e))}}}static bindAll(e){for(const t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,n){return function(...r){const i=n||this;return!1!==t.call(i,...r)&&e.call(i,...r)}}static createSequence(e,t,n){return(...r)=>{const o=e.call(n,...r),s=t.call(n,...r);return s===i?o:s}}static createThrottled(e,t,n,r,i){let o,s,l=-Number.MAX_VALUE;const a=()=>{s=0,l=performance.now(),o.push.apply(o,r),e.apply(n,o)},c=function(...e){const c=performance.now()-l;o=e,c>=t?(clearTimeout(s),a()):(s||(s=setTimeout(a,t-c)),i&&(o.push.apply(o,r),i.apply(n,o)))};return c.cancel=()=>clearTimeout(s),c}static createBuffered(e,t,n,r){let i,o;const s=()=>{o=0,l.isPending=!1,i.push.apply(i,r),e.apply(n,i)},l=function(...e){i=e,o&&clearTimeout(o),l.isPending=!0,o=setTimeout(s,t)};return l.cancel=()=>{l.isPending=!1,clearTimeout(o)},l}static decompile(e){if(!(we in e)){var t,n;const r=e.toString();let i,o,s,l,a,c=xe.exec(r);c?(i=[c[2]],o=c[3]):(c=Se.exec(r))?(a=c[2].trim(),i=a?a.split(Ce):[],o=c[3]):(c=Ee.exec(r))&&(s=c[2],a=c[3].trim(),i=a?a.split(Ce):[],o=c[4]),o=null===(t=o)||void 0===t?void 0:t.trim(),e[we]=l=c&&{args:i,async:Boolean(c[1]),body:null!==(n=o)&&void 0!==n&&n.startsWith("{")?o.substring(1,o.length-1).trim():o},s&&(l.name=s)}return e[we]}static hookMethod(e,t,n){return n.$nextHook=e[t],e[t]=n,()=>{if(Re.call(e,t)){let o,s=e[t];var r;if(s===n)(null===(r=Object.getPrototypeOf(e))||void 0===r?void 0:r[t])===n.$nextHook?delete e[t]:e[t]=n.$nextHook;else for(;o=null===(i=s)||void 0===i?void 0:i.$nextHook;s=o){var i;if(o===n){s.$nextHook=n.$nextHook;break}}}}}static noThrow(e,t,n){const r=e[t];e[t]=(...t)=>{try{return r.apply(e,t)}catch(e){return null==n?void 0:n(e)}}}static returnTrue(){return!0}static animate(e,t,n,i="linear"){let o=!1;const s=new Promise((s=>{const l=performance.now(),a=()=>{const c=Math.min((performance.now()-l)/e,1),d=n&&n.setTimeout?n:r;o||!1===t.call(n,this.easingFunctions[i](c))&&s(),o||1===c?d.requestAnimationFrame((()=>s())):d.requestAnimationFrame(a)};a()}));return s.cancel=()=>(o=!0,s.cancelled=!0,!1),s}}const De=.5,Me=1.70158,Fe=7.5625,Ie=1.525,ke=2/2.75,Oe=2.25/2.75,Le=1/2.75,Ae=1.5/2.75,Pe=2.5/2.75,_e=2.625/2.75,$e=.75,Ne=.9375,He=.984375;Te.easingFunctions={linear:e=>e,easeInQuad:e=>Math.pow(e,2),easeOutQuad:e=>-(Math.pow(e-1,2)-1),easeInOutQuad:e=>(e/=De)<1?De*Math.pow(e,2):-.5*((e-=2)*e-2),easeInCubic:e=>Math.pow(e,3),easeOutCubic:e=>Math.pow(e-1,3)+1,easeInOutCubic:e=>(e/=De)<1?De*Math.pow(e,3):De*(Math.pow(e-2,3)+2),easeInQuart:e=>Math.pow(e,4),easeOutQuart:e=>-(Math.pow(e-1,4)-1),easeInOutQuart:e=>(e/=De)<1?De*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2),easeInQuint:e=>Math.pow(e,5),easeOutQuint:e=>Math.pow(e-1,5)+1,easeInOutQuint:e=>(e/=De)<1?De*Math.pow(e,5):De*(Math.pow(e-2,5)+2),easeInSine:e=>1-Math.cos(e*(Math.PI/2)),easeOutSine:e=>Math.sin(e*(Math.PI/2)),easeInOutSine:e=>-.5*(Math.cos(Math.PI*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:(e/=De)<1?De*Math.pow(2,10*(e-1)):De*(2-Math.pow(2,-10*--e)),easeInCirc:e=>-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>(e/=De)<1?-.5*(Math.sqrt(1-e*e)-1):De*(Math.sqrt(1-(e-=2)*e)+1),easeOutBounce:e=>e<Le?Fe*e*e:e<ke?Fe*(e-=Ae)*e+$e:e<Pe?Fe*(e-=Oe)*e+Ne:Fe*(e-=_e)*e+He,easeInBack:e=>e*e*((Me+1)*e-Me),easeOutBack:e=>(e-=1)*e*((Me+1)*e+Me)+1,easeInOutBack:e=>{let t=1.70158;return(e/=De)<1?De*(e*e*((1+(t*=Ie))*e-t)):De*((e-=2)*e*((1+(t*=Ie))*e+t)+2)},elastic:e=>-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1,swingFromTo:e=>{let t=1.70158;return(e/=De)<1?De*(e*e*((1+(t*=Ie))*e-t)):De*((e-=2)*e*((1+(t*=Ie))*e+t)+2)},swingFrom:e=>e*e*((Me+1)*e-Me),swingTo:e=>(e-=1)*e*((Me+1)*e+Me)+1,bounce:e=>e<Le?Fe*e*e:e<ke?Fe*(e-=Ae)*e+$e:e<Pe?Fe*(e-=Oe)*e+Ne:Fe*(e-=_e)*e+He,bouncePast:e=>e<Le?Fe*e*e:e<ke?2-(Fe*(e-=Ae)*e+$e):e<Pe?2-(Fe*(e-=Oe)*e+Ne):2-(Fe*(e-=_e)*e+He),easeFromTo:e=>(e/=De)<1?De*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2),easeFrom:e=>Math.pow(e,4),easeTo:e=>Math.pow(e,.25)},Te._$name="FunctionHelper";const{isArray:Ve}=Array,{hasOwnProperty:Be}=Object.prototype,ze={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},We=(e,t)=>t.prio-e.prio;var je=e=>class t extends(e||fe){eventsSuspended=null;static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(e,t){const n=t.getInherited("deprecatedEvents"),r=e.deprecatedEvents;for(const e in r)n[e.toLowerCase()]=n[e]=r[e]}static get configurable(){return{listeners:{value:null,$config:{merge(e,t){if(null!==e){if(!e)return t;t&&(e=e?[e]:[]).push[Ve(t)?"apply":"call"](e,t)}return e}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(e,...t){var n;(this.configuredListeners=null===(n=e)||void 0===n?void 0:n.listeners)&&delete(e=m.assign({},e)).listeners,super.construct(e,...t),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const e=this,{isConfiguring:t}=e;e.isConfiguring=!1,e.listeners=e.configuredListeners,e.configuredListeners=null,e.isConfiguring=t}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(e){super.setupClass(e),t.prototype.onListen.$nullFn=!0,t.prototype.onUnlisten.$nullFn=!0}addListener(e,t,n){if(Ve(e)){for(let n=0,{length:r}=e;n<r;n++)this.addListener(e[n],t);return}const o=this,s=o.$meta.getInherited("deprecatedEvents");if("string"==typeof e)return o.addListener({[e]:t,detachable:!1!==t.detachable,thisObj:n});{t=e.thisObj=e.thisObj!==i?e.thisObj:t;for(const n in e)if(!ze[n]&&null!=e[n]){const a=n.toLowerCase(),c=null==s?void 0:s[a],d=o.eventListeners||(o.eventListeners={}),u=H.asArray(e[n]);if(c){const{product:e,invalidAsOfVersion:t,message:n}=c;P.deprecate(e,t,n)}for(const s of u){var l;const c=s.expires||e.expires,u={fn:"object"==typeof s?s.fn:s,thisObj:s.thisObj!==i?s.thisObj:t,args:s.args||e.args,prio:s.prio!==i?s.prio:e.prio!==i?e.prio:0,once:s.once!==i?s.once:e.once!==i&&e.once,buffer:s.buffer||e.buffer,throttle:s.throttle||e.throttle,$internal:e.$internal,catchAll:"catchAll"===n};if(c){const{alt:i}=c,s=i?c.delay:c,l=e.name||n,d=()=>{o.un(a,u),i&&!u.called&&o.callback(i,t)};o.isDelayable?o.setTimeout({fn:d,name:l,cancelOutstanding:!0,delay:s}):r.setTimeout(d,s)}let h=d[a]||(d[a]=[]);h.$firing&&(d[a]=h=h.slice()),h.splice(H.findInsertionIndex(u,h,We,h.length),0,u),!o.onListen.$nullFn&&h.length<2&&o.onListen(a),null===(l=o.afterAddListener)||void 0===l||l.call(o,a,u)}}e.relayAll&&o.relayAll(e.relayAll),t&&t!==o&&o.attachAutoDetacher(e,t);const n=!1!==e.detachable,c=e.name,d=e.expires||n||c?()=>{o.isDestroyed||o.removeListener(e,t)}:null;var a;if(d)if(d.eventer=o,d.listenerName=c,c&&null!==(a=t)&&void 0!==a&&a.trackDetacher&&t.trackDetacher(c,d),e.expires&&o.delay(d,isNaN(e.expires)?e.expires.delay:e.expires,c),n)return d}}on(e,t,n){return this.addListener(e,t,n)}ion(e){return e.$internal=!0,this.on(e)}un(...e){this.removeListener(...e)}updateInternalListeners(e,t){null==t||t.detach(),e&&(e.detach=this.ion(e))}get listeners(){return this.eventListeners}changeListeners(e){if(!this.isConfiguring){if(Array.isArray(e))for(let t=0,n=e[0],{length:r}=e;t<r;n=e[++t])"thisObj"in n||(e[t]=m.assign({thisObj:this},n));else e&&!("thisObj"in e)&&(e=m.assign({thisObj:this},e));return e}this.getConfig("internalListeners"),e&&this.on(e,this)}updateListeners(e,t){t&&this.un(t),e&&this.on(e)}removeListener(e,t=e.thisObj,n){const r=this;if("string"==typeof e)return r.removeListener({[e]:t},n);Object.entries(e).forEach((([e,n])=>{if(!ze[e]&&null!=n){e=e.toLowerCase();const{eventListeners:o}=r,s=r.findListener(e,n,t);if(s>=0){var i;let t=o[e];null===(i=r.afterRemoveListener)||void 0===i||i.call(r,e,t[s]),t.length>1?(t.$firing&&(o[e]=t=t.slice()),t.splice(s,1)):(delete o[e],r.onUnlisten.$nullFn||r.onUnlisten(e))}}})),e.thisObj&&!e.thisObj.isDestroyed&&r.detachAutoDetacher(e)}findListener(e,t,n){var r;const i=null===(r=this.eventListeners)||void 0===r?void 0:r[e],o=t.fn||t,s=t.thisObj||n;if(i)for(let e,t=0,{length:n}=i;t<n;t++)if(e=i[t],e.fn===o&&e.thisObj===s)return t;return-1}hasListener(e){var t;return Boolean(null===(t=this.eventListeners)||void 0===t?void 0:t[null==e?void 0:e.toLowerCase()])}relayAll(e,t,n=!0){this.relayAllTargets||(this.relayAllTargets=[]);const{relayAllTargets:r}=this;e.ion({beforeDestroy:({source:t})=>{if(t===e){r.filter((t=>t.through===e)).forEach((e=>H.remove(r,e)))}}}),r.push({through:e,prefix:t,transformCase:n})}removeAllListeners(e=!0){const t=this.eventListeners;let n,r;for(const l in t){const a=t[l];for(n=a.length;n-- >0;){const t=a[n];var i,o,s;if(!t.$internal||!e)this.removeListener(l,t),r=t.thisObj,null===(i=r)||void 0===i||null===(o=(s=i).untrackDetachers)||void 0===o||o.call(s,this)}}}relayEvents(e,t,n=""){const r={detachable:!0,thisObj:this};return t.forEach((e=>{r[e]=(t,...r)=>this.trigger(n+e,t,...r)})),e.on(r)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:e,target:t,oldDestructor:n}=this;for(let n=0;n<e.length;n++){const{dispatcher:r,config:i}=e[n];r.isDestroyed||r.removeListener(i,t)}n.call(t)}attachAutoDetacher(e,t){const n=e.thisObj||t,r="doDestroy"in n?"doDestroy":"destroy";if(r in n){let{$autoDetachers:t}=n;t||(n.$autoDetachers=t=[]),n.$oldDestructor||(n.$oldDestructor=n[r],n[r]=this.destructorInterceptor.bind({autoDetachers:t,oldDestructor:n.$oldDestructor,target:n})),t.push({config:e,dispatcher:this})}else n[r]=()=>{this.removeListener(e)}}detachAutoDetacher(e){const t=e.thisObj;t.$oldDestructor&&!t.isDestroying&&(H.remove(t.$autoDetachers,t.$autoDetachers.find((t=>t.config===e&&t.dispatcher===this))),t.$autoDetachers.length||(t["doDestroy"in t?"doDestroy":"destroy"]=t.$oldDestructor,t.$oldDestructor=null))}await(e,t={checkLog:!0,resetLog:!0,args:null}){const n=this;!1===t&&(t={checkLog:!1});const{args:r}=t;return new Promise((i=>{var o;if(t.checkLog&&null!==(o=n._triggered)&&void 0!==o&&o[e]&&(i(),t.resetLog&&n.clearLog(e)),r){const o=n.on({[e]:(...s)=>{("function"==typeof r?r(...s):Object.keys(r).every((e=>e in s[0]&&s[0][e]===r[e])))&&(i(...s),t.resetLog&&n.clearLog(e),o())},prio:-1e4})}else n.on({[e]:(...r)=>{i(...r),t.resetLog&&n.clearLog(e)},prio:-1e4,once:!0})}))}clearLog(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}trigger(e,t){var n,r,i,o,s;const l=this,a=e.toLowerCase(),{eventsSuspended:c,relayAllTargets:d,callOnFunctions:u}=l;let h,g,p=null===(n=l.eventListeners)||void 0===n?void 0:n[a];if(l._triggered||(l._triggered={}),l._triggered[e]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;if(null!==(r=l.eventListeners)&&void 0!==r&&r.catchall&&((p=p?p.slice():[]).push(...l.eventListeners.catchall),p.sort(We)),!p&&!d&&!u)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=l:t=Object.setPrototypeOf({source:l},t)):t={source:l},t.type!==a&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:()=>a}):t.type=a),t.eventName=e,!("bubbles"in t)&&null!==(i=l.bubbleEvents)&&void 0!==i&&i[e]&&(t.bubbles=l.bubbleEvents[e]),u){const n="on"+A.capitalize(e);if(n in l){var f;const e=!l[n]||l.callback(l[n],l,[t]);let r;if(m.isPromise(e)?(h||(h=[])).push(e):r=!1===e||r,!l.isDestroyed&&Be.call(l,n)&&(null===(f=l.pluginFunctionChain)||void 0===f||!f[n])){const e=Object.getPrototypeOf(l);if(n in e){const i=e[n].call(l,t);if(m.isPromise(i)?(h||(h=[])).push(i):r=!1===i||r,l.isDestroyed)return}}if(r)return!1}}if(p){let e=0,n=!1;for(p.$firing=!0;e<p.length&&!l.isDestroyed&&!n;e++){const r=p[e];if(!1===g&&!r.$internal)continue;let i,o=r.thisObj;if(!o||!o.isDestroyed){if(r.called=!0,r.once&&l.removeListener(a,r),"string"==typeof r.fn){if(o&&(i=o[r.fn]),!i){const e=l.resolveCallback(r.fn);i=e.handler,o=e.thisObj}}else i=r.fn;if(r.buffer){if(!r.bufferFn){const e=Number(r.buffer);if("number"!=typeof e||isNaN(e))throw new Error(`Incorrect type for buffer, got "${e}" (expected a Number)`);r.bufferFn=Te.createBuffered(i,e,o,r.args)}i=r.bufferFn}if(r.throttle){const e=Number(r.throttle);if("number"!=typeof e||isNaN(e))throw new Error(`Incorrect type for throttle, got "${e}" (expected a Number)`);r.throttledFn||(r.throttledFn=Te.createThrottled(i,e,o,r.args)),i=r.throttledFn}const e=i.call(o||l,...r.args||[],t);!1!==g&&(g=e),r.$internal&&!1===e&&(n=!0),m.isPromise(e)&&(e.$internal=r.$internal,(h||(h=[])).push(e))}}if(p.$firing=!1,n)return!1}return null==d||d.forEach((n=>{let r=e;if(n.transformCase&&(r=A.capitalize(r)),n.prefix&&(r=n.prefix+r),!1===n.through.trigger(r,t))return!1})),t.bubbles&&l.owner&&!l.owner.isDestroyed?l.owner.trigger(e,t):(h=null===(o=h)||void 0===o?void 0:o.filter((e=>!1!==g||e.$internal)),null!==(s=h)&&void 0!==s&&s.length?new Promise((e=>{Promise.all(h).then((t=>{const n=!t.some((e=>!1===e));e(n)}))})):!1!==g)}suspendEvents(e=!1){(this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0})).count++}resumeEvents(){const e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue))for(const t of e.queue)this.trigger(...t);return!Boolean(this.eventsSuspended)}};class Ge{static skipLocaleIntegrityCheck=!1;static mergeLocales(...e){const t={};return e.forEach((e=>{Object.keys(e).forEach((n=>{"object"==typeof e[n]?t[n]={...t[n],...e[n]}:t[n]=e[n]}))})),t}static trimLocale(e,t){const n=(t,n)=>{e[t]&&(n?e[t][n]&&delete e[t][n]:delete e[t])};Object.keys(t).forEach((e=>{Object.keys(t[e]).length>0?Object.keys(t[e]).forEach((t=>n(e,t))):n(e)}))}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if("string"==typeof e){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let n={};if(t.name||t.locale)n=Object.assign({localeName:t.name},t.locale),t.desc&&(n.localeDesc=t.desc),t.code&&(n.localeCode=t.code),t.path&&(n.localePath=t.path);else{if(!t.localeName)throw new Error('"config" parameter doesn\'t have "localeName" property');n=Object.assign({},t)}for(const e of["name","desc","code","path"])n[e]&&delete n[e];if(!n.localeName)throw new Error("Locale name can not be empty");return n}static get locales(){return r.bryntum.locales||{}}static set locales(e){r.bryntum.locales=e}static get localeName(){return r.bryntum.locale||"En"}static set localeName(e){r.bryntum.locale=e||Ge.localeName}static get locale(){return Ge.localeName&&this.locales[Ge.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:n}=r.bryntum,i=Ge.normalizeLocale(e,t),{localeName:o}=i;return n[o]&&!0!==t?n[o]=this.mergeLocales(n[o]||{},i||{}):n[o]=i,n[o]}}r.bryntum=r.bryntum||{},r.bryntum.locales=r.bryntum.locales||{},Ge._$name="LocaleHelper";class Ue extends(je(fe)){static get defaultConfig(){return{throwOnMissingLocale:P.isTestEnv}}construct(...e){const t=this;if(super.construct(...e),s.isBrowserEnv){var n;const e=document.querySelector("script[data-default-locale]");e?t.applyLocale(e.dataset.defaultLocale):null!==(n=t.locale)&&void 0!==n&&n.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return Ge.locales}set locales(e){Ge.locales=e}set locale(e){this.applyLocale(e)}get locale(){return Ge.locale}registerLocale(e,t){P.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),Ge.publishLocale(e,t)}extendLocale(e,t){P.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const n=Ge.publishLocale(e,t);return this.applyLocale(n,!0)}applyLocale(e,t,n=!1){const r=this;let i;if("string"==typeof e)if("object"!=typeof t){if(i=r.locales[e],!i){if(n)return!0;throw new Error(`Locale "${e}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else i=Ge.publishLocale(e,t);else i=Ge.publishLocale(e);if(r.locale.localeName&&r.locale.localeName===i.localeName&&!0!==t)return r.locale;Ge.localeName=i.localeName;const o=()=>{r.trigger("locale",i)};return i.localePath?new Promise(((e,t)=>{r.loadLocale(i.localePath).then((t=>{t.text().then((t=>{new Function(t)(),s.isBrowserEnv&&(i=r.locales[i.localeName],i&&delete i.localePath),o(),e(i)}))})).catch((e=>t(e)))})):(o(),i)}loadLocale(e){return ye.get(e)}set throwOnMissingLocale(e){this._throwOnMissingLocale=e}get throwOnMissingLocale(){return this._throwOnMissingLocale}}const Ye=new Ue,qe=Object.getPrototypeOf(Object),Ke=/L{.*?}/g,Xe=/L{(.*?)}/g,Je=/((.*?)\.)?(.+)/g,Qe=e=>e.replace(/\[\[(\d+)]]/gm,"{$1}"),Ze=Object.freeze(Object.create(null));var et=e=>class t extends(e||fe){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(e){var t,n;return"string"==typeof e?e:e===qe?"Object":e.$$name||e.name||(null===(t=e.prototype)||void 0===t?void 0:t.$$name)||(null===(n=e.prototype)||void 0===n?void 0:n.name)}static parseLocaleString(e){var t;const n=[];let r;if(null!==(t=e)&&void 0!==t&&t.includes("L{"))for(e=e.replace(/{(\d+)}/gm,"[[$1]]"),Xe.lastIndex=0;null!=(r=Xe.exec(e));){Je.lastIndex=0;const e=Je.exec(r[1]);n.push({match:Qe(r[0]),localeKey:Qe(e[3]),localeClass:e[2]})}return n.length>0?n:[{match:e,localeKey:e,localeClass:i}]}construct(e={},...t){super.construct(e,...t),Ye.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(e){var n,r,o;const s=this,l=m.getPath(s,e),a=(null===(n=s.$meta.configs[e])||void 0===n?void 0:n.localeKey)||(null===(r=s.fieldMap)||void 0===r||null===(o=r[e])||void 0===o?void 0:o.defaultValue);let c;return a?(c=t.localize(a,s,s.localeClass||s),c&&!(e in(s.initialConfig||Ze))&&m.setPath(s.isColumn?s.data:s,e,c)):"string"==typeof l&&(s.originalLocales=s.originalLocales||{},c=m.getPath(s.originalLocales,e),c===i&&(m.setPath(s.originalLocales,e,l),c=l),c&&m.setPath(s,e,c=s.optionalL(c,s))),c||l}updateLocalization(){var e,t;!1!==this.localizable&&(null===(e=this.localizableProperties)||void 0===e||e.forEach(this.localizeProperty,this),null===(t=this.trigger)||void 0===t||t.call(this,"localized"))}static getTranslation(e,n,r){const i=Ye.locale;let o,s,l=null;if(i)for(const{match:a,localeKey:c,localeClass:d}of this.parseLocaleString(e)){const u=t=>{var o;const s=null===(o=i[t])||void 0===o?void 0:o[c];return s&&(l="function"==typeof s?null!=n?s(n):s:"object"==typeof s||e===a?s:(l||e).replace(a,s),"string"==typeof s&&s.includes("L{")&&(l=this.getTranslation(s,n,r))),s};let h=!1;for(s=r;s&&(o=t.clsName(s))&&!(h=u(o))&&"string"!=typeof s;s=Object.getPrototypeOf(s));!h&&d&&u(d)}return l}static localize(e,n=i,...r){var o;0===(null===(o=r)||void 0===o?void 0:o.length)&&(r=[this]);let s=null;return r.some((r=>(s=t.getTranslation(e,n,r),null!=s))),s}static L(e,n=i,...r){var o;0===(null===(o=r)||void 0===o?void 0:o.length)&&(r=[this]);const s=this.localize(e,n,...r);if(null==s&&Ye.throwOnMissingLocale&&e.includes("L{"))throw new Error(`Localization is not found for '${e}' in '${r.map((e=>t.clsName(e))).join(", ")}'. ${Ye.locale.localeName?`Locale : ${Ye.locale.localeName}`:""}`);return s??e}L(e,n){const{localeClass:r,constructor:i}=this;return r&&t.clsName(r)!==t.clsName(i)?t.L(e,n,r,i):t.L(e,n,i)}static optionalL(e,n=i,...r){var o;const s=Ye.throwOnMissingLocale;Ye.throwOnMissingLocale=s&&Ke.test(e),0===(null===(o=r)||void 0===o?void 0:o.length)&&(r=[this]);const l=t.L(e,n,...r);return Ye.throwOnMissingLocale=s,l}optionalL(e,t=this,n=!1){const r=Ye.throwOnMissingLocale;Ye.throwOnMissingLocale=r&&Ke.test(e)&&!n;const i=this.L(e,t);return Ye.throwOnMissingLocale=r,i}get localeManager(){return Ye}get localeHelper(){return Ge}};Ge.publishLocale({localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week"},ColorPicker:{noColor:"No color"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:e=>`Add ${e}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:e=>`Value must be less than or equal to ${e.max}`,rangeUnderflow:e=>`Value must be greater than or equal to ${e.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading...",selectAll:"Select All"},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:e=>`of ${e.lastPage}`,summaryTemplate:e=>`Displaying records ${e.start} - ${e.end} of ${e.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"empty",isNotEmpty:"not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"one of",isNotOneOf:"not one of",isGreaterThan:"greater than",isLessThan:"less than",isGreaterThanOrEqualTo:"greater than or equal to",isLessThanOrEqualTo:"less than or equal to",isBetween:"between",isNotBetween:"not between",isBefore:"before",isAfter:"after",isToday:"today",isTomorrow:"tomorrow",isYesterday:"yesterday",isThisWeek:"this week",isNextWeek:"next week",isLastWeek:"last week",isThisMonth:"this month",isNextMonth:"next month",isLastMonth:"last month",isThisYear:"this year",isNextYear:"next year",isLastYear:"last year",isYearToDate:"year to date",isTrue:"true",isFalse:"false",selectAProperty:"Select a property",selectAnOperator:"Select an operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectOneOrMoreValues:"Select one or more values",enterAValue:"Enter a value",enterANumber:"Enter a number",selectADate:"Select a date"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:e=>{let t="th";if(!["11","12","13"].find((t=>e.endsWith(t)))){t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th"}return e+t}}});const{toString:tt}=Object.prototype,nt=tt.call(new Date),rt=new Date,it=36e5,ot=(e,t)=>isNaN(e)||null==e?t:e,st=/([ES]){([^}]+)}/g,lt=e=>{let t="th";if(!["11","12","13"].find((t=>e.endsWith(t)))){t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th"}return e+t},at=(e,t,n)=>(bt[e]||(bt[e]=new Intl.DateTimeFormat(pt,t))).format(n),ct=(e,t,n,r=!1)=>{let i=at(e,t,n);return/am|pm/i.test(i)&&(i=i.replace(/^0/,""),r&&(i=i.replace(/:00/,""))),i},dt=e=>e>=0?e:e+7,ut=/([^\w])(S+)/gm,ht=(e,t)=>t+"SSS",gt=/[:.\-/\s]/;let pt="en-US",mt=lt,ft={},vt={},bt={},yt={};const Ct=e=>{const t=wt[e];if(!t)throw new Error("Only international formats should be used here");if(vt[e]!==i)return vt[e];const n=new Intl.DateTimeFormat(pt,t).formatToParts(new Date(2001,1,2,3,4,5,6)).map((e=>{const n=e.type,r=t[n];return"literal"===n?e.value.replace(/,/g,""):"day"===n?"numeric"===r?"D":"DD":"month"===n?"short"===r?"MMM":"long"===r?"MMMM":"numeric"===r?"M":"MM":"year"===n?"numeric"===r?"YYYY":"YY":void 0})).join("");return vt[e]=n},wt={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},xt={M:e=>e.getMonth()+1,Mo:e=>mt(xt.M(e).toString()),MM:e=>(e.getMonth()+1).toString().padStart(2,"0"),MMM:e=>at("MMM",{month:"short"},e),MMMM:e=>at("MMMM",{month:"long"},e),Q:e=>Math.ceil((e.getMonth()+1)/3),Qo:e=>mt(xt.Q(e).toString()),D:e=>e.getDate(),Do:e=>mt(xt.D(e).toString()),DD:e=>e.getDate().toString().padStart(2,"0"),DDD:e=>Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/It.day.millisecond),DDDo:e=>mt(xt.DDD(e).toString()),DDDD:e=>xt.DDD(e).toString().padStart(3,"0"),d:e=>e.getDay(),do:e=>mt(e.getDay().toString()),d1:e=>at("d1",{weekday:"narrow"},e).substr(0,1),dd:e=>xt.ddd(e).substring(0,2),ddd:e=>at("ddd",{weekday:"short"},e),dddd:e=>at("dddd",{weekday:"long"},e),u:e=>{const t=(bt.u||(bt.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}))).formatToParts(e);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:e=>{const t=(bt.uu||(bt.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))).formatToParts(e);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:e=>e.getDay(),E:e=>e.getDay()+1,W:e=>Wt.getWeekNumber(e)[1],Wo:e=>mt(xt.W(e).toString()),WW:e=>xt.W(e).toString().padStart(2,"0"),Wp:e=>`${Wt.localize("L{Week}")} ${xt.W(e)}`,WWp:e=>`${Wt.localize("L{Week}")} ${xt.WW(e)}`,Wp0:e=>`${Wt.localize("L{Week}")[0]}${xt.W(e)}`,WWp0:e=>`${Wt.localize("L{Week}")[0]}${xt.WW(e)}`,Y:e=>e.getFullYear(),YY:e=>(e.getFullYear()%100).toString().padStart(2,"0"),YYYY:e=>e.getFullYear(),A:e=>e.getHours()<12?"AM":"PM",a:e=>e.getHours()<12?"am":"pm",H:e=>e.getHours(),HH:e=>e.getHours().toString().padStart(2,"0"),h:e=>e.getHours()%12||12,hh:e=>xt.h(e).toString().padStart(2,"0"),k:e=>e.getHours()||24,kk:e=>xt.k(e).toString().padStart(2,"0"),K:e=>ct("K",{hour:"numeric"},e),KK:e=>ct("KK",{hour:"2-digit"},e),m:e=>e.getMinutes(),mm:e=>xt.m(e).toString().padStart(2,"0"),s:e=>e.getSeconds(),ss:e=>xt.s(e).toString().padStart(2,"0"),S:e=>Math.floor(e.getMilliseconds()/100).toString(),SS:e=>Math.floor(e.getMilliseconds()/10).toString().padStart(2,"0"),SSS:e=>e.getMilliseconds().toString().padStart(3,"0"),z:e=>at("z",{timeZoneName:"short"},e),zz:e=>at("zz",{timeZoneName:"long"},e),Z:e=>jt.getGMTOffset(e),LT:e=>ct("LT",{hour:"2-digit",minute:"2-digit"},e),LST:e=>ct("LST",{hour:"numeric",minute:"2-digit"},e,!0),LTS:e=>ct("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e),L:e=>at("L",{year:"numeric",month:"2-digit",day:"2-digit"},e),l:e=>at("l",wt.l,e),LL:e=>at("LL",{year:"numeric",month:"long",day:"numeric"},e),ll:e=>at("ll",wt.ll,e),LLL:e=>at("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e),lll:e=>at("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e),LLLL:e=>at("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e),llll:e=>at("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)},St=`^(?:${Object.keys(xt).sort(((e,t)=>t.length-e.length)).join("|")})`,Et=()=>({}),Rt=e=>(e=>Nt.test(e))(e)&&{milliseconds:parseInt(e.padEnd(3,"0").substring(0,3))},Tt={YYYY:e=>{const t=parseInt(e);return{year:t>=1e3&&t<=9999?t:NaN}},Y:e=>({year:parseInt(e)}),YY:e=>{const t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},M:e=>({month:parseInt(e)-1}),MM:e=>({month:parseInt(e)-1}),Mo:e=>({month:parseInt(e)-1}),MMM:e=>{const t=(e||"").toLowerCase();for(const[e,n]of Object.entries(Wt._monthShortNamesIndex))if(t.startsWith(e))return{month:n.value}},MMMM:e=>{const t=(e||"").toLowerCase();for(const[e,n]of Object.entries(Wt._monthNamesIndex))if(t.startsWith(e))return{month:n.value}},DD:e=>({date:parseInt(e)}),D:e=>({date:parseInt(e)}),Do:e=>({date:parseInt(e)}),DDD:Et,DDDo:Et,DDDD:Et,d:Et,do:Et,d1:Et,dd:Et,ddd:Et,dddd:Et,Q:Et,Qo:Et,W:Et,Wo:Et,WW:Et,e:Et,E:Et,HH:e=>({hours:parseInt(e)}),hh:e=>({hours:parseInt(e)}),mm:e=>({minutes:parseInt(e)}),H:e=>({hours:parseInt(e)}),m:e=>({minutes:parseInt(e)}),ss:e=>({seconds:parseInt(e)}),s:e=>({seconds:parseInt(e)}),S:Rt,SS:Rt,SSS:Rt,A:e=>({amPm:e.toLowerCase()}),a:e=>({amPm:e.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>Ct("l")},ll:{type:"dynamic",parser:()=>Ct("ll")},Z:e=>{if(!e||!Ht.test(e)&&"Z"!==e)return null;let t=0;if("Z"!==e){const n=Ht.exec(e);if(n){t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0))}else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},Dt=Object.keys(Tt).sort(((e,t)=>t.length-e.length)),Mt=new RegExp(`(${Dt.join("|")})`),Ft=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),It={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:87648,minute:5258880,second:315532800,millisecond:3155328e5},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/87648,year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/5258880,year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/315532800,year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/3155328e5,year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},kt={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Ot=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,Lt=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,At=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Pt=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],_t=["decade","year","month","week","day","hour","minute","second","millisecond"],$t=["milliseconds","seconds","minutes","hours","date","month","year"],Nt=/^[0-9]+$/,Ht=/([+-])(\d\d):*(\d\d)*$/,Vt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},Bt={round:(e,t=1)=>Math.round(e/t)*t,floor:(e,t=1)=>Math.floor(e/t)*t,ceil:(e,t=1)=>Math.ceil(e/t)*t},zt={};class Wt extends(et()){static MS_PER_DAY=864e5;static get $name(){return"DateHelper"}static set defaultFormat(e){jt._defaultFormat=e}static get defaultFormat(){return jt._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(Mt),n=[];return 1===t.length||Ft.test(e)?[]:(t.reduce(((t,r,i,o)=>{if(0!==i||""!==r)if(Mt.test(r)){const s=(this.localize("L{parsers}")||{})[r]||Tt[r];if("Z"===r&&i<o.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const l="function"==typeof s||"string"==typeof s?s:s.parser();if("string"==typeof l){const e=jt.buildParser(l),r=e.pop();delete r.last,n.push(...e),t=r}else t.pattern=r,t.fn=l}else t.splitter=r,n.push(t),t={};else Object.prototype.hasOwnProperty.call(t,"pattern")&&n.push(t);return t}),{}),n[n.length-1].last=!0,n)}static makeKey(e){if(10===e.length)return e;e.getTime&&(e=e.getTime());const t=zt[Math.trunc(e/it)];if(t)return t;rt.setTime(e);const n=rt.getMonth()+1,r=rt.getDate();return zt[Math.trunc(e/it)]=`${rt.getFullYear()}-${n<10?"0"+n:n}-${r<10?"0"+r:r}`}static parseKey(e){return jt.parse(e,"YYYY-MM-DD")}static parse(e,t=jt.defaultParseFormat,n=!1){if(e instanceof Date)return e;if("string"!=typeof e||!e)return null;const r={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(ut,ht);let i,o=yt[t];if(o||(o=yt[t]=jt.buildParser(t)),e.includes(" ")&&(e=e.replace(/\s/g," ")),o.reduce(((e,t)=>{if(!t.last){let o,s,l;if("T"===t.splitter&&-1===e.indexOf("T"))o=e.indexOf(" ");else{var i;const r=e.indexOf("+");let{splitter:s}=t;!n&&gt.test(s)&&(s=gt),o=""!==t.splitter?e.search("string"==typeof s?A.escapeRegExp(s):s):(null===(i=t.pattern)||void 0===i?void 0:i.length)||-1,r>-1&&o>r&&(o=-1)}if(-1===o||"SSS"===t.pattern&&e.match(/^\d+Z$/)){const t=e.split(/([Z\-+])/);1===t.length?(s=e,l=""):(s=t[0],l=`${t[1]}${t[2]}`)}else s=e.substring(0,o)||e,l=e.substring(o+t.splitter.length);if(t.fn){const e=t.fn(s);e?Object.assign(r,e):l=s+l}return l}Object.assign(r,t.fn(e))}),e),r.year&&!r.date&&(r.date=1),r.date>31||r.month>12)return null;const s=jt.create(r,n);return s?i=s:n||(i=new Date(e)),i}static create(e,t=!1){const n={...e};let r=isNaN(n.year)||t&&(isNaN(n.month)||isNaN(n.date)),i=!1;if(!r){let e=!0;$t.forEach((t=>{t in n&&!isNaN(n[t])||(n[t]=0),e=e&&null===n[t]})),r=e}if(r)return null;if("am"===n.amPm?n.hours=n.hours%12:"pm"===n.amPm&&(n.hours=n.hours%12+12),"timeZone"in n&&(i=!0,n.minutes-=n.timeZone),t&&(null==n.year||null==n.month||null==n.date))return null;const o=[ot(n.year,2020),ot(n.month,0),ot(n.date,1),n.hours,n.minutes,n.seconds,n.milliseconds];return i?new Date(Date.UTC(...o)):new Date(...o)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=jt.defaultFormat){if(!e||isNaN(e))return null;let n=ft[t],r="";if(!n){n=ft[t]=[];for(let e=0;e<t.length;e++){const r=t.slice(e).match(St),i=null==r?void 0:r[0];if(i){const t=(this.localize("L{formats}")||{})[i]||xt[i];n.push(t),e+=i.length-1}else if("{"===t[e]){const r=t.indexOf("}",e+1);-1===r?(n.push(t.substr(e+1)),e=t.length):(n.push(t.substring(e+1,r)),e=r)}else n.push(t[e])}}return n.forEach((t=>{r+="string"==typeof t?t:t(e)})),r}static formatRange(e,t){return t.replace(st,((t,n,r)=>Wt.format(e["S"===n?0:1],r)))}static asMilliseconds(e,t=null){return"string"==typeof e&&(t=e,e=1),jt.as("millisecond",e,t)}static asMonths(e){const t=jt.as("ms",jt.daysInMonth(e),"day"),n=(e.valueOf()-jt.startOf(e,"month").valueOf())/t;return 12*e.getYear()+e.getMonth()+n}static monthsToDate(e){const t=Math.floor(e),n=e-t,r=new Date(0,t),i=jt.as("ms",jt.daysInMonth(r),"days");return r.setTime(r.getTime()+n*i),r}static formatDelta(e,t){let n,r;"boolean"==typeof t?n=t:t&&(n=t.abbrev);const i=this.getDelta(e,t),o=[],s=(null==t?void 0:t.separator)||(n?"":" ");for(r in i)o.push(`${i[r]}${s}${r}`);return!1===(null==t?void 0:t.asString)?o:o.join(", ")}static getDelta(e,t){let n,r,i,o,s,l,a;"boolean"==typeof t?n=t:t&&(n=t.abbrev,o=jt.normalizeUnit(t.precision),l=t.maxUnit,a=!n&&t.ignoreLocale);const c={},d=n?jt.getShortNameOfUnit:jt.getLocalizedNameOfUnit,u=l?_t.slice(_t.indexOf(l)):_t;for(s of u)if(r=jt.as(s,e),i=o===s,r=Math[i?"round":"floor"](r),(r||i&&!c.length)&&(c[a?s:d.call(jt,s,1!==r)]=r,e-=jt.as("ms",r,s)),i||!e)break;return c}static as(e,t,n="ms"){return"string"==typeof t&&(t=jt.parseDuration(t)),"object"==typeof t&&(n=t.unit,t=t.magnitude),e===n||(e=jt.normalizeUnit(e))===(n=jt.normalizeUnit(n))?t:Vt[n]>Vt[e]?t*Math.abs(It[n][e]):t/Math.abs(It[e][n])}static formatContainsHourInfo(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}static is24HourFormat(e){return jt.format(jt.getTime(13,0,0),e).includes("13")}static add(e,t,n="ms",r=!0){let i;if(i="string"==typeof e?jt.parse(e):r?new Date(e.getTime()):e,"string"==typeof t){const e=Wt.parseDuration(t);t=e.magnitude,n=e.unit}else t&&"object"==typeof t&&(n=t.unit,t=t.magnitude);if(!n||0===t)return i;switch(n=jt.normalizeUnit(n)){case"millisecond":i.setTime(i.getTime()+t);break;case"second":i.setTime(i.getTime()+1e3*t);break;case"minute":i.setTime(i.getTime()+6e4*t);break;case"hour":i.setTime(i.getTime()+36e5*t);break;case"day":t%1==0?(i.setDate(i.getDate()+t),23===i.getHours()&&0===e.getHours()&&i.setHours(i.getHours()+1)):i.setTime(i.getTime()+864e5*t);break;case"week":i.setDate(i.getDate()+7*t);break;case"month":{let e=i.getDate();e>28&&(e=Math.min(e,jt.getLastDateOfMonth(jt.add(jt.getFirstDateOfMonth(i),t,"month")).getDate())),i.setDate(e),i.setMonth(i.getMonth()+t);break}case"quarter":jt.add(i,3*t,"month",!1);break;case"year":i.setFullYear(i.getFullYear()+t);break;case"decade":i.setFullYear(i.getFullYear()+10*t)}return i}static diff(e,t,n="ms",r=!0){if(n=jt.normalizeUnit(n),!e||!t)return 0;let i;switch(n){case"year":i=jt.diff(e,t,"month")/12;break;case"quarter":i=jt.diff(e,t,"month")/3;break;case"month":i=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth()),0===i&&r&&(i=jt.diff(e,t,"day",r)/jt.daysInMonth(e));break;case"week":i=jt.diff(e,t,"day")/7;break;case"day":{const n=e.getTimezoneOffset()-t.getTimezoneOffset();i=(t-e+60*n*1e3)/864e5;break}case"hour":i=(t-e)/36e5;break;case"minute":i=(t-e)/6e4;break;case"second":i=(t-e)/1e3;break;case"millisecond":i=t-e}return r?i:Math.round(i)}static startOf(e,t="day",n=!0,r=jt.weekStartDay){if(!e)return null;switch(t=jt.normalizeUnit(t),n&&(e=jt.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth(3*(jt.get(e,"quarter")-1),1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const t=e.getDay()-r;return e.setDate(e.getDate()-t),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let n=jt.clearTime(e);return t&&n<e&&(n=jt.add(n,1,"d")),n}static getTimeOfDay(e,t="ms"){const n=e.getHours()*It.hour.millisecond+e.getMinutes()*It.minute.millisecond+e.getSeconds()*It.second.millisecond+e.getMilliseconds();return"ms"===t?n:jt.as(t,n,"ms")}static set(e,t,n){if(!t)return e;if("string"==typeof t)switch(jt.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort(((e,t)=>Vt[e[0]]-Vt[t[0]])).forEach((([t,n])=>{jt.set(e,t,n)}));return e}static setDateToMidday(e,t=!0){return jt.set(jt.clearTime(e,t),"hour",12)}static constrain(e,t,n){return null!=t&&(e=jt.max(e,t)),null==n?e:jt.min(e,n)}static getTime(e,t=0,n=0,r=0){return e instanceof Date&&(r=e.getMilliseconds(),n=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(2020,0,1,e,t,n,r)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=(new Date).getFullYear(),t=new Date(e,0,1),n=new Date(e,6,1);return t.getTimezoneOffset()!==n.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),n=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(n.getTimezoneOffset(),r.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,n=null){return null===n?e&&t&&e.getTime()===t.getTime():jt.startOf(e,n)-jt.startOf(t,n)==0}static compare(e,t,n=null){return n&&(e=jt.startOf(e,n),t=jt.startOf(t,n)),e<t?-1:e>t?1:0}static clamp(e,t,n){if(!isNaN(e))return null!=t&&(e=Math.max(e,t)),null!=n&&(e=Math.min(e,n)),new Date(e)}static isSameDate(e,t){return 0===jt.compare(e,t,"d")}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return jt.isEqual(e,jt.startOf(e,t))}static betweenLesser(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}static betweenLesserEqual(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}static intersectSpans(e,t,n,r){return jt.betweenLesser(e,n,r)||jt.betweenLesser(n,e,t)}static compareUnits(e,t){return Math.sign(Vt[jt.normalizeUnit(e)]-Vt[jt.normalizeUnit(t)])}static timeSpanContains(e,t,n,r){return n-e>=0&&t-r>=0}static get weekStartDay(){return null==jt._weekStartDay&&(jt._weekStartDay=this.localize("L{weekStartDay}")||0),jt._weekStartDay}static get nonWorkingDays(){return{...this.localize("L{nonWorkingDays}")}}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return{...this.localize("L{weekends}")}}static get(e,t){switch(jt.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return xt.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),n=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",n)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(t,n,r+1)-new Date(t,n,r);return this.as("hour",i)}static getNormalizedUnitDuration(e,t){let n;switch(t){case"month":n=jt.asMilliseconds(jt.daysInMonth(e),"day");break;case"year":n=jt.asMilliseconds(jt.daysInYear(e),"day");break;case"day":n=jt.asMilliseconds(jt.hoursInDay(e),"hour");break;default:n=jt.asMilliseconds(t)}return n}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,n=1,r=jt.weekStartDay){if("week"===t){const t=jt.clone(e),i=t.getDay();return jt.startOf(t,"day",!1),jt.add(t,r-i+7*(n-(r<=i?0:1)),"day",!1),t.getDay()!==r&&jt.add(t,1,"hour"),t}return jt.startOf(jt.add(e,n,t),t,!1)}static isValidDate(e){return jt.isDate(e)&&!isNaN(e)}static isDate(e){return e&&tt.call(e)===nt}static getStartOfNextDay(e,t=!1,n=!1){let r=jt.add(n?e:jt.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){const n=jt.add(jt.clearTime(e,t),2,"day").getTimezoneOffset(),i=e.getTimezoneOffset();r=jt.add(r,i-n,"minute")}return r}static getEndOfPreviousDay(e,t=!1){const n=t?e:jt.clearTime(e,!0);return n-e?n:jt.add(n,-1,"day")}static getWeekDescription(e,t=e){const n=e.getMonth()===t.getMonth()?Wt.format(e,"MMMM"):`${Wt.format(e,"MMM")} - ${Wt.format(t,"MMM")}`,r=Wt.getWeekNumber(e);return`${r[1]}, ${n} ${r[0]}`}static getWeekNumber(e,t=Wt.weekStartDay){const n=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),11,31),i=dt(n.getDay()-t),o=dt(r.getDay()-t),s=(l=e,a=n,Math.floor((l.getTime()-a.getTime()-(l.getTimezoneOffset()-a.getTimezoneOffset())*It.minute.millisecond)/It.day.millisecond)+1);var l,a;let c;if(c=i<4?Math.floor((s+i-1)/7)+1:Math.floor((s+i-1)/7),c){let t=e.getFullYear();return 53===c&&o<3&&(t++,c=1),[t,c]}const d=Wt.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,d]}static formatCount(e,t){return t=jt.normalizeUnit(t),1!==e&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,n=!1){return(e=jt.normalizeUnit(e))===(t=jt.normalizeUnit(t))?1:It[e]&&It[e][t]&&(n||It[e][t]>0)?1/jt.as(t,1,e):It[t]&&It[t][e]&&(n||It[t][e]>0)?jt.as(e,1,t):-1}static getShortNameOfUnit(e){return e=jt.parseTimeUnit(e),jt.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const n=e.charAt(0)===e.charAt(0).toUpperCase();return e=jt.normalizeUnit(e),e=jt.parseTimeUnit(e),e=jt.unitLookup[e][t?"plural":"single"],n&&(e=A.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return"date"===t||At.includes(t)?t:kt[e]||kt[t]}static getUnitByName(e){return jt.normalizeUnit(e)||jt.normalizeUnit(jt.parseTimeUnit(e))}static getDurationInUnit(e,t,n,r){return jt.diff(e,t,n,r)}static doesUnitsAlign(e,t){return!(e!==t&&"week"===t)}static getSmallerUnit(e){return At[Vt[jt.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return At[Vt[jt.normalizeUnit(e)]+1]||null}static round(e,t,n,r){return jt.snap("round",e,t,n,r)}static floor(e,t,n,r){return jt.snap("floor",e,t,n,r)}static ceil(e,t,n,r){return jt.snap("ceil",e,t,n,r)}static snap(e,t,n,r,i=jt.weekStartDay){const o=Bt[e];if("string"==typeof n&&(n=jt.parseDuration(n)),m.isObject(n)){const s=n.magnitude||n.increment;switch(n.unit){case"week":{const n=t.getDay();return r=jt.add(jt.clearTime(t),n>=i?i-n:-(n-i+7),"day"),jt[e](t,7*s+" days",r)}case"month":{let e;return t=jt.asMonths(t),e=r?t+o(t-(r=jt.asMonths(r)),s):o(t,s),jt.monthsToDate(e)}case"quarter":return jt[e](t,3*s+" months",r);case"year":return jt[e](t,12*s+" months",r);case"decade":return jt[e](t,10*s+" years",r)}n=jt.as("ms",s,n.unit)}if(r){const e=jt.as("ms",r.getTimezoneOffset()-t.getTimezoneOffset(),"ms");return new Date(r.valueOf()+o(jt.diff(r,t,"ms")+e,n))}{const e=60*t.getTimezoneOffset()*1e3;return new Date(o(t.valueOf()-e,n)+e)}}static parseDuration(e,t=!0,n){var r;const i=(t?Ot:Lt).exec(e);if(null==e||!i)return null;const o=(e=>{const t=parseFloat(e);return isNaN(t)?null:t})(null===(r=i[1])||void 0===r?void 0:r.replace(",",".")),s=jt.parseTimeUnit(i[2])||n;return s?{magnitude:o,unit:s}:null}static parseTimeUnit(e){const t=null==e?null:jt.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let e=0;e<At.length;e++)if(t[e+1])return At[e]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=jt._dayNames||[],n=jt._dayShortNames||[];t.length=0,n.length=0;for(let r=2;r<9;r++)e.setDate(r),t.push(jt.format(e,"dddd")),n.push(jt.format(e,"ddd"));jt._dayNames=t,jt._dayShortNames=n}static getDayNames(){return jt._dayNames}static getDayName(e){return jt._dayNames[e]}static getDayShortNames(){return jt._dayShortNames}static getDayShortName(e){return jt._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=jt._monthNames||[],n=jt._monthShortNames||[],r={},i={};t.length=0,n.length=0;for(let o=0;o<12;o++){e.setMonth(o);const s=jt.format(e,"MMMM");t.push(s);const l=jt.format(e,"MMM");n.push(l),r[s.toLowerCase()]={name:s,value:o},i[l.toLowerCase()]={name:l,value:o}}jt._monthNames=t,jt._monthShortNames=n,jt._monthNamesIndex=r,jt._monthShortNamesIndex=i}static getMonthShortNames(){return jt._monthShortNames}static getMonthShortName(e){return jt._monthShortNames[e]}static getMonthNames(){return jt._monthNames}static getMonthName(e){return jt._monthNames[e]}static set locale(e){pt=e,bt={},ft={},vt={}}static get locale(){return pt}static setupDurationRegEx(e=[],t=[]){const n=this,r={};let i="";for(let o=0;o<t.length;o++){const s=t[o],l=e[o];l.canonicalUnitName=At[o],r[l.single]=r[l.single.toUpperCase()]=r[l.canonicalUnitName]=r[l.canonicalUnitName.toUpperCase()]=l,i+=(o?"|":"")+"(";for(let e=0;e<s.length;e++)i+=`${s[e]}|`;if(pt=n.localize("L{locale}")||"en-US","en-US"!==pt){const e=Pt[o];for(let t=0;t<e.length;t++)i+=`${e[t]}|`}i+=`${l.single}|${l.plural}|${l.canonicalUnitName}|${l.canonicalUnitName}s)`}n.unitLookup=r,n.durationRegEx=new RegExp(`^(?:${i})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],n=e.unitNames=e.localize("L{unitNames}");"unitNames"!==n&&(pt=e.localize("L{locale}")||"en-US",mt="en-US"===pt?lt:e.localize("L{ordinalSuffix}")||mt,ft={},vt={},yt={},bt={},jt._weekStartDay=null,jt.setupDurationRegEx(n,t),jt.fillDayNames(),jt.fillMonthNames())}}const jt=Wt;jt.useIntlFormat=at,Ye.ion({locale:"applyLocale",prio:1e3,thisObj:jt}),Ye.locale&&jt.applyLocale(),Wt._$name="DateHelper";const{hasOwn:Gt}=m,Ut="1.01"===1.005.toFixed(2)?null:function(e,t){const n=e.toString().split("."),r=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(r,t)};class Yt extends m{static transformArrayToNamedObject(e,t="ref"){const n={};return e.forEach(((e,r)=>{const i=null!=e[t]&&e[t].toString().length?e[t]:r;n[i]=e})),n}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter((t=>e[t])).map((n=>{const r=e[n];return r[t]=n,r}))}static isEqual(e,t,n=!1){if(null===e&&null!==t||e===i&&t!==i||null===t&&null!==e||t===i&&e!==i)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;const r=typeof e;if(r===typeof t){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every(((e,r)=>qt.isEqual(e,t[r],n)));case"object"===r&&e.constructor.prototype===t.constructor.prototype:return n?qt.isDeeplyEqual(e,t,n):A.safeJsonStringify(e)===A.safeJsonStringify(t)}}return String(e)===String(t)}static isDeeplyEqual(e,t,n={}){if(e===t)return!0;if(!e||!t)return!1;const r=qt.keys(e,n.ignore),i=qt.keys(t,n.ignore);if(r.length!==i.length)return!1;for(let o=0;o<r.length;o++){const s=r[o],l=i[o];if(s!==l)return!1;const a=e[s],c=t[l];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(s,{value:a,object:e},{value:c,object:t})){if(n.evaluate){const r=n.evaluate(s,{value:a,object:e},{value:c,object:t});if(!1===r)return!1;if(!0===r)continue}if(!qt.isEqual(a,c,n))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!==e.indexOf(t)}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?Wt.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?Wt.isAfter(e,t):e>t}static fork(e){let t,n,r;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)r=e[n],r&&(r.constructor===Object?t[n]=qt.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}static copyProperties(e,t,n){let r,i;for(i=0;i<n.length;i++)r=n[i],r in t&&(e[r]=t[r]);return e}static copyPropertiesIf(e,t,n){if(t)for(const r of n)!(r in e)&&r in t&&(e[r]=t[r]);return e}static entries(e,t){const n=[],r="function"==typeof t;if(e)for(const i in e)(r?t(i,e[i]):null!=t&&t[i])||n.push([i,e[i]]);return n}static fromEntries(e,t){if(t=t||{},e)for(let n=0;n<e.length;++n)t[e[n][0]]=e[n][1];return t}static keys(e,t,n){const r=[],i="function"==typeof t;if(e){let o=0;for(const s in e)(i?t(s,e[s]):null!=t&&t[s])||(r.push(n?n(s,o):s),++o)}return r}static values(e,t,n){const r=[],i="function"==typeof t;if(e){let o=0;for(const s in e)(i?t(s,e[s]):null!=t&&t[s])||(r.push(n?n(e[s],o):e[s]),++o)}return r}static pathExists(e,t){return t.split(".").every((t=>!(!e||!(t in e))&&(e=e[t],!0)))}static pathifyKeys(e,t){const n={};for(const r in e)if(Gt(e,r)){const i=null==t?void 0:t[r],o="object"===(null==i?void 0:i.type)||(null==i?void 0:i.complexMapping)||!Boolean(t);if(o&&Array.isArray(e[r]))n[r]=e[r].slice();else if(o&&e[r]instanceof Object){const t=this.pathifyKeys(e[r]);for(const e in t)n[`${r}.${e}`]=t[e]}else n[r]=e[r]}return n}static deletePath(e,t){t.split(".").reduce(((e,t,n,r)=>{if(null==e)return null;if(Gt(e,t)){if(n!==r.length-1)return e[t];delete e[t]}}),e)}static coerce(e,t){const n=m.typeOf(e),r=m.typeOf(t),o="string"==typeof e;if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return!(o&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!o||e&&"null"!==e)&&null;case"undefined":return!(!o||e&&"undefined"!==e)&&i;case"date":return o&&isNaN(e)?Wt.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,n,r,i=!0){const o={};let s=Object.getPrototypeOf(e),l=Object.getOwnPropertyDescriptor(s,t);for(;!l&&s&&i;)s=Object.getPrototypeOf(s),s&&(l=Object.getOwnPropertyDescriptor(s,t));l?(l.set?o.set=t=>{l.set.call(e,t),r&&r.call(e,l.get.call(e))}:o.set=r,l.get?o.get=()=>{let t=l.get.call(e);return n&&(t=n.call(e,t)),t}:o.get=n):(o.set=n=>{e[`_${t}`]=n,r&&r.call(e,n)},o.get=()=>{let r=e[`_${t}`];return n&&(r=n.call(e,r)),r}),Object.defineProperty(e,t,o)}static hookProperty(e,t,n){const r=Yt.getPropertyDescriptor(n.prototype,"value"),i=Yt.getPropertyDescriptor(e,t),o=`_${t}`,s=class{get value(){return i?i.get.call(this):this[o]}set value(e){i?i.set.call(this,e):this[o]=e}},l=Yt.getPropertyDescriptor(s.prototype,"value");return Object.setPrototypeOf(n.prototype,s.prototype),Object.defineProperty(e,t,{configurable:!0,get:r.get||l.get,set:r.set||l.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let n=null;for(let r=e;r&&!n&&!Gt(r,"isBase");r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,t);return n}static cleanupProperties(e,t=!1){return Object.entries(e).forEach((([n,r])=>{t?r===i&&delete e[n]:null==r&&delete e[n]})),e}static removeAllProperties(e){return Object.keys(e).forEach((t=>delete e[t])),e}static assertType(e,t,n){const r=m.typeOf(e);if(null!=e&&r!==t)throw new Error(`Incorrect type "${r}" for ${n}, expected "${t}"`)}static assertObject(e,t){qt.assertType(e,"object",t)}static assertInstance(e,t){qt.assertType(e,"instance",t)}static assertClass(e,t){qt.assertType(e,"class",t)}static assertFunction(e,t){if("function"!=typeof e||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const n=Number(e);if("number"!=typeof e||isNaN(n))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){qt.assertType(e,"boolean",t)}static assertString(e,t){qt.assertType(e,"string",t)}static assertArray(e,t){qt.assertType(e,"array",t)}static toFixed(e,t){return Ut?Ut(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(null==t)return e;const n=10**t;return Math.round(e*n)/n}static getMapPath(e,t,n){const r=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],i=1===r.length,o=r[0],s=e.has(o)?e.get(o):e.set(o,i?n:{}).get(o);return i?s:qt.getPathDefault(s,r.slice(1),n)}}const qt=Yt;Yt._$name="ObjectHelper";const Kt=["border-top-width","border-right-width","border-bottom-width","border-left-width"],Xt=["margin-top","margin-right","margin-bottom","margin-left"],Jt=["padding-top","padding-right","padding-bottom","padding-left"],Qt="border-top-width",Zt="border-right-width",en="border-bottom-width",tn="border-left-width",nn="padding-top",rn="padding-right",on="padding-bottom",sn="padding-left",ln=Object.freeze({x:0,y:0}),an=/^([trblc])(\d*)-([trblc])(\d*)$/i,cn=/^([trblc])(\d*)$/i,dn=["top","right","bottom","left"],un={t:0,r:1,b:2,l:3},hn=["b-t","l-r","t-b","r-l"],gn={bt:1,tb:1,lr:2,rl:2},pn=Object.freeze([0,0]),mn=["width","height"],fn=(e,t=e,n=e,r=t)=>Array.isArray(e)?fn.apply(null,e):[e,t,n,r];function vn(e){return`${dn[(un[e.myEdge]+2)%4][0]}${e.myOffset}-${dn[(un[e.targetEdge]+2)%4][0]}${e.targetOffset}`}class bn{get isRectangle(){return!0}static from(e,t,n){var o,l;if("string"==typeof e?e=document.querySelector(e):(null===(o=e)||void 0===o?void 0:o.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),"string"==typeof t&&(t=document.querySelector(t)),null==e||e.isRectangle)return e;if(e=e.element||e,n===i&&"boolean"==typeof t&&(n=t,t=null),null===(l=t)||void 0===l||!l.isRectangle)if(t){let{scrollLeft:e,scrollTop:n}=t;s.isSafari&&t===document.body&&(e=n=0),t=bn.from(t).translate(-e,-n)}else t=ln;const a=e===document||e===r,c=e===document.body&&0===document.body.offsetHeight,d=c&&e.getBoundingClientRect(),u=c?new bn(d.left,d.top,d.width,document.body.parentElement.scrollHeight):a?new bn(0,0,r.innerWidth,r.innerHeight):e.getBoundingClientRect(),h=n||a?[0,0]:[r.pageXOffset,r.pageYOffset];return new bn(u.left+h[0]-t.x,u.top+h[1]-t.y,u.width,u.height)}static fromScreen(e,t){return bn.from(e,t,!0)}static inner(e,t,n=!1){const r=this.from(e,t,n);if(document.body.contains(e)){const t=Lr.getStyleValue(e,Kt);r.x+=parseFloat(t[tn]),r.y+=parseFloat(t[Qt]),r.right-=parseFloat(t[Zt]),r.bottom-=parseFloat(t[en])}return r}static content(e,t,n=!1){const r=this.from(e,t,n);if(document.body.contains(e)){const t=Lr.getStyleValue(e,Kt),n=Lr.getStyleValue(e,Jt);r.x+=parseFloat(t[tn])+parseFloat(n[sn]),r.y+=parseFloat(t[Qt])+parseFloat(n[nn]),r.right-=parseFloat(t[Zt])+parseFloat(n[rn]),r.bottom-=parseFloat(t[en])+parseFloat(n[on])}return r}static client(e,t,n=!1){const r=this.content(e,t,n),i=Lr.scrollBarWidth;let o;return i&&(e.scrollHeight>e.clientHeight&&"hidden"!==Lr.getStyleValue(e,"overflow-y")&&(o=parseFloat(Lr.getStyleValue(e,"padding-right")),r.right+=o-Math.max(o,i)),e.scrollWidth>e.clientWidth&&"hidden"!==Lr.getStyleValue(e,"overflow-x")&&(o=parseFloat(Lr.getStyleValue(e,"padding-bottom")),r.bottom+=o-Math.max(o,i))),r}static outer(e,t,n=!1){const r=this.from(e,t,n);if(document.body.contains(e)){const t=Lr.getStyleValue(e,Xt);r.x-=parseFloat(t["margin-left"]),r.y-=parseFloat(t["margin-top"]),r.right+=parseFloat(t["margin-right"]),r.bottom+=parseFloat(t["margin-bottom"])}return r}static union(...e){let t,{x:n,y:r,right:i,bottom:o}=e[0];if(e.length>1)for(let s=1;s<e.length;s++)t=e[s],t.x<n&&(n=t.x),t.y<r&&(r=t.y),t.right>i&&(i=t.right),t.bottom>o&&(o=t.bottom);return new bn(n,r,i-n,o-r)}roundPx(e=r.devicePixelRatio||1){const t=this;return t._x=Lr.roundPx(t._x,e),t._y=Lr.roundPx(t._y,e),t._width=Lr.roundPx(t._width,e),t._height=Lr.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}constructor(e,t,n,r){Yt.assertNumber(e,"Rectangle.x"),Yt.assertNumber(t,"Rectangle.y"),Yt.assertNumber(n,"Rectangle.width"),Yt.assertNumber(r,"Rectangle.height");const i=this;n<0&&(e+=n,n=-n),r<0&&(t+=r,r=-r),i._x=e,i._y=t,i._width=n,i._height=r}clone(){const e=this,t=new bn(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return!!e.isRectangle&&(e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom)}intersect(e,t=!1,n=!1){const r=this,i=Math.max(r.y,e.y),o=Math.min(r.right,e.right),s=Math.min(r.bottom,e.bottom),l=Math.max(r.x,e.x);return!!(n?s>=i&&o>=l:s>i&&o>l)&&(!!t||new bn(l,i,o-l,s-i))}equals(e,t=!1){const n=t?e=>Math.round(e):e=>e;return e.isRectangle&&n(e.x)===n(this.x)&&n(e.y)===n(this.y)&&n(e.width)===n(this.width)&&n(e.height)===n(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){return new bn.Point(this.x+this.width/2,this.y+this.height/2)}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,n,r){const i=this;return i.x+=e,i.y+=t,i.width+=n,i.height+=r,i}inflate(e,t=e,n=e,r=t){return Array.isArray(e)&&([e,t,n,r]=fn(e)),this.adjust(-r,-e,t,n)}deflate(e,t=e,n=e,r=t){return Array.isArray(e)&&([e,t,n,r]=fn(e)),this.adjust(r,e,-t,-n)}constrainTo(e,t){const n=this,r=n.height,i=n.y,o=n.minWidth||n.width,s=n.minHeight||n.height;if(n.height>=e.height){if(t&&s>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&o>e.width)return n.y=i,n.height=r,!1;n._x=e.x,n.width=e.width}return n.translate.apply(n,n.constrainVector=[Math.min(e.right-n.right,0),Math.min(e.bottom-n.bottom,0)]),n.translate(Math.max(e.x-n.x,0),Math.max(e.y-n.y,0)),n}alignTo(e){let t,n,i,o,s=this.clone(),{target:l,constrainTo:a,constrainPadding:c}=e;if(l&&!l.isRectangle&&(l=bn.from(l.element?l.element:l)),a){if(!a.isRectangle){o=a===r||a===document;const t="ignorePageScroll"in e?e.ignorePageScroll:!o;a=bn.from(a.element?a.element:a,null,t)}c&&(c=fn(c),c[0]=Math.min(c[0],l.top),c[1]=Math.min(c[1],a.right-l.right),c[2]=Math.min(c[0],a.bottom-l.bottom),c[3]=Math.min(c[0],l.left),a=a.deflate.apply(a.clone(),c))}const d=this,u=null==(R=e.offset)?pn:"number"==typeof R?[R,R]:R,{align:h,axisLock:g,anchorSize:p,anchorPosition:m,matchSize:f,position:v,rtl:b}=e,y=function(e,t){const n=an.exec(e),r=n[1],i=n[3],o=parseInt(n[2]||50),s=parseInt(n[4]||50),l=!t||1&un[r]?o:100-o,a=!t||1&un[i]?s:100-s;return{myAlignmentPoint:r+l,myEdge:r,myOffset:l,targetAlignmentPoint:i+a,targetEdge:i,targetOffset:a,startZone:un[i],edgeAligned:gn[r+i]}}(h,b),C=a&&a.clone(),w=[],x=[{zone:n=y.startZone,align:h}],S=f&&mn[1&y.startZone],E=d[S];var R;if(S&&g?s[S]=l[S]:!y.edgeAligned&&f&&(s.width=l.width,s.height=l.height),a&&s.constrainTo(a),a&&null!=y.startZone)if(g)x.push({zone:n=(n+2)%4,align:vn(y)}),"flexible"===g&&(x.push({zone:n=(y.startZone+1)%4,align:hn[n]}),x.push({zone:n=(n+2)%4,align:hn[n]}));else for(let e=1;e<4;e++)x.push({zone:n=(n+1)%4,align:hn[n]});if(m){const e=1&y.startZone?"y":"x";t={[e]:m[e],edge:dn[(y.startZone+2)%4]}}if(C&&l&&(C.adjust(-l.width,-l.height,l.width,l.height),l.constrainTo(C)),s.minWidth=d.minWidth,s.minHeight=d.minHeight,v)s.moveTo(v.x,v.y),s.translate.apply(s,u),a&&s.constrainTo(a);else{const e="c"===y.myEdge||"c"===y.targetEdge,n=p&&!e?[p[1]+u[0],p[1]+u[1]]:u,r=l.getAlignmentPoint(y.targetAlignmentPoint,n),c=s.getAlignmentPoint(y.myAlignmentPoint);s.translate(r[0]-c[0],r[1]-c[1]);let h=s.intersect(l,!0);if(h)a&&s.constrainTo(a),i=y.startZone,s.translate(...n);else if(a&&!a.contains(s)){const e=s.clone(),r=[];let c,u;t=null,w[0]=c=a.clone(),c.bottom=l.y-n[1],w[1]=c=a.clone(),c.x=l.right+n[0],w[2]=c=a.clone(),c.y=l.bottom+n[1],w[3]=c=a.clone(),c.right=l.x-n[0];for(let e=0;e<x.length;e++){if(S&&2==e&&(s[S]=E),c=w[i=x[e].zone],s=s.alignTo({target:l,offsets:n,align:x[e].align}),s.constrainTo(c,!0)&&(r.push({result:s,zone:i}),!u||s.width<d.width||s.height<d.height)){s.align=x[e].align;break}if(!u||c.area>u.area){const e=s.clone();switch(i){case 0:e.moveTo(null,c.bottom-e.height);break;case 1:e.moveTo(c.left);break;case 2:e.moveTo(null,c.top);break;case 3:e.moveTo(c.right-e.width)}u={area:c.area,result:e,zone:i}}}r.length?(r.length>1&&!g&&r.sort(((t,n)=>Math.sqrt((e.x-t.result.x)**2+(e.y-t.result.y)**2)-Math.sqrt((e.x-n.result.x)**2+(e.y-n.result.y)**2))),s=r[0].result,i=r[0].zone):(s=u.result,i=u.zone,o&&s.constrainTo(a))}else i=y.startZone;if(s.zone=i,s.overlap=h=s.intersect(l,!0),p&&!h){if(!t){const e=1&i,n=e?"y":"x",r=e?"bottom":"right",o=Math.max(l[n],s[n]);let a=o+(Math.min(l[r],s[r])-o)/2-p[0]/2;const c=a+p[0];c>s[r]&&(a-=c-s[r]),a<s[n]&&(a+=s[n]-a),t={[n]:a-s[n],edge:dn[(i+2)%4]}}s.anchor=t}}return s}getAlignmentPoint(e,t=pn){const n=this,r=cn.exec(e),i=r[1].toLowerCase(),o=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(i){case"t":return[n.x+n.width*o,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*o];case"b":return[n.x+n.width*o,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*o];case"c":return[n.x+n.width/2,n.y+n.height/2]}}highlight(){const e=this,t=Lr.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;\n                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return Lr.highlight(t).then((()=>t.remove()))}visualize(e,t){const n=this,r=Yt.merge({style:{left:`${n.x}px`,top:`${n.y}px`,width:`${n.width}px`,height:`${n.height}px`,pointerEvents:"none",...e.class?{}:{position:"absolute","z-index":9999999}}},e);return t?r:Lr.createElement(r)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}}bn._$name="Rectangle";const yn=Symbol("value"),Cn=Symbol("length");class wn{static change(e,t,n,r="string"){n=wn.normalize(n,"object");const i=wn.normalize(e,"array").filter((e=>!n[e]));if(t){t=wn.normalize(t,"array");for(let e=0;e<t.length;++e)i.includes(t[e])||i.push(t[e])}return wn.normalize(i,r)}static from(e,t){return e&&(e.isDomClassList?t=t??!0:(t=t??(m.isObject(e)&&!m.isEmpty(e)),e=new wn(e)),e.value||t||(e=null)),e||(t?new wn:null)}static normalize(e,t="string"){const n=typeof(e=e||""),r="array"===t,i=!r&&!("object"===t);let o,s,l,a="string"===n;var c;"object"===n&&(e.nodeType===Element.ELEMENT_NODE&&"function"==typeof e.getAttribute?(e=e.getAttribute("class")||"",a=!0):null!==(c=e)&&void 0!==c&&c.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter((t=>e.get(t))):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=m.getTruthyKeys(e)));for(a&&(e=[...new Set(A.split(e))]),s=e.length;s-- >0;)o=e[s],o.length?o.includes(" ")&&e.splice(s,1,...A.split(o)):e.splice(s,1);if(r)l=e;else if(i)l=e.join(" ");else for(l=Object.create(null),s=0;s<e.length;++s)l[e[s]]=!0;return l}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new wn(this)}contains(e){return!("string"!=typeof e||!e)&&Boolean(this[e])}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=wn.normalize(e,"array"),n=t.length;if(this.length===n){for(let e=0;e<n;e++)if(!this[t[e]])return!1;return!0}return!1}get value(){let e,t=this[yn];return null==t&&(e=m.getTruthyKeys(this),this[Cn]=e.length,this[yn]=t=e.join(" ")),t}set value(e){const t=this,n=Object.keys(t),r=n.length;for(let e=0;e<r;e++)delete t[n[e]];e?t.process(1,[e]):delete t[yn]}get values(){return m.getTruthyKeys(this)}get length(){return this.value?this[Cn]:0}process(e,t){for(let n,r,i=0;i<t.length;i++)if(t[i])if(n=t[i],n.isDomClassList||m.isObject(n))for(r in n)this[r]=e?n[r]:!n[r];else for(n=wn.normalize(t[i],"array"),r=0;r<n.length;++r)this[n[r]]=e;return delete this[yn],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[yn]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,n=wn.from(t);n.add(this),t.value=n.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=Boolean(!this[e])){if(t=Boolean(t),Boolean(this[e])!==t)return this[e]=t,delete this[yn],!0}split(){return m.getTruthyKeys(this)}forEach(e){return m.getTruthyKeys(this).forEach(e)}}wn.prototype[yn]=null,wn._$name="DomClassList";const xn=e=>e.floating,Sn={touchend:1,pointerup:1},En={Meta:1,Control:1,Alt:1},Rn=new class extends(fe.mixin(je)){suspendFocusEvents(){An=!0}resumeFocusEvents(){An=!1}setupFocusListenersOnce(e,t){e&&!Rn.observedElements.has(e)&&(Rn.setupFocusListeners(e,t),Rn.observedElements.add(e))}setupFocusListeners(e=document,t,n=!1){var i;const o={element:e,touchstart(e){if(Dn||1!==e.changedTouches.length)Dn=null;else if(Dn=e.changedTouches[0],!s.isAndroid){const n=({clientX:e,clientY:t,type:n})=>{(Sn[n]||Math.max(Math.abs(e-Dn.clientX),Math.abs(t-Dn.clientY))>5)&&(Mn=null,r(),clearTimeout(i))},r=t.on({element:document,touchmove:n,touchend:n,pointermove:n,pointerup:n,capture:!0}),i=setTimeout((()=>{Mn=Dn.identifier,r(),e.target.dispatchEvent(new MouseEvent("contextmenu",t.copyEvent({},e)))}),t.longPressTime)}},touchend:{handler:e=>{Dn&&(e.changedTouches[0].identifier===Mn?(e.stopImmediatePropagation(),!1!==e.cancelable&&e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===Dn.identifier&&Rn.trigger("globaltap",{event:e}),Dn=null)},passive:!1},mousedown:{handler:e=>{Fn="mouse",Dn||Rn.trigger("globaltap",{event:e}),kn=e;const t=e.ctrlKey||e.altKey||e.shiftKey||e.metaKey;!In&&t?In=new KeyboardEvent("keydown",{key:e.ctrlKey?"Control":e.shiftKey?"Shift":e.altKey?"Alt":"Meta",ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}):In&&!t&&(In=null)},passive:!1},mouseup(){kn=null},pointerdown:{passive:!1,handler:t=>{var n;On=t,Lr.usingKeyboard=!1,null===(n=e.classList)||void 0===n||n.remove("b-using-keyboard"),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&Lr.removeClsGlobally(e,"b-using-keyboard")}},pointerup:{passive:!1,handler:e=>{var t;(null===(t=On)||void 0===t?void 0:t.pointerId)===e.pointerId&&(On=null)}},keydown(t){if(Fn="key",In=t,!En[t.key])if(Lr.usingKeyboard=!0,e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(const t of e.children)t.matches(".b-outer")&&t.classList.add("b-using-keyboard");else e.classList.add("b-using-keyboard")},keypress(){Fn="key"},keyup(){In=null},focusin(e){var t,n;const{Widget:r}=Rn;if(null!==(t=e.target)&&void 0!==t&&t.shadowRoot||null!==(n=e.target)&&void 0!==n&&n._shadowRoot)return;if(r.resetFloatRootScroll(),An)return;const i=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,o=e.target||document.body,s=r.fromElement(i),l=r.fromElement(o),a=Lr.getCommonAncestor(s,l),c=!!(i&&4&o.compareDocumentPosition(i)),d=r.query(Tn);let u=null;if(u=o&&o!==document.body?Lr.getActiveElement(o):Lr.getActiveElement(document),d&&!d._isRevertingFocus&&(!l||!d.owns(l)&&!(4&d.element.compareDocumentPosition(l.element)&&l.up(xn))))return d.focus();let h=Pn("focusout",i,e.target,s,l,c);for(let t,n=s;n&&n!==a;n=t)if(t=n.owner,!n.isDestroying&&n.onFocusOut&&(n.onFocusOut(h),e.target&&u!==Lr.getActiveElement(e.target)))return;if(a&&e.target===a.element)!a.isDestroying&&Lr.getActiveElement(a)===o&&a.focusElement&&a.focusElement!==a.element&&(a.element.contains(u)&&!a.focusDescendant||a.setTimeout((()=>{var e;return null===(e=a.focus)||void 0===e?void 0:e.call(a)}),0));else{h=Pn("focusin",o,i,s,l,c);for(let e=l;e&&e!==a;e=e.owner){var g,p;if(!e.isDestroying)null===(g=(p=e).onFocusIn)||void 0===g||g.call(p,h)}}const m=Lr.getCommonAncestor((null==i?void 0:i.nodeType)===Element.ELEMENT_NODE?i:null,o)||o.parentNode;m&&(h=Pn("focusmove",o,i,s,l,c,{bubbles:!0}),m.dispatchEvent(h))},focusout(e){if(!(An||e.relatedTarget&&Rn.Widget.fromElement(e.relatedTarget))){const t=e.relatedTarget&&e.relatedTarget instanceof HTMLElement?e.relatedTarget:null;o.focusin({target:t,relatedTarget:e.target}),In=kn=null}},blur:{element:r,handler(e){e.target===r&&(In=null,kn=null)}},capture:!0,passive:!0};n&&(null===(i=Ln)||void 0===i||i()),Ln=this.detachEvents=t.on(o)}get lastInteractionType(){return Fn}get shiftKeyDown(){var e;return null===(e=In)||void 0===e?void 0:e.shiftKey}get ctrlKeyDown(){var e,t;return(null===(e=In)||void 0===e?void 0:e.ctrlKey)||(null===(t=In)||void 0===t?void 0:t.metaKey)}get altKeyDown(){var e;return null===(e=In)||void 0===e?void 0:e.altKey}isKeyDown(e){var t;return e?(null===(t=In)||void 0===t?void 0:t.key)===e||!0===In[(null==e?void 0:e.toLowerCase())+"Key"]:Boolean(In)}isMouseDown(e=0){var t;return(null===(t=kn)||void 0===t?void 0:t.button)===e}get currentMouseDown(){return kn}get currentPointerDown(){return On}get currentTouch(){return Dn}get currentKeyDown(){return In}},Tn=e=>e.isVisible&&e.isTopModal;Rn.observedElements=new Set;let Dn,Mn,Fn,In,kn,On,Ln,An=!1;function Pn(e,t,n,r,i,o,s){const l=new CustomEvent(e,s);return Object.defineProperty(l,"_target",{get:()=>t}),Object.defineProperty(l,"relatedTarget",{get:()=>n}),l.fromWidget=r,l.toWidget=i,l.backwards=o,l}class _n extends bn{static from(e){const t=e.changedTouches;return new _n(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}constructor(e,t){super(e,t,0,0)}constrain(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}toArray(){return[this.x,this.y]}}Object.getPrototypeOf(_n).Point=_n,_n._$name="Point";const $n=["clientX","clientY","pageX","pageY","screenX","screenY"],Nn={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},Hn=!0,Vn={configurable:Hn,value:!0},Bn={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},zn={Control:"ctrl",Alt:"alt",Shift:"shift"},Wn=/^(ctrl|shift|alt|meta)$/,jn=["altKey","bubbles","button","buttons","cancelBubble","cancelable","clientX","clientY","ctrlKey","layerX","layerY","metaKey","pageX","pageY","returnValue","screenX","screenY","shiftKey"];class Gn{static eventNameMap={mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mousemove:"MouseMove",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"};static normalizeEvent(e){return Yt.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],$n)}static copyEvent(e,t){return Yt.copyProperties(e,t,jn)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const n=Un.getXY(e),r=Un.getXY(t);return Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2))}static getPagePoint(e){return new bn.Point(e.pageX,e.pageY)}static getClientPoint(e){return new bn.Point(e.clientX,e.clientY)}static addListener(e,t,n,r){return r=e.nodeType?"string"==typeof t?Object.assign({element:e,[t]:n},r):Object.assign({element:e},t):e,Un.on(r)}static on(e){const t=e.element,n=e.thisObj,r=[];for(const n in e)if(!Nn[n]){let i=e[n];"object"!=typeof i&&(i={handler:i});const o=i.element||t;r.push(Un.addElementListener(o,n,i,e))}const i=()=>{for(let e,t=0;t<r.length;t++)e=r[t],Un.removeEventListener(e[0],e[1],e[2]);r.length=0};return n&&!1!==e.autoDetach&&(n.doDestroy=Te.createInterceptor(n.doDestroy,i,n)),i}static addElementListener(e,t,n,o){const s=Un.createHandler(e,t,n,o),{spec:l}=s,a=n.expires||o.expires,c=null!=l.capture||null!=l.passive?{capture:l.capture,passive:l.passive}:i;if(e.addEventListener(t,s,c),a){const i=n.thisObj||o.thisObj,l=null!=i&&i.isDelayable?i:r,{alt:c}=a,d=c?a.delay:a,{spec:u}=s;u.expires=a,u.timerId=l["number"==typeof d?"setTimeout":"requestAnimationFrame"]((()=>{u.timerId=null,Un.removeEventListener(e,t,s),c&&!s.called&&("string"==typeof c?i[c]:c).call(i)}),d,`listener-timer-${performance.now()}`)}return[e,t,s,c]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,n,r;if(e.fixed)return e;const{type:i,target:o}=e;if((null!=o&&o.shadowRoot||null!=o&&null!==(t=o.getRootNode)&&void 0!==t&&null!==(n=t.call(o))&&void 0!==n&&n.host)&&e.composedPath){const t=this.getComposedPathTarget(e),n=o;Object.defineProperty(e,"target",{value:t,configurable:Hn}),Object.defineProperty(e,"originalTarget",{value:n,configurable:Hn})}if(Object.defineProperty(e,"fixed",Vn),i.startsWith("key")){const t=Bn[e.key];t&&Object.defineProperty(e,"key",{value:t,configurable:Hn})," "!==e.key||e.code||Object.defineProperty(e,"code",{value:"Space",configurable:Hn})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",Vn),o&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(s.isSafari?0:parseInt(o.ownerDocument.defaultView.getComputedStyle(o).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(s.isSafari?0:parseInt(o.ownerDocument.defaultView.getComputedStyle(o).getPropertyValue("border-top-width")))})),(null==o?void 0:o.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){const t=Lr.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:t,configurable:Hn})}if((null==o?void 0:o.nodeType)===Element.TEXT_NODE){const t=e.target.parentElement;Object.defineProperty(e,"target",{value:t,configurable:Hn})}if((null===(r=e.relatedTarget)||void 0===r?void 0:r.nodeType)===Element.TEXT_NODE){const t=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:t,configurable:Hn})}return i.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,n,i){const o=n.delay||i.delay,s=n.throttled||i.throttled,l=n.block||i.block,a="once"in n?n.once:i.once,c="capture"in n?n.capture:i.capture,d="passive"in n?n.passive:i.passive,u="delegate"in n?n.delegate:i.delegate,h=n.handler,g=n.expires,p=n.thisObj||i.thisObj,{rtlSource:m=p}=p||{};let f=(e,...t)=>{Un.playingDemo&&e.isTrusted||null!=p&&p.isDestroyed||(e=Un.fixEvent(e,null==m?void 0:m.rtl),f.called=!0,("string"==typeof h?p[h]:h).call(p,e,...t),delete e.target,delete e.relatedTarget,delete e.originalarget,delete e.key,delete e.code,delete e.ctrlKey,delete e.fixed)};if(l){const e=f;let t,n;f=(r,...i)=>{const o=performance.now();(!t||r.target!==n||o-t>l)&&(n=r.target,t=o,e(r,...i))}}if(null!=o){const e=f,t=null!=p&&p.setTimeout?p:r;f=(...n)=>{t.setTimeout((()=>{e(...n)}),o)}}if(null!=s){let e,t=s;s.buffer&&(e=e=>s.alt.call(Un,Un.fixEvent(e,null==m?void 0:m.rtl)),t=s.buffer),f=null!=p&&p.isDelayable?p.throttle(f,{delay:t,throttled:e}):Te.createThrottled(f,t,p,null,e)}if(a){const n=f;f=(...r)=>{Un.removeEventListener(e,t,f),n(...r)}}if(u){const e=f;f=(t,...n)=>{var r;const i=(null===(r=(t=Un.fixEvent(t,null==m?void 0:m.rtl)).target.closest)||void 0===r?void 0:r.call)&&t.target.closest(u);i&&(Object.defineProperty(t,"currentTarget",{get:()=>i,configurable:!0}),e(t,...n))}}return n.thisObj&&!1!==n.autoDetach&&(p.doDestroy=Te.createInterceptor(p.doDestroy,(()=>Un.removeEventListener(e,t,f)),p)),f.spec={delay:o,throttled:s,block:l,once:a,thisObj:p,capture:c,expires:g,passive:d,delegate:u},f}static removeEventListener(e,t,n){const{expires:i,timerId:o,thisObj:s,capture:l}=n.spec;if(null!=i&&i.alt&&o){(null!=s&&s.isDelayable?s:r)["number"==typeof i.delay?"clearTimeout":"cancelAnimationFrame"](o)}e.removeEventListener(t,n,l)}static onTransitionEnd({element:e,animationName:t,property:n,handler:i,mode:o=(t?"animation":"transition"),duration:s=Lr[`get${"transition"===o?"Property":""}${A.capitalize(o)}Duration`](e,n),thisObj:l=r,args:a=[],timerSource:c,runOnDestroy:d}){let u;c=c||(l.isDelayable?l:r);const h=[e,n,...a],g=()=>{p(),l.isDestroyed||(l.callback?l.callback(i,l,h):i.apply(l,h))},p=Un.on({element:e,[`${o}end`]({animationName:r,propertyName:i,target:o}){if(o===e&&(i===n||null!=r&&r.match(t))){var s,l;if(u)null===(s=(l=c).clearTimeout)||void 0===s||s.call(l,u),u=null;g()}}});return null!=s&&(u=c.setTimeout(g,s+50,"onTransitionEnd",d)),p}static async waitForTransitionEnd(e){return new Promise((t=>{e.handler=t,Gn.onTransitionEnd(e)}))}static createDblClickWrapper(e,t,n){let r,i,o;return()=>{i||(i=Un.on({element:e,touchstart:e=>{r=e.changedTouches[0].identifier,e.preventDefault()},touchend:e=>{if(e.changedTouches[0].identifier===r){e.preventDefault(),clearTimeout(o),r=i=null;const s=bn.from(e.changedTouches[0].target,null,!0),l=e.changedTouches[0].pageX-s.x,a=e.changedTouches[0].pageY-s.y,c=Object.assign({browserEvent:e},e),d=new MouseEvent("dblclick",c);Object.defineProperties(d,{target:{value:e.target},offsetX:{value:l},offsetY:{value:a}}),"string"==typeof t&&(t=n[t]),t.call(n,d)}},once:!0}),o=setTimeout((()=>{i(),r=i=null}),Un.dblClickTime))}}static toSpecialKey(e,t=(s.isMac?"metaKey":"ctrlKey")){let n=!1;return!0===e?n=t:"string"==typeof e&&(e=e.toLowerCase()).match(Wn)&&(n=`${e}Key`),n}static specialKeyFromEventKey(e){return zn[e]||"no-special-key"}}const Un=Gn;Un.longPressTime=700,Un.dblClickTime=300,s.isTouchDevice&&Un.on({element:document,touchmove:e=>{e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),Gn._$name="EventHelper";const Yn={align:"t0-t0"},qn=Node.ELEMENT_NODE,Kn=Node.TEXT_NODE,{isObject:Xn}=Yt,Jn=/[+-]?\d*\.?\d+[eE]?-?\d*/g,Qn=Jn.source,Zn=new RegExp(`matrix\\((?:${Qn}),\\s?(?:${Qn}),\\s?(?:${Qn}),\\s?(?:${Qn}),\\s?(${Qn}),\\s?(${Qn})`),er=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),tr=new RegExp(`(?:${Zn.source})|(?:${er.source})`),nr=new RegExp(`translate(3d|X)?\\((${Qn})px(?:,\\s?(${Qn})px)?`),rr=new RegExp(`translate(3d|Y)?\\((${Qn})px(?:,\\s?(${Qn})px)?`),ir=/\s+/,or=/\s*;\s*/,sr=/\s*:\s*/,lr=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,ar={elementData:"",for:"htmlFor",retainElement:""},cr={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},dr={length:1,parentRule:1,style:1},ur={INPUT:1,TEXTAREA:1},hr={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},gr=r,pr=document,mr=Object.freeze({}),fr=Array.prototype.slice,vr=Promise.resolve(),br=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],yr=e=>e._hidden,Cr=(e,t,n)=>"children"===n.key?Yt.mergeItems(e,t,n):Yt.blend(e,t,n),wr=e=>{const t=e.ownerDocument.defaultView.getComputedStyle(e);return"none"!==t.getPropertyValue("display")&&"hidden"!==t.getPropertyValue("visibility")},xr=e=>e&&(e===pr.body||Boolean(e.offsetParent)||(e.ownerDocument.defaultView&&"offsetParent"in e&&"fixed"!==Lr.getStyleValue(e,"position")?e.offsetParent:xr(e.parentNode))),Sr=e=>e instanceof Node?e:"string"==typeof e?Ar.createElementFromTemplate(e):Ar.createElement(e),Er=Object.create(null),Rr=(e,t)=>{const n=Er[e]||[A.hyphenate(e),t];return Er[e]||(Er[n[0]]=Er[e]=n),n},Tr=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach((e=>Rr(e,!0)));let Dr,Mr,Fr,Ir=null,kr=0,Or=null;class Lr{static async slideIn(e,t=1){const n="b-slide-in-"+(t>0?"next":"previous"),{classList:r,parentNode:{classList:i}}=e;i.add(".b-sliding-child-element"),r.add(n),await Gn.waitForTransitionEnd({element:e,animationName:Tr}),r.remove(n),i.remove(".b-sliding-child-element")}static isFocusable(e,t=!1){if(!t&&(!Ar.isVisible(e)||Ar.Widget.fromElement(e,yr)))return!1;const n=e.nodeName;return hr[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}static isEditable(e){return e.isContentEditable||ur[e.nodeName]}static isInView(e,t=!1,n){if(!xr(e))return!1;const i=(null==n?void 0:n.positioned)&&"fixed"!==Lr.getStyleValue(n.element,"position"),o=bn.from(r),s=t?"contains":"intersect",l=i&&n.element.offsetParent,a=i&&bn.from(l);if(o.height=pr.scrollingElement.scrollHeight,e===pr.body)return o;const c=this.getViewportIntersection(e,o,s);return c&&i&&c.translate(pr.scrollingElement.scrollLeft,pr.scrollingElement.scrollTop),i&&c?c.translate(-a.x+l.scrollLeft,-a.y+l.scrollTop):c}static getViewportIntersection(e,t,n){const{parentNode:r}=e,{parentElement:i}=r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,o=i.ownerDocument.defaultView.getComputedStyle(i),s="visible"!==o.overflowX||"visible"!==o.overflowY,l=(a=e).ownerSVGElement?a.ownerSVGElement.parentNode:a.offsetParent;var a;let c=bn.from(e,null,!0);for(let r=s?e.parentNode:l;c&&r!==pr.documentElement;r=r.parentNode){r.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&r.host&&(r=r.host.parentNode);const e=r===pr.body,i=r.ownerDocument.defaultView.getComputedStyle(r),o=e?t:bn.inner(r,null,!0);(e||"visible"!==i.overflow)&&(c=o[n](c,!1,!0))}return c}static isVisible(e){const t=e.ownerDocument;for(;e;e=(n=e).parentNode||n.host){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!wr(e))return!1}var n;return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return Yt.blend(e,t,{merge:Cr})}static normalizeChildren(e,t,n){var r;let i,o,s,l,a,c=null==e?void 0:e.children;if(null!=e&&null!==(r=e.syncOptions)&&void 0!==r&&r.ignoreRefs&&(n=!0),c&&!(e instanceof Node))if(Array.isArray(c))for(o=0;o<c.length;++o)Ar.normalizeChildren(c[o],t,n);else for(s in l=c,e.children=c=[],l){var d;i=l[s],null!==(d=i)&&void 0!==d&&d.isWidget&&(i=i.element),a=!s.startsWith("$")&&!Ar.isElement(i),a&&(null==t||t(s,!n)),i&&(i instanceof Node||(!1===i.reference?delete i.reference:a&&"string"!=typeof i&&(i.reference=s),Ar.normalizeChildren(i,t,n)),c.push(i))}return e}static roundPx(e,t=r.devicePixelRatio||1){const n=1/t;return Math.round(e/n)*n}static floorPx(e,t=r.devicePixelRatio||1){const n=1/t;return Math.floor(e*n)/n}static isCustomElement(e){return Boolean(null==e?void 0:e.shadowRoot)}static elementFromPoint(e,t){let n=document.elementFromPoint(e,t);return Ar.isCustomElement(n)&&(n=n.shadowRoot.elementFromPoint(e,t)||n),n}static childFromPoint(e,t,n,r=e){const i=null==n?t:new bn(t,n,0,0);let o=null;return Array.from(e.children).reverse().some((e=>{if(bn.from(e,r).contains(i))return o=e.children.length&&Ar.childFromPoint(e,i,null,r)||e,!0})),o}static unitize(e,t,n="px"){const[r,i]=Rr(e);return null!=t&&(t=String(t),t=i&&lr.test(t)?t+n:t),[r,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){var t,n;null!==(t=e)&&void 0!==t&&t.isWidget&&(e=e.element);let r=((null===(n=e)||void 0===n?void 0:n.getRootNode())||document).activeElement;for(;null!==(i=r)&&void 0!==i&&i.shadowRoot;){var i;r=r.shadowRoot.activeElement}return r}static getRootElement(e){var t;const n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e),{nodeType:r}=n;return r===Node.DOCUMENT_NODE?n.body:r===Node.DOCUMENT_FRAGMENT_NODE?n:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t,n;const r=null===(t=(n=e).getRootNode)||void 0===t?void 0:t.call(n);if(null!=r&&r.body)return null==r?void 0:r.body;for(;e.parentNode!==r&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||"ShadowRoot"===e.constructor.name}static getId(e){return e.id||(e.id="b-element-"+ ++kr)}static getCommonAncestor(e,t){if(e===t)return e;for(;e&&!(null!==(n=(r=e)[e.isWidget?"owns":"contains"])&&void 0!==n&&n.call(r,t)||e===t);){var n,r;e=e.owner||e.parentNode}return e}static getElement(e){return e instanceof Element?e:pr.querySelector(e)}static setAttributes(e,t){const n=Ar.getElement(e);if(n&&t)for(const e in t)null==t[e]?n.removeAttribute(e):n.setAttribute(e,t[e])}static setLength(e,t,n){return n=1===arguments.length?"number"==typeof e?`${e}px`:e??"":(e=Ar.getElement(e)).style[t]="number"==typeof n?`${n}px`:n??""}static percentify(e,t=2){const n=Math.pow(10,t);return null==e||""===e||isNaN(e)?"":Math.round(e*n)/n+"%"}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return null!=Ar.getChild(e,t)}static children(e,t){return(">"===t[0]||t.startsWith("# "))&&("#"===t[0]&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const n=Ar.getRootElement(e),r=Ar.getRootElement(t);return r&&n!==r&&r.host?Ar.isDescendant(n,r.host):e.contains(t)}static getEventElement(e,t="target"){return!e||Ar.isElement(e)?e:e[t]}static isElement(e){return(null==e?void 0:e.nodeType)===document.ELEMENT_NODE&&Ar.isNode(e)}static isReactElement(e){return(null==e?void 0:e.$$typeof)===Symbol.for("react.element")}static isNode(e){return Boolean(e)&&"number"==typeof e.nodeType&&!Xn(e)}static forEachSelector(e,t,n){if("string"==typeof e)throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");Ar.children(e,t).forEach(n)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){Ar.forEachSelector(e,t,(e=>e.remove()))}static removeClsGlobally(e,...t){t.forEach((t=>Ar.forEachSelector(e,"."+t,(e=>e.classList.remove(t)))))}static up(e,t){return P.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,n=null){let r,i=!1,o=e;for(t=H.asArray(t);o=o.parentElement;){if(t.includes(o)){i=!0;break}if(n&&o===n)break;r=o}return i?r||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return A.makeValidDomId(e,t)}static createElement(e={},t){var n,r,i;let o,s,l,a,c,d,u,h,g,p,m,f=t;if("boolean"==typeof f)throw new Error("Clean up");t&&(c=t.ignoreRefs,g=t.refOwner,p=t.refs,f=t.returnAll,m=t.syncIdField,c&&(l=!0,c="children"!==c)),"string"==typeof e.parent&&(e.parent=document.getElementById(e.parent));const v=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:b,html:y,reference:C,syncOptions:w,text:x}=e;if(w&&(m=w.syncIdField||m,a=w.ignoreRefs,a&&(l=!0,c="children"!==a,t={...t,ignoreRefs:!0})),c&&(g=null),o=e.ns?pr.createElementNS(e.ns,e.tag||"svg"):pr.createElement(e.tag||"div"),null!=x?Ar.setInnerText(o,x):null!=y&&(y instanceof DocumentFragment?o.appendChild(y):o.innerHTML=y),e.tooltip&&Ar.Widget.attachTooltip(o,e.tooltip),e.style&&Ar.applyStyle(o,e.style),b)for(u in b)h=b[u],null!=h&&(o.dataset[u]=h);v&&this.addChild(v,o,e.nextSibling),g&&(o.$refOwnerId=g.id),C&&!c&&(g?(o.$reference=C,g.attachRef(C,o,e)):(p||((t=Object.assign({},t)).refs=p={}),p[C]=o,o.setAttribute("data-reference",C)));const S=e.className||e.class,E=Object.keys(e);for(S&&o.setAttribute("class",wn.normalize(S)),s=0;s<E.length;++s)u=E[s],h=e[u],null!=(d=ar[u])?o[d||u]=h:!cr[u]&&u&&null!=h&&o.setAttribute(u,h);return e["aria-hidden"]||e.role||e.tabIndex||Lr.isFocusable(o,!0)||o.htmlFor||o.setAttribute("role","presentation"),null===(n=t)||void 0===n||null===(r=n.callback)||void 0===r||r.call(n,{action:"newElement",domConfig:e,targetElement:o,syncId:g?C:t.syncIdField&&(null===(i=e.dataset)||void 0===i?void 0:i[t.syncIdField])}),!0===f?t.returnAll=f=[o]:Array.isArray(f)&&f.push(o),e.children&&(m&&(o.syncIdMap={}),e.children.forEach((n=>{if(n)if("string"==typeof n){const e=document.createTextNode(n);g&&(e.$refOwnerId=g.id),o.appendChild(e)}else if(isNaN(n.nodeType)){var r,i;n.parent=o,!n.ns&&e.ns&&(n.ns=e.ns);const s=Ar.createElement(n,{...t,ignoreRefs:(null===(r=e.syncOptions)||void 0===r?void 0:r.ignoreRef)??l}),a=null===(i=n.dataset)||void 0===i?void 0:i[m];null!=a&&(o.syncIdMap[a]=s),delete n.parent}else o.appendChild(n)}))),o.lastDomConfig=e,p||f||o}static createElementFromTemplate(e,t=mr){const{array:n,raw:r,fragment:i}=t;let o;if(Ar.supportsTemplate){if((Dr||(Dr=pr.createElement("template"))).innerHTML=e,o=Dr.content,i)return o.cloneNode(!0)}else if(o=(Mr||(Mr=new DOMParser)).parseFromString(e,"text/html").body,i){const e=o.childNodes;for(o=document.createDocumentFragment();e.length;)o.appendChild(e[0]);return o}return o=r?o.childNodes:o.children,1!==o.length||n?fr.call(o):o[0]}static triggerMouseEvent(e,t="contextmenu"){const n=(this.isInView(e)||bn.from(e)).center,r=new MouseEvent(t,{clientX:n.x,clientY:n.y,bubbles:!0});e.dispatchEvent(r)}static insertFirst(e,t){return t&&t.nodeType!==qn&&t.tag&&(t=Ar.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,n){return t&&t.nodeType!==qn&&t.tag&&(t=Ar.createElement(t)),n?e.insertBefore(t,n):Ar.insertFirst(e,t)}static insertAt(e,t,n){const r=Array.from(e.children);if(n>=r.length)return Ar.append(e,t);const i=r[n];return Ar.insertBefore(e,t,i)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map((e=>Sr(e)))),e.append)e.append(...t);else{const n=document.createDocumentFragment();t.forEach((function(e){n.appendChild(e)})),e.appendChild(n)}return t}return e.appendChild(Sr(t))}static getTranslateX(e){const t=e.style.transform;let n=nr.exec(t);return n?parseFloat(n[2]):(n=tr.exec(t)||tr.exec(Ar.getStyleValue(e,"transform")),n?parseFloat(n[1]||n[3]):0)}static getTranslateY(e){const t=e.style.transform;let n=rr.exec(t);if(n){const e=parseFloat(n["Y"===n[1]?2:3]);return isNaN(e)?0:e}return n=tr.exec(t)||tr.exec(Ar.getStyleValue(e,"transform")),n?parseFloat(n[2]||n[4]):0}static getTranslateXY(e){return[Ar.getTranslateX(e),Ar.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[Ar.getOffsetX(e,t),Ar.getOffsetY(e,t)]}static focusWithoutScrolling(e){if(!s.isSafari)e.focus({preventScroll:!0});else{const t=Ar.getParents(e).map((e=>({element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop})));e.focus(),setTimeout((()=>function(e){e.forEach((({element:e,scrollLeft:t,scrollTop:n})=>{e.scrollLeft!==t&&(e.scrollLeft=t),e.scrollTop!==n&&(e.scrollTop=n)}))}(t)),0)}}static getPageX(e){return e.getBoundingClientRect().left+gr.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+gr.pageYOffset}static getExtremalSizePX(e,t){const n=A.hyphenate(t),r=n.split("-")[1];let i=Ar.getStyleValue(e,n);return i=/%/.test(i)?e.parentElement?parseInt(Ar.getStyleValue(e.parentElement,r),10):NaN:parseInt(i,10),i}static setScale(e,t,n=t){const r=Ar.getStyleValue(e,"transform").split(/,\s*/);r.length>1?(r[0].startsWith("matrix3d")?(r[0]=`matrix3d(${t}`,r[5]=n):(r[0]=`matrix(${t}`,r[3]=n),e.style.transform=r.join(",")):e.style.transform=`scale(${t}, ${n})`}static setTranslateX(e,t){const n=Ar.getStyleValue(e,"transform").split(/,\s*/);t=Ar.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?12:4]=t,e.style.transform=n.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const n=Ar.getStyleValue(e,"transform").split(/,\s*/);t=Ar.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?13:5]=t,e.style.transform=n.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){Ar.setLength(e,"top",t)}static setLeft(e,t){Ar.setLength(e,"left",t)}static setTopLeft(e,t,n){Ar.setLength(e,"top",t),Ar.setLength(e,"left",n)}static setRect(e,{x:t,y:n,width:r,height:i}){Ar.setTopLeft(e,n,t),Ar.setLength(e,"width",r),Ar.setLength(e,"height",i)}static setTranslateXY(e,t,n){if(null==t)return Ar.setTranslateY(e,n);if(null==n)return Ar.setTranslateX(e,t);t=Ar.roundPx(t),n=Ar.roundPx(n);const r=Ar.getStyleValue(e,"transform").split(/,\s*/),i=r[0].startsWith("matrix3d");r.length>1?(r[i?12:4]=t,r[i?13:5]=n,e.style.transform=r.join(",")+")"):e.style.transform=`translate(${t}px, ${n}px)`}static addTranslateX(e,t){Ar.setTranslateX(e,Ar.getTranslateX(e)+t)}static addTranslateY(e,t){Ar.setTranslateY(e,Ar.getTranslateY(e)+t)}static addLeft(e,t){Ar.setLeft(e,Ar.getOffsetX(e)+t)}static addTop(e,t){Ar.setTop(e,Ar.getOffsetY(e)+t)}static alignTo(e,t,n=Yn,r){t=t instanceof bn?t:bn.from(t,!0);const i=Ar.getTranslateXY(e),o=bn.from(e,!0);r&&(o.roundPx(),t.roundPx());const s=o.alignTo(Object.assign(n,{target:t}));Ar.setTranslateXY(e,i[0]+s.x-o.x,i[1]+s.y-o.y)}static getStyleValue(e,t,n,r){const i=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){const e={};for(const n of t)e[n]=i.getPropertyValue(A.hyphenate(n));return e}return i.getPropertyValue(A.hyphenate(t))}static getEdgeSize(e,t,n){const r="border"===t?"-width":"",i={raw:{}};for(const o of["top","right","bottom","left"])n&&!n.includes(o[0])||(i[o]=parseFloat(i.raw[o]=Ar.getStyleValue(e,`${t}-${o}${r}`)));return i.width=(i.left||0)+(i.right||0),i.height=(i.top||0)+(i.bottom||0),i}static parseStyle(e){if("string"==typeof e){const t=e.split(or);e={};for(let n=0,{length:r}=t;n<r;n++){const r=t[n].split(sr);e[r[0]]=r[1]}}return e||{}}static applyStyle(e,t,n=!1){if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){let r,i;for(r in n&&(e.style.cssText=""),t.style&&"string"!=typeof t.style&&(t=Yt.assign({},t,t.style)),t)dr[r]||([r,i]=Ar.unitize(r,t[r]),null==i?e.style.removeProperty(r):e.style.setProperty(r,i));"string"==typeof t.style&&(e.style.cssText+=t.style)}}static getCSSText(e){if("string"==typeof e)return e;let t="";for(const n in e)dr[n]||(t+=`${A.hyphenate(n)}:${e[n]};`);return t}static addClasses(e,t){P.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){P.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,n=null){t=H.asArray(t),!0===n?e.classList.add(...t):!1===n?e.classList.remove(...t):t.forEach((t=>e.classList.toggle(t)))}static addTemporaryClass(e,t,n,i=r){n>0&&(e.classList.add(t),i.setTimeout({fn:t=>e.classList.remove(t),delay:n,name:t,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const n=r.getComputedStyle(e),i=n.transitionProperty.split(", "),o=n.transitionDuration.split(", "),s=i.indexOf(A.hyphenate(t));let l;return-1!==s&&(l=1e3*parseFloat(o[s])),l}static getAnimationDuration(e){return 1e3*parseFloat(Ar.getStyleValue(e,"animation-duration"))}static highlight(e,t=r){return e instanceof bn?e.highlight():new Promise((n=>{t.setTimeout((()=>{e.classList.add("b-fx-highlight"),t.setTimeout((()=>{e.classList.remove("b-fx-highlight"),n()}),1e3)}),0)}))}static get scrollBarWidth(){if(null===Ir){const e=Fr||(Fr=Ar.createElement({parent:pr.documentElement,style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==pr.documentElement&&pr.documentElement.appendChild(e),Ir=e.offsetWidth}return Ir}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){Ir=null}static measureText(e,t,n=!1,r=i){const o=Ar.getMeasureElement(t,r);o[n?"innerHTML":"innerText"]=e;const s=o.clientWidth;return o.className="",s}static measureSize(e,t,n=!0){if(!e)return 0;if("number"==typeof e)return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const r=Ar.getMeasureElement(t);r.innerHTML="",r.style.width=Ar.setLength(e);const i=n?r.offsetWidth:r.getBoundingClientRect().width;return r.style.width=r.className="",i}return/^\d+em$/.test(e)?14*parseInt(e):isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=pr.body){const n=gr.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||Ar.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return br.forEach((e=>{r.style[e]!==n[e]&&(r.style[e]=n[e])})),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}static stripTags(e){return(Ar.$domParser||(Ar.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=Ar.createElementFromTemplate(e)}return Ar.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML&&(Ar.syncAttributes(e,t),Ar.syncContent(e,t),Ar.syncChildren(e,t),!0)}static getSyncAttributes(e){const t={},n=[];for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r];if(i.specified){const e=i.name.toLowerCase();t[e]=i.value,n.push(e)}}return{attributes:t,names:n}}static syncAttributes(e,t){const{attributes:n,names:r}=Ar.getSyncAttributes(e),{attributes:i,names:o}=Ar.getSyncAttributes(t),s=r.includes("dataset"),l=r.filter((e=>!o.includes(e))),a=o.filter((e=>!(r.includes(e)||s&&e.startsWith("data-")))),c=r.filter((e=>o.includes(e)));if(l.length>0)for(let e=0;e<l.length;e++){const r=l[e];"style"===r?Ar.applyStyle(t,n.style,!0):"dataset"===r?Object.assign(t.dataset,n.dataset):t.setAttribute(r,n[r])}if(a.length>0)for(let e=0;e<a.length;e++)t.removeAttribute(a[e]);if(c.length>0)for(let e=0;e<c.length;e++){const r=c[e];if("style"===r)Ar.applyStyle(t,n.style,!0);else if("dataset"===r)Object.assign(t.dataset,n.dataset);else if("class"!==r||!n.class.isDomClassList&&"object"!=typeof n.class)i[r]!==n[r]&&t.setAttribute(r,n[r]);else{let e;e=n.class.isDomClassList?n.class:new wn(n.class),e.isEqual(i.class)||t.setAttribute("class",e)}}}static syncContent(e,t){0===Ar.getChildElementCount(e)&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:n}=e;(null==n?void 0:n.nodeType)===Element.TEXT_NODE?n.data=t:e.textContent=t}static syncChildren(e,t){const n=this,r=fr.call(e.childNodes),i=fr.call(t.childNodes);for(;r.length;){const e=r.shift(),o=i.shift();if(e&&e.nodeType!==Kn&&e.nodeType!==qn)throw new Error(`Source node type ${e.nodeType} not supported by DomHelper.sync()`);if(o&&o.nodeType!==Kn&&o.nodeType!==qn)throw new Error(`Target node type ${o.nodeType} not supported by DomHelper.sync()`);if(o)if(e.nodeType===o.nodeType)e.nodeType===Kn?o.data=e.data:e.tagName===o.tagName?n.performSync(e,o):(t.insertBefore(e,o),o.remove());else{if(e.nodeType!==Kn||o.nodeType!==qn){const t=e.parentElement||e;throw new Error(`Currently no support for transforming nodeType.\n${t.outerHTML}`)}t.innerText=e.data.trim()}else t.appendChild(e)}i.forEach((e=>{e.remove()}))}static syncClassList(e,t){const{classList:n}=e,r="string"==typeof t,i=r?t.split(ir):wn.normalize(t,"array"),o=i.length;let s,l=n.length!==o;for(s=0;!l&&s<o;s++)l=!n.contains(i[s]);return l&&(e.className=r?t:i.join(" ")),l}static updateClassList(e,t){const{classList:n}=e;let r,i,o=!1;for(r in t)i=Boolean(t[r]),n.contains(r)!==i&&(n[i?"add":"remove"](r),o=!0);return o}static setTheme(e,t){e=e.toLowerCase();const{head:n}=document,r=Ar.getThemeInfo(t).name.toLowerCase();let i=n.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),o=0;if(r===e)return vr;Ar.removeEachSelector(n,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const s={theme:e,prev:r};function l(t,n,l){const a=Lr.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:t.href.replace(r,e),nextSibling:t});a.addEventListener("load",(()=>{delete a.dataset.loading,Or=null,++o===i.length&&(i.forEach((e=>e.remove())),Rn.trigger("theme",s),n(s))})),a.addEventListener("error",(e=>{delete a.dataset.loading,l(e)}))}if(i.length)return new Promise(((e,t)=>{i.forEach(((n,r)=>{l(n,e,t,i.length)}))}));{const e=n.querySelector("#bryntum-theme:not([data-loading])")||n.querySelector(`[href*="${r}.css"]:not([data-loading])`);if(null==e||!e.href.includes(`${r}.css`))throw new Error(`Theme link for ${r} not found`);return i=[e],new Promise(((t,n)=>l(e,t,n)))}}static get themeInfo(){return Lr.getThemeInfo()}static getThemeInfo(e){if(!Or){const t=Ar.createElement({parent:document.body,className:"b-theme-info"}),n=Ar.getStyleValue(t,"content",!1,":before");if(n)try{Or=JSON.parse(n.replace(/^["']|["']$|\\/g,""))}catch(e){Or=null}Or=Or||(e?{name:e}:null),t.remove()}return Or}static async transition({element:e,selector:t="[data-dom-transition]",duration:n,action:i,thisObj:o=this,addTransition:s={},removeTransition:l={}}){const a=new Set,c=Array.from(e.querySelectorAll(t)),d=new Map(c.map((t=>{let n=0,r=t.parentElement;for(;r&&r!==e;)n++,r=r.parentElement;t.$depth=n,t.scrollHeight>t.offsetHeight&&"auto"===getComputedStyle(t).overflow&&(t.$scrollTop=t.scrollTop,a.add(t));const{parentElement:i}=t,o=bn.from(t,e),s=bn.from(t,i),l=getComputedStyle(i),c=parseFloat(l.borderLeftWidth);return c&&(o.left-=c,s.left-=c),[t.id,{element:t,globalBounds:o,localBounds:s,depth:n,parentElement:i}]})));i.call(o);const u=Array.from(e.querySelectorAll(t)),h=new Map(u.map((t=>{const n=bn.from(t,e),i=bn.from(t,t.parentElement),o=r.getComputedStyle(t.parentElement),s=parseFloat(o.borderLeftWidth);return s&&(n.left-=s,i.left-=s),[t.id,{element:t,globalBounds:n,localBounds:i}]}))),g=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[t,n]of d){const r=h.get(t);if(r){const{element:t}=r,{style:i,parentElement:o}=t,s=parseInt(Ar.getStyleValue(t,"zIndex")),{globalBounds:l,localBounds:c,depth:d,parentElement:u}=n,h=u!==o;let p;Yt.copyProperties(t.$initial={parentElement:o},i,g),h?(r.bounds=r.globalBounds,p=l,e.appendChild(t)):(r.bounds=r.localBounds,p=c,u.appendChild(t));let m="hidden";a.has(t)&&(t.$scrollPlaceholder=Ar.createElement({parent:t,style:{height:t.scrollHeight}}),m="auto");const f={position:"absolute",top:`${p.top}px`,left:`${p.left}px`,width:`${p.width}px`,height:`${p.height}px`,minWidth:0,minHeight:0,margin:0,zIndex:d+(s||0),overflow:m};"preserve-padding"!==t.dataset.domTransition&&(f.padding=0),Object.assign(i,f),r.processed=!0}else{const{element:e,localBounds:r,depth:i,parentElement:o}=n;e.$initial={removed:!0},Object.assign(e.style,{position:"absolute",top:`${r.top}px`,left:`${r.left}px`,width:`${r.width}px`,height:`${r.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:i,overflow:"hidden"}),o.appendChild(e),h.set(t,{element:e,bounds:r,removed:!0,processed:!0}),u.push(e)}}for(const[,e]of h)if(!e.processed){const{element:t}=e,{style:n,parentElement:r}=t,i=e.bounds=e.localBounds;t.classList.add("b-dom-transition-adding"),Yt.copyProperties(t.$initial={parentElement:r},n,g),Object.assign(n,{position:"absolute",top:s.top?0:`${i.top}px`,left:s.left?0:`${i.left}px`,width:s.width?0:`${i.width}px`,height:s.height?0:`${i.height}px`,opacity:s.opacity?0:null,zIndex:r.$depth+1,overflow:"hidden"})}for(const e of a)e.scrollTop=e.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:e,bounds:t,removed:n}]of h)n?Object.assign(e.style,{top:l.top?0:`${t.top}px`,left:l.left?0:`${t.left}px`,width:l.width?0:`${t.width}px`,height:l.height?0:`${t.height}px`,opacity:l.opacity?0:e.$initial.opacity}):Object.assign(e.style,{top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,opacity:e.$initial.opacity});await V.sleep(n),e.classList.remove("b-dom-transition");for(const e of u)e.$initial&&(e.$initial.removed?e.remove():(Yt.copyProperties(e.style,e.$initial,g),e.$scrollPlaceholder&&(e.$scrollPlaceholder.remove(),delete e.$scrollPlaceholder),e.classList.remove("b-dom-transition-adding"),e.$initial.parentElement.appendChild(e)));for(const e of a)e.scrollTop=e.$scrollTop,delete e.$scrollTop}static async loadScript(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)}))}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb)/.test(e)}static get NodeFilter(){return NodeFilter}static addChild(e,t,n){e.insertBefore(t,n)}static cloneStylesIntoShadowRoot(e,t){return new Promise(((n,r)=>{t&&e.querySelectorAll('style, link[rel="stylesheet"]').forEach((e=>e.remove()));const i=document.querySelectorAll('link[rel="stylesheet"]');let o=0;i.forEach((t=>{const s=t.cloneNode();s.addEventListener("load",(()=>{o+=1,o===i.length&&n()})),s.addEventListener("error",(e=>{r(s.href)})),e.appendChild(s)})),document.querySelectorAll("style").forEach((t=>{e.appendChild(t.cloneNode())}))}))}}const Ar=Lr;let Pr;const _r=()=>Ar.isTouchEvent=!1,$r=()=>{Ar.isTouchEvent=!0,clearTimeout(Pr),Pr=setTimeout(_r,400)};if(pr.addEventListener("touchstart",$r,!0),pr.addEventListener("touchend",$r,!0),Ar.canonicalStyles=Er,Ar.supportsTemplate="content"in pr.createElement("template"),Ar.elementPropKey="$bryntum",Ar.numberRe=Jn,!("children"in Node.prototype)){const e=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,e)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){const t=(this.document||this.ownerDocument).querySelectorAll(e);let n=t.length;for(;--n>=0&&t.item(n)!==this;);return n>-1}),gr.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){let t=this;if(!pr.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&t.nodeType===t.ELEMENT_NODE);return null}:Node.prototype.closest=function(e){var t;return null===(t=this.parentNode)||void 0===t?void 0:t.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),r.addEventListener("resize",(()=>Ir=null)),Lr._$name="DomHelper";const Nr={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3,SHOW_ALL:4294967295,SHOW_ELEMENT:1,SHOW_ATTRIBUTE:2,SHOW_TEXT:4,SHOW_CDATA_SECTION:8,SHOW_ENTITY_REFERENCE:16,SHOW_ENTITY:32,SHOW_PROCESSING_INSTRUCTION:64,SHOW_COMMENT:128,SHOW_DOCUMENT:256,SHOW_DOCUMENT_TYPE:512,SHOW_DOCUMENT_FRAGMENT:1024,SHOW_NOTATION:2048},Hr=Object.create||function(e){function t(){}return t.prototype=e,new t},Vr={first:"firstChild",last:"lastChild",next:"firstChild",previous:"lastChild"},Br={next:"nextSibling",previous:"previousSibling"},zr=Vr.toString,Wr=function(e,t){return zr.call(e).toLowerCase()==="[object "+t.toLowerCase()+"]"},jr=function(e,t){return 1<<t.nodeType-1&e.whatToShow?null===e.filter?Nr.FILTER_ACCEPT:e.filter.acceptNode(t):Nr.FILTER_SKIP},Gr=function(e,t){let n,r,i,o,s;for(r=e.currentNode[Vr[t]];null!==r;){if(o=jr(e,r),o===Nr.FILTER_ACCEPT)return e.currentNode=r,r;if(o!==Nr.FILTER_SKIP||(n=r[Vr[t]],null===n))for(;null!==r;){if(s=r[Vr[t]],null!==s){r=s;break}if(i=r.parentNode,null===i||i===e.root||i===e.currentNode)return null;r=i}else r=n}return null},Ur=function(e,t){let n,r,i;if(n=e.currentNode,n===e.root)return null;for(;;){for(i=n[Br[t]];null!==i;){if(n=i,r=jr(e,n),r===Nr.FILTER_ACCEPT)return e.currentNode=n,n;i=n[Vr[t]],r===Nr.FILTER_REJECT&&(i=n[Br[t]])}if(n=n.parentNode,null===n||n===e.root)return null;if(jr(e,n)===Nr.FILTER_ACCEPT)return null}},Yr=function(e,t){if(e===t)return null;if(null!==e.nextSibling)return e.nextSibling;for(;null!==e.parentNode;){if((e=e.parentNode)===t)return null;if(null!==e.nextSibling)return e.nextSibling}return null};class qr{constructor(e,t,n){const r=this;let i=!1;if(!e||!e.nodeType)throw new Error("DOMException: NOT_SUPPORTED_ERR");r.root=e,r.whatToShow=Number(t)||0,r.currentNode=e,Wr(n,"function")?(r.filter=Hr(Nr),r.filter.acceptNode=function(e){if(i)throw new Error("DOMException: INVALID_STATE_ERR");i=!0;const t=n(e);return i=!1,t}):r.filter=null}parentNode(){let e=this.currentNode;for(;null!==e&&e!==this.root;)if(e=e.parentNode,null!==e&&jr(this,e)===Nr.FILTER_ACCEPT)return this.currentNode=e,e;return null}firstChild(){return Gr(this,"first")}lastChild(){return Gr(this,"last")}previousSibling(){return Ur(this,"previous")}nextSibling(){return Ur(this,"next")}previousNode(){let e,t,n;for(e=this.currentNode;e!==this.root;){for(n=e.previousSibling;null!==n;){for(e=n,t=jr(this,e);t!==Nr.FILTER_REJECT&&null!==e.lastChild;)e=e.lastChild,t=jr(this,e);if(t===Nr.FILTER_ACCEPT)return this.currentNode=e,e;n=e.previousSibling}if(e===this.root||null===e.parentNode)return null;if(e=e.parentNode,jr(this,e)===Nr.FILTER_ACCEPT)return this.currentNode=e,e}return null}nextNode(){let e,t,n;for(e=this.currentNode,t=Nr.FILTER_ACCEPT;;){for(;t!==Nr.FILTER_REJECT&&null!==e.firstChild;)if(e=e.firstChild,t=jr(this,e),t===Nr.FILTER_ACCEPT)return this.currentNode=e,e;if(n=Yr(e,this.root),null===n)return null;if(e=n,t=jr(this,e),t===Nr.FILTER_ACCEPT)return this.currentNode=e,e}}}function Kr(e,t,n){return t=t===i?Nr.SHOW_ALL:t,n&&Wr(n.acceptNode,"function")?n=n.acceptNode:Wr(n,"function")||(n=null),new qr(e,t,n)}const Xr=[],Jr={},Qr=Array.prototype.slice;let Zr;function ei(e){let t;if(1===e.nodeType){t=document.createElement(e.tagName),Lr.syncAttributes(e,t);ti(e.childNodes).forEach((e=>t.appendChild(e)))}return 3===e.nodeType&&(t=document.createTextNode(e.wholeText)),t}function ti(e){if(e instanceof Node)return ei(e);{const t=[];for(let n=0,r=e.length;n<r;n++)t.push(ei(e[n]));return t}}Lr.supportsTemplate=!1;N.apply(class{static get target(){return{class:Lr}}static getRootElement(e){var t;const n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return(null==n?void 0:n.body)||(null==n?void 0:n.firstChild)||n||e.ownerDocument.body}static getChildElementCount(e){return e.children.length}static isValidFloatRootParent(e){return e.isConnected&&!e.parentElement}static createElementFromTemplate(e,t=Jr){const{array:n,raw:r,fragment:i}=t;let o;if(o=(Zr||(Zr=new DOMParser)).parseFromString(e,"text/html").body,i){const e=o?o.childNodes:Xr;o=document.createDocumentFragment();for(let t=0,n=e.length;t<n;t++)o.appendChild(ti(e[t]));return o}return o=r?o.childNodes:o.children,o=1!==o.length||n?Qr.call(o):o[0],ti(o)}static isDOMEvent(e){return e&&"stopImmediatePropagation"in e}static get NodeFilter(){return Nr}static addChild(e,t,n){e===document.body||e===document.documentElement?e.appendChild(t):this._overridden.addChild.call(this,e,t,n)}});const ni=Node.prototype.contains;Node.prototype.contains=function(e){return e===this||ni.apply(this,arguments)};N.apply(class{static get target(){return{class:s}}static get supportsPointerEvents(){return"onpointerdown"in HTMLElement.prototype}}),Object.defineProperty(s,"queryString",{get(){if(r.location.href){var e;const t=new URL(r.location.href).searchParams;return null===(e=Object.fromEntries)||void 0===e?void 0:e.call(Object,t.entries())}return{}}});const{defineProperty:ri}=Reflect;let ii;ii=s.isBrowserEnv?r.performance:{now:()=>(new Date).getTime()};let oi=null;if(P.isTestEnv){const e=r.bryntum||(r.bryntum={});oi=e.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty:(e=!1)=>oi.timeouts.size+oi.animationFrames.size+oi.idleCallbacks.size+(e?oi.intervals.size:0)===0,getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:n=!1}){const r=[],i=["timeouts","animationFrames","idleCallbacks"];n&&i.push("intervals");for(const n of i){const i=oi[n];for(const[,n]of i.entries())e.includes(n.name)||Number.isInteger(n.delay)&&!(n.delay<t)||r.push(n)}return r}}}const si=(e,t,n,r)=>{const i="string"==typeof t,o=(null==r?void 0:r.appendArgs)||[],s=()=>{n.timerId=null,n.lastCallTime=ii.now();const r=n.args;n.args=null,i?e[t](...r,...o):t.call(e,...r,...o),n.called=!0,++n.calls};return r&&(e=r.thisObj||e),n.lastCallTime=-9e9,n.calls=0,n.invoker=s,s.wrapFn=n,s},li=(e,t,n="clearTimeout")=>(t.cancel=()=>{t.isPending&&(e[n](t.timerId),t.args=t.timerId=null)},t.flush=()=>{t.isPending&&(e[n](t.timerId),t.timerId=null,t.invoker())},t.now=(...e)=>{t.cancel(),t.args=e,t.invoker()},t.resume=e=>{const n=t.suspended;t.suspended=e||n<1?0:n-1},t.suspend=()=>{++t.suspended},t.immediate=!1,t.suspended=0,t.timerId=null,ri(t,"isPending",{get:()=>null!==t.timerId}),t);var ai=e=>class extends(e||fe){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const e=this;super.doDestroy(),e.timeoutIds&&(e.timeoutIds.forEach(((e,t)=>{var n;"function"==typeof e&&e(),clearTimeout(t),null===(n=oi)||void 0===n||n.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach(((e,t)=>clearTimeout(t))),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((e=>{var t;clearInterval(e),null===(t=oi)||void 0===t||t.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((e=>{var t;cancelAnimationFrame(e),null===(t=oi)||void 0===t||t.animationFrames.delete(e)})),e.animationFrameIds=null),e.idleCallbackIds&&(e.idleCallbackIds.forEach((e=>{var t;cancelIdleCallback(e),null===(t=oi)||void 0===t||t.idleCallbacks.delete(e)})),e.idleCallbackIds=null)}hasTimeout(e){var t;return Boolean(null===(t=this.timeoutMap)||void 0===t?void 0:t.has(e))}setTimeout({fn:e,delay:t,name:n,runOnDestroy:r,cancelOutstanding:i,args:o}){var s;(arguments.length>1||"function"==typeof arguments[0])&&([e,t,n,r]=arguments),"string"==typeof e?n=e:n||(n=e.name||e),i&&this.clearTimeout(n);const l=this,a=l.timeoutIds||(l.timeoutIds=new Map),c=l.timeoutMap||(l.timeoutMap=new Map),d=setTimeout((()=>{var t;"string"==typeof e&&(e=l[n]),null==a||a.delete(d),null==c||c.delete(n),null===(t=oi)||void 0===t||t.timeouts.delete(d),e.apply(l,o)}),t);return a.set(d,!r||e),null===(s=oi)||void 0===s||s.timeouts.set(d,{fn:e,delay:t,name:n}),n&&c.set(n,d),d}clearTimeout(e){var t,n;let r=e;if("string"==typeof r){if(!this.timeoutMap)return;r=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(r),null===(t=this.timeoutIds)||void 0===t||t.delete(r),null===(n=oi)||void 0===n||n.timeouts.delete(r)}clearInterval(e){var t,n;clearInterval(e),null===(t=this.intervalIds)||void 0===t||t.delete(e),null===(n=oi)||void 0===n||n.intervals.delete(e)}setInterval(e,t,n){var r;const i=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(i),null===(r=oi)||void 0===r||r.intervals.set(i,{fn:e,delay:t,name:n}),i}requestAnimationFrame(e,t=[],n=this){var r;const i=this.animationFrameIds||(this.animationFrameIds=new Set),o=requestAnimationFrame((()=>{var r;null===(r=oi)||void 0===r||r.animationFrames.delete(o),i.delete(o)&&e.apply(n,t)}));return i.add(o),null===(r=oi)||void 0===r||r.animationFrames.set(o,{fn:e,extraArgs:t,thisObj:n}),o}requestIdleCallback(e,t=[],n=this){var r;const i=this.idleCallbackIds||(this.idleCallbackIds=new Set),o=requestIdleCallback((()=>{var r;null===(r=oi)||void 0===r||r.idleCallbacks.delete(o),i.delete(o)&&e.apply(n,t)}));return i.add(o),null===(r=oi)||void 0===r||r.idleCallbacks.set(o,{fn:e,extraArgs:t,thisObj:n}),o}createOnFrame(e,t=[],n=this,r){let i;const o=(...o)=>{null!=i&&r&&(this.cancelAnimationFrame(i),i=null),null==i&&(i=this.requestAnimationFrame((()=>{"string"==typeof e&&(e=n[e]),i=null,o.push(...t),e.apply(n,o)})))};return o.cancel=()=>this.cancelAnimationFrame(i),o}cancelAnimationFrame(e){var t,n;cancelAnimationFrame(e),null===(t=this.animationFrameIds)||void 0===t||t.delete(e),null===(n=oi)||void 0===n||n.animationFrames.delete(e)}cancelIdleCallback(e){var t,n;cancelIdleCallback(e),null===(t=this.idleCallbackIds)||void 0===t||t.delete(e),null===(n=oi)||void 0===n||n.idleCallbacks.delete(e)}async nextAnimationFrame(){return new Promise((e=>this.requestAnimationFrame(e)))}buffer(e,t){let n=t;t&&"number"!=typeof t?n=t.delay:t=null;const r=(...e)=>{if(r.suspended)return;const{delay:t}=r;r.cancel(),r.called=!1,r.args=e,r.immediate||!t?i():r.timerId=this.setTimeout(i,t)},i=si(this,e,r,t);return r.delay=n,li(this,r)}raf(e,t){let n=t;t&&"boolean"!=typeof t?n=t.cancelOutstanding:t=null;const r=(...e)=>{r.suspended||(r.cancelOutstanding&&r.cancel(),r.called=!1,r.args=e,r.immediate?i():r.isPending||(r.timerId=this.requestAnimationFrame(i)))},i=si(this,e,r,t);return r.cancelOutstanding=n,li(this,r,"cancelAnimationFrame")}idle(e,t){let n=t;t&&"boolean"!=typeof t?n=t.cancelOutstanding:t=null;const r=(...e)=>{r.suspended||(r.cancelOutstanding&&r.cancel(),r.called=!1,r.args=e,r.immediate?i():r.isPending||(r.timerId=this.requestIdleCallback(i)))},i=si(this,e,r,t);return r.cancelOutstanding=n,this.setTimeout((()=>this.idleCallbackIds.delete(r.timerId)&&r.now()),100),li(this,r,"cancelIdleCallback")}throttle(e,t){let n,r=t;t&&"number"!=typeof t?(r=t.delay,n=t.throttled):t=null;const i=this,o=(...e)=>{if(o.suspended)return;const{delay:t}=o,r=ii.now()-o.lastCallTime;o.args=e,o.immediate||r>=t?(i.clearTimeout(o.timerId),s()):(o.isPending||(o.timerId=i.setTimeout(s,t-r),o.called=!1),n&&(n.wrapFn.args=e,n()))},s=si(i,e,o,t);return o.delay=r,n&&(n=si(i,n,(()=>{}),t)),li(i,o)}static setupDelayable(e){e.setupDelayableMethods(e.delayable)}static setupDelayableMethods(e,t=null){const n=e.static,r=t||this.prototype;n&&delete e.static;for(const t in e){let n=e[t];const i=t+"Now",o=typeof n;r[i]||(r[i]=r[t]),"number"===o?n={type:"buffer",delay:n}:"string"===o&&(n={type:n}),ri(r,t,{get(){const e=this[n.type](((...e)=>{this[i](...e)}),n);return ri(this,t,{value:e}),e}})}}get widgetClass(){}};class ci extends(fe.mixin(ai)){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var e;null===(e=this.mousedownRemover)||void 0===e||e.call(this),this.cancel(),super.doDestroy()}cancel(){var e,t,n;const r=this;null===(e=r.activeElement)||void 0===e||e.classList.remove(r.pressedCls),r.activeElement=null,null===(t=r.acceleration)||void 0===t||t.cancel(),r.activeListenerRemover=null===(n=r.activeListenerRemover)||void 0===n?void 0:n.call(r),r.clearTimeout(r.autoRepeatTimer),r.clearTimeout(r.repeatTimer)}updateElement(e){var t;null===(t=this.mousedownRemover)||void 0===t||t.call(this),this.mousedownRemover=Gn.on({element:e,mousedown:"onMouseDown",thisObj:this})}onMouseDown(e){const t=this,n=t.delegate?e.target.closest(t.delegate):t.element;t.cancel(),n&&(t.activeElement=n,t.triggerEvent=e,n.classList.add(t.pressedCls),t.activeListenerRemover=Gn.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.autoRepeatTimer=t.setTimeout("startAutoRepeat",t.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(e){const t=this;e.buttons?(t.activeElement.classList.add(t.pressedCls),t.triggerEvent=e,t.fireClick()):t.cancel()}onTargetMouseMove(e){this.triggerEvent=e}startAutoRepeat(){const e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=Te.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}nextTick(e){this.interval=this.startInterval-this.accelerationDelta*e}fireClick(){const e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}}ci._$name="ClickRepeater";N.apply(class{static get target(){return{class:ci}}onMouseDown(e){this._overridden.onMouseDown.apply(this,arguments),this.eventTarget=e.target}fireClick(){var e;const t=this;null===(e=t.eventTarget)||void 0===e||e.dispatchEvent(new MouseEvent("click",Gn.copyEvent({},t.triggerEvent))),t.repeatTimer=t.setTimeout(t.fireClick,t.interval)}});class di extends(fe.mixin(je,et)){static $name="InstancePlugin";static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(e){this.owner||(this.owner=e)}updateKeyMap(e){const{client:t}=this;t.keyMap=t.mergeKeyMaps(t.keyMap,e,A.uncapitalize(this.constructor.$name))}static initPlugins(e,...t){const n=e.plugins||(e.plugins={});for(const r of t)n[r.$$name]=new r(e)}get enabled(){return!this.disabled}getFocusRevertTarget(){var e;return null===(e=this.client)||void 0===e?void 0:e.getFocusRevertTarget()}construct(...e){const t=this;let n,[r,i]=e;1===e.length?Yt.isObject(r)&&(i=r,r=i.client):(i=Yt.assign({},i),delete i.client),t.client=r,super.construct(i),t.applyPluginConfig(r),n=t.clientListeners,n&&(n=Yt.assign({},n),n.thisObj=t,r.ion(n))}applyPluginConfig(e){const t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){const{assign:r,chain:i,after:o,before:s,override:l}=n;r&&t.applyAssign(e,r),(i||o)&&t.applyChain(e,i||o),s&&t.applyChain(e,s,!1),l&&t.applyOverride(e,l)}}applyAssign(e,t){t.forEach((t=>this.assign(e,t)))}applyChain(e,t,n=!0){if(Array.isArray(t))for(const r of t)this.chain(e,r,r,n);else for(const r in t)this.chain(e,r,t[r],n)}applyOverride(e,t){const n=this;n.overridden||(n.overridden={}),t.forEach((t=>{if(!n[t])throw new Error(`Trying to chain fn ${e.$$name}#${t}, but plugin fn ${n.$$name}#${t} does not exist`);"function"==typeof e[t]&&(n.overridden[t]=e[t].bind(e)),e[t]=n[t].bind(n)}))}assign(e,t){const n=this,r=function(e,t){const n=Yt.getPropertyDescriptor(e,t);return n&&(n.get||n.set)?n:null}(n,t);r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(n),set:r.set&&r.set.bind(n)}):e[t]=n[t].bind(n)}chain(e,t,n,r=!0){let i=0;"object"==typeof t&&(t=t.fn),"object"==typeof n&&(i=n.prio||0,n=n.fn);const o=this,s=e.pluginFunctionChain||(e.pluginFunctionChain={}),l=o[n]&&o[n].bind(o),a=o.functionChainRunner;if(!l)throw new Error(`Trying to chain fn ${e.$$name}#${n}, but plugin fn ${o.$$name}#${n} does not exist`);if(!s[t]){let n=e[t];n&&(n=n.bind(e),n.$this=e,n.$prio=0),s[t]=n?[n]:[],e[t]=(...e)=>a(s[t],e)}l.$this=o,l.$prio=i,s[t][r?"push":"unshift"](l),s[t].$sorted=!1}functionChainRunner(e,t){let n,r,i;for(e.$sorted||(e.sort(((e,t)=>t.$prio-e.$prio)),e.$sorted=!0),r=0;r<e.length&&(n=e[r],n.$this.isDestroyed||(i=n(...t),!1!==i));r++);return i}doDisable(e){const t=this,{constructor:n}=t,r="featureClass"in n?n.featureClass:`b-${n.$$name.toLowerCase()}`,i=A.uncapitalize(n.$$name);var o,s,l,a;r&&(null===(o=t.client)||void 0===o||null===(s=o._element)||void 0===s||s.classList[e?"remove":"add"](r));t.isConfiguring||(e?t.trigger("disable"):t.trigger("enable"),null===(l=(a=t.client).syncSplits)||void 0===l||l.call(a,(t=>{const n=t.features[i];n&&(n.disabled=e)})))}updateDisabled(e){this.doDisable(e)}throwOverrideIsMissing(e){throw new Error(`Trying to override fn ${e.plugIntoName}#${e.fnName}, but plugin fn ${e.pluginName}#${e.fnName} does not exist`)}get rootElement(){return this.client.rootElement}}di._$name="InstancePlugin";var ui=e=>class extends(e||fe){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(e){e&&(Array.isArray(e)||(e=[e]),di.initPlugins(this,...e)),this.initPlugins()}initPlugins(){}addPlugins(...e){di.initPlugins(this,...e)}hasPlugin(e){return null!=this.getPlugin(e)}getPlugin(e){var t;return"function"==typeof e&&(e=e.$$name),null===(t=this.plugins)||void 0===t?void 0:t[e]}get widgetClass(){}};class hi{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(e){return null}removeItem(e){}setItem(e,t){}}hi._$name="StateStorage";const gi=()=>Object.create(null),pi=(e,t=0)=>{const n=[],r=localStorage.length;for(let i,o=0;o<r;++o)i=localStorage.key(o),i.startsWith(e)&&n.push(i.slice(t));return n},mi=new hi,fi={local:class extends hi{constructor(e){super(),this.prefix=e.prefix||""}get isLocal(){return!0}get data(){const e=gi(),t=this.keys;for(const n of t)e[n]=this.getItem(n);return e}get keys(){return pi(this.prefix,this.prefix.length)}clear(){const e=pi(this.prefix);for(const t of e)localStorage.removeItem(t)}getItem(e){const t=localStorage.getItem(this.prefix+e);return null===t?t:JSON.parse(t)}removeItem(e){return localStorage.removeItem(this.prefix+e)}setItem(e,t){return localStorage.setItem(this.prefix+e,JSON.stringify(t))}},memory:class extends hi{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return Yt.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=gi()}getItem(e){return e in this._data?this._data[e]:null}removeItem(e){delete this._data[e]}setItem(e,t){this._data[e]=t}}};class vi extends(fe.mixin(ai,je)){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){null==e?e=bi:(("string"==typeof e||Yt.isClass(e)||e instanceof hi)&&(e={storage:e}),Yt.isObject(e)&&(e=new vi(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(e)for(const t in e)this.setValue(t,e[t]);else this.clear()}clear(){return this.storage.clear(),this}changeStorage(e){if(null==e)e=mi;else{if("string"==typeof e){if(!fi[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(fi).join('", "')}")`);e=fi[e]}Yt.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:t}=e,n=null==t?void 0:t.length,r=[],i=[];if(e.pendingSaves=null,n){for(let e,o,s,l=0;l<n;++l)[o,e]=t[l],!o.isDestroying&&o.isSaveStatePending&&(s=o.saveState({...e,immediate:!0}),s&&(r.push(s),i.push(o)));r.length&&e.trigger("save",{stateIds:r,saved:i})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const n=this,{storage:r}=n,i=n.getValue(e);return null!=t?(r.setItem(e,t),n.trigger("set",{key:e,value:t,was:i})):null!==i&&(r.removeItem(e),n.trigger("remove",{key:e,was:i})),n}}const bi=new vi({storage:mi});vi._instance=bi,vi._$name="StateProvider";const yi=/boolean|number|string/;var Ci=e=>class extends(e||fe){static $name="State";static configurable={stateful:{value:null,$config:{merge:"classList"}},statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null};static prototypeProperties={statefulLoaded:!1,statefulSuspended:0};afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(e){this._state=e,e&&this.applyState(e)}updateStatefulEvents(e){const t=this,n={name:"statefulEvents",thisObj:t};if(t.detachListeners(n.name),e&&("string"==typeof e?e=A.split(e):Array.isArray(e)||(e=Yt.getTruthyKeys(e)),e.length)){var r;for(const t of e)n[t]="onStatefulEvent";null===(r=t.ion)||void 0===r||r.call(t,n)}}get statefulId(){const e=this,{responsiveState:t}=e;let n=e.stateId;return null==n&&!1===e.hasGeneratedId&&!1!==e.stateful&&(n=e.id),n&&t&&(n=`${n}[${t}]`),n}get statefulness(){const{stateful:e}=this;return Array.isArray(e)?Yt.createTruthyKeys(e):e}get stateProvider(){return this._stateProvider||vi.instance}applyState(e){(e=this.pruneState(e))&&this.setConfig(e)}getState(){const e=this,{initialConfig:t,statefulness:n,isConstructing:r}=e,{configs:i}=e.$meta,o=r?Object.setPrototypeOf(t,e.$meta.config):e;let s,l,a=null;if(n)for(s in a={},n)if(n[s]){var c;if(l=o[s],null!==(c=l)&&void 0!==c&&c.isStateful)l=l.state;else if(!r&&(Yt.isDate(l)&&(l=Wt.format(l,"YYYY-MM-DDTHH:mm:ssZ")),i[s].equal(l,null==t?void 0:t[s])||!yi.test(typeof l)))continue;a[s]=l}return a}loadState(e,t){"boolean"==typeof e&&(t=e,e=null);const n=this,{statefulLoaded:r}=n;if(n.isStatefulActive&&(t||!r)){const t=n.loadStatefulData(e||(e=n.statefulId));!r&&e&&(n.defaultState=n.state,n.statefulLoaded=!0),t&&(n.state=t)}}loadStatefulData(e){var t;return(e=this.isStatefulActive?e||this.statefulId:null)&&(null===(t=this.stateProvider)||void 0===t?void 0:t.getValue(e))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(e=!1){this.statefulSuspended=e?0:Math.max(this.statefulSuspended-1,0)}saveState(e){e="string"==typeof e?{id:e}:e||{};const t=this,{stateProvider:n}=t,r=e.id||t.isStatefulActive&&t.statefulId;if(r&&n)return e.immediate?(t.isSaveStatePending=!1,n.setValue(r,t.state)):t.isSaveStatePending||(t.isSaveStatePending=!0,n.saveStateful(t,e)),r}suspendStateful(){++this.statefulSuspended}onConfigChange({name:e,value:t,was:n,config:r}){if(super.onConfigChange({name:e,value:t,was:n,config:r}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:t}=this;(Array.isArray(t)?t.includes(e):null==t?void 0:t[e])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(e){const{statefulness:t}=this;if(t){const n={};for(const r in e)t[r]&&(n[r]=e[r]);e=n}return e}get widgetClass(){}};const wi=Yt.getPathDefault(r,"bryntum.idCounts",Object.create(null)),xi={string:1,number:1};var Si=e=>class extends(e||fe){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(e,t){const{identifiable:n}=e;n.idMap=Object.create(null),Reflect.defineProperty(e,"identifiable",{get:()=>n})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(e){return(this.hasGeneratedId=!e)?this.generateAutoId():e}updateId(e,t){const n=this,r=n.constructor;t&&r.unregisterInstance(n,t),n.hasGeneratedId&&!1===r.identifiable.registerGeneratedId||r.registerInstance(n,e)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(e="generatedId"){return e+(wi[e]=(wi[e]||0)+1)}static registerInstance(e,t=e.id){const{idMap:n}=this.identifiable;if(t in n&&!this.disableThrow)throw new Error("Id "+t+" already in use");n[t]=e}static unregisterInstance(e,t=e.id){const{idMap:n}=this.identifiable;xi[typeof e]?delete n[e]:n[t]===e&&delete n[t]}static getById(e){const t=this.identifiable.idMap;if(t)return t[e]}static get registeredInstances(){const e=this.identifiable.idMap;return e?Object.values(e):[]}};const Ei=Symbol("STM_PROP"),Ri={parentIndex:1};var Ti=e=>class extends(e||fe){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(e){this.stm||(this.stm=e.stm)}unjoinStore(e,t=!1){var n;this.stm===e.stm&&(this.stm=null),null===(n=super.unjoinStore)||void 0===n||n.call(this,e,t)}get stm(){return this[Ei]}set stm(e){this[Ei]=e}beforeChronoFieldSet(e,t){var n;const r=this;return r.inSetting||null===(n=r.stm)||void 0===n||!n.enabled||Ri[e]||r.constructor.nonPersistableFields[e]||!r.getFieldDefinition(e)?null:{[e]:{value:t,oldValue:r[e]}}}afterChronoFieldSet(e,t,n){n&&this.afterSet(e,t,!1,!1,n,!0)}shouldRecordFieldChange(e,t,n){const r=this.firstStore;return!(this.constructor.nonPersistableFields[e]||null==t&&null==n||t===n||t instanceof Date&&n instanceof Date&&t.getTime()===n.getTime()||"id"===e||"$PhantomId"===e||"parentId"===e&&r&&r.oldIdMap[t]===r.getById(n))}afterSet(e,t,n,r,i,o){const{stm:s}=this,l=this.constructor.nonPersistableFields;if(null!=s&&s.isBase&&s.enabled&&!Ri[e]&&!l[e]&&i){let e;const[t,n]=Object.keys(i).reduce(((t,n)=>{const{value:r,oldValue:o}=i[n];return this.shouldRecordFieldChange(n,o,r)&&(e=!0,t[0][n]=r,t[1][n]=o),t}),[{},{}]);e&&s.onModelUpdate(this,t,n,o)}}beforeInsertChild(e){var t;const n=(null===(t=super.beforeInsertChild)||void 0===t?void 0:t.call(this,e))||[],{stm:r}=this;return null!=r&&r.enabled&&n.push(e.reduce(((e,t)=>(t.root===this.root&&e.set(t,{parent:t.parent,index:t.parent?t.parentIndex:i}),e)),new Map)),n}afterInsertChild(e,t,n,r){var i;const{stm:o}=this;if(null!=o&&o.enabled){const t=n.pop();r&&o.onModelInsertChild(this,e,r,t)}null===(i=super.afterInsertChild)||void 0===i||i.call(this,e,t,n,r)}beforeRemoveChild(e,t){const n=super.beforeRemoveChild?super.beforeRemoveChild(e,t):[],{stm:r}=this;return null!=r&&r.enabled&&!t&&n.push(e.reduce(((e,t)=>(e.set(t,{parentIndex:t.parentIndex,orderedParentIndex:t.orderedParentIndex}),e)),new Map)),n}afterRemoveChild(e,t,n){var r;const{stm:i}=this;if(null!=i&&i.enabled&&!n){const n=t.pop();e&&e.length&&i.onModelRemoveChild(this,e,n)}null===(r=super.afterRemoveChild)||void 0===r||r.call(this,e,t,n)}};const Di={includeFilteredOutRecords:!1},Mi=e=>("boolean"==typeof(e=e||!1)&&(e={includeFilteredOutRecords:e}),e||Di);var Fi=e=>class extends(e||fe){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e}constructor(...e){super(...e),this.children&&(this.orderedChildren=this.orderedChildren||[])}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(e,t=this.stores){const{inProcessChildren:n,constructor:r}=this,i=t[0];if(!0===e)return!!n||[];if(e){const t=(e=H.asArray(e)).length,n=[];for(let o,s=0;s<t;s++)o=e[s],o=o.isModel?o:i?i.createRecord(o,!1,!0):new r(o,null,null,!0),o=i?i.processRecord(o):o,n.push(o);if(!0===this.children&&i){const e=i.createSorterFn(i.sorters);n.sort(e)}return n}}processChildren(e=this.stores){const t=this,{meta:n}=t;t.inProcessChildren=!0;const r=t.ingestChildren(t.data[t.constructor.childrenField],e);if(r){const{convertEmptyParentToLeaf:e}=t.constructor;if(!0===e||e.onLoad?r.length:Array.isArray(r)){if(n.isLeaf=!1,!0===t.children)t.children=[];else if(0===r.length)return void(t.children=r);t.insertChild(r)}else!0===r?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)}t.inProcessChildren=!1}ancestorsExpanded(e=this.firstStore){const{parent:t}=this;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}isExpanded(e=this.firstStore){const t=this.instanceMeta(e.id);return Object.prototype.hasOwnProperty.call(t,"collapsed")||(t.collapsed=!this.expanded),!t.collapsed}get expanded(){return this.data.expanded}get childLevel(){let e=this,t=-1;for(;e&&!e.isRoot;)++t,e=e.parent;return t}get isLeaf(){return!1!==this.meta.isLeaf&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(e=!1,t=this.firstStore){const{children:n}=this;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce(((t,n)=>t+n.getDescendantCount(e)),n.length)}get allChildren(){return this.getAllChildren(!1)}get allUnfilteredChildren(){return this.getAllChildren(!0)}getAllChildren(e=!1){const{[e?"unfilteredChildren":"children"]:t}=this;return t&&!0!==t?t.reduce(((t,n)=>(t.push(n),t.push.apply(t,e?n.allUnfilteredChildren:n.allChildren),t)),[]):[]}get firstChild(){const{children:e}=this;return(null==e?void 0:e.length)&&e[0]||null}get lastChild(){const{children:e}=this;return(null==e?void 0:e.length)&&e[e.length-1]||null}get previousSiblingsTotalCount(){let e=this.previousSibling,t=this.parentIndex;for(;e;)t+=e.descendantCount,e=e.previousSibling;return t}get previousOrderedSibling(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.orderedChildren[this.orderedParentIndex-1])??null}get nextOrderedSibling(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.orderedChildren[this.orderedParentIndex+1])??null}get root(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(e){const t=this,{parent:n}=t,r=null===e?t.firstStore.rootNode:t.firstStore.getById(e);r!==n&&(n||r)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:r?r.appendChild(t):t.parent.removeChild(t))}static set parentIdField(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(e){let t;return t=e.includeFilteredOutRecords?this.unfilteredChildren||this.children:e.useOrderedTree?this.orderedChildren:this.children,t}traverse(e,t,n){n=Mi(n);const r=this,i=r.getChildren(n);t||e.call(r,r);for(let t=0,r=null==i?void 0:i.length;t<r;t++)i[t].traverse(e,!1,n)}traverseBefore(e,t,n){n=Mi(n);const r=this,i=r.getChildren(n);for(let t=0,r=null==i?void 0:i.length;t<r;t++)i[t].traverse(e,!1,n);t||e.call(r,r)}traverseWhile(e,t,n){n=Mi(n);const r=this;let i=t||!1!==e.call(r,r);if(i){const t=r.getChildren(n);null!=t&&t.length&&(i=t.every((t=>t.traverseWhile(e,!1,n))))}return i}bubble(e,t=!1){let n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}bubbleWhile(e,t=!1){let n=this,r=!0;for(t||(r=e.call(n,n));r&&n.parent;)n=n.parent,r=e.call(n,n);return r}contains(e,t=!1){return e&&"object"==typeof e&&(e=e.id),!this.traverseWhile((t=>t.id!=e),t)}getTopParent(e){let t;return e?(t=[],this.bubbleWhile((e=>(t.push(e),e.parent&&!e.parent.isRoot)))):(t=null,this.bubbleWhile((e=>(t=e,e.parent&&!e.parent.isRoot)))),t}appendChild(e,t=!1,n={}){return this.insertChild(e,null,t,n)}insertChild(e,t=null,n=!1,r={}){var i,o,s,l;const a=this,c=Array.isArray(e);var d;(e=H.asArray(e),"number"==typeof t)&&(t=(null===(d=a.children)||void 0===d?void 0:d[t])??null);if(!n&&!a.stores.every((t=>!1!==t.trigger("beforeAdd",{records:e,parent:a}))))return null;e=a.ingestChildren(e);const u=(null===(i=t)||void 0===i?void 0:i.parentIndex)??(null===(o=a.children)||void 0===o?void 0:o.length)??0,h=null===(s=a.beforeInsertChild)||void 0===s?void 0:s.call(a,e),g=a.internalAppendInsert(e,t,n,r);return g.length&&a.convertToParent(n),null===(l=a.afterInsertChild)||void 0===l||l.call(a,u,e,h,g),c||!g?g:g[0]}convertToParent(e=!1){const t=this,n=t.isLeaf;t.meta.isLeaf=!1,t.children||(t.children=[]),!n||t.root.isLoading||e||t.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(e,t=this.stores){t.forEach((t=>{t.trigger("update",{record:this,records:[this],changes:e}),t.trigger("change",{action:"update",record:this,records:[this],changes:e})}))}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(e,t,n,r){const i=this,{stores:o,root:s,children:l}=i,{firstStore:a}=s,{parentIdField:c}=i.constructor,d=i.id;let u,h,g,p,m,f;if(!s.isLoading&&a)for(f={},m=[],g=0;g<e.length;g++){const t=e[g];f[t.id]=t.root===s,m[g]=t.parentIndex}if(t&&t.parent!==i&&(t=null),l){const n=t?t.parentIndex:l.length;if(l[h=n]===e[0]||l[h=n-1]===e[0])for(u=!0,g=0;u&&g<e.length;g++)e[g]!==l[h+g]&&(u=!1)}if(u)return e;for(g=0;g<e.length;g++){var v;const t=e[g],o=t.parent;if(a&&!s.isLoading&&t.traverse((e=>{e.root===s&&(f[e.id]=!0)})),!1===(null==o?void 0:o.removeChild(t,null===(v=f)||void 0===v?void 0:v[t.id],n,{isInserting:!0,...r})))p||(e=e.slice(),p=!0),e.splice(g--,1);else{t.parent=i,t.data[c]=d;const{meta:e}=t;e.modified[c]!==d||o||(e.oldParentId=d),o&&(e.oldParentId=o.id)}}if(e.length){Array.isArray(l)||(i.children=[]),Array.isArray(i.orderedChildren)||(i.orderedChildren=[]);const s=i.addToChildren(t,e,r);o.forEach((t=>{t.isChained||(e.forEach((e=>{e.joinStore(t)})),t.onNodeAddChild(i,e,s,f,n),e.forEach(((e,r)=>{if(null!=e.meta.oldParentId&&!i.inProcessChildren&&!i.isLoading){const o={[c]:d,[i.getDataSource("parentIndex")]:e.parentIndex},s={},{modified:l,oldParentId:a}=e.meta,u=m[r];if(delete e.meta.oldParentId,i.id!==a&&(s[c]={value:d,oldValue:a}),e.parentIndex!==u&&(s.parentIndex={value:e.parentIndex,oldValue:u}),l[c]===i.id?Reflect.deleteProperty(l,c):c in l||(l[c]=a),f[e.id]){const e=t.getById(a);e.isLeaf&&!n&&e.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}},[t])}e.afterChange(o,s)}e.traverse((e=>{e.ignoreBag||e.isLinked||t.updateModifiedBagForRecord(e)}))})))}))}return e}removeChild(e,t=!1,n=!1,r={}){var i,o;const s=this,l=[],a=s.isLeaf,{children:c,stores:d}=s;if(e=(e=H.asArray(e)).filter((e=>e.parent===s)),!n)for(const n of d)if(!n.isChained&&!1===n.trigger("beforeRemove",{parent:s,records:e,isMove:t}))return!1;const u=null===(i=s.beforeRemoveChild)||void 0===i?void 0:i.call(s,e,t);for(const i of e){const{parentIdField:e}=i.constructor,{modified:o}=i.meta,a=i.parent?i.parent.id:null;e in o||i.isLinked||(o[e]=a);const c=s.removeFromChildren(i,r);d.forEach((e=>{if(!e.isChained){const{isRemoving:r}=e;e.isRemoving=!0,l.push(...e.onNodeRemoveChild(s,[i],c,{isMove:t,silent:n})),e.isRemoving=r}})),t||(i.parent=i.parentIndex=i.unfilteredIndex=i.nextSibling=i.previousSibling=null,i.data[e]=null)}return 0===(s.unfilteredChildren||c).length&&s.constructor.convertEmptyParentToLeaf.onRemove&&!s.isRoot&&(s.meta.isLeaf=!0),s.isLeaf===a||n||t||s.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}}),null===(o=s.afterRemoveChild)||void 0===o||o.call(s,e,u,t),l}clearParentId(){const e=this;Reflect.deleteProperty(e.data,e.parentIdField),Reflect.deleteProperty(e.originalData,e.parentIdField),e.meta.modified&&Reflect.deleteProperty(e.meta.modified,e.parentIdField)}replaceChildren(e){return this.clearChildren(),this.data[this.constructor.childrenField]=e,this.processChildren(),this.children}clearChildren(e=!1){const t=this,{stores:n}=t,r=t.unfilteredChildren||t.children;t.children=[],t.orderedChildren=[],r&&!0!==r&&(n.forEach((n=>{n.isChained||n.onNodeRemoveChild(t,r,0,{unfiltered:!0,silent:e})})),t.unfilteredChildren&&(t.unfilteredChildren=[]))}clear(){var e;const t=this,{stores:n}=t,r=null===(e=t.children)||void 0===e?void 0:e.slice();if(t.isRoot&&r){for(const e of n)if(!e.isChained&&!1===e.trigger("beforeRemove",{parent:t,records:r,isMove:!1,removingAll:!0}))return!1;t.children.length=0,t.unfilteredChildren&&(t.unfilteredChildren.length=0),n.forEach((e=>{r.forEach((t=>{t.stores.includes(e)&&t.unjoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}updateChildrenIndices(e,t,n=!1){let r=null;for(let o=0;o<e.length;o++){const s=e[o],l=s[t];"parentIndex"===t||"orderedParentIndex"===t?l===i||n?s.setData(t,o):l!==o&&s.set(t,o,!0):s[t]=o,"parentIndex"===t&&(s.previousSibling=r,r&&(r.nextSibling=s),o===e.length-1&&(s.nextSibling=null),r=s)}}addToChildren(e,t,n={}){const r=this,o=[[r.children,"parentIndex",e],[r.unfilteredChildren,"unfilteredIndex",e],[r.orderedChildren,"orderedParentIndex",(null==n?void 0:n.orderedBeforeNode)===i?(null==n?void 0:n.orderedParentIndex)!==i?r.orderedChildren[null==n?void 0:n.orderedParentIndex]:e:null==n?void 0:n.orderedBeforeNode]];for(const e of o){const[i,o,l]=e;if(i){var s;const a=l?"orderedParentIndex"===o?i.indexOf(l):l[o]:i.length;e.push(a),i.splice(a,0,...t),null!=n&&null!==(s=n[o])&&void 0!==s&&s.skip||r.updateChildrenIndices(i,o)}}return o[0][3]}removeFromChildren(e,t){const n=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const i of n){const[n,o]=i;if(n){const s=n.indexOf(e);var r;if(i.push(s),s>-1)n.splice(s,1),null!=t&&null!==(r=t[o])&&void 0!==r&&r.skip||this.updateChildrenIndices(n,o)}}return n[0][2]}sortOrderedChildren(e=!0,t=!1){const n=[];return this.isLeaf||(this.orderedChildren.sort(((e,r)=>{if(t){const t=(e.meta.modified.orderedParentIndex??e.orderedParentIndex)-(r.meta.modified.orderedParentIndex??r.orderedParentIndex);return 0!==t&&(n.push(e),n.push(r)),t}return e.orderedParentIndex-r.orderedParentIndex})),e&&this.orderedChildren.forEach((r=>{n.push(...r.sortOrderedChildren(e,t))})),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(n)}sortVisibleChildren(e=!0,t){const n=this;n.isLeaf||(n.children.sort(t),e&&n.orderedChildren.forEach((n=>n.sortVisibleChildren(e,t))),n.updateChildrenIndices(n.children,"parentIndex",!0))}sortUnfilteredChildren(e=!0,t){const n=this;!n.isLeaf&&n.unfilteredChildren&&(n.unfilteredChildren.sort(t),e&&n.orderedChildren.forEach((n=>n.sortUnfilteredChildren(e,t))),n.updateChildrenIndices(n.unfilteredChildren,"unfilteredIndex",!0))}unjoinStore(e,t=!1){var n;const r=this;r.unfilteredChildren&&(r.children=r.unfilteredChildren.slice(),r.unfilteredChildren=null),null===(n=super.unjoinStore)||void 0===n||n.call(this,e,t)}};const Ii={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},ki={get(e,t){return"proxyMeta"===t?this.proxyMeta:"constructor"===t?e.constructor:"setData"===t?this.setDataOverride:"set"===t?this.setOverride:Ii[t]?this.proxyMeta.data[t]:Reflect.get(e,t,this.proxyRecord)},set(e,t,n){return Ii[t]?this.proxyMeta.data[t]=n:e[t]=n,!0},setDataOverride(e,t){"parentIndex"===e?this.proxyMeta.data.parentIndex=t:this.proxyMeta.originalRecord.setData(e,t)},setOverride(e,t,...n){"parentIndex"===e?this.proxyMeta.data.parentIndex=t:this.proxyMeta.originalRecord.set(e,t,...n)}};var Oi=e=>class extends(e||fe){static $name="ModelLink";link(){if(this.isLinked)return this.$original.link();const e=this,t={...ki,proxyMeta:{originalRecord:e,data:{id:`${e.id}_link_${A.generateUUID()}`,stores:[]}}},n=new Proxy(e,t);return t.proxyRecord=n,(e.meta.linkedRecords||(e.meta.linkedRecords=[])).push(n),n}get isLinked(){var e;return Boolean(null===(e=this.proxyMeta)||void 0===e?void 0:e.originalRecord)}get hasLinks(){return Boolean(!this.proxyMeta&&this.$links.length)}removeLink(e,t=null,n=!1){if(e.hasLinks)for(const r of e.$links.slice())t?H.include(t,r):r.remove(n);else e.isLinked&&H.remove(e.$original.$links,e)}beforeRemove(e){this.removeLink(this,e)}removeChild(e,t,n,r){if(null==r||!r.isInserting){e=H.asArray(e);for(const t of e)this.removeLink(t,null,n)}return super.removeChild(e,t,n,r)}get $originalId(){return this.$original.id}get $links(){return this.meta.linkedRecords??[]}};const{defineProperty:Li}=Reflect,Ai=Symbol("owner"),Pi=/[\s,]+/;var _i=e=>class extends(e||fe){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(e,t,n=r.__BRYNTUM_EXAMPLE){const{factoryable:i}=this.initClass(),{caseless:o,registry:s}=i,l=A.split(e,Pi);for(let e,r,a=0;a<l.length;++a){if(r=l[a],e=o?r.toLowerCase():r,!n&&e in s)throw new Error(`Type "${r}" already registered with ${i.class.name} factory`);s[r]=s[e]=t.initClass()}}static isA(e,t){return this.isType(e,t,!0)}static isType(e,t,n){const{factoryable:r}=this,{caseless:i,registry:o}=r,s=o[i?t.toLowerCase():t];return!!s&&(n?e instanceof s:e.constructor===s)}static setupAlias(e){e.register(e.alias,e)}static setupFactoryable(e,t){const n=t.super.class;let{factoryable:r}=e;r={caseless:!0,defaultType:null,extends:n.factoryable?[n]:null,typeKey:"type",...r},r.class=e,r.registry=Object.create(null),r.extends&&!Array.isArray(r.extends)&&(r.extends=[r.extends]),Li(e,"factoryable",{get:()=>r})}static setupType(e,t){const{type:n}=e;e.register(n,e,t.replaceType),Li(e.prototype,"type",{value:n})}static create(e,t){return this.reconfigure(null,e,t)}static reconfigure(e,t,n){const r=this,{factoryable:i}=r,{typeKey:o}=i;let s,l,a,c,d,u,h,g,p,m=n;if(n&&!Yt.isClass(n)&&(m=null,h=typeof n,"function"===h?u=n:"string"===h?m=n:Yt.isObject(n)?(s=n.cleanup,l=n.defaults,c=n.owner,u=n.setup,m=n.type,g=n.transform):c=n),g&&(t="string"==typeof g?c[g](t):g(t)),p=t,"string"==typeof p)t={};else if(t){if(!0===t&&(t={}),!Yt.isObject(t)){var f;if(c&&t!==e&&(null==e?void 0:e[Ai])===c)"string"==typeof s?c[s](e):null===(f=s)||void 0===f||f(e),e.destroy();return t}p=t[o]}if(p=p&&r.resolveType(p),e){if(t&&(!p||e.constructor===p))return o in t&&delete(t=Yt.assign({},t))[o],e.setConfig(t),e;var v;if(c&&e[Ai]===c)"string"==typeof s?c[s](e):null===(v=s)||void 0===v||v(e),e.destroy()}if(t){if(l){if(!(a=p)){if(!(a=l[o]||m||i.defaultType))throw new Error(`No default mergeType defined for ${i.class.name} factory`);a=r.resolveType(a)}a&&(t=a.mergeConfigs(l,t))}if(u){if(d="string"==typeof u?c[u](t,p,l):u(t,p,l),null===d)return d;t=d||t}if(!p){if(!(p=t[o]||m||i.defaultType))throw new Error(`No default type defined for ${i.class.name} factory`);p=r.resolveType(p)}l&&!a&&(t=p.mergeConfigs(l,t)),o in t&&delete(t=Yt.assign({},t))[o],t=new p(t),c&&(t[Ai]=c)}return t||null}static resolveType(e,t){if("string"!=typeof e)return e;const{factoryable:n}=this,r=n.extends;let i,o=n.registry[n.caseless?e.toLowerCase():e];for(i=0;!o&&r&&i<r.length;++i)o=r[i].resolveType(e,!0);if(!o&&!t)throw new Error(`Invalid type name "${e}" passed to ${n.class.name} factory`);return o}};const{getOwnPropertyDescriptor:$i}=Reflect;class Ni extends(fe.mixin(_i)){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:i,persist:!0,readOnly:!1,internal:!1,useProp:null}}construct(e){const t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=(e,n)=>t.compare(null==e?void 0:e[t.name],null==n?void 0:n[t.name]))}defineAccessor(e,t){const{name:n,dataSource:r}=this;!t&&n in e&&e.$meta.hierarchy.some((e=>{var t;return!1===(null===(t=$i(e.prototype,n))||void 0===t?void 0:t.enumerable)}))||Reflect.defineProperty(e,n,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(n,r)}:function(){return this.batching&&n in this.meta.batchChanges?this.meta.batchChanges[n]:r in this.data?this.data[r]:this.data[n]},set(e){const t=this.$meta.fields.map[n];t&&t.readOnly||this.set(n,e)}})}isEqual(e,t){return Yt.isEqual(e,t)}print(e){return null==e?this.nullText:this.printValue(e)}printValue(e){return String(e)}}Ni._$name="DataField";class Hi extends Ni{static $name="ArrayDataField";static type="array";isEqual(e,t){return e===t}getAt(e,t){return e.get(this.name)[t]}}Hi.initClass(),Hi._$name="ArrayDataField";class Vi extends Ni{static $name="BooleanDataField";static type="boolean";static alias="bool";static get prototypeProperties(){return{nullValue:!1}}isEqual(e,t){return null==e&&null==t||super.isEqual(e,t)}convert(e){var t;return null==e?this.nullable?e:this.nullValue:"false"!==(null===(t=e.toLowerCase)||void 0===t?void 0:t.call(e))&&Boolean(e)}}Vi.initClass(),Vi._$name="BooleanDataField";class Bi extends Ni{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(e){return null==e?this.nullable||(e=this.nullValue):"now"===e?e=new Date:e instanceof Date||(e=Wt.parse(e,this.format||Wt.defaultParseFormat))&&!isNaN(e)||(e=i),e}serialize(e){return e instanceof Date&&(e=Wt.format(e,this.format||Wt.defaultFormat)),e}printValue(e){return Wt.format(e,this.format||Wt.defaultFormat)}}Bi.initClass(),Bi._$name="DateDataField";class zi extends Ni{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(e){return null==e?this.nullable?e:this.nullValue:String(e)}}zi.initClass(),zi._$name="StringDataField";class Wi extends zi{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(e,t){return 0===Wt.compareUnits(e,t)}}Wi.initClass(),Wi._$name="DurationUnitDataField";class ji extends Ni{static $name="IntegerDataField";static type="integer";static alias="int";static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(e){return null==e?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}ji.initClass(),ji._$name="IntegerDataField";class Gi extends Ni{static get $name(){return"ModelDataField"}static get type(){return"model"}static get prototypeProperties(){return{complexMapping:!0}}isEqual(e,t){return e&&t&&t instanceof e.constructor&&t.id==e.id}}Gi.initClass(),Gi._$name="ModelDataField";class Ui extends Ni{static $name="NumberDataField";static type="number";static alias="float";static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(e,t){return isNaN(Number(e))&&isNaN(Number(t))||super.isEqual(e,t)}convert(e){if(null==e)return this.nullable?e:this.nullValue;if(e=Number(e),isNaN(e))return;let t=this.precision;return t?(t=10**t,e=Math.round(e*t)/t):0===t&&(e=Math.round(e)),e}}Ui.initClass(),Ui._$name="NumberDataField";class Yi extends Ni{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}}Yi.initClass(),Yi._$name="ObjectDataField";class qi extends Ni{static $name="StoreDataField";static type="store";init(e,t){var n;const r=this,i=`${r.name}Store`,o={skipStack:!0,syncDataOnLoad:!0};if(r.store&&Yt.assign(o,r.store),r.modelClass&&(o.modelClass=r.modelClass),null===(n=t[`init${A.capitalize(i)}`])||void 0===n||n.call(t,o),!o.storeClass&&!r.storeClass)throw new Error(`Field '${r.name}' with type 'store' must have a storeClass configured`);const s=t.meta[i]=new(o.storeClass||r.storeClass)(o);r.complexMapping?Yt.setPath(e,r.dataSource,s):e[r.dataSource]=s,s.verifyNoGeneratedIds=!1,s.usesId=!s.count||!s.every((e=>e.hasGeneratedId)),s.$currentValue=r.getValue(s),s.ion({change:({action:e})=>{const n=r.getValue(s);if(!s.$isSettingStoreFieldData){const i=s.$preserveCurrentDataset;s.$preserveCurrentDataset=r.subStore&&("update"===e||"remove"===e||"add"===e),r.$isUpdatingRecord=!0,t.set(r.name,n),r.$isUpdatingRecord=!1,s.$preserveCurrentDataset=i}s.$currentValue=n}})}set(e,t,n){var r;const i=this,o=`${i.name}Store`,{[o]:s}=n.meta;if(!s)return n.meta.initableValues.set(i,e),!1;s.$isSettingStoreFieldData||(s.$isSettingStoreFieldData=!0,e=(null===(r=n[`process${A.capitalize(o)}Data`])||void 0===r?void 0:r.call(n,e,n))??e,s.$preserveCurrentDataset||(s.data=e),s.$isSettingStoreFieldData=!1,s.usesId=!s.count||!s.every((e=>e.hasGeneratedId)))}serialize(e,t){const n=t.meta[`${this.name}Store`];return this.$isUpdatingRecord?this.getValue(n):n.$currentValue}getValue(e){return e.allRecords.map((t=>{const n=t.persistableData;return e.usesId||delete n.id,n}))}isEqual(e,t){if(null==e&&null==t)return!0;if(null==e&&null!=t||null!=e&&null==t)return!1;if(e.isStore&&t.isStore)return Yt.isDeeplyEqual(e.$currentValue,t.$currentValue);if(e.isStore&&t.isStore||!e.isStore&&!t.isStore)return Yt.isDeeplyEqual(e,t);{const r=(e.isStore?e:t).modelClass,o=r.$meta.fields.defs,s=e.isStore?e.$currentValue:t.$currentValue,l=e.isStore?t:e;if(s.length!==l.length)return!1;for(let e=0;e<o.length;e++){const t=o[e];if(t.persist)for(let e=0;e<s.length;e++){const o=s[e][t.dataSource],a=l[e][t.dataSource];if(o!==i&&a===i){if(t.dataSource===r.idField&&("string"==typeof(n=o)&&n.startsWith("_generated")))continue;if(t.defaultValue!==i&&Yt.isDeeplyEqual(t.defaultValue,o))continue}if(!Yt.isDeeplyEqual(o,a))return!1}}return!0}var n}getOldValue(e){const t=e.meta[`${this.name}Store`];return t?Yt.clone(t.$currentValue):null}getAt(e,t){const n=e.meta[`${this.name}Store`];return null==n?void 0:n.getAt(t)}}qi.initClass(),qi._$name="StoreDataField";const Ki=new RegExp(/^(.*?)\.(.*)/),Xi=/(.*)\[(.*)]\.?(.*)/,{defineProperty:Ji}=Reflect,{hasOwn:Qi}=Yt,Zi=i,eo={children:1,data:1,meta:1},to=["name","title","text","label","description"],no={boolean:1,number:1,date:1,object:1},ro={parentId:1,$PhantomId:2,id:3};class io extends(fe.mixin(Ti,Fi,Oi)){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"},{name:"expanded",internal:!0}]}static relations=null;static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=(null==e?void 0:e.dataSource)||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,n=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[n--]=t.parentIndex+1;return e}construct(e={},t=null,n=null,r=!1,o=!1,s=!1){var l;const a=this,c=H.asArray(t)??[],{constructor:d,fieldMap:u}=a;let h=null;if(t=c[0],a.meta={modified:{},...d.metaConfig,...n},d.applyConfigs)for(const t in a.getDefaultConfiguration())h||(h={},a.useRawData&&a.useRawData.enabled||(e={...e})),t in e&&(e[t]!==i&&(h[t]=e[t]),delete e[t]);if(super.construct(h),r||d.exposeProperties(e,s),!Qi(d,"idFieldProcessed")){let e=a.meta.idField;e||(d._assignedIdField?e=d.idField:t&&(e=t.idField)),e&&e!==u.id.dataSource&&d.addField({name:"id",dataSource:e,internal:!0}),d._idField=u.id.dataSource,d.idFieldProcessed=!0}a._internalId=io._internalIdCounter++,a.stores=[],a.unjoinedStores=[],a.originalData||(a.originalData=e),a.data=d.processData(e,!1,t,a,o),(null===(l=a.meta.initableValues)||void 0===l?void 0:l.size)&&a.assignInitables(),null==a.id&&a.setData("id",a.generateId(t)),a.data[d.childrenField]&&a.processChildren(c),a.generation=0}set isCreating(e){const t=this;Boolean(t.meta.isCreating)!==e&&(t.meta.isCreating=e,t.stores.forEach((n=>{n.onIsCreatingToggle(t,e)})))}get isCreating(){return Boolean(this.meta.isCreating)}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,n=0,{length:r}=t;n<r;n++){const r=t[n],{name:i}=r;if("id"!==i&&!r.isEqual(this.getValue(i),e.getValue(i)))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:Zi},this.data),this.stores[0],null,!0)}static processData(e,t=!1,n,r,i){const{fieldMap:o,fieldDataSourceMap:s,defaultValues:l}=this,{useRawData:a={enabled:!1}}=n||{},c=i||a.enabled?e:Yt.clone(e);let d;if(!(t=t||a.disableDefaultValue||i))for(d in l)if(c[d]===Zi){const e=s[d];let t=l[d];Array.isArray(t)&&(t=t.slice()),null!=e&&e.complexMapping?Yt.setPath(c,d,t):c[d]=t}if(!a.disableTypeConversion&&!i)for(d in o){const n=o[d],{name:i,dataSource:s}=n,l=s!==i,u=n.complexMapping,h=l&&(u?Yt.pathExists(e,s):s in e),g=i in e&&(!l||!h),p=!a.disableTypeConversion&&n.convert;if((g||p)&&(!t||g||h)){const t=g?c[i]:u?Yt.getPath(c,s):c[s],o=p?n.convert(t,e,r):t;u?Yt.setPath(c,s,o):c[s]=o,l&&delete c[i]}}return this.$meta.fields.initable.length&&this.initInitables(r,c),c}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,t){const n=Qi(e,"fields")&&e.fields,r=t.super.fields,i=t.fields={defs:(null==r?void 0:r.defs.slice())??[],exposedData:!1,defaults:r?{...r.defaults}:{},exposed:Object.create((null==r?void 0:r.exposed)??null),ordinals:Object.create((null==r?void 0:r.ordinals)??null),map:Object.create((null==r?void 0:r.map)??null),sources:Object.create((null==r?void 0:r.sources)??null)};Qi(e,"defaults")&&Object.assign(i.defaults,e.defaults),Qi(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),i.exposed[e.idField]=!0),null!=n&&n.length&&n.map(e.addField,e),i.initable=i.defs.filter((e=>e.init)),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const n=this,r=n.$meta.fields,i=t?"exposed":"map";if(e&&n.autoExposeFields&&!r.exposedData){let t,o,s;for(t in e)r[i][t]||t===n.childrenField||(s=Yt.typeOf(e[t]),o={name:t,dataSource:t,fromData:!0},no[s]&&(o.type=s),n.addField(o));r.exposedData=!0}n.exposeRelations()}static addField(e){if(null==e)return;"string"==typeof e&&(e={name:e});const t=this.initClass(),n=t.$meta.fields,{ordinals:r}=n,i=n.exposed,{name:o}=e,s=n.map[o],l=e.dataSource||(e.dataSource=o);let a,c;if(!s||e.type&&e.type!==s.type)a=Ni.create(e),a.definedBy=s?s.definedBy:t,a.ordinal=s?s.ordinal:r[o]=n.defs.length;else for(c in a=Object.create(s),e)"type"!==c&&(a[c]=e[c]);return a.owner=t,n.defs[a.ordinal]=a,n.map[o]=a,n.sources[l]||(n.sources[l]=a),l.includes(".")&&(a.complexMapping=!0),a.complexMapping?i[l.split(".")[0]]=!0:i[l]=!0,"defaultValue"in a&&(n.defaults[l]=a.defaultValue),eo[o]||a.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,a}static removeField(e){const t=this.initClass(),n=t.$meta.fields,r=n.map[e],{ordinals:i}=n,o=i[e];if(r){n.defs.splice(o,1),delete i[e],delete n.defaults[e],delete n.exposed[e],delete n.map[e],delete n.sources[r.dataSource];for(const e in i)i[e]>o&&--i[e];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!Qi(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const n=e.relations[t];n.relationName=t,e.exposedRelations.push(n),Reflect.ownKeys(e.prototype).includes(t)||Ji(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(e){this.setForeign(t,e,n)}})}}}static initInitables(e,t){const n=e.meta.initableValues=new Map;for(const r of this.$meta.fields.initable){const o=Yt.getPath(t,r.dataSource);o!==i&&n.set(r,o),!r.lazy&&r.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,n]of e)!1!==t.set(n,this.data,this)&&e.delete(t)}static get autoExposeFields(){return!0}static fieldSorter(e,t){return(ro[e]||100)-(ro[t]||100)}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.$meta.fields.map[e]}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){return this.$meta.fields.map[e]}static getFieldDataSource(e){var t;return(null===(t=this.getFieldDefinition(e))||void 0===t?void 0:t.dataSource)||e}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return(null==t?void 0:t.dataSource)||(null==t?void 0:t.name)}static processField(e,t,n){const r=this.fieldMap[e];return null!=r&&r.convert?r.convert(t,this.data,n):t}initRelations(){const e=this;e.constructor.exposedRelations&&e.stores.forEach((t=>{var n;t.modelRelations||t.initRelations();const r=[];null===(n=t.modelRelations)||void 0===n||n.forEach((t=>{r.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,r)}))}initRelation(e){const t=this,n=t.get(e.foreignKey),r=n!==Zi&&"string"!=typeof e.foreignStore&&e.foreignStore.getById(n);return(t.meta.relationCache||(t.meta.relationCache={}))[e.relationName]=r||(null!=n?{id:n,placeHolder:!0}:null),r}removeRelation(e){const{relationName:t,foreignKey:n,nullFieldOnRemove:r}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],r&&this.setData(n,null))}getForeign(e){var t;return null===(t=this.meta.relationCache)||void 0===t?void 0:t[e]}setForeign(e,t,n){const r=io.asId(t);return this.set(n.foreignKey,r)}getRelationConfig(e){var t,n;return null===(t=this.firstStore)||void 0===t||null===(n=t.modelRelations)||void 0===n?void 0:n.find((t=>t.foreignKey===e))}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:Yt.getPath(this.data,t)}get(e){if(!e)return;const t=this,n=t.fieldMap[e];if(!n){if(e.includes("[")){const[,n,r,i]=e.match(Xi),o=t.fieldMap[n];if(null!=o&&o.getAt){t._thisIsAUsedExpression(t[n]);const e=o.getAt(t,r);return e&&i?e.isModel?e.getValue(i):e[i]:e}return null}if(e.includes("."))return Yt.hasPath(t.data,e)?t.complexGet(e,e):Yt.getPath(t,e)}return null!=n&&n.complexMapping?t.complexGet(e,n.dataSource):t.flatGet(e,(null==n?void 0:n.dataSource)||e)}getValue(e){if(e)return e in this?this[e]:this.get(e)}setValue(e,t){e in this?this[e]=t:this.set(e,t)}setData(e,t){const{data:n,fieldMap:r}=this;if("string"==typeof e){const i=r[e],o=(null==i?void 0:i.dataSource)??e;null!=i&&i.set?i.set(t,this.data,this):null!=i&&i.complexMapping?Yt.setPath(n,o,t):n[o]=t}else{const i=Object.keys(e);for(let o=0;o<i.length;o++){const s=i[o],l=r[s],a=(null==l?void 0:l.dataSource)??s;null!=l&&l.set?l.set(t,this.data,this):a&&(null!=l&&l.complexMapping?Yt.setPath(n,a,e[s]):n[a]=e[s])}}}getData(e){const t=this.fieldMap[e],n=(null==t?void 0:t.dataSource)??e;if(n)return null!=t&&t.complexMapping?Yt.getPath(this.data,n):this.data[n]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}set(e,t,n=!1,r=!1,i=!1,o=!1,s=!0){const l=this;if(l.isBatchUpdating)return l.inBatchSet(e,t,n||l.$silenceBatch),null;{var a;const c=l.inSet(e,t,n,r,i,o,s);return null===(a=l.afterSet)||void 0===a||a.call(l,e,t,n,r,c),c}}fieldToKeys(e,t){return"string"!=typeof e?Yt.assign({},e):{[e]:t}}inBatchSet(e,t,n){const r=this,{meta:i,constructor:o,fieldMap:s}=r,l={};let a,c=!1;if("string"!=typeof e?Object.keys(r.fieldToKeys(e,t)).forEach((n=>{a=s[n]||Yt,t=o.processField(n,e[n],r),a.isEqual(i.batchChanges[n],t)||(l[n]={value:t,oldValue:r.get(n)},i.batchChanges[n]=t,c=!0)})):(a=s[e]||Yt,a.isEqual(i.batchChanges[e],t)||(l[e]={value:t,oldValue:r.get(e)},i.batchChanges[e]=t,c=!0)),c&&(r.generation++,!n)){const e={action:"update",record:r,records:[r],changes:l};r.stores.forEach((t=>{t.trigger("batchedUpdate",{...e})})),r.forEachLinked(((t,n)=>t.trigger("batchedUpdate",{...e,record:n,records:[n]})))}}inSet(e,t,n,r,o=!1,s=!1,l=!0){const a=this,{data:c,meta:d,fieldMap:u,constructor:h}=a,{prototype:g,childrenField:p,relations:m}=h,f={},v=a.fieldToKeys(e,t),b=Object.keys(v).sort(h.fieldSorter);let y=!1;if(!n&&l&&!a.triggerBeforeUpdate(v))return null;a.inSetting=!0;for(let e=0;e<b.length;e++){const t=b[e];if(t===p)continue;if(t.includes("[")){const[,e,n,r]=t.match(Xi),i=a.fieldMap[e];if(null!=i&&i.getAt){const e=i.getAt(a,n);e.isModel?e.set(r,v[t]):Yt.setPath(e,r,v[t]);continue}}const n=t.includes(".");if(m&&n){const[,e,n]=t.match(Ki);if(m[e]){a[e].set(n,v[t]);continue}}const l=u[t],w=l||Yt,x=null==l?void 0:l.readOnly,S=(null==l?void 0:l.dataSource)??t,E=!o&&!l&&t in g||(null==l?void 0:l.useProp),R=E?a[S]:null!=l&&l.complexMapping||n?Yt.getPath(c,S):c[S],T=h.processField(t,v[t],a),D=v[t]={value:T},M=a.getRelationConfig(t);var C;if(!(x||w.isEqual(R,T)||s&&T===i))a.generation++,D.oldValue=(null==l||null===(C=l.getOldValue)||void 0===C?void 0:C.call(l,a))??R,y=!0,t in d.modified&&w.isEqual(d.modified[t],T)?(Reflect.deleteProperty(d.modified,t),a.isReverting&&(a.data[S]=T)):a.ignoreBag||(t in d.modified||a.storeFieldChange(t,R),D.oldValue===Zi&&Reflect.deleteProperty(D,"oldValue")),f[t]=D,a.applyValue(E,S,T,o,l),M&&!r&&(a.initRelation(M),a.stores.forEach((e=>e.cacheRelatedRecord(a,T,M.relationName,D.oldValue))))}return y&&a.afterChange(v,f,n,r,o),a.inSetting=!1,y?f:null}applyValue(e,t,n,r,i){var o,s,l;const a=this;var c;if(((null===(o=i)||void 0===o?void 0:o.dataSource)||t)===a.constructor.idField&&(a.$isPhantom=!1),((null===(s=i)||void 0===s?void 0:s.dataSource)||t)===a.constructor.parentIdField)(null===(c=a.parent)||void 0===c||!c.isRoot||null!=n&&a.firstStore.getById(n))&&(a.firstStore.getById(n)||a.firstStore.rootNode).insertChild(a,null,!1,{orderedParentIndex:{skip:!0}});else if(e){var d;a[(null===(d=i)||void 0===d?void 0:d.name)||t]=n}else if(null!==(l=i)&&void 0!==l&&l.set)i.set(n,a.data,a);else{var u;let e=null===(u=i)||void 0===u?void 0:u.complexMapping;if(!i&&t.includes(".")){var h,g;const n=t.split(".")[0];e=(null===(h=i=a.constructor.fieldMap[n])||void 0===h?void 0:h.complexMapping)||"object"===(null===(g=i)||void 0===g?void 0:g.type)}e?Yt.setPath(a.data,t,n):a.data[t]=n}}afterChange(e,t,n,r,i){for(const o of this.stores)o.onModelChange(this,e,t,n,r,i);this.forEachLinked(((o,s)=>o.onModelChange(s,e,t,n,r,i)))}forEachLinked(e){for(const t of this.$links)for(const n of t.stores)e(n,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!Yt.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t="string"==typeof e?this.getFieldDefinition(e):e,n=(null==t?void 0:t.name)||e;let r;return t&&!t.persist||(r=this.getValue(n),null!=t&&t.serialize&&(r=t.serialize(r,this))),r}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let n=!1;return Object.keys(e.meta.modified).forEach((r=>{const i=e.getFieldPersistentValue(r);i!==Zi&&(t[r]=i,n=!0)})),n?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&Yt.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,n={};if(!e.isModified)return null;let r=!1;return Object.keys(e.meta.modified).forEach((i=>{var o,s;let l=t[i],a=null===(o=l)||void 0===o?void 0:o.dataSource;if(i.includes(".")){const e=i.match(Ki)[1];l=t[e],a=i}if(null!==(s=l)&&void 0!==s&&s.persist){const t=e.getFieldPersistentValue(i);t!==Zi&&(Yt.setPath(n,a,t),r=!0)}})),r?n:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach((e=>{t[this.getFieldDefinition(e).dataSource]=this.getFieldPersistentValue(e)})),t}get persistableData(){const e=this,t={};return e.fields.forEach((n=>{const r=e.getFieldPersistentValue(n);r!==Zi&&(null!=n&&n.complexMapping?Yt.setPath(t,n.dataSource,r):t[n.dataSource]=r)})),t}get dataByFieldName(){const{data:e}=this;return this.fields.reduce(((t,n)=>(Yt.hasPath(e,n.dataSource)&&(t[n.name]=e[n.dataSource]),t)),{})}get isCommitting(){return Boolean(this.meta.committing)}clearChanges(e=!0,t=!0,n=null){const r=this,{meta:i}=r;if(n)for(const e in n)delete i.modified[e];else i.modified={};const o=Yt.isEmpty(i.modified);i.committing=!1,t&&r.stores.forEach((t=>{if(o&&t.modified.remove(r),t.added.remove(r),e){const e=t.collectDescendants(r).all;t.added.remove(e),o&&t.modified.remove(e)}}))}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.isReverting=!0,this.set(this.meta.modified,Zi,e),this.isReverting=!1}setByDataSource(e){const{fieldDataSourceMap:t}=this.constructor,n=Yt.pathifyKeys(e,t),r={};for(const e in n){const i=t[e];r[(null==i?void 0:i.name)??e]=n[e]}return this.set(r)}applyChangeset(e,t="$PhantomId",n=!0){const r=this,i=r.constructor,{idField:o,fieldDataSourceMap:s}=i,l=Yt.pathifyKeys(e,s),a=Yt.pathifyKeys(r.modificationData),c={},d=t in e;for(const e in l){const t=s[e],r=(null==t?void 0:t.name)??e;(n||((null==t?void 0:t.name)===o?d:l[e]===a[e]))&&(c[r]=l[e])}const u=r.set(c);return r.clearChanges(!1,!0,n?null:c),u?Object.entries(u).reduce(((e,[t,n])=>(e[t]=n.value,e)),{}):{}}get internalId(){return this._internalId}get isPhantom(){return""===this.id||null==this.id||this.hasGeneratedId||Boolean(this.$isPhantom)}get isModel(){return!0}get hasGeneratedId(){return"string"==typeof this.id&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${A.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return null!=e&&e.isModel?e.id:Yt.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return A.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,n=this.persistableData;return(t||e)&&(n[this.constructor.childrenField]=(t||e).map((e=>e.toJSON()))),n}toString(){const e=this,t=to.find((t=>t in e.constructor.fieldMap)),n=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return A.safeJsonStringify(n)}get isBatchUpdating(){return Boolean(this.batching)}hasBatchedChange(e){var t,n;return null===(t=this.meta)||void 0===t||null===(n=t.batchChanges)||void 0===n?void 0:n[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,t=!1,n=!0){const r=this,{parentIdField:o}=r.constructor;if(r.batching&&(r.batching--,r.$silenceBatch&&r.$silenceBatch--,!(r.batching>0||Yt.isEmpty(r.meta.batchChanges)))){let{batchChanges:s}=r.meta;r.meta.batchChanges=null,s[o]&&(s={...s},r.parentId=s[o],delete s[o]),r.set(s,Zi,e,!1,t,i,n)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:t}=e.meta,n={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach((([t,r])=>{n[t]={oldValue:r,value:e[t]}}));const r={action:"update",record:e,records:[e],changes:n};e.stores.forEach((e=>{e.trigger("batchedUpdate",{...r})})),e.forEachLinked(((e,t)=>{e.trigger("batchedUpdate",{...r,record:t,records:[t]})}))}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!(null!==(t=this.stores)&&void 0!==t&&t.some((t=>!1===t.trigger("beforeUpdate",{record:this,changes:e}))))}copy(e=null,t){const n=this,r=Yt.clone(n.data),o=n.constructor.idField,s=Yt.isObject(t)?t.deep:t;let l;if(e&&"object"==typeof e?(l=e[o],Object.assign(r,e)):l=e,s&&n.children?r.children=n.children.map((e=>e.copy(i,t))):(delete r.children,delete r.expanded),n.$meta.fields.initable.length>0){const e=n.toJSON();for(const t of n.$meta.fields.initable)r[t.name]=e[t.name]}!1!==e&&(r[o]=l||n.generateId(n.firstStore));const a=new n.constructor(r,null,null,!1,!0);return a.originalInternalId=n.internalId,a}copyData(e,t,n){const r={};e.allFields.forEach((({name:n})=>{n!==e.constructor.idField&&(r[n]=t?e.get(n):e.getValue(n))})),this.set(r,null,n)}remove(e=!1){const t=this,{parent:n,stores:r}=t;if(n)n.removeChild(t);else if(r.length&&!t.isSpecialRow){r.slice().forEach((n=>n.remove(t,e,!1,!0)))}}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){const t=this,{stores:n}=t;if(!n.includes(e)){var r;const{unjoinedStores:i}=t;super.joinStore(e),e.register(t),n.push(e),i.includes(e)&&i.splice(i.indexOf(e),1),t.isLoaded&&t.children.forEach((t=>t.joinStore(e))),t.initRelations(),!e.tree||t.isRoot||null!==(r=e.stm)&&void 0!==r&&r.isRestoring||(t.instanceMeta(e.id).collapsed=!t.expanded)}}unjoinStore(e,t=!1){const n=this,{stores:r,unjoinedStores:i}=n;var o,s,l;r.includes(e)&&(e.isDestroying||(e.unregister(n),i.push(e)),null===(o=n.unfilteredChildren||n.children)||void 0===o||null===(s=o.forEach)||void 0===s||s.call(o,(n=>n.unjoinStore(e,t))),r.splice(r.indexOf(e),1),null===(l=super.unjoinStore)||void 0===l||l.call(this,e,t),e.uncacheRelatedRecord(n))}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){var t;const{meta:n}=this,r=e.id||e;return(null===(t=n.map)||void 0===t?void 0:t[r])||this.setInstanceMeta(r,{})}setInstanceMeta(e,t){const{meta:n}=this,r=e.id||e;return n.map||(n.map={}),n.map[r]=t}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return Boolean(null===(e=this.meta)||void 0===e?void 0:e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach((t=>{t.persist&&!t.calculated||(e._nonPersistableFields[t.name]=1)}))),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach((t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)}))),e._alwaysWriteFields}get domId(){return"string"==typeof this.id?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta;return`class ${t[t.length-2]} extends ${t[t.length-3]} { static fields = ${A.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:n}=this,{defaultValues:r,applyConfigs:i}=this.constructor,o=i?super.getCurrentConfig(e):{};if(o){for(const n of this.fields)if(n.persist){const i=Yt.getPath(t,n.dataSource);n.isEqual(i,r[n.name])||Yt.setPath(o,n.dataSource,fe.processConfigValue(i,e))}if(n)if(Array.isArray(n)){o.children=[];for(const t of n)o.children.push(t.getCurrentConfig(e))}else o.children=n;this.hasGeneratedId&&delete o.id,delete o.parentId,delete o.parentIndex}return o}}io._idField="id",io._internalIdCounter=1,io._assignedIdField=!1,io.exposeProperties(),io._$name="Model";class oo{constructor(e,t){"number"==typeof e||null===e?(this._magnitude=e,this._unit=t):("string"==typeof e&&Object.assign(this,Wt.parseDuration(e)),"object"==typeof e&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude="number"==typeof e&&e}get unit(){return this._unit}set unit(e){this._unit=Wt.parseTimeUnit(e)}get isValid(){return null!=this._magnitude&&Boolean(Wt.normalizeUnit(this._unit))}get milliseconds(){return this.isValid?Math.round(Wt.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return Boolean(e)&&null!=this._magnitude&&null!=e._magnitude&&this.milliseconds===e.milliseconds}toString(e){const t=this,n=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${Wt[n](t._unit,1!==t._magnitude)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}diff(e){return new oo({unit:this.unit,magnitude:Wt.as(this.unit,this.milliseconds-e.milliseconds)})}}oo._$name="Duration";const so=(e,t)=>null==e?void 0:e[t],lo=/^is(this|next|last)(week|month|year)$/i,ao=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"];class co extends(fe.mixin(Si)){static $name="CollectionFilter";static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){"function"==typeof e&&(e={filterBy:e}),e.type?"date"!==e.type||null==e.value||Array.isArray(e.value)?"duration"!==e.type||null==e.value||Array.isArray(e.value)||(e.value=new oo(e.value)):e.value=new Date(e.value):Wt.isDate(e.value)||Array.isArray(e.value)&&e.value.every(Wt.isDate)?e.type="date":e.value instanceof oo&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=co.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||co.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const n=this;n.isConfiguring||null===(t=n.owner)||void 0===t||!t.onFilterChanged||n.owner.isConfiguring||n.owner.onFilterChanged(n,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let n;return n=e.isModel?e.getValue(t.property):t._propertyItems.length>1?t._propertyItems.reduce(so,e):e[t.property],t[t.operator](t.convert(n))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&"string"==typeof e[0])?t._filterValue=e.map((e=>t.convert(e))):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?t._filterValue=e.map((e=>null==e?void 0:e.toLowerCase())):t.caseSensitive||"string"!=typeof e?t._filterValue=t.convert(e):t._filterValue=e.toLowerCase(),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":"string"==typeof e.filterValue?"*":"="}convert(e){var t;"sameTime"===this.operator||"string"==typeof this.filterValue&&e instanceof Date||("sameDay"===this.operator&&(e=Wt.clearTime(e)),e=(null===(t=e)||void 0===t?void 0:t.valueOf())??e);return e=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return 0===this.filterValue.length||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return 0===this.filterValue.length||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return Wt.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return Yt.isEqual(e,this.filterValue)}"!="(e){return!Yt.isEqual(e,this.filterValue)}">"(e){return Yt.isMoreThan(e,this.filterValue)}">="(e){return Yt.isMoreThan(e,this.filterValue)||Yt.isEqual(e,this.filterValue)}"<"(e){return Yt.isLessThan(e,this.filterValue)}"<="(e){return Yt.isLessThan(e,this.filterValue)||Yt.isEqual(e,this.filterValue)}"*"(e){return Yt.isPartial(e,this.filterValue)}between(e){const[t,n]=this._filterValue;return(Yt.isMoreThan(e,t)||Yt.isEqual(e,t))&&(Yt.isLessThan(e,n)||Yt.isEqual(e,n))}notBetween(e){return!this.between(e)}empty(e){return e===i||null===e||0===String(e).length}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return!0===e}isFalse(e){return!1===e}setRelativeDateValues(){this._filterValue=co.getRelativeDateRange(this._operator).map((e=>e.valueOf()))}static getRelativeDateRange(e,t=new Date){let n,r,i,o,s,l,a;switch(e){case"isYearToDate":return[Wt.floor(t,"1 year"),t];case"isToday":return n=Wt.floor(t,"1 day"),[n,Wt.add(n,1,"day")];case"isYesterday":return n=Wt.floor(t,"1 day"),[Wt.add(n,-1,"day"),n];case"isTomorrow":return r=Wt.getStartOfNextDay(t),[r,Wt.add(r,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(i=e.toLowerCase().match(lo),!i)throw new Error(`Unrecognized relative date expression: ${e}`);return[,l,a]=i,o=`1 ${a}`,s=Wt.floor(t,o),"next"===l?s=Wt.add(s,1,a):"last"===l&&(s=Wt.add(s,-1,a)),[s,Wt.add(s,1,a)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return Te.returnTrue;for(const t of e)"date"===t.type&&ao.includes(t._operator)&&t.setRelativeDateValues();return function(t){let n=!0;for(const r of e)if(r.disabled||(n=r.filter(t)),!n)break;return n}}}co._$name="CollectionFilter";const uo=Yt.getPathDefault(r,"bryntum.idCounts",Object.create(null));class ho{static generateId(e="generatedId"){return e+(uo[e]=(uo[e]||0)+1)}}ho._$name="IdHelper";class go extends fe{static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(e){"function"==typeof e&&(e={sortFn:e}),super.construct(e)}get id(){return this._id||(this._id=this.property||ho.generateId("b-sorter"))}set id(e){this._id=e}set sortFn(e){this._sortFn=e}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(e,t){const{convert:n,property:r,useLocaleSort:i}=this,o="desc"===this.direction.toLowerCase()?-1:1;if(e=e[r],t=t[r],n&&(e=n(e),t=n(t)),i&&null!=e&&null!=t&&"string"==typeof e){if(!0===i)return String(e).localeCompare(t);if("string"==typeof i)return String(e).localeCompare(t,i);if("object"==typeof i)return String(e).localeCompare(t,i.locale,i)}return(e>t?1:e<t?-1:0)*o}static generateSortFunction(e,t){const n=e.isCollection?e.values:e,r=n.length;return(e,i)=>{let o,s;for(s=0;s<r;++s)if(o=n[s].sortFn(e,i),o)return o;return t?t(e,i):0}}}go._$name="CollectionSorter";const po=()=>0,mo=(e,t)=>t-e,fo=Symbol("filteredIndicesProperty"),vo=Object.freeze([]),bo=Object.freeze({action:"sort",added:vo,removed:vo,replaced:vo}),yo=Object.freeze({action:"filter",added:vo,removed:vo,replaced:vo}),Co={string:1,number:1};function wo(e,t,n,r){if(!1!==t.unique)t.set(n,e),r&&t.count++;else{let r=t.get(n);r||(r=new Set,t.set(n,r)),r.add(e)}}function xo(e,t,n,r,i=!1){for(let o=0;o<e.length;o++){const s=e[o];for(let e=0;e<r;e++){const r=n[e],o=s[r],l=t[r];wo(s,l,o,!i&&l.onDuplicate)}}}class So extends(fe.mixin(je)){_sortFunction=null;_addedValues=null;static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(e){this.generation=0,this._values=[],super.construct(e)}doDestroy(){var e;super.doDestroy();const t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),null===(e=t._sorters)||void 0===e||e.destroy()}clear(){const e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}equals(e,t){if(e.isCollection&&(e=e.values),e.length===this.count){let{values:n}=this;return t&&(e=e.map(t),n=n.map(t)),H.delta(e,n).inBoth.length===this.count}return!1}replaceValues({values:e,filteredValues:t,silent:n=!1,isNewDataset:r=!1}){const o=this;let s,l;if(o.isFiltered&&!r){Boolean(t)?e&&(s=o._values,o._values=e.slice()):(t=e.slice(),e=null),l=o._filteredValues,o._filteredValues=t.slice()}else s=o._values,o._values=e.slice(),t=null,o.isFiltered&&r&&o.autoFilter?(o._filterFunction=null,o._filteredValues=o._values.filter(o.filterFunction)):o._filteredValues&&(o._filteredValues.length=0);o._indicesInvalid=!0,o._addedValues=i,o.generation++,n||o.trigger("change",{action:"replaceValues",replacedValues:s,replacedFilteredValues:l,values:e,filteredValues:t})}set values(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[Symbol.iterator](){return this.values[Symbol.iterator]()}forEach(e,t=!1){(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}map(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}find(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(e,t=!0){const n=this,{_values:r}=n,i=[];return n.forEach((o=>{const s=e.get(o.id,!0);if(s){const e=n.indexOf(o,!0),t=r[e];r[e]=s,n.removeFromIndices(t),n.addToIndices(s)}else t&&i.push(o)})),i.length&&n.remove(i),n.isFiltered&&(n._filteredValues=n._values.filter(n.filterFunction)),i}add(...e){1===e.length?this.splice(this._values.length,null,...e):this.splice(this._values.length,null,e)}remove(...e){1===e.length?this.splice(0,...e):this.splice(0,e)}move(e,t){for(e=H.asArray(e);e.length&&e[0]===t;)e.shift();if(!e.length)return;const n=this,{_values:r}=n,i=n.indexOf(e[0],!0);if(1===e.length&&r[i+1]===t)return;n.suspendEvents(),n.remove(e),n.resumeEvents();const o=t?n.indexOf(t,!0):r.length;if(-1===o)throw new Error("Collection move beforeItem parameter must be present in Collection");return r.splice(o,0,...e),n._indicesInvalid=1,n.trigger("change",{action:"move",items:e,from:i,to:o}),o}splice(e=0,t,...n){var r;const i=this,o=i.idProperty,s=i._values,l={},a=[],c=[],d=i.totalCount;let u,h;if(1===(null===(r=n)||void 0===r?void 0:r.length)&&Array.isArray(n[0])&&(n=n[0]),!1!==i.trigger("beforeSplice",{index:e,toRemove:t,toAdd:n})){if(n)if(d&&n.length){const e=i.indices[o];u=[];for(let t=0;t<n.length;t++){const r=n[t],i=r[o],a=e.get(i),d=a?s.indexOf(a):-1;l[i]=!0,-1!==d?s[d]!==r&&(c.push([s[d],r]),s[d]=r):u.push(r)}}else u=n;if(t){if("number"==typeof t){t=Math.min(t,s.length-e);for(let n=e;t;--t){l[s[n][o]]?(e++,n++):(a.push(s[n]),s.splice(n,1),h=!0)}}else{let e,n=0===u.length;const r=(t=H.asArray(t)).reduce(((t,r)=>{const o="number"==typeof r,s=o?r:i.indexOf(r,!0);return n&&(null!=e&&s!==e+1||o)&&(n=!1),s>=0&&s<d&&t.push(s),e=s,t}),[]).sort(mo);if(n)r.length&&(a.push.apply(a,t),s.splice(r[r.length-1],r.length),h=!0);else for(let e=0;e<r.length;e++){const t=r[e];if(-1!==t){l[s[t][o]]||(a.unshift(s[t]),s.splice(t,1),h=!0)}}}a.length&&!i._indicesInvalid&&a.forEach(i.removeFromIndices,i)}if(u.length){s.splice(Math.min(e,s.length),0,...u),h=!0,i._indicesInvalid||u.forEach(i.addToIndices,i),i._addedValues||(i._addedValues=new Set);for(const e of u)i._addedValues.add(e)}if(a.length&&i._addedValues)for(const e of a)i._addedValues.delete(e);c.length&&!i._indicesInvalid&&c.forEach((e=>{i.removeFromIndices(e[0]),i.addToIndices(e[1])})),h||c.length?(i.isSorted?i.onSortersChanged():i.isFiltered&&(i.autoFilter?i.onFiltersChanged({action:"splice",oldCount:1}):i._filteredValues.splice(Math.min(e,i._filteredValues.length),0,...u)),i.generation++,i.trigger("change",{action:"splice",removed:a,added:u,replaced:c,oldCount:d})):i.trigger("noChange",{index:e,toRemove:t,toAdd:n})}}changeId(e,t){const n=this,{idProperty:r}=n,i=Co[typeof e]?e:e[r],o=n.get(i);if(o){const s=n.get(t);if(s&&o!==s)throw new Error(`Attempt to set item ${i} to already existing member's id ${t}`);n.removeIndexEntry(e,r,i),n.addIndexEntry(e,r,t),o[r]=t}}get(e,t=!1){return this.getBy(this.idProperty,e,t)}getAt(e,t=!1){return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}getBy(e,t,n=!1){return this.findItem(e,t,this.isFiltered&&n)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(e){this.addIndex({property:e,unique:!0})}changeSorters(e){return new So({values:H.asArray(e),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(e){const t=e instanceof go?e:new go(e);return this.sorters.add(t),t}get isSorted(){var e;return Boolean(null===(e=this._sorters)||void 0===e?void 0:e.count)}onSortersChanged(){const e=this;e._sortFunction=null,e._addedValues=null,e._values.sort(e.sortFunction),e.trigger("change",bo)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=go.generateSortFunction(this.sorters.values):this._sortFunction=po),this._sortFunction}get filters(){return this._filters||(this._filters=new So({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(e){const t=e instanceof co?e:new co(e);return this.filters.add(t),t}removeFilter(e){const{filters:t}=this;e.isCollectionFilter||(e=t.get(e)),t.remove(e)}clearFilters(){this.filters.clear()}get isFiltered(){return Boolean(this._filters&&this._filters.count)}onFiltersChanged({action:e,removed:t,oldCount:n}){const r=this,i=n||"clear"===e&&t.length?r._filteredValues:r._values;r._filterFunction=null,r._filteredValues=r._values.filter(r.filterFunction),r._indicesInvalid=!0;const{toAdd:o,toRemove:s}=H.delta(r._filteredValues,i,!0);r.trigger("change",{...yo,added:o,removed:s})}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=co.generateFiltersFunction(this.filters.values):this._filterFunction=Te.returnTrue),this._filterFunction}changeExtraKeys(e){return H.asArray(e).map((e=>"string"==typeof e?{property:e,unique:!0}:e))}updateExtraKeys(e){for(let t=0;t<e.length;t++)this.addIndex(e[t])}addIndex(e){const t=this;e&&((t._indices||(t._indices={}))[e.property]=new Map,Object.assign(t._indices[e.property],e),t.invalidateIndices(),e.dependentOn&&(t.hasCompositeIndex=!0))}findIndex(e,t,n=!1){const r=this.findItem(e,t,n);if(!r)return-1;return(this.isFiltered&&!n?this._filteredValues:this._values).indexOf(r)}findItem(e,t,n=!1){const r=this,{isFiltered:i}=r,o=i&&!n?r.indices[fo][e]:r.indices[e];if(o){const e=o.get(t)??("string"==typeof t&&t.length&&!isNaN(t)&&o.get(Number(t))||null);if(null!=e)return e}else{const o=i&&!n?r._filteredValues:r._values,s=o.length;for(let n=0;n<s;n++){const r=o[n];if(r[e]==t)return r}}return null}removeIndex(e){delete this._indices[e],this.hasCompositeIndex=Object.values(this.indices).some((e=>e.dependentOn))}indexOf(e,t=!1){return this.findIndex(this.idProperty,Co[typeof e]?e:e[this.idProperty],t)}includes(e,t=!1){return Array.isArray(e)?e.some((e=>this.includes(e))):Boolean(this.findItem(this.idProperty,Co[typeof e]?e:e[this.idProperty],t))}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const e=this,t=e.isFiltered,n=e._indices||(e._indices={}),r=Object.keys(n),i=r.length,o=e._values;let s,l=!1;t&&(s=n[fo]={});for(let e=0;e<i;e++){const i=n[r[e]];if(i.clear(),i.onDuplicate&&(i.count=0,l=!0),t){let t=s[r[e]];t?t.clear():(t=s[r[e]]=new Map,t.unique=i.unique)}}if(xo(o,n,r,i),l)for(let e=0;e<i;e++){const t=n[r[e]];if(t.onDuplicate&&t.count>t.size){const n=new Set;for(let i=0;i<o.length;i++){const s=o[i],l=s[r[e]];n.has(l)&&t.onDuplicate(s,l,t),n.add(l)}}}t&&xo(e._filteredValues,s,r,i,!0),e._indicesInvalid=!1}getIndices(e){const t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[fo][e]),t}addToIndices(e){Object.keys(this.indices).forEach((t=>{this.addIndexEntry(e,t,e[t])}))}removeFromIndices(e){Object.keys(this.indices).forEach((t=>{this.removeIndexEntry(e,t,e[t])}))}removeIndexEntry(e,t,n){this.getIndices(t).forEach((t=>function(e,t,n){!1!==t.unique?t.delete(n):t.has(n)&&(t.get(n).delete(e),t.get(n).size||t.delete(n))}(e,t,n)))}addIndexEntry(e,t,n){this.getIndices(t).forEach((t=>wo(e,t,n)))}onItemMutation(e,t){const n=this;!n._indicesInvalid&&Object.keys(n.indices).length>1&&Object.keys(t).forEach((r=>{if(n.indices[r]){const{value:i,oldValue:o}=t[r];n.removeIndexEntry(e,r,o),n.addIndexEntry(e,r,i)}if(n.hasCompositeIndex){const o=Object.values(n.indices).find((e=>{var t;return null===(t=e.dependentOn)||void 0===t?void 0:t[r]}));if(o){const r={};for(const n in o.dependentOn){var i;r[n]=(null===(i=t[n])||void 0===i?void 0:i.oldValue)||e[n]}const s=e.buildIndexKey(r);n.removeIndexEntry(e,o.property,s),n.addIndexEntry(e,o.property,e[o.property])}}}))}}So._$name="Collection";const Eo=new WeakMap,Ro=e=>{if(e&&"object"==typeof e){let t=Eo.get(e);t===i&&(t=Symbol("bscik"),Eo.set(e,t)),e=t}return e};class To{constructor(e){const t=this;t.generation=0,t.items=new Set,t.idMap={},t.idProperty="id",e&&(e.idProperty&&(t.idProperty=e.idProperty),e.values&&(t.values=e.values))}get(e){return this.idMap[Ro(e)]}get count(){return this.items.size}add(...e){1===e.length&&Array.isArray(e[0])&&(e=e[0]);const t=this,{items:n,idMap:r,idProperty:i}=t,o=e.length;for(let s=0;s<o;s++){const o=e[s],l=Co[typeof o]?o:Ro(o[i]),a=r[l];null==a?(r[l]=o,n.add(o),t.generation++):a!==o&&(r[l]=o,n.delete(a),n.add(o))}}at(e){let t,n;for(t of(e<0&&(e+=this.count),this.items))if(!e--){n=t;break}return n}remove(e){e=H.asArray(e);const{items:t,idMap:n,idProperty:r}=this,i=e.length;for(let o=0;o<i;o++){const i=e[o],s=Co[typeof i]?i:Ro(i[r]),l=n[s];null!=l&&(t.delete(l),delete n[s],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(e){let t,n=0;for(t of this.items)e(t)&&++n;return n}changeId(e,t){const n=this,{idMap:r,idProperty:i}=n,o=Co[typeof e]?e:Ro(e[i]),s=n.get(o);if(s){const e=n.get(t);if(e&&s!==e)throw new Error(`Attempt to set item ${o} to already existing member's id ${t}`);s[i]=t,delete r[o],r[t]=s}}filter(e,t){const{items:n}=this,r=[];let i=0;return n.forEach((o=>{e.call(t,o,i++,n)&&r.push(o)})),r}includes(e){const t=Co[typeof e]?e:Ro(e[this.idProperty]);return Boolean(this.idMap[t])}map(e,t){const{items:n}=this,r=new Array(n.size);let i=0;return n.forEach((o=>{r[i]=e.call(t,o,i++,n)})),r}forEach(e,t){return this.items.forEach(e,t)}find(e,t=0){let n,r;for(n of(t<0&&(t+=this.countOf(e)),this.items))if(e(n)&&!t--){r=n;break}return r}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(e,t){let n,r=-1;for(n of this.items)if((!t||t(n))&&(++r,n===e))return r;return-1}get values(){return[...this.items]}set values(e){e=H.asArray(e),this.clear(),this.add.apply(this,e),this.generation++}sort(e){this.values=this.values.sort(e)}some(e,t){return this.values.some(e,t)}}To._$name="Bag";class Do extends To{add(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),super.add(...e.filter((e=>e.isPersistable)))}}Do._$name="StoreBag";var Mo=e=>class extends(e||fe){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(e,t=!1){const n=this,{storage:r}=n;if(0===(e=H.asArray(e).reduce(((e,t)=>((t=n.getById(t))&&e.push(t),e)),[])).length)return e;if(!n.tree&&!t&&!1===n.trigger("beforeRemove",{records:e}))return[];if(n.isRemoving=!0,n.isGrouped){const t=r.count,i=[],o=new Set;for(const t of e){const{groupParent:e}=t.instanceMeta(n);e.meta.collapsed&&i.push(t),H.remove(e.groupChildren,t),H.remove(e.unfilteredGroupChildren,t),e.meta.childCount--,o.add(e)}for(const e of o)e.groupChildren.length>0&&n.onModelChange(e,{},{});i.length&&r.trigger("change",{action:"splice",removed:i,added:[],replaced:[],oldCount:t})}else if(n.tree){const o=[],s=e.length>1,l=e[0],a=s?i:r.indexOf(l),c=e.reduce(((e,t)=>{const{parent:n}=t;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{}),d=Array.from(Object.values(c));if(!t&&!1===n.trigger("beforeRemove",{records:e,isMove:!1,parent:s?i:l.parent}))return n.isRemoving=!1,[];d.sort(((e,t)=>t[0].childLevel-e[0].childLevel));for(const[e,t]of d)o.push(...e.removeChild(t,!1,!0));return t||(n.trigger("remove",{parent:s?i:l.parent,index:a,isChild:!0,allRecords:o,isMove:!1,records:e}),n.trigger("change",{action:"remove",records:e})),n.isRemoving=!1,e}if(0===e.length)return n.isRemoving=!1,e;for(const t of e)t.beforeRemove(e);return t&&n.suspendEvents(),r.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),n.isRemoving=!1,e}clear(e=!1){var t,n;const r=this,{storage:i}=r;if(r.storage.totalCount||null!==(t=r.rootNode)&&void 0!==t&&null!==(n=t.unfilteredChildren)&&void 0!==n&&n.length){if(!e&&!1===r.trigger("beforeRemove",{records:i.allValues,removingAll:!0}))return null;if(r.rootNode)r.isChained||r.rootNode.clearChildren(e);else if(e){const e=r.registeredRecords;for(let t,n=e.length-1;n>=0;n--)t=e[n],t&&!t.isDestroyed&&t.unjoinStore(r)}e&&(r.removed.clear(),i.suspendEvents()),i.clear(),e&&i.resumeEvents(),r.added.clear(),r.modified.clear()}}removeAll(e=!1){const t=this,n=t.storage;let r;if(t.isRemoving=!0,e){n.suspendEvents();const e=t.registeredRecords;for(let n,r=e.length-1;r>=0;r--)n=e[r],!n||n.isDestroyed||n.isRoot||n.unjoinStore(t)}return r=t.tree?!1!==t.rootNode.clear():null!==t.clear(),e&&n.resumeEvents(),t.isRemoving=!1,r}add(e,t=!1,n={}){var r;const i=this,{storage:o}=i;if(null===(r=e=H.asArray(e))||void 0===r||!r.length)return;if(i.tree=i.tree||Boolean(i.autoTree&&e[0].children),i.tree){const r=new Map,o=i.modelClass.getFieldDataSource("parentIndex"),{parentIdField:s}=i.modelClass,l=[];return e.forEach((e=>{const t=e[s];r.has(t)||r.set(t,{append:[],insert:[]});const n=r.get(t);!e.isModel&&o in e?n.insert.push(e):n.append.push(e)})),r.forEach((({append:e,insert:r},s)=>{const a=null==s?i.rootNode:i.getById(s);if(!a)throw new Error(`Parent node with id ${s} not found, cannot add children.`);if(e.length&&l.push(...a.appendChild(e,t,n)),r.length)for(const e of r)l.push(a.insertChild(e,e[o],t,n))})),i.isFiltered&&i.reapplyFilterOnAdd&&i.filter({silent:!0}),i.reapplySortersOnAdd&&!i.isSyncingDataOnLoad&&i.sort(),l}if(!t&&!1===i.trigger("beforeAdd",{records:e}))return null;if(i.tree=i.tree||Boolean(i.autoTree&&e[0].children),i.tree)return i.rootNode.appendChild(e);const s=i.processRecords(e);return t&&i.suspendEvents(),i.addingClean=n.clean,o.add(s),i.addingClean=!1,t&&i.resumeEvents(),i.autoCommit&&i.doAutoCommit(),s}processRecords(e,t){return e.map((e=>{const n=this.processRecord(e.isModel?e:this.createRecord(e));return null==t||t.call(this,n),n}))}insert(e,t,n=!1){const r=this,i=r.storage,o=r.getAt(e),s=i.values,l=[];if(t=H.asArray(t),r.tree){var a;const i=r.rootNode;return i.insertChild(t,null===(a=i.children)||void 0===a?void 0:a[e],n)}if(!n&&!1===r.trigger("beforeAdd",{records:t}))return null;let c,d,u;if(s[d=e]===t[0]||s[d=e-1]===t[0])for(c=!0,u=0;c&&u<t.length;u++)t[u]!==s[d+u]&&(c=!1);if(c)return null;const h=r.processRecords(t,(t=>{const n=i.indexOf(t);t.children&&t.children.length&&r.autoTree&&(r.tree=!0),n>-1&&(n<e&&o&&e--,l.push(n)),t.meta.previousIndex=n}));return r.suspendEvents(),r.storage.remove(l),r.resumeEvents(),n&&r.suspendEvents(),i.splice(e,0,...h),n&&r.resumeEvents(),r.autoCommit&&r.doAutoCommit(),h}move(e,t){this.isTree?t.parent.insertChild(e,t):this.storage.move(e,t)}setMultiple(e,t,n){const r=this,i=[],o=[];r.forEach((r=>{e(r)&&(o.push(r.set(t,n,!0)),i.push(r))})),r.trigger("updateMultiple",{records:i,all:r.records.length===i.length}),r.trigger("change",{action:"updatemultiple",records:i,all:r.records.length===i.length}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}setAll(e,t){const n=this,r=[];n.forEach((n=>{r.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}acceptChanges(){const e=this;e.added.forEach((e=>e.clearChanges(!0,!1))),e.modified.forEach((e=>e.clearChanges(!0,!1))),e.added.clear(),e.modified.clear(),e.removed.clear()}commit(e=!1){const{changes:t}=this;return!(!e&&!1===this.trigger("beforeCommit",{changes:t}))&&(this.acceptChanges(),e||this.trigger("commit",{changes:t}),t)}revertChanges(){const e=this,{changes:t}=e;if(t){const n={action:"clearchanges",changes:t};e.add(e.removed.values,!0),e.remove(e.added.values,!0),e.modified.forEach((e=>e.revertChanges(!0))),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",n),e.trigger("refresh",n)}}get changes(){const e=this,t=e.modified.values.filter((e=>e.rawModifications));return e.added.count||t.length||e.removed.count?{added:e.added.values.slice(),modified:t,removed:e.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(e){this._autoCommit=e,e&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(e=!0){this.suspendCount--,this.autoCommit&&e&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},Fo=e=>class extends(e||fe){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(e){const t=this,{changes:n}=e;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((e=>e.id))),n.modified&&n.modified.forEach((e=>{const n=t.getById(e.id);null==n||n.set(e.modifications)})))}applyChangeset(e,t=null,n="$PhantomId",r=!0,i=!1){const o=this,{added:s,updated:l,modified:a,removed:c}=(null==t?void 0:t(e,o))??e,d=l??a??[],u=o.modelClass.getFieldDataSource("id"),h=o.modelClass.getFieldDataSource("parentId"),g=i?new Map:null,p=[],m=[];let f=!1,v=[];if(o.trigger("startApplyChangeset"),o._groupVisibleRecordIds=[],o.isGrouped&&o.forEach((e=>{o._groupVisibleRecordIds.push(e.id)})),(null==s?void 0:s.length)>0){const e=[],t=[];for(const r of s)o.getById(r[n]??Yt.getPath(r,u))?e.push(r):t.push(r);d.unshift.apply(d,e);const r=o.reapplySortersOnAdd;o.reapplySortersOnAdd=!1;const i=o.add(t,!1,{orderedParentIndex:{skip:!0}})??[];if(p.push(...i),o.reapplySortersOnAdd=r,o.tree)for(const e of i){const{parent:t}=e;if(t.isRoot){f=!0,v=[t];break}!t.isRoot&&v.every((e=>!e.contains(t)))&&v.push(t)}for(const e of i)null==g||g.set(e.id,e.data),e.clearChanges()}if((null==d?void 0:d.length)>0)for(const e of d){const t=e[n],i=Yt.getPath(e,u),s=Yt.getPath(e,h),l=o.getById(t??i);if(l){var b;const t=null!=s&&(null===(b=o.getById(s))||void 0===b?void 0:b.isLeaf),a=l.applyChangeset(e,n,r);t&&o.toggleCollapse(l.parent,!1),o.tree&&!f&&v.every((e=>!e.contains(l)))&&(l.parent.isRoot?(f=!0,v=[l.parent]):v.push(l.parent)),null==g||g.set(i,a),m.push(l)}}if((null==c?void 0:c.length)>0&&o.applyRemovals(c),"changes"===o.applyChangesetFilterSortTarget){const e=o.filterChangeset(p,m);v.push(...e)}if(o.afterChangesetApplied(v),o.tree&&o.isSorted&&o.reapplySortersOnAdd&&(null!=s&&s.length||null!=d&&d.length)){const e=new Set;v.forEach((t=>{e.has(t)||(e.add(t),t.sortVisibleChildren(!1,o.sorterFn),t.sortUnfilteredChildren(!1,o.sorterFn))})),o.storage.replaceValues({values:o.collectDescendants(o.rootNode).visible,silent:!0}),o.afterPerformSort(!1)}return o._groupVisibleRecordIds=null,o.trigger("endApplyChangeset"),g}afterChangesetApplied(e){const t=new Set;e.forEach((e=>{t.has(e)||e.traverse((e=>{t.has(e)||(t.add(e),e.sortOrderedChildren(!1,!1),e.children&&e.updateChildrenIndices(e.children,"parentIndex",!0),e.unfilteredChildren&&e.updateChildrenIndices(e.unfilteredChildren,"unfilteredIndex",!0))}))}))}applyRemovals(e){const t=this,{removed:n}=t,r=t.modelClass.idField,i=[];for(const t of e){const e=Yt.getPath(t,r);if(n.includes(e)){const t=n.get(e);t.clearChanges(!1,!0,null),t.$isPhantom=!0,n.remove(e)}else i.push(e)}t.remove(i);for(const e of i)n.remove(e)}filterChangeset(e,t){const n=this,{isFiltered:r,tree:o,isGrouped:s,filtersFunction:l}=n,a=n.isSorted?n.createSorterFn(n.sorters):i,{allValues:c,addedValues:d,isSorted:u}=n.storage,h=null!=a||u?a??n.storage.sortFunction:null,g=new Set;if(!r)return[];let p,m=!1;if(s&&(p=n.groupers,n.clearGroupers(!0)),o){const r=new Set(t.filter(l));for(const t of e.filter(l))r.add(t);r.forEach((e=>e.bubble((e=>r.add(e))))),r.delete(n.rootNode);const i=H.groupBy(Array.from(r).filter((e=>{var t,n;return!(null!==(t=e.parent)&&void 0!==t&&null!==(n=t.children)&&void 0!==n&&n.includes(e))})),"parentId");for(const e of Object.values(i)){const{parent:t}=e[0];t.unfilteredChildren&&(t.children.push(...e),g.add(t))}}else if(h&&!s){const{filteredValues:e}=n.storage,r=d?e.findLastIndex((e=>!d.has(e)))+1:e.length,i=e.slice(0,r),o=new Set(t.filter(l));for(const t of e)o.has(t)&&o.delete(t);for(const e of o)i.push(e);i.sort(h),e.splice(0,r,...i),m=!0}else{const e=t.filter((e=>l(e)&&!n.storage.includes(e)));e.length>0&&(n.includeInSubset(c,n.storage.filteredValues,e),m=!0)}const f=new Set(e.filter((e=>!l(e))));if(f.size>0){if(o)for(const e of f)H.remove(e.parent.children,e),g.add(e.parent);else H.remove(n.storage.filteredValues,f);m=!0}return p&&(n.group(p[0],null,!1,!0,!0),m=!0),o&&g.size>0?n.storage.replaceValues({values:n.collectDescendants(n.rootNode).visible,silent:!0}):m&&(n._idMap=null,n.trigger("refresh")),[...g]}includeInSubset(e,t,n){const r=new Set(n);let i=0,o=0,s=0===r.size;for(;o<e.length&&!s;){const n=t[i];let l=e[o];for(;n!==l;)r.has(l)&&(t.splice(i,0,l),i++,r.delete(l),s=0===r.size),l=e[++o];r.has(n)&&r.delete(n),i<t.length&&i++}return t}},Io=e=>class extends(e||fe){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(e){this.storage.autoFilter=e}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(e){const t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(const t of Object.entries(e))"filterBy"===t[0]&&"function"==typeof t[1]?n.add(new co({filterBy:t[1]})):n.add(new co("Object"===t[1].constructor.name?Object.assign({property:t[0]},t[1]):{property:t[0],value:t[1]}));else Array.isArray(e)?n.add(...e.map((e=>e instanceof co?e:new co(e)))):e.isCollection?n.add(...e.values):n.add(new co({filterBy:e}));n.forEach((e=>e.owner=t))}}get filters(){return this._filters||(this._filters=new So({extraKeys:["property"]}))}set filtersFunction(e){this._filtersFunction=e}get filtersFunction(){const e=this,{filters:t,isGrouped:n}=e;if(!e._filtersFunction)if(t.count){const r=co.generateFiltersFunction(t);e._filtersFunction=e=>n&&e.isSpecialRow?e.groupChildren.some(r):r(e)}else e._filtersFunction=Te.returnTrue;return e._filtersFunction}get isFiltered(){return this.filters.values.some((e=>!e.disabled))}traverseFilter(e){const t=this,n=!e.isRoot&&t.filtersFunction(e),r=e.unfilteredChildren||e.children;return r&&r.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((e=>t.traverseFilter(e))),e.updateChildrenIndices(e.unfilteredChildren,"unfilteredIndex",!0),e.updateChildrenIndices(e.children,"parentIndex",!0),n||Boolean(e.children.length)):n}traverseClearFilter(e){const t=this;e.unfilteredChildren&&(e.children=e.orderedChildren.slice(),e.unfilteredChildren=null),e.children&&(e.children.forEach((e=>t.traverseClearFilter(e))),e.updateChildrenIndices(e.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(e,t=!1){const n=this;if((e=e instanceof co?e:new co(e)).owner=n,n.filters.add(e),!t){if(n.remoteFilter)return n.filter().then((()=>e));n.filter()}return e}filter(e){const t=this;let n,r=!1;if(e){let i=typeof e;if("object"===i&&("silent"in e||"replace"in e||e.filters)&&(r=e.silent,e.replace&&t.clearFilters(0===e.filters.length),n=e.internal,i=typeof(e=e.filters)),e){const r=t.isFiltered;if(t.isConfiguring=!0,Array.isArray(e))e.forEach((e=>t.addFilter(e,!0)),t);else if("function"===i){const r=new co(e);r.internal=n,t.addFilter(r,!0)}else"string"===i?t.addFilter({property:e,value:arguments[1]},!0):t.addFilter(e,!0);if(t.isConfiguring=!1,!t.isFiltered&&!r)return null}}t.filtersFunction=null;const i=t.performFilter(r);return t._idMap=null,i}performFilter(e){const t=this,{storage:n,filters:r,rootNode:i}=t,o=t.count;let s,l;if(t.trigger("beforeFilter",{filters:r}),t.tree){const e=n.values;t.isFiltered?t.traverseFilter(i):t.traverseClearFilter(i);const r=t.collectDescendants(i).visible;n.replaceValues({values:r,silent:!0});const o=H.delta(r,e,!0);s=o.toAdd,l=o.toRemove}else n.ion({change({removed:e,added:t}){l=e,s=t},once:!0}),t.isFiltered?(t.isGrouped&&t.includeCollapsed(),n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}),t.isGrouped&&t.excludeCollapsed()):n.filters.clear();t.afterPerformFilter(e||t.isRemoteDataLoading?null:{action:"filter",filters:r,oldCount:o,added:s,removed:l,records:t.storage.values})}afterPerformFilter(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}triggerFilterEvent(e){this.trigger("filter",e),this.remoteFilter||(this.trigger("refresh",e),this.trigger("change",e))}filterBy(e){return this.filter(e)}removeFilter(e,t=!1){const n=this,r=e instanceof co?e:n.filters.get(e);if(r){if(n.filters.remove(r),n._filtersFunction=null,!t){if(n.remoteFilter)return n.filter().then((()=>r));n.filter()}return r}}clearFilters(e=!0){if(this.filters.remove(this.filters.values.filter((e=>!e.internal))),e)return this.filter()}convertFilterToString(e){const t=this.filters.getBy("property",e);return t&&!t.filterBy?String(t):""}doDestroy(){var e;null===(e=this._filters)||void 0===e||e.destroy(),super.doDestroy()}};const ko={add:1,replace:1};var Oo=e=>class extends(e||fe){static $name="StoreGroup";static configurable={groupers:null,useGroupFooters:!1,startGroupsCollapsed:null};static get properties(){return{collapsedGroups:new Set}}construct(e){super.construct(e),this.ion({change:"onDataChanged",thisObj:this})}updateGroupers(e){this.setGroupers(e)}setGroupers(e,t=null){const n=this,{storage:r}=n;let i;return null!=e&&e.length?n._groupers=e:n.groupers&&(delete n._groupers,n.includeCollapsed(),r.replaceValues({values:n.removeHeadersAndFooters(r._values),filteredValues:r.isFiltered?n.removeHeadersAndFooters(r._filteredValues):null,silent:!0}),i=n.group(null,null,null,!1,null==t?void 0:t.silent)),n._idMap=null,i}get groupRecords(){const e=[];if(this.isGrouped)for(const t of this)t.isSpecialRow&&e.push(t);return e}get unfilteredGroupRecords(){const e=this;if(e.isGrouped){var t;const{generation:n}=e.storage;(null===(t=e._unfilteredGroupRecords)||void 0===t?void 0:t.generation)!==n&&(e._unfilteredGroupRecords=e.storage.allValues.filter((e=>e.isSpecialRow)),e._unfilteredGroupRecords.generation=n)}return e._unfilteredGroupRecords||[]}getGroupHeaderForRecord(e,t=!1){if(this.isGrouped){let n;const r=t?this.storage._values:this.storage.values;for(const t of r)if(t.isGroupHeader)if(e){if(t===e||t.unfilteredGroupChildren.includes(e)){n=t;break}}else n=t;return n}}includeCollapsed(){for(const e of this.collapsedGroups)this.expand(this.getById(e),!1)}excludeCollapsed(){for(const e of this.collapsedGroups)this.collapse(this.getById(e))}onDataChange({source:e,action:t,removed:n}){var r;const i=this,{groupers:o}=i;o&&(o.length?("splice"===t&&null!=n&&n.length||"move"===t)&&e.replaceValues({...i.prepareGroupRecords(),silent:!0}):e.replaceValues({values:i.removeHeadersAndFooters(e._values),filteredValues:e.isFiltered?i.removeHeadersAndFooters(e._filteredValues):null,silent:!0})),null===(r=super.onDataChange)||void 0===r||r.call(this,...arguments)}move(e,t){const n=this;if(n.isGrouped&&!n.tree){var r,i;let o=t;if(null!==(r=t)&&void 0!==r&&r.isSpecialRow&&(o=n.getPrev(t,!1,!1),!o))return;const s=n.getGroupHeaderForRecord(o),l=n.groupers[0].field,a=s.meta.groupRowFor,{reapplyFilterOnUpdate:c}=n;if(n.reapplyFilterOnUpdate=!1,n.beginBatch(),e.forEach((e=>e.setValue(l,a))),n.endBatch(),n.reapplyFilterOnUpdate=c,n.isFiltered&&null!==(i=t)&&void 0!==i&&i.isSpecialRow){const{unfilteredGroupRecords:e}=n,r=e.indexOf(s);t=e[r+1]}}super.move(e,t)}collapse(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,this.collapsedGroups.add(e.id),this.trigger("toggleGroup",{groupRecord:e,collapse:!0}),!0)}expand(e,t=!0){return!(null==e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,t&&this.collapsedGroups.delete(e.id),t&&this.trigger("toggleGroup",{groupRecord:e,collapse:!1}),!0)}removeHeadersAndFooters(e){return e.filter((e=>!e.isSpecialRow||(this.unregister(e),!1)))}prepareGroupRecords(e){const t=this,{isFiltered:n,reapplyFilterOnUpdate:r,startGroupsCollapsed:o}=t,s=t.collapsedGroups,{allValues:l}=t.storage,a=[],c=t._groupVisibleRecordIds||[],d=e=>{const i=!n||t.filtersFunction(e);return r?i:i||c.includes(e.id)};for(const e of l)e.isGroupHeader&&(e.meta.collapsed||s.has(e.id))&&(s.add(e.id),a.push(e));for(const e of a)t.includeGroupRecords(e);const u=t.removeHeadersAndFooters(t.storage._values);e&&u.sort(e),n&&(t.filtersFunction=null);const h=[],g=t.groupers[0].field;let p=null,m=null,f=0;function v(){const e=m.meta.groupRowFor,n=`group-footer-${"number"==typeof e?e:A.createId(e)}`,r=t.getById(n)||new t.modelClass({id:n},t,{specialRow:!0,groupFooterFor:e,groupRecord:m});return r.stores=[t],t.register(r),r.groupChildren=m.groupChildren,m.meta.collapsed||h.push(r),t.allRecords.push(r),m.groupChildren.push(r),m.unfilteredGroupChildren.push(r),f++,r}u.forEach((e=>{var n;const r=e.getValue(g),l=r==i?"__novalue__":r,a=`group-header-${"number"==typeof l?l:A.createId(l)}`;0!==(null===(n=e.unfilteredGroupChildren)||void 0===n?void 0:n.length)?(Yt.isEqual(l,p)||(m&&(t.useGroupFooters&&v(),m.meta.childCount=f),m=t.getById(a),m||(m=new t.modelClass({id:a},t,{specialRow:!0,groupRowFor:l,groupField:g}),o&&(s.add(a),t.startGroupsCollapsed=!1)),m.meta.collapsed=s.has(a),m.stores=[t],t.register(m),m.groupChildren=[],m.unfilteredGroupChildren=[],h.push(m),t.allRecords.push(m),p=l,f=0),e.instanceMeta(t.id).groupParent=m,s.has(a)||h.push(e),d(e)&&(m.groupChildren.push(e),f++),m.unfilteredGroupChildren.push(e)):t.unregister(e)})),m&&(t.useGroupFooters&&v(),m.meta.childCount=f),t._idMap=null;const b={values:h};return n&&(b.filteredValues=h.filter(d)),b}get isGrouped(){var e;return Boolean(null===(e=this.groupers)||void 0===e?void 0:e.length)}group(e,t,n=!1,r=!0,i=!1){const o=this;let s,l;if(e&&"object"==typeof e&&(t=e.ascending,l=e.fn,e=e.field),n)o.groupers.push(s={field:e,ascending:t,complexMapping:e.includes(".")});else if(e){var a,c;if(null==t)t=(null===(a=o.groupInfo)||void 0===a?void 0:a.field)!==e||(null===(c=o.groupInfo)||void 0===c?void 0:c.fn)!==l||!o.groupInfo.ascending;o.groupInfo=s={field:e,ascending:t,fn:l,complexMapping:e.includes(".")},o.groupers=[o.groupInfo]}if(s){const{prototype:t}=o.modelClass;s.complexMapping&&!Object.prototype.hasOwnProperty.call(t,e)&&Object.defineProperty(t,e,{get(){return Yt.getPath(this,e)}})}if(!1!==r){if(o.remoteSort&&!o.isRemoteDataLoading)return o.sort(null,null,!1,!0).then((()=>o.onAfterGrouping(i)));o.sort(null,null,!1,!0)}o.onAfterGrouping(i)}onAfterGrouping(e){if(e)return;const t=this,n=t.groupers||[];t.trigger("group",{isGrouped:t.isGrouped,groupers:n,records:t.storage.values}),t.trigger("refresh",{action:"group",isGrouped:t.isGrouped,groupers:n,records:t.storage.values})}addGrouper(e,t=!0){return this.group(e,t,!0)}removeGrouper(e){const t=this,{groupers:n}=t;if(!n)return;const r=n.findIndex((t=>t.field===e));return r>-1?(n.splice(r,1),n.length?t.group():t.clearGroupers()):void 0}clearGroupers(e=!1){return this.setGroupers(null,{silent:e})}isRecordInGroup(e,t){var n;if(!this.isGrouped)return null;const r=null===(n=this.groupers[0])||void 0===n?void 0:n.field;return e.getValue(r)===t&&!e.isSpecialRow}isInCollapsedGroup(e){const t=e.instanceMeta(this).groupParent;return null==t?void 0:t.meta.collapsed}getGroupRecords(e){return this.isGrouped?this.storage.values.filter((t=>this.isRecordInGroup(t,e))):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:e,action:t}){this.isGrouped&&(!e&&ko[t]||e&&this.groupers.some((t=>t.field in e)))&&this.sort()}internalIncludeExcludeGroupRecords(e,t){const n=this,r=n.indexOf(e),i=n.allIndexOf(e),{id:o,storage:s}=n,{_filteredValues:l,_values:a}=s,{meta:c,groupChildren:d,unfilteredGroupChildren:u}=e;-1===i||c.collapsed&&!t||!c.collapsed&&t||(u.forEach((e=>e.instanceMeta(o).hiddenByCollapse=!t)),t?(l&&l.splice(r+1,0,...d.filter((e=>!n.isAvailable(e)))),s._values.splice(i+1,0,...u.filter((e=>!n.isAvailable(e))))):(l&&l.splice(r+1,d.length),a.splice(i+1,u.length)),s._indicesInvalid=!0,n._idMap=null)}excludeGroupRecords(e){this.internalIncludeExcludeGroupRecords(e,!1)}includeGroupRecords(e){this.internalIncludeExcludeGroupRecords(e,!0)}collectGroupRecords(e,t=!0){return(e?this.storage.allValues:this.storage.values).reduce(((e,n)=>(n.isSpecialRow&&(t&&!n.isGroupFooter&&e.push(n),n.isGroupHeader&&e.push.apply(e,n.groupChildren)),e)),[])}},Lo=e=>class extends(e||fe){static get configurable(){return{objectify:null}}initProxy(){if(!r.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(e,t){if(t in e)return e[t];if("$store"===t)return e;let n=e.getById(t);return n||isNaN(parseInt(t))||(n=e.getAt(parseInt(t))),n},set:(e,t,n)=>(t in e||e.isDestroying||"_triggered"===t?e[t]=n:e.add({[e.modelClass.idField]:t,...n}),!0),deleteProperty:(e,t)=>e.isDestroying?(delete e[t],!0):Boolean(e.remove(t).length),has(e,t){if(t in e)return!0;if(t.startsWith("{")&&t.endsWith("}")){const e=A.safeJsonParse(t);t=null==e?void 0:e.id}return e.includes(t)}})}},Ao=e=>class extends(e||fe){static $name="StoreRelation";initRelations(e){const t=this,n=t.modelClass.exposedRelations;e&&t.modelRelations&&t.modelRelations.forEach((e=>{var t;return null===(t=e.storeDetacher)||void 0===t?void 0:t.call(e)})),t.modelRelations&&0!==t.modelRelations.length&&!e||!n||(t.modelRelations=[],null==n||n.forEach((n=>{const r={...n},{foreignStore:i,relationName:o,relatedCollectionName:s}=r,l="string"==typeof i?t[i]:i;if(r.dependentStore=t,t.modelRelations.push(r),l){r.foreignStoreProperty=r.foreignStore,r.foreignStore=l;const n=l.dependentStoreConfigs;if(n.has(t)){const i=n.get(t);if(e){const e=i.find((e=>e.relationName===o));e&&H.remove(i,e)}i.push(r)}else n.set(t,[r]);s&&l.initRelationCollection(r,t),l.count>0&&l.updateDependentStores("dataset",l.records)}})))}initRelationCollection(e,t){const n=this,r=e.relatedCollectionName;(n.collectionStores||(n.collectionStores={}))[r]={store:t,config:e},n[r+"Store"]||(n[r+"Store"]=t),n.count>0&&n.initModelRelationCollection(r,n.allRecords)}initModelRelationCollection(e,t){const n=this;t.forEach((t=>{t.traverse((t=>{const r=e in t?`$related${A.capitalize(e)}`:e;Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}resetRelationCache(){this.relationCache={},this.forEach((e=>e.initRelations()))}updateRecordRelationCache(e,t){null==t||t.forEach((t=>{const{config:n}=t,r=t.related?t.related.id:e.getValue(n.foreignKey);r!==i&&this.cacheRelatedRecord(e,r,n.relationName,r)}))}getRelationCollection(e,t){var n;const r=io.asId(t);return(null===(n=this.relationCache[e])||void 0===n?void 0:n[r])||[]}getCollection(e,t){var n;const{config:r,store:i}=this.collectionStores[t];return(null===(n=i.relationCache[r.relationName])||void 0===n?void 0:n[e.id])||[]}setCollection(e,t,n){const{config:r,store:i}=this.collectionStores[t],o=((i.relationCache[r.relationName]||(i.relationCache[r.relationName]={}))[e.id]||[]).slice(),s=[],l=[];i.suspendEvents(),o.forEach((e=>{n.includes(e)||(e[r.foreignKey]=null,i.remove(e),l.push(e))})),n.forEach((t=>{t.isModel instanceof io?t.stores.includes(i)||(i.add(t),s.push(t)):([t]=i.add(t),s.push(t)),t[r.foreignKey]=e.id})),i.resumeEvents(),l.length&&(i.trigger("remove",{records:l}),i.trigger("change",{action:"remove",records:l})),s.length&&(i.trigger("add",{records:s}),i.trigger("change",{action:"add",records:s}))}cacheRelatedRecord(e,t,n,r=null){const i=this,o=i.relationCache[n]||(i.relationCache[n]={});null!==r&&i.uncacheRelatedRecord(e,n,r),null!=t&&H.include(o[t]||(o[t]=[]),e)}uncacheRelatedRecord(e,t=null,n=null){const r=this;function i(t,n){const i=r.relationCache[t],o=null==i?void 0:i[n];if(o){const t=o.indexOf(e);t>=0&&o.splice(t,1),0===o.length&&delete i[n]}}null!=n?i(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((([e,t])=>i(e,null==t?void 0:t.id)))}updateDependentStores(e,t){this.dependentStoreConfigs.forEach((n=>{n.forEach((n=>{const{dependentStore:r,relatedCollectionName:i,relationName:o,foreignKey:s}=n,l=r.relationCache[o];return"dataset"===e?(i&&this.initModelRelationCollection(i,t),void r.forEach((e=>{const t=e.initRelation(n);t&&r.cacheRelatedRecord(e,t.id,o,t.id)}))):"removeall"===e?(r.forEach((e=>e.removeRelation(n))),void delete r.relationCache[o]):("replace"===e&&(t=t.map((e=>e[1]))),"add"!==e&&"replace"!==e||i&&this.initModelRelationCollection(i,t),void("add"!==e&&"replace"!==e&&"remove"!==e||t.forEach((t=>{const i=null==l?void 0:l[t.id];switch(e){case"remove":i&&i.forEach((e=>e.removeRelation(n)));break;case"add":case"replace":r.forEach((e=>{e.getValue(s)==t.id&&(e.initRelation(n),r.cacheRelatedRecord(e,t.id,o))}))}}))))}))}))}updateDependentRecordIds(e,t){var n;null===(n=this.dependentStoreConfigs)||void 0===n||n.forEach((n=>{n.forEach((n=>{var r;const{dependentStore:i,relationName:o,foreignKey:s}=n,l=i.relationCache[o],a=null==l||null===(r=l[e])||void 0===r?void 0:r.slice();null==a||a.forEach((n=>{i.cacheRelatedRecord(n,t,o,e),n.set(s,t,!1,!0)}))}))}))}},Po=e=>class extends(e||fe){static get $name(){return"StoreSum"}sum(e,t=this.storage.values){return t?t.reduce(((t,n)=>{if(n.isSpecialRow)return t;const r=Number(n.getValue(e));return isNaN(r)?t:t+r}),0):0}min(e,t=this.storage.values){return null!=t&&t.length?t.reduce(((t,n)=>{const r=n.getValue(e);return"number"===typeof(null==r?void 0:r.valueOf())&&r<t&&(t=r),t}),t[0].getValue(e)):0}max(e,t=this.storage.values){return null!=t&&t.length?t.reduce(((t,n)=>{const r=n.getValue(e);return"number"===typeof(null==r?void 0:r.valueOf())&&r>t&&(t=r),t}),t[0].getValue(e)):0}average(e,t=this.storage.values){if(null==t||!t.length)return 0;let n=0;const r=t.reduce(((t,r)=>{if(r.isSpecialRow)return t;const i=parseFloat(r.getValue(e));return isNaN(i)?t:(n++,t+i)}),0);return n>0?r/n:0}groupSum(e,t){return this.sum(t,this.getGroupRecords(e))}};const _o=(e,t)=>String(e).toLowerCase().includes(t),$o={string:_o,number:_o,boolean:_o,date:(e,t)=>e instanceof Date&&t instanceof Date?e-t==0:String(e.getMonth()+1).includes(t)||String(e.getDate()).includes(t)||String(e.getFullYear()).includes(t),object:(e,t)=>e===t,undefined:(e,t)=>e===t};var No=e=>class extends(e||fe){static get $name(){return"StoreSearch"}search(e,t=null,n,r){const i=this.isTree&&!r?this.rootNode.allChildren:this.getAllDataRecords(r),o=i.length,s=[];if(null==e)return[];let l,a,c,d,u,h;for("string"==typeof e&&(e=e.toLowerCase()),l=0;l<o;l++){c=i[l],a=0;for(const r of t||c.fieldNames){var g;d=c.getValue(r),u=d instanceof Date?"date":typeof d;const t=null==n?void 0:n[a];t&&(d=t(d),u="string"),h=$o[u],d&&null!==(g=h)&&void 0!==g&&g(d,e)&&s.push({index:l,data:c,field:r,id:c.id}),a++}}return s}findByField(e,t,n=!1,r=!1){const i=this.getAllDataRecords(r),o=i.length,s=new Set,l=[];let a,c,d;for(null!=t&&(t=String(t).toLowerCase()),a=0;a<o;a++)if(c=i[a],d=c.getValue(e),!n||!s.has(d)){const e=d instanceof Date?"date":typeof d;(null==t&&d===t||""===t&&""===d||t&&(0,$o[e])(d,t))&&(l.push({id:c.id,index:a,data:c}),n&&s.add(d))}return l}find(e,t=!1){return this.getAllDataRecords(t).find(e)}findRecord(e,t,n=!1){const r=n=>Yt.isEqual(n[e],t);return this.isTree?this.query(r,n)[0]:this.getAllDataRecords(n).find(r)}query(e,t=!1){if(this.isTree){const n=[];return this.traverse((t=>{e(t)&&n.push(t)}),i,i,t),n}return this.getAllDataRecords(t).filter(e)}some(e,t=!1){return this.getAllDataRecords(t).some(e)}},Ho=e=>class extends(e||fe){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return Boolean(this.sorters.length)||this.isGrouped}changeSorters(e){return e.map((e=>this.normalizeSorterConfig(e,!0)))}updateReapplySortersOnAdd(e){this.storage.autoSort=e}sort(e,t,n=!1,r=!1){const i=this,o=i.allRecords,s=i.sorters?i.sorters.slice():[];let l,a=null;if(e)if(Array.isArray(e))i.sorters=e.map((e=>i.normalizeSorterConfig(e,"string"==typeof e||t)));else{const r=i.normalizeSorterConfig(e,t);n?(l=i.getCurrentSorterByField(r.field),l?(a=l.ascending,l.ascending=r.ascending):i.sorters.push(r)):i.sorters=[r]}return r||!1!==i.trigger("beforeSort",{sorters:i.sorters,records:o,currentSorters:s})?i.performSort(r):(i.sorters=s,null!==a&&(l.ascending=a),null)}normalizeSorterConfig(e,t){const n=this,r={ascending:t};if("object"==typeof e?(Yt.assign(r,e),e.fn&&(delete r.fn,r.sortFn=e.fn),r.ascending=e.ascending??t):"function"==typeof e?r.sortFn=e:r.field=e,null==r.ascending){const e=n.getCurrentSorterByField(r.field);r.ascending=!e||!e.ascending}if(null==r.sortFn){var i,o;const e=null===(i=n.modelClass)||void 0===i||null===(o=i.$meta.fields.map[r.field])||void 0===o?void 0:o.compareItems;e&&(r.sortFn=e)}return r}getCurrentSorterByField(e){return"string"==typeof e&&this.sorters.find((t=>t.field===e))||null}addSorter(e,t=!0){return this.sort(e,t,!0)}removeSorter(e){const t=this.sorters.findIndex((t=>t.field===e||t.sortFn===e));if(t>-1)return this.sorters.splice(t,1),this.sort()}clearSorters(e=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(i,i,i,e)}createSorterFn(e){const t=this.useLocaleSort;return(n,r)=>{for(let i=0;i<e.length;i++){const o=e[i],{field:s,ascending:l=!0,useLocaleSort:a=t}=o,c=o.fn||o.sortFn,d=l?1:-1;if(c){const e=c.call(o,n,r);if(0===e)continue;if(null!==e)return e*d}const u=n.isModel?n.getValue(s):n[s],h=r.isModel?r.getValue(s):r[s];if(u!==h){if(null==u)return-d;if(null==h)return d;if(a&&"string"==typeof u){if(!0===a)return String(u).localeCompare(h)*d;if("string"==typeof a)return String(u).localeCompare(h,a)*d;if("object"==typeof a)return String(u).localeCompare(h,a.locale,a)*d}if(u>h)return d;if(u<h)return-d}}return 0}}get sorterFn(){const e=this,{sorters:t}=e;return e.createSorterFn(e.remoteSort?[{field:"_remoteSortIndex"}]:e.isGrouped?e.groupers.concat(t):t)}performSort(e){const t=this,{rootNode:n,storage:r,sorterFn:i}=t;t.tree?(!t.isChained&&n.traverse((e=>{e.isLoaded&&e.isParent&&(e.children.sort(i),e.updateChildrenIndices(e.children,"parentIndex",!0))})),r.replaceValues({values:t.collectDescendants(n).visible,silent:!0})):t.isGrouped?r.replaceValues({...t.prepareGroupRecords(i),silent:!0}):r.replaceValues({values:r.values.sort(i),silent:!0}),t.afterPerformSort(e||t.isRemoteDataLoading)}afterPerformSort(e){if(e)return;const t=this;t._idMap=null;const n={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",n),t.trigger("refresh",n)}};const Vo=()=>!0;var Bo=e=>class extends(e||fe){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],excludeCollapsedRecords:!0,chainSuspended:0}}static get properties(){return{chainedStores:null}}construct(e){super.construct(e);const t=this,{masterStore:n}=t,r=t.syncOrder?"sort":"";n&&(t.methodNamesToRelay.forEach((e=>t[e]=(...n)=>t.relayToMaster(e,n))),t.removeAll=(...e)=>{n.remove(t.getRange(),...e)},n.ion({changePreCommit:t.onMasterDataChangedPreCommit,change:t.onMasterDataChanged,[r]:t.onMasterDataChanged,prio:1,thisObj:t}),n.chainedStores||(n.chainedStores=[]),n.chainedStores.push(t),t.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return Boolean(this.masterStore)}set chainedFilterFn(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e}get chainedFilterFn(){return this._chainedFilterFn||Vo}get methodNamesToRelay(){const e=Array.isArray(this.doRelayToMaster),t=Array.isArray(this.dontRelayToMaster);return e&&this.doRelayToMaster.filter((e=>!t||!this.dontRelayToMaster.includes(e)))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach((e=>e.fillFromMaster()))}fillFromMaster(){const e=this,{masterStore:t,isTree:n}=e;let r=[];if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(!e.isChainSuspended){if(t.isGrouped&&t.isFiltered?t.forEach((e=>r.push(e)),t,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0}):r=t.allRecords.filter((t=>!t.isSpecialRow&&e.chainedFilterFn(t))),n&&(e.idRegister={},e.internalIdRegister={},r.forEach((t=>{t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.excludeCollapsedRecords)){const t=e.getChildren(e.rootNode);r=e.doIncludeExclude(t,!0)}e.isFillingFromMaster=!0,e.data=r,e.isFillingFromMaster=!1}}commitToMaster(){const e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}relayToMaster(e,t){return this.masterStore[e](...t)}onMasterDataChangedPreCommit(e){this.onMasterDataChanged(e),this.$masterEventhandled=!0}onMasterDataChanged({action:e,changes:t,$handled:n,isMove:r}){var i;this.$masterEventhandled?this.$masterEventhandled=!1:r&&"remove"===e||("update"!==e||null!==(i=this.chainedFields)&&void 0!==i&&i.some((e=>e in t)))&&this.fillFromMaster()}makeChained(e=Vo,t,n){if(this.isChained){const t=e;e=e=>t(e)&&this.chainedFilterFn(e)}return new((null==n?void 0:n.storeClass)||this.constructor)({storeId:i,id:`${this.id}-chained-${A.generateUUID()}`,...n||{},tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:e,chainedFields:t})}chain(){return this.makeChained(...arguments)}doDestroy(){var e;null===(e=this.chainedStores)||void 0===e||e.forEach((e=>e.destroy())),super.doDestroy()}suspendChain(){this.chainSuspended++}resumeChain(e=!1){this.chainSuspended&&!--this.chainSuspended&&e&&this.fillFromMaster()}get isChainSuspended(){return this.chainSuspended>0}},zo=e=>class extends(e||fe){static get $name(){return"StoreState"}getState(){const{sorters:e,groupers:t,filters:n}=this,r={};return null!=e&&e.length&&(r.sorters=e.map((e=>{const t=Yt.cleanupProperties(Yt.clone(e));return delete t.fn,delete t.sortFn,t}))),null!=t&&t.length&&(r.groupers=t.map((e=>{const t=Yt.cleanupProperties(Yt.clone(e));return delete t.fn,t}))),null!=n&&n.values.length&&(r.filters=n.values.map((e=>{const t=Yt.cleanupProperties(Yt.clone(e.config));return t.value=e.value,t.caseSensitive&&delete t.caseSensitive,t}))),r}applyState(e){const t=this,{sorters:n=[],groupers:r=[],filters:i=[]}=e,{sortParamName:o,filterParamName:s}=t;t.sorters=n.filter((e=>e.field||e.sortFn&&!o)),t.groupers=r.slice(),t.sort(),t.filters=i.filter((e=>e.property||e.filterBy&&!s)),t.filter()}};const Wo=e=>String(e).padStart(6,"0");class jo{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(e??"")}get value(){return this._value}static from(e){return null==e||e instanceof jo?e:new jo(e)}static pad(e){return e instanceof jo?e.valueOf():jo.split(e).map(Wo).join(".")}static split(e){let t,n;if(e||0===e)switch(typeof e){case"object":e=String(e);case"string":for(n=e.split("."),t=n.length;t-- >0;)n[t]=parseInt(n[t],10);break;case"number":n=[e]}return n||[]}static compare(e,t){return e===t?0:e&&t?(e=jo.pad(e))<(t=jo.pad(t))?-1:t<e?1:0:e?1:t?-1:0}append(e){const t=this.value;return jo.from(t?`${t}.${e}`:e)}isEqual(e){return!jo.compare(this,e)}match(e){let t=!1;if(e){const n=this.value,r="*"===e[0],i=e.endsWith("*"),o=e.length;t=r===i?n.indexOf(r?e.substr(1,o-2):e)>-1:r?n.endsWith(e.substr(1)):n.startsWith(e.substr(0,o-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){return this._padded??(this._padded=jo.pad(this.value))}}jo._$name="Wbs";const Go=Object.freeze([]),Uo=Symbol("StopBranch");var Yo=e=>class extends(e||fe){static $name="StoreTree";static StopBranch=Uo;get StopBranch(){return Uo}static configurable={transformFlatData:null,fireRemoveEventForMoveAction:P.checkVersion("core","6.0","<")};get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const e=this,t=[];return e.isTree?(e.traverse((e=>{e.isLeaf&&t.push(e)})),t):(e.allRecords.forEach((e=>{e.isLeaf&&t.push(e),e.traverse((e=>{e.isLeaf&&t.push(e)}),!0)})),t)}async loadChildren(e){}onNodeAddChild(e,t,n,r,o=!1){const s=this,l=e===s.rootNode&&e.isLoading,{storage:a}=s,{previousSibling:c}=t[0];let d;const{visible:u,all:h}=s.collectDescendants(t,i,i,{inCollapsedBranch:!(e.isExpanded(s)&&e.ancestorsExpanded(s)),applyFilter:s.isFiltered&&s.reapplyFilterOnAdd});if(!l&&h.length)for(const e of h)s.modified.includes(e)||r[e.id]||(s.removed.includes(e)?s.removed.remove(e):e.isLinked||s.added.add(e));var g;if(l&&s.rootVisible&&(u.unshift(e),h.unshift(e)),u.length?(d=0!==n&&c?a.indexOf(c)+c.getDescendantCount(!0,s):a.indexOf(e),a.suspendEvents(),s.storage.splice(++d,0,u),a.resumeEvents(),s._idMap=null):s._allRecords=null,s.updateDependentStores("add",t),l&&u.length){if(s.sorters.length&&s.sort(null,null,!1,!0),null===(g=s.afterLoadData)||void 0===g||g.call(s),!o){const e={action:"dataset",data:s._data,records:u};s.trigger("refresh",e),s.trigger("change",e)}}else if(!o){const n={action:"add",parent:e,isChild:!0,isMove:r,records:t,allRecords:h,index:d};if(s.trigger("add",n),s.trigger("change",n),Object.values(r).some((e=>e))){const n={newParent:e,records:t.filter((e=>r[e.id])),oldParents:t.map((e=>s.getById(e.meta.oldParentId)))};s.trigger("move",n)}}}onNodeRemoveChild(e,t,n,r={isMove:!1,silent:!1,unfiltered:!1}){const i=this,{storage:o}=i,s=[],l=[],{isMove:a,silent:c,unfiltered:d}=r,u=d&&i.isFiltered,h=u&&e.unfilteredChildren?e.unfilteredChildren:t;if(i.collectDescendants(h,s,l,{inCollapsedBranch:!(e.isExpanded(i)&&e.ancestorsExpanded(i)),unfiltered:u}),!a){for(const e of t)e.unjoinStore(i);for(const e of l)e.stores.includes(i)&&e.unjoinStore(i),i.added.includes(e)?i.added.remove(e):e.isLinked||i.removed.add(e);i.modified.remove(l)}if(s.length?(n=o.indexOf(s[0]))>-1&&(o.suspendEvents(),o.splice(n,s.length),o.resumeEvents(),i._idMap=null):(n=-1,i._allRecords=null),!c&&(i.fireRemoveEventForMoveAction||!a)){const r={action:"remove",parent:e,isChild:!0,isMove:a,records:t,allRecords:l,index:n};i.trigger("remove",r),i.trigger("change",r)}return l}collectDescendants(e,t=[],n=[],r={}){const i=this,{inCollapsedBranch:o=!1,unfiltered:s=!1,applyFilter:l=!1}=r,a=Array.isArray(e)?e:i.getChildren(e,s)??[];if(l)return{visible:a.flatMap((e=>this.collectVisibleNodeDescendantsFiltered(e))),all:a.flatMap((e=>e.allChildren))};for(let e,r=0,l=a.length;r<l;r++)e=a[r],o||t.push(e),n.push(e),i.collectDescendants(e,t,n,{inCollapsedBranch:o||!e.isExpanded(i),unfiltered:s});return{visible:t,all:n}}collectVisibleNodeDescendantsFiltered(e){const t=e.unfilteredChildren||e.children;if(!t||0===t.length||!e.isLeaf&&!e.isExpanded(this))return this.filtersFunction(e)?[e]:[];const n=t.flatMap((e=>this.collectVisibleNodeDescendantsFiltered(e)));return n.length||this.filtersFunction(e)?[e,...n]:[]}getChildren(e,t=!1){const n=this,r=(t||n.isChained)&&e.unfilteredChildren||e.children;return null!=r&&r.length?n.isChained?r.filter(n.chainedFilterFn).sort(n.sorterFn):r:Go}internalToggleTreeSubRecords(e,t){const n=this,{storage:r}=n,i=r.indexOf(e),o=n.doIncludeExclude(n.getChildren(e),t);if(n.isFiltered&&t&&e.unfilteredChildren&&n.updateChildrenHiddenState(e),o.length&&!1!==i){if(r.suspendEvents(),t){r.splice(i+1,0,...o);const e={action:"add",isExpand:!0,records:o,index:i+1};n.trigger("add",e),n.trigger("change",e)}else{r.splice(i+1,o.length);const e={action:"remove",isCollapse:!0,records:o,index:i+1};n.trigger("remove",e),n.trigger("change",e)}r.resumeEvents(),n._idMap=null}}updateChildrenHiddenState(e){var t;null===(t=e.unfilteredChildren)||void 0===t||t.forEach((e=>{e.instanceMeta(this.id).hidden=!1,e.isLeaf||this.updateChildrenHiddenState(e)}))}doIncludeExclude(e,t,n=[]){const r=this,i=(null==e?void 0:e.length)||0;for(let o=0;o<i;o++){const i=e[o];if(!r.isChained||r.chainedFilterFn(i)){const e=i.instanceMeta(r.id);!t&&e.hidden||n.push(i),e.hidden=!t,i.isExpanded(r)&&r.doIncludeExclude(r.getChildren(i),t,n)}}return n}async toggleCollapse(e,t){const n=this,r=n.getById(e),o=r.instanceMeta(n);if(t===i&&(t=!o.collapsed),!o.isLoadingChildren&&!r.isLeaf&&r.isExpanded(n)===t){if(n.trigger("beforeToggleNode",{record:r,collapse:t}),o.collapsed=t,o.collapsed)return n.onNodeCollapse(r),!0;{n.onNodeExpand(r);let e=!0;if(!r.isLoaded){o.isLoadingChildren=!0;try{await n.loadChildren(r)}catch(t){o.collapsed=!0,e=!1,n.trigger("loadChildrenException",{record:r,exception:t})}finally{o.isLoadingChildren=!1}}return e}}}onNodeCollapse(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}onNodeExpand(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}transformToTree(e){const{parentIdField:t,idField:n,childrenField:r}=this.modelClass,i=new Map,o=new Set,s=[];for(const r of e){const e=r[n];null!=e&&i.set(e,r),null!=r[t]&&o.add(r[t])}const l=e=>{const t=Object.assign({},e);return t[r]=[],i.set(t[n],t),t};for(let a of e){o.has(a[n])&&!a[r]&&(a=l(a));const e=a[t];if(null!=e){let t=i.get(e);t&&(t[r]||(t=l(t)),t[r].push(a))}else a[r]?s.push(a):null!=a[n]?s.push(l(a)):s.push(a)}return s}treeify(e,t,n=!1){const{length:r}=e,o=[],s=[],l={};let a,c;for(a=0;a<r;a++){let t=e[a];t=t.field||t,e[a].call||(e[a]=e=>e[t],e[a].fieldName=t),o[a]=new Map}this.rootNode.traverse((t=>{if(c=null,t.isLeaf){for(a=0;a<r;a++){var n;const r=(null===(n=c)||void 0===n?void 0:n.path)||"",i=o[a],s=e[a](t);if(s===Uo)break;const l=`${r+(null!=s&&s.isModel?s.id:s)}/`,d=A.makeValidDomId(`generated_${l}`,"_"),u=e[a].fieldName,h=i.get(d)||i.set(d,{id:d,key:s,path:l,expanded:!0,readOnly:!0,children:[],generatedParent:!0,field:u,firstGroupChild:t}).get(d);c&&!c.children.includes(h)&&c.children.push(h),c=h}c?c.children.push(t):s.push(t)}}),!0),(t||n)&&o.forEach((e=>e.forEach(((e,r,i)=>{null==t||t(e),n&&(e=this.createRecord(e),i.set(r,e))})))),l.children=[...o[0].values(),...s];const d=t=>{t.children&&(t.children.sort(((t,n)=>{if(t.isLeaf===n.isLeaf){if(t.isLeaf){let i;for(let o=0;!i&&o<r;o++){const r=e[o](t),s=e[o](n);if(r===Uo||s===Uo)return t.isLeaf<n.isLeaf?-1:t.isLeaf>n.isLeaf?1:0;i=r<s?-1:s>r?1:0}return i}return"string"==typeof t.key&&"string"==typeof n.key?t.key.localeCompare(n.key,i,{numeric:!0}):t.key<n.key?-1:t.key>n.key?1:0}return t.isLeaf<n.isLeaf?-1:t.isLeaf>n.isLeaf?1:0})),t.children.forEach(d))};return d(l),l}treeifyFlatData(e){const{childrenField:t,parentIdField:n}=this.modelClass;let r=!1,i=!0;for(const o of e){if(o.isModel||Array.isArray(o[t])){i=!1;break}null!=o[n]&&(r=!0)}return i&&r&&(e=this.transformToTree(e)),e}async indent(e){const t=this;if((e=(e=Array.isArray(e)?e:[e]).filter((t=>{let n=Boolean(t.previousSibling);for(;n&&!t.isRoot;)n=!e.includes(t.parent),t=t.parent;return n}))).length&&!1!==t.trigger("beforeIndent",{records:e})){e.sort(((e,t)=>jo.compare(e.wbsCode,t.wbsCode))),t.beginBatch();for(const n of e){const e=n.previousSibling;e.appendChild(n),t.toggleCollapse(e,!1)}t.endBatch(),t.trigger("indent",{records:e}),t.trigger("change",{action:"indent",records:e})}}async outdent(e){const t=this;if((e=(e=Array.isArray(e)?e:[e]).filter((t=>{const{parent:n}=t;let r=n&&!n.isRoot;for(;r&&!t.isRoot;)r=!e.includes(n),t=t.parent;return r}))).length&&!1!==t.trigger("beforeOutdent",{records:e})){e.sort(((e,t)=>jo.compare(e.wbsCode,t.wbsCode))),t.beginBatch();for(const n of e){const{parent:e}=n,r=e.children.slice(e.children.indexOf(n)+1);e.parent.insertChild(n,e.nextSibling),n.appendChild(r),t.toggleCollapse(n,!1)}t.endBatch(),t.trigger("outdent",{records:e}),t.trigger("change",{action:"outdent",records:e})}}};class qo{static preWalk(e,t,n){const r=[e];let i,o;for(;r.length;)i=r.pop(),n(i),o=t(i),o&&r.push.apply(r,o.slice().reverse())}static preWalkWithParent(e,t,n){const r=[{node:e,parent:null}];for(;r.length;){const{parent:e,node:i}=r.pop();n(e,i);const o=t(i);Array.isArray(o)&&r.push(...o.slice().reverse().map((e=>({node:e,parent:i}))))}}static preWalkUnordered(e,t,n){const r=[e];let i,o;for(;r.length;)i=r[r.length-1],n(i),o=t(i),o?r.splice(r.length-1,1,...o):r.length=r.length-1}static postWalk(e,t,n){const r=new Map,i=[e];let o,s;for(;i.length;)o=i[i.length-1],r.has(o)?(n(o),i.pop()):(s=t(o),s&&i.push(...s.slice().reverse()),r.set(o,o))}static prePostWalk(e,t,n,r){const i=new Map,o=[e];let s,l;for(;o.length;)s=o[o.length-1],i.has(s)?(r(s),o.pop()):(n(s),l=t(s),l&&o.push(...l.slice().reverse()),i.set(s,s))}}qo._$name="WalkHelper";var Ko=e=>class extends(e||fe){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null,shouldSyncDataset:null,shouldSyncRecord:null}}syncDataset(e){var t;const n=this,{storage:r}=n,o=null===(t=n.shouldSyncDataset)||void 0===t?void 0:t.call(n,{data:e});if(!1===o)return;n.trigger("startApplyChangeset"),n.isSyncingDataOnLoad=!0;const{toAdd:s,toRemove:l,toMove:a,updated:c,ids:d}=n.tree?n.syncTreeDataset(e,o):n.syncFlatDataset(e,o);let{threshold:u}=n.syncDataOnLoad,h=!1;if(u&&("string"==typeof u&&(u=parseInt(u,10)/100*n.count),h=s.length+l.length+a.length+c.length>u),n.tree){if(s.length){n.add(s,h).forEach((e=>e.clearParentId()))}if(a.length)for(const{parent:e,node:t,index:r}of a){n.getById(e.id).insertChild(t,r)}n.remove(l,h)}else h&&n.suspendEvents(),n.remove(l),n.add(s),h&&n.resumeEvents();u&&!h&&c.forEach((({record:e,toSet:t,wasSet:r})=>n.onModelChange(e,t,r))),n.acceptChanges();const g={added:s,removed:l,updated:c,thresholdSurpassed:h};if(n.isFiltered&&!n.remoteFilter&&n.filter({silent:n.isRemoteDataLoading}),n.isGrouped)n.group(null,null,!1,!0,n.isRemoteDataLoading);else if(n.isSorted)n.remoteSort?r.replaceValues({values:r.values.sort(n.createSorterFn(n.sorters)),silent:!0}):n.sort();else if(n.tree){let e=!1,t=0;qo.preWalk(n.rootNode,(t=>Array.isArray(t.children)&&!e?t.children:null),(n=>{n.id!==d[t++]&&(e=!0)})),e&&(n.sort(((e,t)=>d.indexOf(e.id)-d.indexOf(t.id)),i,i,!0),n.clearSorters(!0),!h&&n.afterPerformSort())}else r.values.some(((e,t)=>e.id!==d[t]))&&(r.replaceValues({values:r.values.sort(((e,t)=>d.indexOf(e.id)-d.indexOf(t.id))),silent:!0}),!h&&n.afterPerformSort());h&&n.trigger("refresh",{action:"batch",data:e,records:r.values,syncInfo:g}),n.isSyncingDataOnLoad=!1,n.trigger("endApplyChangeset"),n.trigger("loadSync",g)}syncFlatDataset(e,t){if(!e)return{toRemove:this.records};const n=this,{idField:r,allFields:i}=n.modelClass,o=[],s=[],l=[],a={},c=[],d=Array.isArray(t),{threshold:u,keepMissingValues:h}=n.syncDataOnLoad;let g=0;if(e.forEach((e=>{const o=(e=e.isModel?e.data:e)[r],p=n.getById(o);var m;if(!d||t.includes(o))if(p){if(!1!==(null===(m=n.shouldSyncRecord)||void 0===m?void 0:m.call(n,{record:p,data:e}))){var f,v;if(null===(f=n.beforeSyncRecord)||void 0===f||f.call(n,{record:p,data:e}),!1===h)for(const t of i)!(t.dataSource in e)&&t.dataSource in p.data&&(e[t.dataSource]=t.defaultValue);const t=p.set(e,null,Boolean(u));t&&l.push({record:p,wasSet:t,toSet:e}),null===(v=n.afterSyncRecord)||void 0===v||v.call(n,{record:p,data:e})}}else s.push(n.processRecord(n.createRecord(e)));p&&g++,a[o]=1,c.push(o)})),g<n.allRecords.filter((e=>!e.isSpecialRow)).length)if(t)for(const e of t)a[e]||o.push(n.getById(e));else n.forEach((e=>{a[e.id]||o.push(e)}),n,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0});return{toAdd:s,toRemove:o,toMove:[],updated:l,ids:c}}syncTreeDataset(e){if(!e)return{toRemove:this.records};const t=this,{idField:n,parentIdField:r,childrenField:o,allFields:s}=t.modelClass,{keepMissingValues:l,threshold:a}=t.syncDataOnLoad,c=[],d=[],u=[],h=[],g=new Set,p=[];return t.transformFlatData&&(e=t.treeifyFlatData(e)),qo.preWalkWithParent({isRoot:!0,id:t.rootNode.id,children:e},(e=>e.children),((e,c)=>{if(e){const{id:f,node:v}=t.resolveSyncNode(c);var m;if(v){if(!1!==(null===(m=t.shouldSyncRecord)||void 0===m?void 0:m.call(t,{record:v,data:c}))){let r;const i=v.children;if(!0!==i&&!0===c[o]&&(v.clearChildren(),v.data[o]=v.children=!0,delete c[o],t.toggleCollapse(v,!0),r=!0),v.parent.id!==e[n]&&u.push({node:v,parent:e,index:e[o].indexOf(c)}),!1===l)for(const e of s)"parentId"!==e.name&&!(e.dataSource in c)&&e.dataSource in v.data&&(c[e.dataSource]=e.defaultValue);const d=v.set(c,null,Boolean(a));d?h.push({record:v,wasSet:d,toSet:c}):r&&v.signalNodeChanged({[o]:{value:!0,oldValue:i}})}}else c[r]=e[n],d.push({...c,...Array.isArray(c[o])?{children:[]}:i});g.add(v),p.push(f)}})),g.length!==e.length&&t.traverse((e=>{g.has(e)||c.push(e)})),{toAdd:d,toRemove:c,toMove:u,updated:h,ids:p}}resolveSyncNode(e){const t=e[this.modelClass.idField];return{id:t,node:this.getById(t)}}};const Xo=Symbol("STM_PROP");var Jo=e=>class extends(e||fe){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[Xo]}set stm(e){const t=this;var n;t.stm!==e&&(null!==(n=t.stm)&&void 0!==n&&n.hasStore(t)&&t.stm.removeStore(t),t[Xo]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}add(e,t=!1,n={}){let r;const{stm:i}=this;var o;!this.tree&&null!=i&&i.enabled?(r=super.add(e,t),null!==(o=r)&&void 0!==o&&o.length&&i.onStoreModelAdd(this,r,t)):r=super.add(e,t,n);return r}insert(e,t,n=!1){let r;const{stm:o}=this;if(!this.tree&&null!=o&&o.enabled){var s;const l=(Array.isArray(t)?t:[t]).reduce(((e,t)=>{const n=t instanceof io?this.indexOf(t):i;return n!==i&&-1!==n&&e.set(t,n),e}),new Map);r=super.insert(e,t),null!==(s=r)&&void 0!==s&&s.length&&(e=this.indexOf(r[0]),o.onStoreModelInsert(this,e,r,l,n))}else r=super.insert(e,t,n);return r}remove(e,t=!1,n){let r;const{stm:o}=this;if(!this.tree&&null!=o&&o.enabled){var s;const l=(Array.isArray(e)?e:[e]).map((e=>this.getById(e))).filter((e=>!!e)).reduce(((e,t)=>{const n=this.indexOf(t);return n!==i&&-1!==n&&e.set(t,n),e}),new Map);r=super.remove(e,t,n),null!==(s=r)&&void 0!==s&&s.length&&o.onStoreModelRemove(this,r,l,t)}else r=super.remove(e,t,n);return r}removeAll(e){const{stm:t}=this;let n;if(null!=t&&t.enabled){const{tree:r,rootNode:i,allRecords:o}=this,s=o.length,l=r?i.children.slice():o.slice();n=super.removeAll(e),s&&0===this.count&&t.onStoreRemoveAll(this,l,e)}else n=super.removeAll(e);return n}beforeApplyChangeset(){const{stm:e,crudManager:t}=this;let n=!1,r=null;return null!=t&&t.applyingChangeset||null==e||!e.enabled||(n=!0,e.isRecording&&(r=e.stash()),this.ignoreRemoteChangesInSTM?e.disable():e.startTransaction()),{shouldResume:n,transactionId:r}}applyChangeset(e,t,n,r,i){const{shouldResume:o,transactionId:s}=this.beforeApplyChangeset(),l=super.applyChangeset(e,t,n,r,i);return this.afterApplyChangeset(o,s),l}afterApplyChangeset(e,t){if(e){const{stm:e}=this;this.ignoreRemoteChangesInSTM?e.enable():e.stopTransaction(),e.applyStash(t)}}};const Qo={splice:1,clear:1},Zo={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},es=(e,t)=>("boolean"==typeof(t=t||!1)&&(t={includeFilteredOutRecords:t,includeCollapsedGroupRecords:!1}),t||Zo);class ts extends(fe.mixin(ai,Si,je,ui,Ci,Io,Fo,Mo,Ao,Po,No,Ho,Oo,Bo,zo,Yo,Jo,Ko,Lo)){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map,addingClean:!1}}static get configurable(){return{id:!0,modelClass:io,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){Object.assign(this,{added:new Do,removed:new Do,modified:new Do,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=Yt.assign({id:e.storeId},e)),super.construct(e),this.initRelations()}static from(e,t={},n=null){return e&&!e.isStore&&("string"==typeof e?e=ts.getStore(e):(Array.isArray(e)?(n&&(e=e.map((e=>e.isModel?e:n(e)))),e=Yt.assign({},t,{data:e})):e=Yt.assign({},t,e),e=new ts(e))),e}doDestroy(){var e,t,n;const r=this,i=r.registeredRecords;null===(e=r.stm)||void 0===e||null===(t=e.removeStore)||void 0===t||t.call(e,r);for(let e,t=i.length-1;t>=0;t--){var o;e=i[t],null!==(o=e)&&void 0!==o&&o.isDestroyed||e.unjoinStore(r)}var s;(null===(n=r._storage)||void 0===n||n.destroy(),r.isChained)||(null===(s=r.rootNode)||void 0===s||s.destroy());super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}set storage(e){const t=this;null!=e&&e.isCollection?t._storage=e:t._storage=new So(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const e of t._storage)e.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){var e;const t=this;if((null===(e=t._allRecords)||void 0===e?void 0:e.generation)!==t.storage.generation){if(t.isTree){const e=t.collectDescendants(t.rootNode,i,i,{unfiltered:!0}).all;t.rootVisible&&e.unshift(t.rootNode),t._allRecords=e}else t._allRecords=t.isGrouped?t.collectGroupRecords():t.storage.allValues;t._allRecords.generation=t.storage.generation}return t._allRecords}getAllDataRecords(e){const t=this;return t.tree?e?t.allRecords:t.rootNode.allChildren:t.isGrouped?t.collectGroupRecords(e,!1):e?t.storage.allValues:t.storage.values}onIsCreatingToggle(e,t){const n=this,r=e.isPersistable&&!t;n.added[r?"add":"remove"](e),r&&(n.trigger("addConfirmed",{record:e}),n.autoCommit&&n.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let n=0;n<e.length;n++){const r=e[n];r.setData("parentIndex",t+n-e.length),r.joinStore(this)}}onDataChange({source:e,action:t,added:n,removed:r,replaced:i,oldCount:o,items:s,from:l,to:a}){const c=this,d=Qo[t],u=d&&(null==n?void 0:n.length),h=d&&(null==r?void 0:r.length);let g,p;if(c._idMap=null,u&&c.joinRecordsToStore(n),null==i||i.forEach((([e,t])=>{e.unjoinStore(c,!0),t.joinStore(c)})),super.onDataChange(...arguments),!c.isTree){if(u){for(const e of n)c.removed.includes(e)?c.removed.remove(e):c.addingClean||e.isLinked||c.added.add(e);g=!c.remoteFilter&&c.isFiltered&&c.reapplyFilterOnAdd,g&&c.filter({silent:!0}),p=!c.remoteSort&&c.isSorted&&c.reapplySortersOnAdd,p&&c.sort(null,null,!1,!0)}if(h){for(const e of r)e.cancelBatch(),e.unjoinStore(c),c.added.includes(e)?c.added.remove(e):e._undoingInsertion||e.isCreating||e.isLinked||c.removed.add(e);c.modified.remove(r),g=!c.remoteFilter&&c.isFiltered,g&&c.filter({silent:!0})}}switch(t){case"clear":c.relationCache={},c.updateDependentStores("removeall"),c.trigger("removeAll"),c.trigger("change",{action:"removeall"});break;case"splice":if(u){c.updateDependentStores("add",n);const t=n.reduce(((e,t)=>{const{previousIndex:n}=t.meta;return n>-1&&n<e&&(e=n),e}),n[0].meta.previousIndex),r={records:n,index:e.indexOf(n[0],!e.autoFilter)};t>-1&&(r.oldIndex=t),c.trigger("add",r),c.trigger("change",Object.assign({action:"add"},r)),g&&c.triggerFilterEvent({action:"filter",filters:c.filters,oldCount:o,records:c.storage.allValues}),p&&c.trigger("sort",{action:"sort",sorters:c.sorters,records:c.storage.allValues})}r.length&&(c.updateDependentStores("remove",r),c.trigger("remove",{records:r}),c.trigger("change",{action:"remove",records:r})),i.length&&(c.updateDependentStores("replace",i),c.trigger("replace",{records:i,all:c.records.length===i.length}),c.trigger("change",{action:"replace",replaced:i,all:c.records.length===i.length}));break;case"filter":(c.isGrouped||c.isSorted)&&c.performSort(!0);break;case"move":{const e=Math.min(l,a),n=Math.min(c.storage.allValues.length-1,Math.max(l,a));for(let t=c.storage.allValues,r=e;r<=n;r++)t[r].setData("parentIndex",r);c.trigger("move",{record:s[0],records:s,from:l,to:a}),c.isFiltered&&c.performFilter(),c.trigger("change",{action:t,record:s[0],records:s,from:l,to:a});break}}}onDataReplaced(e,t){var n;const r=this,{storage:i}=r,o=i.allValues,s=Boolean(r.sorters.length>0);for(let e=0;e<o.length;e++)o[e].joinStore(r);if(!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.remoteSort?r.isGrouped&&i.replaceValues({...r.prepareGroupRecords(),silent:!0}):(r.isGrouped&&r.group(null,null,!1,!s,!0),s&&r.sort(null,null,!1,!0)),!r.useRawData.disableDuplicateIdCheck){const{idMap:e}=r;if(Object.keys(e).length<i.values.length){const t=[];throw i.values.forEach((n=>e[n.id]?delete e[n.id]:t.push(n))),new Error(`Id collision on ${t.map((e=>e.id))}`)}}const l={action:e,data:t,records:i.values};r.updateDependentStores(e,l.records),null===(n=r.afterLoadData)||void 0===n||n.call(r),r.isRemoteDataLoading||r.trigger("refresh",l),r.trigger("change",l)}onModelChange(e,t,n,r,i){const o=this,s={record:e,records:[e],changes:n,batch:null!=e.batching,fromRelationUpdate:i},l=!e.ignoreBag&&!e.isLinked&&o.updateModifiedBagForRecord(e);if(o.storage.onItemMutation(e,n),"id"in n){const{oldValue:n,value:r}=t.id;o.updateDependentRecordIds(n,r),o.onRecordIdChange({record:e,oldValue:n,value:r})}if(!r){if("id"in n){const{oldValue:n,value:r}=t.id;o.trigger("idChange",{store:o,record:e,oldValue:n,value:r})}o.onUpdateRecord(e,n),o.trigger("update",s),o.trigger("change",Object.assign({action:"update"},s))}o.autoCommit&&l&&o.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let n=!1;return e.isModified?t.modified.includes(e)||t.added.includes(e)||!e.isPartOfStore(t)||e.isAutoRoot||(e.isPhantom?t.added.add(e):t.modified.add(e),n=!0):t.modified.remove(e),n}get idMap(){const e=this,t=!e._idMap,n=e._idMap||(e._idMap={});if(t){const t=e.storage.values;for(let e,r=0,i=0;r<t.length;r++)e=t[r],n[e.id]={index:r,visibleIndex:i,record:e},e.isSpecialRow||i++;if(e.isFiltered)for(let t=0,r=e.storage._values.length;t<r;t++){const r=e.storage._values[t];r.id in n?n[r.id].unfilteredIndex=t:n[r.id]={index:-1,unfilteredIndex:t,record:r}}}return n}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let n=e;if(null!=t&&t.length){class r extends e{static get fields(){return t}}n=r}else if(!this.preventSubClassingModel){class t extends e{}n=t}return n.initClass(),n}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(!0!==e&&e,t)}updateId(e,t){const n=ts.getById(e);n&&ts.unregisterInstance(n),super.updateId(e,t)}generateAutoId(){return ts.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof ts)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let n;const r=e.map((e=>(e instanceof io?n=e.constructor:"string"==typeof e&&(e={text:e}),e)));if(!n){class e extends io{}n=e}e={autoCreated:!0,data:r,modelClass:n,allowNoId:!0},t||(t=ts)}return t?new t(e):void 0}static get stores(){return ts.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const n=this,r=n._rootNode;e!==r&&(r&&n.clear(!0),e instanceof io?(e.instanceMeta(n).collapsed=!1,n._rootNode=e):n._rootNode=e=new n.modelClass(Object.assign({expanded:!0,[n.modelClass.idField]:`${n.id}-rootNode`},e),n,null,!0),n._tree=!0,e.isRoot=!0,e.joinStore(n),(null!==(t=e.children)&&void 0!==t&&t.length||n.rootVisible)&&(e.isLoading=!0,n.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),n.trigger("rootChange",{oldRoot:r,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){var t,n;const r=this,{idField:i,childrenField:o}=r.modelClass;if(r.transformFlatData&&(null===(t=e)||void 0===t?void 0:t.length)>0&&!Object.isExtensible(e[0])&&(r.useRawData=r.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=Yt.clone(e)),r.getConfig("plugins"),r.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=Yt.transformNamedObjectToArray(e,i)),r.tree=!r.isChained&&(r.tree||Boolean(r.autoTree&&(null===(n=e)||void 0===n?void 0:n.some((e=>e[o]))))),e&&(r.remoteSort||r.remoteFilter))for(let t=0;t<e.length;t++)e[t]._remoteSortIndex=t;if(r.syncDataOnLoad&&r._data)r.syncDataset(e);else{if(r._data=e,r.tree){r.transformFlatData&&(e=r.treeifyFlatData(e));const t=r.rootNode;if(t.isLoading=!0,r.clear(!0),t.appendChild(e),r.updateDependentStores("dataset",[t]),t.isLoading=!1,0===e.length){const e={action:"dataset",data:[],records:[]};r.trigger("refresh",e),r.trigger("change",e)}else r.isFiltered&&r.filter()}else r.loadData(e);r.added.clear(),r.removed.clear(),r.modified.clear()}}loadData(e,t="dataset"){const n=this,{storage:r,allowNoId:i}=n,o=n.modelClass.fieldMap.id.dataSource,s=n.find((e=>e.isCreating));s&&r.values.splice(n.records.indexOf(s),1);let l=n.verifyNoGeneratedIds;if(n.removeHeadersAndFooters(n.storage.values),n._idMap=null,n.oldIdMap={},e){if(!(e[0]instanceof io)){n.modelClass.exposeProperties(e[0]);const t=e.length,s=new Array(t);for(let r=0;r<t;r++){var a,c,d;const t=e[r];if(!i&&null==t[o])throw new Error(`Id required but not found on row ${r}`);l&&null!==(a=t[o])&&void 0!==a&&null!==(c=(d=a).startsWith)&&void 0!==c&&c.call(d,"_generated")&&(console.warn(`Generated id found in data: ${t[o]}. Generated ids are temporary and should be replaced with real ids by the backend`),l=!1),s[r]=n.processRecord(n.createRecord(t,!0),!0),s[r].setData("parentIndex",r)}n.clear(!0),r.replaceValues({values:s,isNewDataset:!0,silent:!0})}else n.clear(!0),r.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});s&&!r.values.includes(s)&&r.values.push(s),n._data=e,n.onDataReplaced(t,e)}else n.clear(!0),n._data=null;n.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,n=!0){return(n?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,n=!1){return new this.modelClass(e,this,null,t,!1,n)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:n}){const r=this,i=r._idMap,{idRegister:o,oldIdMap:s}=r;if(r.storage._indicesInvalid=!0,s[t]=e,i&&!i[n]){const e=i[t];delete i[t],i[n]=e}r.added.changeId(t,n),r.removed.changeId(t,n),r.modified.changeId(t,n),delete o[t],o[n]=e,e.index=r.storage.indexOf(e)}onUpdateRecord(e,t){const n=this,{internalId:r}=t,{internalIdRegister:i}=n;r&&(this.storage._indicesInvalid=!0,delete i[r.oldValue],i[r.value]=e),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}get useRawData(){return this._useRawData}set useRawData(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-((null===(e=this.groupRecords)||void 0===e?void 0:e.length)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const n=t.isTree&&t.idRegister[e.id];if(n&&n!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(null!=e&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find((e=>this.storage.allValues.includes(e))):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?null!=this.idRegister[io.asId(e)]:this.indexOf(e)>-1}indexOf(e,t=!1,n=!1){if(null!=e&&e.isModel&&!e.stores.includes(this.$store||this)){const n=e.$links.find((e=>this.storage.allValues.includes(e)));return n?this.indexOf(n,t):-1}if(this.isTree)return(n?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const r=io.asId(e);if(null==r)return-1;const i=this.idMap[r];return i?i[t?"visibleIndex":"index"]:-1}allIndexOf(e){return this.isTree?this.allRecords.indexOf(this.getById(e)):this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const n=[],r={};let i;return this.forEach((t=>{if(!t.isSpecialRow&&!t.isRoot){i=t.getValue(e);const o=i instanceof Date?i.getTime():i;r[o]||(n.push(i),r[o]=1)}}),this,t),n}getValueCount(e,t){let n=0;return this.forEach((r=>{Yt.isEqual(r.getValue(e),t)&&n++})),n}set json(e){"string"==typeof e&&(e=A.safeJsonParse(e)),this.data=e}get json(){return A.safeJsonStringify(this)}get formattedJSON(){return A.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map((e=>e.toJSON()))}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){const t=[];var n;this.tree?null===(n=this.rootNode.children)||void 0===n||n.forEach((n=>t.push(n.getCurrentConfig(e)))):this.forEach((n=>t.push(n.getCurrentConfig(e))));return t}getCurrentConfig(e){const t=super.getCurrentConfig(e),{state:n}=this;var r;t&&(t.data&&(t.data=this.getInlineData(e)),delete t.project,delete t.stm,delete t.asyncEvents,(null===(r=t.modelClass)||void 0===r?void 0:r.$meta.hierarchy[t.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete t.modelClass,this.tree||delete t.tree,n&&Object.assign(t,n));return t}forEach(e,t=this,n){const r=this,i=(n,r)=>{if(!n.isRoot&&!n.isSpecialRow)return e.call(t,n,r)};if(n=es(0,n),r.isTree)r.isChained&&(n={...n,sorterFn:r.sorterFn}),r.rootNode.traverseWhile(i,!1,n);else{const e=n.includeFilteredOutRecords?r.storage.allValues:r.storage.values;if(r.isGrouped&&n.includeCollapsedGroupRecords)for(let t=0;t<e.length;t++){const r=e[t],o=n.includeFilteredOutRecords?r.unfilteredGroupChildren:r.groupChildren;if(o&&!0===r.meta.collapsed)for(let e=0;e<o.length;e++){if(!1===i(o[e],e))return}else if(!1===i(r,t))return}else for(let t=0;t<e.length;t++)if(!1===i(e[t],t))return}}map(e,t=this){return this.storage.values.map(e,t)}flatMap(e,t=this){return this.storage.values.flatMap(e,t)}every(e,t=this,n){return this.storage[n?"allValues":"values"].every(e,t)}reduce(e,t=[],n=this){return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,n=t===this.rootNode,r){const i=this;if(r=es(0,r),i.isTree){if("boolean"==typeof t&&(n=t,t=i.rootNode),i.isChained){const t=e;e=e=>{i.chainedFilterFn(e)&&t(e)}}t.traverse(e,n,r)}else i.forEach((t=>t.traverse(e,!1,r)),i,r)}traverseWhile(e,t=this.rootNode,n=t===this.rootNode,r){const i=this;if(r=es(0,r),i.isTree){if("boolean"==typeof t&&(n=t,t=i.rootNode),i.isChained){const t=e;e=e=>{i.chainedFilterFn(e)&&t(e)}}t.traverseWhile(e,n,r)}else for(const t of i.storage)if(!1===t.traverse(e,!1,r))break}getNext(e,t=!1,n=!1){const r=this,i=r.storage.values;let o=r.indexOf(e);if(o>=i.length-1){if(!t)return null;o=-1}const s=i[o+1];return n&&s&&s.isSpecialRow?r.getNext(i[o+1],t,!0):s}getPrev(e,t=!1,n=!1){const r=this,i=r.storage.values;let o=r.indexOf(e);if(0===o){if(!t)return null;o=i.length}const s=i[o-1];return n&&s&&s.isSpecialRow&&o>0?r.getPrev(i[o-1],t,!0):s}getAdjacent(e,t=!0,n=!1,r=!1){return t?this.getNext(e,n,r):this.getPrev(e,n,r)}getNextLeaf(e,t=!1){const n=this.leaves,r=this.getById(e);let i=n.indexOf(r);if(i>=n.length-1){if(!t)return null;i=-1}return n[i+1]}getPrevLeaf(e,t=!1){const n=this.leaves,r=this.getById(e);let i=n.indexOf(r);if(0===i){if(!t)return null;i=n.length}return n[i-1]}getAdjacentLeaf(e,t=!0,n=!1){return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}}ts.initClass(),ts._$name="Store";const ns=(e,t)=>(Array.isArray(t[1])?t[1].forEach((n=>e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(n)))):e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(t[1])),e),rs=Promise.resolve(),is=e=>String(e).padStart(2,"0");class os extends ts{static $name="AjaxStore";static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}static get configurable(){return{params:null}}afterConstruct(e){super.afterConstruct(e),this.autoLoad&&this.load().catch((()=>{}))}get isLoading(){return this._isLoading?2:!!this.loadTriggerPromise&&1}get isCommitting(){return Boolean(this.commitPromise)}set pageParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e}get pageParamName(){return this._pageParamName}set pageStartParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(e,...t){const n=e.includes("?"),r=Object.entries(Object.assign({},...t)).reduce(ns,[]).join("&");return r?(n?"&":"?")+r:""}async performSort(e){const t=this;if(t.remoteSort&&!t.isRemoteDataLoading){t.isRemoteDataLoading=!0;const n=await t.internalLoad({},"",(n=>{t.data=n.data,t.afterPerformSort(e)}));return t.isRemoteDataLoading=!1,n}super.performSort(e)}async performFilter(e){const t=this;if(t.remoteFilter){var n;null===(n=t.loadingPromise)||void 0===n||n.abort(),t.isRemoteDataLoading=!0;const r=t.count,{filters:i}=t;t.currentPage=1;const o=await t.internalLoad({},"",(n=>{t.data=n.data,n=e?null:{action:"filter",filters:i,oldCount:r,records:t.storage.values},t.afterPerformFilter(n),t.trigger("refresh",n)}));return t.isRemoteDataLoading=!1,o}super.performFilter(e)}encodeFilterParams(e){const t=[];for(const{property:n,operator:r,value:i,caseSensitive:o}of e)t.push({field:n,operator:r,value:i,caseSensitive:o});return JSON.stringify(t,(function(e,t){return""===e?t:this[e]instanceof Date?`${(n=this[e]).getFullYear()}-${is(n.getMonth()+1)}-${is(n.getDate())}T${is(n.getHours())}:${is(n.getMinutes())}:${is(n.getSeconds())}.${n.getMilliseconds()}`:t;var n}))}encodeSorterParams(e){return JSON.stringify(e.filter((e=>!e.sortFn)).map((e=>e)))}buildReadUrl(){const{readUrl:e}=this;if(this.restfulFilter&&this.filters.count){return(e.endsWith("/")?e:e+"/")+this.filters.first.value}return e}internalLoad(e,t,n,r=0){e=Yt.assign({},this.params,e);const i=this,o=i.buildReadUrl(),s={action:"read"+t,params:e,url:o};if(!o)throw new Error("No load url specified");if(!1===i.trigger("beforeLoad"+t,s))throw!1;return i.loadArgs=[o,s,e,t,n],!1===r?new Promise(((e,t)=>i.sendLoadRequest(e,t))):i.loadTriggerPromise||(i.loadTriggerPromise=new Promise(((e,t)=>{i.setTimeout({delay:r,fn:"sendLoadRequest",args:[e,t],cancelOutstanding:!0})})))}async sendLoadRequest(e,t){const n=this,[r,i,o,s,l]=n.loadArgs;if(n.loadTriggerPromise=null,r){if(n._isLoading=!0,n.trigger(`load${s}Start`,i),n.trigger("beforeRequest",i),n.filterParamName&&n.isFiltered&&(o[n.filterParamName]=n.encodeFilterParams(n.filters.values)),n.remoteSort&&n.isSorted&&(o[n.sortParamName]=n.encodeSorterParams(n.groupers?n.groupers.concat(n.sorters):n.sorters)),n.isPaged){if(!(n.pageParamName in o)&&!(n.pageStartParamName in o)){const e=Math.min(n.currentPage||1,n.allCount?n.lastPage:1/0);n.pageParamName?o[n.pageParamName]=e:o[n.pageStartParamName]=(e-1)*n.pageSize}o[n.pageSizeParamName]=n.pageSize}const r={headers:n.headers,parseJson:!0};n.useRestfulMethods&&(r.method=n.httpMethods.read,i.body&&(r.body=JSON.stringify(i.body)));try{const a=n.loadingPromise=ye.get(i.url+n.buildQueryString(i.url,o),Yt.assign(r,n.fetchOptions)),c=await a,d=c.parsedJson,u=Array.isArray(d),h=u||d&&!1!==Yt.getPath(d,n.responseSuccessProperty),g=u?null:Yt.getPath(d,n.responseTotalProperty);if(n.isDestroyed)return;if(n.loadingPromise=null,n._isLoading=!1,i.response=c,i.json=d,h){if(null!=g&&(n.remoteTotal=parseInt(g,10)),n.isPaged){if(!(n.remoteTotal>=0))throw new Error("A paged store must receive its responseTotalProperty in each data packet");{const e=n.pageParamName?o[n.pageParamName]:o[n.pageStartParamName]/n.pageSize+1;n.currentPage=Math.min(e,n.lastPage)}}i.data=u?d:Yt.getPath(d,n.responseDataProperty),await l(i),!n.isDestroyed&&n.trigger("load"+s,i),e(i)}else Object.assign(i,{exception:!0,exceptionType:"server",error:null==d?void 0:d.error}),!n.isDestroyed&&n.trigger("exception",i),t(i);!n.isDestroyed&&n.trigger("afterRequest",i)}catch(e){n._isLoading=!1,i.exception=!0,e instanceof Response?(i.exceptionType=e.ok?"server":"network",i.response=e,i.error=e.error):(i.exceptionType="server",i.error=e),!n.isDestroyed&&n.trigger("exception",i),t(i),!n.isDestroyed&&n.trigger("afterRequest",i)}}}async load(e){const t=this;return t.isPaged?t.loadPage(t.currentPage||1,e):t.internalLoad(e,"",(e=>{t.data=e.data}))}async loadChildren(e){return this.readUrl?this.internalLoad({[this.parentIdParamName]:e.id},"Children",(t=>{t.parentRecord=e,e.children.length&&e.clearChildren(!0),e.data[e.constructor.childrenField]=t.data,e.processChildren(e.stores)}),!1):this.immediatePromise}async loadPage(e,t){this.allCount&&(e=Math.min(e,this.lastPage));const n=this,r=n.pageParamName?{[n.pageParamName]:e}:{[n.pageStartParamName]:(e-1)*n.pageSize};return r[n.pageSizeParamName]=n.pageSize,n.internalLoad(Yt.assign(r,t),"Page",(e=>{n.loadData(e.data,"pageLoad")}))}async nextPage(e){const t=this;return t.isPaged&&t.currentPage!==t.lastPage?t.loadPage(t.currentPage+1,e):rs}async previousPage(e){return this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,e):rs}async commit(){const e=this,{changes:t}=e,n=[];if(e.commitPromise)return!1;if(!t)return e.modified.count&&(e.modified.forEach((e=>e.clearChanges(!0,!1))),e.modified.clear()),rs;if(!1!==e.trigger("beforeCommit",{changes:t})){[...t.added,...t.modified,...t.removed].forEach((e=>e.meta.committing=!0)),e.trigger("commitStart",{changes:t});const r={action:"commit",exception:!1,changes:t};let i=e.commitRemoved(r);return i&&n.push(i),i=e.commitAdded(r),i&&n.push(i),i=e.commitModified(r),i&&n.push(i),n.length?(i=1===n.length?n[0]:Promise.all(n),e.commitPromise=new Promise(((n,o)=>{i.then((()=>{e.commitPromise=null,r.exception?(e.trigger("exception",r),o(r)):(e.trigger("commit",{changes:t}),n(r))})).catch((()=>{e.commitPromise=null,o(r)}))}))):(e.modified.forEach((e=>e.clearChanges(!0,!1))),e.modified.clear(),e.added.forEach((e=>e.clearChanges(!0,!1))),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),rs)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch((e=>{const{response:t}=e;if(!t||!(t.ok&&t.parsedJson||[500,404].includes(t.status)))throw e}))}commitAdded(e){const t=this,n=t.added,r={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((i=>{const o=n.values.map((e=>e.persistableData));e.create=r,r.body={data:o},t.trigger("beforeRequest",r);let s=r.body;if(t.sendAsFormData){const e=new FormData;e.append("data",JSON.stringify(o)),s=e}const l={headers:t.headers,parseJson:!0},a=t.createUrl+t.buildQueryString(t.createUrl,t.params);t.useRestfulMethods&&(l.method=t.httpMethods.create),ye.post(a,s,Yt.assign(l,t.fetchOptions)).then((o=>{const s=o.parsedJson,l=Array.isArray(s),a=l||s&&!1!==s.success;e.response=o,r.json=s,r.response=o,a?(t.processReturnedData(n.values,l?s:Yt.getPath(s,t.responseDataProperty)),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),i(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((o=>{n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}commitModified(e){const t=this,{modified:n}=t.changes,r={action:"update",params:t.params},i=n.length&&t.updateUrl?new Promise((i=>{const o=n.map((e=>t.writeAllFields?e.persistableData:e.modificationDataToWrite)).filter((e=>!Yt.isEmpty(e)));if(0===o.length)return t.modified.clear(),n.forEach((e=>e.meta.committing=!1)),void i();e.update=r,r.body={data:o},t.trigger("beforeRequest",r);let s=r.body;if(t.sendAsFormData){const e=new FormData;e.append("data",JSON.stringify(o)),s=e}const l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.update),ye.post(t.updateUrl+t.buildQueryString(t.updateUrl,t.params),s,Yt.assign(l,t.fetchOptions)).then((o=>{const s=o.parsedJson,l=Array.isArray(s),a=l||s&&!1!==s.success;e.response=o,r.json=s,r.response=o,a?(t.processReturnedData(n,l?s:Yt.getPath(s,t.responseDataProperty),!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",r),i(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((o=>{n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null;return!n.length&&t.modified.count&&t.modified.clear(),i}processReturnedData(e,t,n=!1){const r=this,i=r.modelClass,o=i.fieldMap.id.dataSource;t.forEach(((t,s)=>{const l=e[s];l.clearChanges(!0,!1),l.syncId(t[o]),Object.assign(e[s].data,i.processData(t,n,r,l))}))}commitRemoved(e){const t=this,n=t.removed,r={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((i=>{e.delete=r,r.body={ids:n.map((e=>e.id))},t.trigger("beforeRequest",r);let o=r.body;if(t.sendAsFormData){const e=new FormData;e.append("id",JSON.stringify(o.ids)),o=e}const s={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(s.method=t.httpMethods.delete),ye.post(t.deleteUrl+t.buildQueryString(t.deleteUrl,t.params),o,Yt.assign(s,t.fetchOptions)).then((o=>{const s=o.parsedJson,l=Array.isArray(s)||s&&!1!==s.success;e.response=o,r.json=s,r.response=o,l?(n.forEach((e=>e.meta.committing=!1)),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),i(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((o=>{n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}get remoteFilter(){return Boolean(this.filterParamName||this.restfulFilter)}get remoteSort(){return Boolean(this.sortParamName)}}os._$name="AjaxStore";class ss{static insertRule(e,t=document.head){const n=this.getStyleSheet(t),r=n.cssRules.length;if(n.insertRule(e,0),n.cssRules.length>r)return n.cssRules[0]}static findRule(e){let t;const n="function"==typeof e;return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),(r=>{if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,(t=>n?e(t):t.selectorText===e)),t)return!0})),t}static getStyleSheet(e=document.head){return e.$bryntumStylesheet||(e.$bryntumStylesheet=Lr.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:e}).sheet),e.$bryntumStylesheet}static getCSSVersion(){return getComputedStyle(document.documentElement).getPropertyValue("--bryntum-version").replace(/[" ]/gm,"")}}ss._$name="CSSHelper";const ls=Array.prototype.slice,as=Object.freeze([]),cs=Object.freeze({}),ds=/[&<]/,{getPrototypeOf:us}=Object,{toString:hs}=Object.prototype,{isEqual:gs,isObject:ps}=Yt,ms={parent:1,elementData:1,ns:1,syncOptions:1},fs=()=>({ignore:ms,refsFound:new Set}),vs={class:1,className:1,classname:1},bs={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},ys={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1};class Cs{static checkEquality(e,t,n,r){if(e===t)return!0;if(null==e)return null==t;if(!e||!t)return!1;const o=typeof e;if(o!==typeof t||bs[o])return!1;let s,l,a,c,d,u,h,g=n.equalityCache||(n.equalityCache=new Map),p=Boolean(r);if(g=g.get(e)||g.set(e,new Map).get(e),s=g.get(t),s===i){if(s=!0,us(e)!==us(t)||e instanceof Node)s=!1;else if(Array.isArray(e)){if(l=e.length,l!==t.length)s=!1;else for(;l-- >0;)if(!Cs.checkEquality(e[l],t[l],n,p)){s=!1;break}}else{var m;for(d in u=e.syncOptions,c=null===(m=u)||void 0===m?void 0:m.ignoreRefs,c&&(p=!0,r="children"!==c),a=n.ignore||cs,t)if(!(a[d]||d in e||r&&"reference"===d)){s=!1;break}if(s)if("[object Date]"===hs.call(t))s=e.getTime()===t.getTime();else for(d in e)if(!(a[d]||r&&"reference"===d)){if(!(d in t)){s=!1;break}if(h=e[d],!Cs.checkEquality(h,t[d],n,p)){s=!1;break}}}var f;if(!r&&ps(e)&&e.reference)null===(f=n.refsFound)||void 0===f||f.add(e.reference);g.set(t,s)}return s}static sync(e){const t=e,{refOwner:n}=e,r=null==n?void 0:n.byRef,i=fs();let o,s,l,a,c=e.affected;if("string"==typeof c&&(c=[c]),e={...e,checkEqualityOptions:i},n){if(n.byRef={},c)for(s in r)c.includes(s)||(n.byRef[s]=r[s]);e.refsWas=r}if(t.changed=Cs.performSync(e,e.targetElement),n)for(c||(c=Object.keys(r)),o=0;o<c.length;++o)s=c[o],l=r[s],i.refsFound.has(s)||l.retainElement?n.byRef[s]=l:(a=l.lastDomConfig,l.remove(),n.detachRef(s,l,a));return e.targetElement}static performSync(e,t){const{domConfig:n,callback:r}=e,{lastDomConfig:i}=t;return(e.configEquality||Cs.checkEquality)(n,i,e.checkEqualityOptions,e.ignoreRefs)?(null==r||r({action:"none",domConfig:n,targetElement:t}),!1):(n?(n.onlyChildren||(Cs.syncAttributes(n,t,e),Cs.syncContent(n,t)),n.keepChildren||Cs.syncChildren(e,t)):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=null!=n&&n.onlyChildren&&i?{...i,children:n.children}:n,!0)}static syncDataset(e,t){const{lastDomConfig:n}=t,r=e===n,i=Object.keys(e.dataset),o=n&&n.dataset&&Object.keys(n.dataset),s=H.delta(i,o);let l,a,c,d;for(a=0;a<s.onlyInA.length;a++)l=s.onlyInA[a],d=e.dataset[l],null!=d&&t.setAttribute(`data-${A.hyphenate(l)}`,d);for(a=0;a<s.inBoth.length;a++)l=s.inBoth[a],d=e.dataset[l],(r||d!=n.dataset[l])&&(c=`data-${A.hyphenate(l)}`,null==d?t.removeAttribute(c):t.setAttribute(c,d));for(a=0;a<s.onlyInB.length;a++)t.removeAttribute(`data-${A.hyphenate(s.onlyInB[a])}`)}static addCls(e,t){const{lastDomConfig:n}=t;(e=wn.normalize(e,"array")).forEach((e=>{t.classList.add(e),((e,t)=>{const n="className"in t?"className":"class",r=t[n];if(r)if("string"==typeof r){const i=r.split(" ");i.includes(e)||(i.push(e),t[n]=i.join(" "))}else Array.isArray(r)?r.includes(e)||r.push(e):r.isDomClassList?r.add(e):Yt.isObject(r)&&(r[e]=1)})(e,n)}))}static removeCls(e,t){const{lastDomConfig:n}=t;(e=wn.normalize(e,"array")).forEach((e=>{t.classList.remove(e),((e,t)=>{const n="className"in t?"className":"class",r=t[n];if(r)if("string"==typeof r){const i=r.split(" ");i.includes(e)&&(i.splice(i.indexOf(e),1),t[n]=i.join(" "))}else Array.isArray(r)?r.includes(e)&&r.splice(r.indexOf(e),1):r.isDomClassList?r.remove(e):Yt.isObject(r)&&delete r[e]})(e,n)}))}static syncClassList(e,t,n){let r,i,o,s,l,a,c=e.className||e.class,d=!1;if(n){for(i=wn.normalize(t,"array"),c=wn.normalize(c,"object"),a=wn.normalize(n.className||n.class,"object"),l=[],o=0,s=i.length;o<s;++o)r=i[o],c[r]||!(r in a)?(a[r]=1,l.push(r)):d=!0;for(r in c)a[r]||(l.push(r),d=!0);if(!d)return;c=l.join(" ")}else c=wn.normalize(c);t.setAttribute("class",c)}static getSyncAttributes(e){const t={},n=[];return e&&Object.keys(e).forEach((r=>{if(!ys[r]){const i=r.toLowerCase();t[i]=e[r],n.push(i)}})),{attributes:t,names:n}}static syncAttributes(e,t,n){const{lastDomConfig:r}=t,i=e===r,o=Cs.getSyncAttributes(e),{attributes:s,names:l}=o,{attributes:a,names:c}=i?o:Cs.getSyncAttributes(r),{onlyInA:d,onlyInB:u,inBoth:h}=i?{onlyInA:as,onlyInB:as,inBoth:l}:H.delta(l,c);let g,p;for(p=0;p<d.length;p++){g=d[p];const n=s[g];"style"===g&&null!=n?Lr.applyStyle(t,n,!0):"dataset"===g?Cs.syncDataset(e,t):vs[g]?Cs.syncClassList(e,t):null!=n&&t.setAttribute(g,n)}for(p=0;p<u.length;p++)t.removeAttribute(u[p]);for(p=0;p<h.length;p++){g=h[p];const r=s[g],o=a[g];null==r?t.removeAttribute(g):"style"===g?n.strict?i?Cs.syncStyles(t,r):gs(r,o,!0)||Cs.syncStyles(t,r,o):!i&&gs(r,o,!0)||Lr.applyStyle(t,r,!0):"dataset"===g?Cs.syncDataset(e,t):vs[g]?Cs.syncClassList(e,t,n.strict&&t.lastDomConfig):(i||r!==o)&&t.setAttribute(g,r)}}static syncStyles(e,t,n){let r,i,o;if(n){if(r={},t=Lr.parseStyle(t),n=Lr.parseStyle(n),t)for(i in t)o=t[i],n[i]!==o&&(r[i]=o);for(i in n)i in t||(r[i]="")}else r=t;Lr.applyStyle(e,r)}static syncContent(e,t){const{html:n,text:r}=e,i=r??n;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),i instanceof DocumentFragment)1===t.childNodes.length&&0===Lr.getChildElementCount(t)&&1===i.childNodes.length&&0===Lr.getChildElementCount(i)?Lr.setInnerText(t,i.firstChild.data):(t.innerHTML="",t.appendChild(i));else if(null!=n&&ds.test(n))t.innerHTML=String(n);else if(null!=i){var o;const{lastDomConfig:e}=t;null!=e&&null!==(o=e.children)&&void 0!==o&&o.length||null!=e&&e.html&&ds.test(t.lastDomConfig.html)?t.innerHTML=i:(Lr.setInnerText(t,String(i)),t.didSetTextContent=!0)}}static insertTextNode(e,t,n,r,i=null){const o=document.createTextNode(e);t.insertBefore(o,i),r&&(o.$refOwnerId=r.id),null==n||n({action:"newNode",domConfig:e,targetElement:o})}static insertElement(e,t,n,r,i,o,s){var l;const a=s.ns?document.createElementNS(s.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(a,n),Cs.performSync(s,a),null!=o&&(i[o]=a),e.role||e.tabIndex||e["aria-hidden"]||Lr.isFocusable(a,!0)||a.htmlFor||a.setAttribute("role","presentation"),r&&(a.$refOwnerId=r.id,o&&(a.$reference=o,r.attachRef(o,a,e))),null===(l=s.callback)||void 0===l||l.call(s,{action:"newElement",domConfig:e,targetElement:a,syncId:o})}static syncChildren(e,t){let n,r,i,{domConfig:o,syncIdField:s,callback:l,releaseThreshold:a,configEquality:c,ns:d,refOwner:u,refsWas:h,strict:g,checkEqualityOptions:p,ignoreRefs:m}=e,f=null;const v=o.syncOptions||{};if(o.html??o.text)return;m=Boolean(v.ignoreRefs??m),m&&(u=h=null),"strict"in v&&(g=v.strict);const b=u?u.byRef:{},y=ls.call(o.children||[]),C=ls.call(t.childNodes),w=h||t.syncIdMap||{},x=t.releasedIdMap||{},S=e=>{for(;C.length&&C[0].parentNode!==t;)C.shift();return(e?C.shift():C[0])||null};s=v.syncIdField||s,g=v.strict||g,l=v.callback||l,c=v.configEquality||c,a="releaseThreshold"in v?v.releaseThreshold:a,s&&(t.syncIdMap=b);const E={checkEqualityOptions:p||fs(),ignoreRefs:m,refOwner:u,refsWas:h,strict:g,syncIdField:s,releaseThreshold:a,callback:l,configEquality:c};for(;y.length;){const o=y.shift();if(i=null,!o)continue;if(Lr.isReactElement(o)){l({jsx:o,targetElement:t});continue}if(Array.isArray(o)){this.syncChildren({...e,domConfig:{...e.domConfig,children:o}},t);continue}if(o instanceof Node){r=S(),o!==r&&t.insertBefore(o,r),n=C.indexOf(o),n>-1&&C.splice(n,1);continue}const a="string"==typeof o;if(E.domConfig=o,E.ns=o.ns||d,!a){if(u?i=o.reference:s&&o.dataset&&(i=o.dataset[s]),null!=i&&!o.unmatched){const e=w[i]||x[i];if(e){const{lastDomConfig:n}=e;if(e.retainElement);else if(Cs.performSync(E,e)){var R;null===(R=l)||void 0===R||R({action:"reuseOwnElement",domConfig:o,targetElement:e,lastDomConfig:n,syncId:i})}o.retainElement&&(e.retainElement=!0),b[i]=e,H.remove(C,e),delete x[i],e.isReleased=!1,r=S(),(e.parentNode!==t||g&&e.nextSibling!==r)&&t.insertBefore(e,r)}else g?Cs.insertElement(o,t,S(),u,b,i,E):(y.push(o),o.unmatched=!0);continue}o.unmatched&&delete o.unmatched}let c,h=null,p=null;for(;!p&&(c=S(!0));){if(u){if(c.$refOwnerId!==u.id)continue;if(c.$reference){if(!g)continue;h=c;break}p=c}else c.retainElement||(p=c);p||(f||(f=[])).push(c)}if(h||!p)a?Cs.insertTextNode(o,t,l,u,h):Cs.insertElement(o,t,h,u,b,i,E);else if(a||p.nodeType!==Node.ELEMENT_NODE||(o.tag||"div").toLowerCase()!==p.tagName.toLowerCase())a&&p.nodeType===Node.TEXT_NODE?p.data=o:(a?Cs.insertTextNode(o,t,l,u,p):Cs.insertElement(o,t,p,u,b,i,E),p.remove());else{var T,D;const{lastDomConfig:e}=p,t=Cs.performSync(E,p);if(s&&null!=(null==e||null===(T=e.dataset)||void 0===T?void 0:T[s])){const t=e.dataset[s];delete x[t],delete w[t]}null!=i&&(b[i]=p),p.isReleased=!1,t&&(null===(D=l)||void 0===D||D({action:"reuseElement",domConfig:o,targetElement:p,lastDomConfig:e,syncId:i}))}}if(!t.didSetTextContent||1!==C.length||C[0].nodeType!==Node.TEXT_NODE){for(;r=S(!0);)u&&(r.$refOwnerId!==u.id||r.$reference)||(f||(f=[])).push(r);f&&Cs.syncChildrenCleanup(t,f,b,l,u,a,s)}}static syncChildrenCleanup(e,t,n,r,i,o,s){let l,a=0;for(const c of t){const{lastDomConfig:t}=c;c.nodeType!==Element.TEXT_NODE?c.retainElement?s&&t&&(n[c.dataset[s]]=c):!i&&s&&(null==o||a<o)?(c.isReleased||(c.className="b-released",c.isReleased=!0,null!=t&&t.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[t.dataset[s]]=c),null==r||r({action:"releaseElement",domConfig:t,lastDomConfig:t,targetElement:c}),t&&(t.isReleased=!0,t.className&&(t.className="b-released"),t.class&&(t.class="b-released"),t.style&&(t.style=null))),a++):(c.remove(),i&&(l=c.$reference,l&&i.detachRef(l,c,t)),e.releasedIdMap&&s&&null!=t&&t.dataset&&delete e.releasedIdMap[t.dataset[s]],null==r||r({action:"removeElement",domConfig:c.lastDomConfig,lastDomConfig:c.lastDomConfig,targetElement:c})):c.remove()}}static removeChild(e,t){if(e.contains(t)){const n=e.syncIdMap;if(n){const e=Object.values(n).indexOf(t);e>-1&&delete n[Object.keys(n)[e]]}e.removeChild(t)}}static addChild(e,t,n){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[n]=t}static getChild(e,t){const n=String(t).split(".");for(const t of n){var r,i;if(!(e=null===(r=e)||void 0===r||null===(i=r.syncIdMap)||void 0===i?void 0:i[t]))return null}return e}}Cs._$name="DomSync";class ws{static init(){const e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=t=>e.map((e=>{let n=t+A.capitalize(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}));this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];const n=["fullscreenchange","fullscreenerror"],r=e=>n.map((t=>e+A.capitalize(t)));this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[],this.onFullscreenChange(this.onInternalFullscreenChange.bind(this))}static get enabled(){return Boolean(this.functions[0]&&document[this.functions[0]])}static async request(e){return this.functions[1]&&(null==e?void 0:e[this.functions[1]]())}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(e){this.events[0]&&document.addEventListener(this.events[0],e)}static unFullscreenChange(e){this.events[0]&&document.removeEventListener(this.events[0],e)}static onInternalFullscreenChange(){const e=this,{element:t}=e;if(t){if(!t.closest(".b-floatroot")){const n=Lr.getRootElement(t),{floatRoot:r}=n;r&&(e._floatRoot=r,e._oldParent=r.parentElement,t.appendChild(r))}}else e._floatRoot&&e._oldParent.appendChild(e._floatRoot),e._oldParent=null,e._floatRoot=null}}ws.init(),ws._$name="Fullscreen";let xs=null;const Ss=[],Es=e=>{var t;return e.nodeType===e.ELEMENT_NODE&&"absolute"===(null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).getPropertyValue("position"))};class Rs{static addResizeListener(e,t){const n=this;if(e!==document&&e!==r||(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(r.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(r.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[r,i,o]=Lr.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});i.scrollLeft=i.scrollTop=o.scrollLeft=o.scrollTop=1e6,i.addEventListener("scroll",n.onSizeMonitorScroll,!0),o.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((e=>{const t=[],n=[];for(const r of e)"childList"===r.type&&(t.push.apply(t,r.addedNodes),n.push.apply(n,r.removedNodes));const r=[...t.filter((e=>!n.includes(e))),...n.filter((e=>!t.includes(e)))];0!==r.length&&(r.length>0&&r.every(Es)||i.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=r}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){e!==document&&e!==r||(e=document.body);const n=e._bResizemonitor;let i=0;n&&n.handlers&&(H.remove(n.handlers,t),i=n.handlers.length),i||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const e=t.target,n=e._bResizemonitor,r=t.contentRect||e.getBoundingClientRect();if(xr(e)&&(!n.rectangle||r.width!==n.rectangle.width||r.height!==n.rectangle.height)){const t=n.rectangle;n.rectangle=r;for(const i of n.handlers)i(e,t,r)}}}static onSizeMonitorScroll(e){var t;if(null!==(t=document.body)&&void 0!==t&&t.contains(e.target)){e.stopImmediatePropagation();const t=e.target.parentNode,n=t.parentNode,r=n._bResizemonitor,i=n.getBoundingClientRect();r.rectangle&&i.width===r.rectangle.width&&i.height===r.rectangle.height||(Ss.push([n,r.rectangle,i]),r.rectangle=i,xs||(xs=requestAnimationFrame(Rs.fireResizeEvents))),t.firstChild.scrollLeft=t.firstChild.scrollTop=t.childNodes[1].scrollTop=t.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,n=t._bResizemonitor,r=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();for(const e of n.handlers)e(t,r,n.rectangle)}static fireResizeEvents(){for(const e of Ss)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);xs=null,Ss.length=0}static removeGlobalListeners(){r.removeEventListener("resize",this.onWindowResize)}}Rs._$name="ResizeMonitor";const Ts={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:s.supportsOverflowClip?"clip":"hidden"},Ds="b-widget-scroller",Ms={block:"nearest"},Fs=Promise.resolve(),Is=e=>new Promise((t=>Gn.on({element:e===document.documentElement?r:e,scroll:t,once:!0}))),ks={x:1},Os={auto:1,scroll:1},Ls={true:1,auto:1},As={overflowX:"auto",overflowY:"auto"};class Ps extends(ai(je(fe))){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null,propagateSync:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}syncOverflowState(){const e=this,{element:t}=e,n=new wn(t.classList),r=e.hasOverflowX=t.scrollWidth>t.clientWidth,i=e.hasOverflowY=t.scrollHeight>t.clientHeight;n.value=t.classList;(n.toggle("b-horizontal-overflow",r)||n.toggle("b-vertical-overflow",i))&&(Lr.syncClassList(t,n),e.isConfiguring||e.trigger("overflowChange",{x:r,y:i}))}hasOverflow(e="y"){const t=this,n=t[`overflow${e.toUpperCase()}`],r=t["overflow"+("y"===e?"x":"y")];if(!Lr.scrollBarWidth||!Ls[n]||"hidden-scroll"===r){const n="y"===e?"Height":"Width";return t[`scroll${n}`]>t[`client${n}`]}return t[`hasOverflow${e.toUpperCase()}`]}hasScrollbar(e="y"){const{element:t}=this;if(t&&Lr.scrollBarWidth){const n="y"===e,r=n?"Width":"Height",i=t[`client${r}`],o=parseInt(Lr.getStyleValue(t,`border${n?"Left":"Top"}Width`))+parseInt(Lr.getStyleValue(t,`border${n?"Right":"Bottom"}Width`)),s=t[`offset${r}`]-o-i;return Math.abs(s-Lr.scrollBarWidth)<2}}addPartner(e,t=ks){const n=this;"string"==typeof t&&(t={[t]:1}),n.partners||(n.partners={}),n.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=n.x),t.y&&(e.y=n.y),e.isPartneredWith(n)||e.addPartner(n,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){e&&this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return Boolean(null===(t=this.partners)||void 0===t?void 0:t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach((e=>e.scroller.removePartner(this)))}async scrollIntoView(e,t=Ms){const n=this,{isRectangle:r}=e,i=r?e:bn.from(e),{xDelta:o,yDelta:s}=n.getDeltaTo(e,t),l=n.scrollBy(o,s,t);return(t.highlight||t.focus)&&l.then((()=>{var l;e=r?i.translate(-o,-s):(null===(l=t.elementAfterScroll)||void 0===l?void 0:l.call(t))??e,t.highlight&&(isNaN(t.highlight)?(n.widget||n).callback(t.highlight,null,[e]):Lr.highlight(e,n)),t.focus&&Lr.focusWithoutScrolling(e)})),l}static async scrollIntoView(e,t=Ms,n=!1){const r=bn.from(e),i="object"==typeof t?t.animate:t,o=Ps._globalScroller||(Ps._globalScroller=new Ps),s=[];o.rtlSource={rtl:n};let l,a=0,c=0;for(let n=e.parentNode;n.nodeType===Node.ELEMENT_NODE;n=n.parentNode){if(n===document.body&&n!==document.scrollingElement)continue;const e=n===document.scrollingElement?As:n.ownerDocument.defaultView.getComputedStyle(n);if(!1!==t.y&&Os[e.overflowY]&&n.scrollHeight>n.clientHeight||!1!==t.x&&Os[e.overflowX]&&n.scrollWidth>n.clientWidth){o.element=n,o.positionDirty=!0;const{xDelta:e,yDelta:i}=o.getDeltaTo(r,t);(e||i)&&(s.push({element:n,x:n.scrollLeft,y:n.scrollTop,xDelta:e,yDelta:i}),r.translate(-e,-i),a+=e,c+=i)}}if(s.length){const e=Math.abs(a),t=Math.abs(c);let r=i&&("number"==typeof i?i:"number"==typeof i.duration?i.duration:300);if(r&&(e>10||t>10))Math.max(e,t)<50&&(r=Math.min(r,500)),l=o.scrollAnimation=Te.animate(r,(e=>{const t=1===e;for(const{element:r,x:i,y:l,xDelta:a,yDelta:c}of s)o.element=r,a&&(o.x=Math[n?"min":"max"](i+(t?a:Math.round(a*e)),0)),c&&(o.y=Math.max(l+(t?c:Math.round(c*e)),0))}),null,i.easing),l.then((()=>{o.scrollAnimation=null}));else{for(const{element:e,xDelta:t,yDelta:n}of s)e.scrollTop+=n,e.scrollLeft+=t;l=Is(s[s.length-1].element)}}else l=Fs;return(t.highlight||t.focus)&&l.then((()=>{t.highlight&&(isNaN(t.highlight)?o.callback(t.highlight,null,[e]):Lr.highlight(e,o)),t.focus&&e.focus()})),l}scrollBy(e=0,t=0,n=Ms){const r=this,i="object"==typeof n?n.animate:n,o=Math.abs(e),s=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=n.silent);let l=i&&("number"==typeof i?i:"number"==typeof i.duration?i.duration:300);if(l&&(o>10||s>10)){const{x:a,y:c}=r;let d=a,u=c;return Math.max(o,s)<50&&(l=Math.min(l,500)),r.scrollAnimation=Te.animate(l,(i=>{const o=1===i;if(e){var s;if(Math.abs(r.x-d)>1&&!n.force)return null===(s=r.scrollAnimation)||void 0===s?void 0:s.cancel();r.x=Math.max(a+(o?e:Math.round(e*i)),0)}if(t){var l;if(Math.abs(r.y-u)>1&&!n.force)return null===(l=r.scrollAnimation)||void 0===l?void 0:l.cancel();r.y=Math.max(c+(o?t:Math.round(t*i)),0)}d=r.x,u=r.y}),r,i.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then((()=>{r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)})),r.scrollAnimation}if(e||t){const n=r.x,i=r.y;if(Math.round(o)>=1&&(r.x+=e),Math.round(s)>=1&&(r.y+=t),r.x!==n||r.y!==i)return Is(r.element)}return Fs}async scrollTo(e,t,n){const{x:r,y:i}=this,o=null==e?0:e-r,s=null==t?0:t-i;return this.scrollingToCenter=null==n?void 0:n.scrollingToCenter,this.scrollBy(o,s,n)}doDestroy(){var e;const t=this;var n;t._element&&(t._element.removeEventListener("scroll",t.scrollHandler),null===(n=t.wheelListenerRemover)||void 0===n||n.call(t));null===(e=t.scrollAnimation)||void 0===e||e.cancel(),Object.values(t.partners||{}).forEach((({scroller:e})=>e.removePartner(t))),super.doDestroy()}onElMutation(e){const t=this,[n,r]=Lr.getTranslateXY(t.element);if(t._x!==-n||t.y!==-r){const e=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(e,"target",{get:()=>t.element}),t.onScroll(e)}}onElResize(){const e=this,{widget:t}=e;null!=t&&t.isAnimating?-1===t.findListener("animationend","onElResize",e)&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:n,_y:r,element:i}=t;let o=0;"clip"===t.overflowX&&i.scrollLeft!==n&&(i.scrollLeft=n,++o),"clip"===t.overflowY&&i.scrollTop!==r&&(i.scrollTop=r,++o),2!==o&&(t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,i.classList.contains("b-scrolling")||i.classList.add("b-scrolling"),e.widget=t.widget,e.scrollingToCenter=t.scrollingToCenter,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e)))}syncPartners(e,t=this.propagateSync){const n=this;n.partners&&Object.values(n.partners).forEach((({axes:r,scroller:i})=>{(i!==n.controllingPartner||e)&&i.sync(n,r)&&t&&i.syncPartners(e,t)}))}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.scrollingToCenter=!1,t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const n=this;if(!n.viewport)return{xDelta:0,yDelta:0};const{x:r,y:i,scrollWidth:o,scrollHeight:s,isRTL:l}=n,a=e instanceof bn?e:bn.from(e),c=t.block||"nearest",d=n.viewport,u=(e=>{let t,n,r,i;return e?"number"==typeof e?t=n=r=i=e:(t=e.top??0,n=e.bottom??0,r=e.start??0,i=e.end??0):t=n=r=i=0,{top:t,bottom:n,start:r,end:i}})(t.edgeOffset),h=d.width>=a.width+(u.start+u.end)?u:{start:0,end:0},g=d.height>=a.height+(u.top+u.bottom)?u:{top:0,bottom:0},p=new bn(l?d.right- -r-o:d.x-r,d.y-i,o,s),m=a.clone().adjust(-h.start,-g.top,h.end,g.bottom).constrainTo(p),f=m.clone(),v=n.isRTL?-1:1;let b=0,y=0;if("start"===c)f.moveTo(d.x+(n.isRTL?d.width-f.width:0),d.y),b=m.x-f.x,y=m.y-f.y;else if("end"===c)f.moveTo(d.x+(n.isRTL?0:d.width-f.width),d.bottom-f.height),b=m.x-f.x,y=m.y-f.y;else if("center"===c){const e=d.center;f.moveTo(e.x-f.width/2,e.y-f.height/2),b=b||m.x-f.x,y=y||m.y-f.y}else f.width>d.width?b=f.x-d.x:f.right>d.right?b=f.right-d.right:f.x<d.x&&(b=f.x-d.x),f.height>d.height?y=f.y-d.y:f.bottom>d.bottom?y=f.bottom-d.bottom:f.y<d.y&&(y=f.y-d.y);return b=v*Math.round(b),y=Math.round(y),{xDelta:!1===t.x?0:Math.max(Math.min(b,n.maxX-r),-r),yDelta:!1===t.y?0:Math.max(Math.min(y,n.maxY-i),-i)}}get viewport(){return bn.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){const n=this;if(n===Ps._globalScroller)return n._element=e,void(n.positionDirty=!0);const r=n.scrollHandler||(n.scrollHandler=n.onScroll.bind(n)),i=n.resizeHandler||(n.resizeHandler=n.onElResize.bind(n));if(t){var o;if(n.translate)null===(o=n.mutationObserver)||void 0===o||o.disconnect();else t.removeEventListener("scroll",r),t.classList.remove(Ds),t.style.overflowX=t.style.overflowY="";Rs.removeResizeListener(t,i)}if(e){if(n.translate){if(n.mutationObserver||(n.mutationObserver=new MutationObserver(n.mutationHandler||(n.mutationHandler=n.onElMutation.bind(n)))),n._x=n._y=0,document.contains(e)){const[t,r]=Lr.getTranslateXY(e);n._x=-t,n._y=-r}n.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",r),e.classList.add(Ds);Rs.addResizeListener(e,i),n.widget||(n.rtlSource={get rtl(){return"rtl"===Lr.getStyleValue(e,"direction")}}),n.isRTL&&e.classList.add("b-rtl"),n.positionDirty&&(n.updateOverflowX(n.overflowX),n.updateOverflowY(n.overflowY)),n.syncOverflowState(),n.isConfiguring&&(n._x&&n.updateX(n._x),n._y&&n.updateY(n._y))}n.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[n,r]=Lr.getTranslateXY(t);e._x=-n,e._y=-r}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.x*(this.isRTL?-1:1)}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e="string"==typeof e?this.element.querySelector(e):e,Rs.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const n=this,{element:r}=n;!r||null!==(t=n.widget)&&void 0!==t&&t.isConfiguring||(e=Math.round(e),n.trigger("scrollStart",{x:e}),n.translate?Lr.setTranslateX(r,-e):r.scrollLeft=n.isRTL?-e:e),n.positionDirty=!0}sync(e,t){const n=this,{x:r,y:i}=t;let o=!1;return null!=r&&n.x!==e.x&&(n.controllingPartner=e,n.x=e.x,o=!0),null!=i&&n.y!==e.y&&(n.controllingPartner=e,n.y=e.y,o=!0),o}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[n,r]=Lr.getTranslateXY(t);e._x=-n,e._y=-r}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:n}=this;!t||null!=n&&n.isConfiguring||(this.trigger("scrollStart",{y:e}),this.translate?Lr.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const n=this,{element:r,translate:i}=n,{style:o,classList:s}=r;if("hidden-scroll"===t&&s.remove("b-hide-scroll"),"hidden-scroll"===e&&!i){Os[o.overflowY]?(e="hidden",n.enableWheel()):s.add("b-hide-scroll")}i||(o.overflowX=Ts[e]||e),n.isConfiguring||(n.positionDirty=!0,n.syncOverflowState())}updateOverflowY(e,t){const n=this,{element:r,translate:i}=n,{style:o,classList:s}=r;if("hidden-scroll"===t&&s.remove("b-hide-scroll"),"hidden-scroll"===e&&!i){Os[o.overflowX]?(e="hidden",n.enableWheel()):s.add("b-hide-scroll")}i||(o.overflowY=Ts[e]||e),n.isConfiguring||(n.positionDirty=!0,n.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=Gn.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&"hidden-scroll"===this.overflowX?this.x+=e.deltaX:"hidden-scroll"===this.overflowY&&(this.y+=e.deltaY)}get scrollWidth(){var e;return(null===(e=this.element)||void 0===e?void 0:e.scrollWidth)??0}set scrollWidth(e){const t=this,{element:n,isRTL:r}=t;let i=t.widthStretcher;i&&null==e?(i.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),i||(i=t.widthStretcher=Lr.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),i.style.transform=`translateX(${(e-1)*(r?-1:1)}px)`,n&&!n.contains(i)&&n.insertBefore(i,n.firstElementChild)),!1!==t.propagate&&t.eachPartner((({scroller:t})=>{t.propagate=!1,t.scrollWidth=e,delete t.propagate})),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var e;return(null===(e=this.element)||void 0===e?void 0:e.scrollHeight)??0}set scrollHeight(e){const t=this,n=t.stretcher||(t.stretcher=Lr.createElement({className:"b-scroller-stretcher"}));n.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==n&&t.element.appendChild(n),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return(null===(e=this.element)||void 0===e?void 0:e.clientWidth)||0}get clientHeight(){var e;return(null===(e=this.element)||void 0===e?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=ho.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}}Ps._$name="Scroller";class _s{constructor(e){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),e&&e(this)}}_s._$name="Promissory";const{defineProperty:$s}=Reflect;class Ns extends(fe.mixin(et,je,ai,Si)){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let n,r,o=t.renderConfigs;if(o===i){for(r in o=null,n=t.configs,n)n[r].render&&(o||(o=new Set)).add(r);t.renderConfigs=e.prototype.$renderConfigs=o}return o}construct(...e){this.$iid=++Ns.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==Ns.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const n=this;return t&&t.remove(),e&&(e.id=n.id,e=Lr.createElement(e,{refOwner:n})),e}updateId(e,t){const n=this;if(t){const r=n.element;r.id=e,n.fixRefOwnerId(r,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;const r=e.$reference;r&&(e.id=`${t}-${r}`);for(const r of e.childNodes)this.fixRefOwnerId(r,t,n)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,n){const r=this,i="_"+e,{listeners:o}=n;i in r||$s(r,e,{get:()=>(r.refreshDom.flush(),r[i]),set(e){r[i]=e}}),t.id=`${r.id}-${e}`,r.byRef[e]=t,r[e]=t,o&&(n.listeners={on:o,un:Gn.on(Object.assign({element:t,thisObj:r},o))})}detachRef(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,n=e.constructor;let r=t.renderConfigs||n.renderConfigs,i=e;if(!r){i=Object.create(e),r=new Set;for(const n in t.configs)$s(i,n,{get:()=>(r.add(n),e[n])});i.renderDom=()=>e.renderDom.call(i),e.$renderConfigs=r}return $s(e,"renderContext",{value:i}),i}refreshDom(){Cs.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){"draw"===e&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find((e=>e.classList.contains("b-drawable")));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver((t=>{e.isDestroyed||t.forEach((t=>{t.isIntersecting&&e.onDraw({count:++e.drawCounter})}))})),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}}Ns.$idSeed=0,Object.assign(Ns.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),Ns._$name="Renderable";class Hs extends Ns{static $name="Mask";static type="mask";static configurable={autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1};static delayable={deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}};static counter=0;static masks=[];construct(e){if(e){let t,n=e.element;n&&(P.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=t=Object.assign({},e),delete t.element,t.target=n),n=e.target,"string"==typeof n&&(e=t=t||Object.assign({},e),t.target=e.owner[n])}super.construct(e);const t=this,{type:n}=t;t.target||(t.target=document.body),t.maskName=`mask${"string"==typeof n?n.trim():""}-${Hs.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if("trial"===e.type)return!1;t&&(e.element=null,e.mode.endsWith("blur")&&Lr.forEachChild(t,(t=>{t.classList.remove(`b-masked-${e.mode}`)})),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,H.remove(Hs.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const n of e)"string"==typeof n?t.text=n:Yt.assign(t,n);return t}static mask(e,t=document.body){return Hs.new({target:t},"string"!=typeof e?{...e}:{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach((e=>e.close()))}static getElementMasks(e){return this.masks.filter((t=>t.target===e))}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;null===(e=this.owner)||void 0===e||null===(t=e.syncMaskCover)||void 0===t||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),null==e||e.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then((()=>{var e;null==t||null===(e=t.onMaskAutoClose)||void 0===e||e.call(t,this)})),null==t||null===(e=t.onMaskAutoClosing)||void 0===e||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:n,hiding:r,maskName:i}=e;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),n.classList.add("b-masked"),n[i]||(n[i]=e,n.appendChild(t)),H.include(Hs.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&Lr.forEachChild(n,(n=>{n!==t&&n.classList.add(`b-masked-${e.mode}`)}))}hide(){const e=this,{target:t,element:n}=e;let{hiding:r}=e;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new _s,e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&Lr.forEachChild(t,(t=>{t!==n&&t.classList.remove(`b-masked-${e.mode}`)})),r.promise=r.promise.then((()=>{e.hiding===r&&(e.hiding=null)})),e.setTimeout((()=>r.resolve()),500,"hide")}return r.promise}async close(){await this.hide(),this.destroy()}}Hs._$name="Mask";var Vs=e=>class extends(e||fe){static $name="KeyMap";get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}static configurable={keyMap:{value:null,$config:{merge:"objects",nullify:!0}}};matchKeyMapEntry(e,t=this.keyMap){if(t&&!e.handled&&e.key!==i)return Yt.keys(t).find((t=>{const n=t.split("+"),r=n.includes("Alt"),i=n.includes("Shift"),o=n.includes("Ctrl");let s=n[n.length-1].toLowerCase();return"space"===s&&(s=" "),s===e.key.toLowerCase()&&(!e.altKey&&!r||e.altKey&&r)&&(!e.ctrlKey&&!o||e.ctrlKey&&o)&&(!e.shiftKey&&!i||e.shiftKey&&i)}))}performKeyMapAction(e){const{keyMap:t}=this;let n=!1;if(t&&!e.handled&&e.key!==i){const i=this.matchKeyMapEntry(e);if(t[i]){const o=H.asArray(t[i]);let s;e.fromKeyMap=!0;for(let t of o){if(s=!0,Yt.isObject(t)){if(!t.handler)continue;!1===t.preventDefault&&(s=!1),t=t.handler}if("string"==typeof t){var r;const{thisObj:o,handler:s}=this.resolveKeyMapAction(t);if(!1!==(null===(r=o.isActionAvailable)||void 0===r?void 0:r.call(o,{key:i,action:t,event:e,actionName:t.split(".").pop()}))&&!1!==s.call(o,e)){n=!0;break}}else if(!1!==t.call(this)){n=!0;break}}delete e.fromKeyMap,n&&(s&&e.preventDefault(),e.handled=!0)}}return n}resolveKeyMapAction(e){const{keyMapSubComponents:t}=this;if(e.startsWith("up.")||e.startsWith("this."))return this.resolveCallback(e);if(t&&e.includes(".")){const[n,r]=e.split(".");if(n&&r)return{thisObj:t[n],handler:t[n][r]}}return{thisObj:this,handler:this[e]}}updateKeyMap(e){var t;null===(t=this.keyMapDetacher)||void 0===t||t.call(this),Yt.isEmpty(e)||(this.keyMapDetacher=Gn.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(e){this.performKeyMapAction(e)}mergeKeyMaps(e,t,n=null){const r={};e&&Yt.assign(r,e);for(const i in t){if(!t[i])continue;const o=H.asArray(null==e?void 0:e[i]),s=[];null!=o&&o.length&&s.push(...o);for(const e of H.asArray(t[i]))Yt.isObject(e)&&e.handler?s.push(Yt.assignIf({handler:(n?n+".":"")+e.handler},e)):s.push((n?n+".":"")+e);s.sort(((e,t)=>{const n=(e.weight||0)-(t.weight||0);return 0===n&&null!=o&&o.length?o.indexOf(e)-o.indexOf(t):n})),r[i]=s}return r}},Bs=e=>class extends(e||fe){static $name="RTL";get widgetClass(){}static configurable={rtl:null};get isRTL(){return this.rtl}updateRtl(e){const{element:t}=this;t&&(t.classList.toggle("b-rtl",!0===e),t.classList.toggle("b-ltr",!1===e))}startConfigure(e){var t;if(null===(t=super.startConfigure)||void 0===t||t.call(this,arguments),!e.floating&&null==e.rtl){var n;const t=this,r=e.rootElement||e.forElement||(null===(n=t.parent)||void 0===n?void 0:n.contentElement)||(t.floating?t.floatRoot:t.changeElementRef(t.getRenderContext(e)[0]||e.adopt||document.body)),i=e.owner||e.parent||t.constructor.fromElement(r);e.rtl=i?i[i.isConfiguring?"peekConfig":"getConfig"]("rtl"):1===(null==r?void 0:r.nodeType)&&"rtl"===getComputedStyle(r).getPropertyValue("direction"),e.rtl&&(t.configDone.rtl=!1)}}render(...e){var t,n;(super.render&&super.render(...e),(s.isChrome&&s.chromeVersion<87||s.isFirefox&&s.firefoxVersion<66||s.isSafari&&s.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),"rtl"===getComputedStyle(this.element).direction||null!==(t=this.owner)&&void 0!==t&&t.rtl)&&(this.rtl=!0,null===(n=this.childItems)||void 0===n||n.forEach((e=>e.rtl=!0)))}};const zs=Object.freeze({highlight:!1,onlyName:!1}),Ws=[],js="highlightExternalChange",Gs=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,Us=Symbol("renderConfigObserver"),Ys={INPUT:1,TEXTAREA:1},qs=(e,t,n,r)=>{var i;let o=(null==n?void 0:n.listeners)||(null==n?void 0:n.internalListeners);if(o=(null===(i=o)||void 0===i?void 0:i.on)||o,o){const i=Gn.on(Yt.assign({element:t,thisObj:e},o));r?(e._refListeners||(e._refListeners=Object.create(null)))[r]=i:n.listeners={on:o,un:i}}},Ks=(e,t)=>e&&t&&t[Yt.keys(e)[0]]?J.merge(e,t):e,Xs=e=>{e.isVisible&&e.triggerPaint()},Js=/^:not\((.+)\)$/,Qs=/absolute|fixed/i,Zs=e=>null!=e.scale,{hasOwn:el}=Yt,{defineProperty:tl}=Reflect,nl=e=>parseFloat(e)*(e.endsWith("ms")?1:1e3),rl=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],il={configurable:!0,get:()=>!1},ol=/(?:L\{([^}.]+)\})/,sl=(e,t)=>"L{Tooltip."+t+"}",ll=/^([trblc])(\d*)-([trblc])(\d*)$/i,al=(e,t)=>(ll.test(e)&&(e={align:e}),ll.test(t)&&(t={align:t}),J.merge(e,t)),cl=/^[\w.]+$/,dl={1:"maxHeight",2:"height",4:"maxWidth",8:"width"};class ul extends(fe.mixin(et,je,ai,Si,_i,Vs,Bs)){static mergeCls(e,t){return t&&e?e=new wn(t).assign("string"==typeof e?new wn(e):e):e&&!e.isDomClassList&&(e=new wn(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:al},value:"t-b"},centered:null,constrainTo:i,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:Ks},value:null},showAnimation:{$config:{merge:Ks},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:Ps,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50},maximizeOnMobile:null}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return ul._recomposeAsync}static set recomposeAsync(e){if(ul._recomposeAsync=e,null!=e){const{all:t}=ul;for(let n=0;n<t.length;++n)t[n].isComposable&&(t[n].recomposeAsync=e)}}isType(e,t){return ul.isType(this,e,t)}static setupRenderConfigs(e,t){const n=t.getInherited("renderConfigs"),{renderConfigs:r}=e;if(r){if(Array.isArray(r))for(const e of r)n[e]=!0;else Yt.assign(n,r);n[Us]=null}}construct(e={},...t){const n=this,{domSyncCallback:i}=n;if(!r.bryntum.cssVersion){const e=r.bryntum.cssVersion=ss.getCSSVersion(),t=P.getVersion("core");e&&e!==t&&console.warn(`CSS version ${e} doesn't match bundle version ${t}!\nMake sure you have imported css from the appropriate product version.`)}n.configureAriaDescription=e.ariaDescription,n._isAnimatingCounter=0,n.alignmentChanges=0,n.byRef=Object.create(null),n.onTargetResize=n.onTargetResize.bind(n),n.onFullscreenChange=n.onFullscreenChange.bind(n),n.domSyncCallback=i.$nullFn?null:i.bind(n),n._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:o}=ul;null!=o&&null==n.recomposeAsync&&(n.recomposeAsync=o),n.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:n,element:r}=t;n&&(t.adoptElement(r,n,e.id),t.updateElement(t._element,r))}finalizeInit(){const e=this,t=e.insertBefore||e.appendTo||e.insertFirst||e.adopt;var n;t&&(e.owner||null!==(n=t.nodeType?t:document.getElementById(t))&&void 0!==n&&n.isConnected?e.render():(e.onFirstResizeAfterConnect=e.onFirstResizeAfterConnect.bind(e),Rs.addResizeListener(t,e.onFirstResizeAfterConnect)))}onFirstResizeAfterConnect(e){Rs.removeResizeListener(e,this.onFirstResizeAfterConnect),this.isDestroyed||this.rendered||this.render()}doDestroy(){var e;const t=this,{preExistingElements:n,element:r,adopt:i,_refListeners:o,_rootElement:s}=t;if(ws.element===r&&ws.exit(),o&&(Object.values(o,(e=>e())),t._refListeners=null),r){var l,a,c;const e=!t._tooltip&&s&&(null===(l=ul.Tooltip)||void 0===l?void 0:l.getSharedTooltip(s,t.eventRoot,!0));if((null==e?void 0:e.owner)===t&&(e.owner=null,e.hide()),t.onExitFullscreen(),t.clearTimeout(t.scrollListenerTimeout),t.clearTimeout(t.resizeListenerTimeout),t.removeTransientListeners(),t.floating||t.positioned?t.hide(!1):t.revertFocus(),Rs.removeResizeListener(r.parentElement,t.onParentElementResize),Rs.removeResizeListener(r,t.onElementResize),i){for(let e=Array.from(r.childNodes),i=0,{length:o}=e;i<o;i++){const r=e[i];n.includes(r)||r===t.floatRoot||r.remove()}r.className=t.adoptedElementClassName,r.style.cssText=t.adoptedElementCssText}null===(a=t.dragEventDetacher)||void 0===a||a.call(t),null===(c=t.dragOverEventDetacher)||void 0===c||c.call(t),t.dragGhost.remove()}null===(e=t.connectedObserver)||void 0===e||e.disconnect(),super.doDestroy(),i||r.remove()}get assignValueDefaults(){return zs}get valueName(){return this.name||this.ref||this.id}getValueName(e){return(e=e&&"object"==typeof e?e.onlyName:e)?this.name:this.valueName}assignFieldValue(e,t,n){const r=this,i=r.defaultBindProperty;i in r&&(r[i]=n)}assignValue(e,t=zs){const n=this,r=n[js],i=n.getValueName(t);!i||e&&!(i in e)||(!1===t.highlight&&(n[js]=!1),n.assignFieldValue(e,i,e?e[i]:null),n[js]=r)}gatherValue(e){const t=this,n=t.defaultBindProperty;t.constructor!==ul&&n in t&&(e[t.name||t.ref||t.id]=t[n])}gatherValues(e){this.eachWidget((t=>t.gatherValue(e)),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&Yt.getTruthyKeys(e)}configureOverflowTwin(e){var t;const n=this;let r=Yt.clone(n.initialConfig);return delete r.id,r.hidden=!1,r.type=n.type,r._overflowTwinOrigin=n,r.disabled=n.disabled,"value"in n&&(r.value=n.value),null===(t=n.forwardTwinEvents)||void 0===t||t.forEach((e=>{delete r[`on${A.capitalize(e)}`]})),e&&(r="function"==typeof e?e(r)||r:Yt.assign(r,e)),r}createOverflowTwin(e){var t;const n=this,r=n.configureOverflowTwin(e),i=ul.create(r);return null===(t=n.forwardTwinEvents)||void 0===t||t.forEach((e=>{i.ion({[e]:e=>{n.overflowTwin===e.source&&(delete(e=Yt.assign({},e)).source,n.trigger(e.eventName,e))}})})),i}ensureOverflowTwin(e,t){let{overflowTwin:n}=this;return n||(this.overflowTwin=n=this.createOverflowTwin(e),null==t||t(n)),n}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,n){const r=this,i="string"==typeof t?document.getElementById(t):t,o=ul.fromElement(i);if(o&&o.adopt&&o!==r){("string"==typeof o.adopt?document.getElementById(o.adopt):o.adopt)===i&&o.destroy()}r.preExistingElements=Array.from(i.childNodes),r.adoptedElementClassName=i.className,r.adoptedElementCssText=i.style.cssText,i.id&&!n&&(r.id=e.id=i.id),Lr.syncAttributes(e,i);for(let t=0,{length:n}=e.childNodes;t<n;t++)i.appendChild(e.childNodes[0]);delete r._contentRange,r._element=i;const s=e.lastDomConfig,l=null==s?void 0:s.listeners;var a;l&&r.isComposable&&(null===(a=l.un)||void 0===a||a.call(l),qs(r,i,s));i.lastDomConfig=s||i.lastDomConfig,i.$refOwnerId=r.id,r.scaleToFitWidth||r.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:n}=this.constructor;tl(n,t,{writable:!0,value:null}),tl(n,e,{get(){return this.recompose.flush(),this[t]},set(e){this[t]=e}})}attachRef(e,t,n){const r=this,i="_"+e;t.dataset&&(t.dataset.ownerCmp=r.id),r.isComposable&&(i in r||r.addRefAccessor(e,i),qs(r,t,n,e)),r.byRef[e]=t,r[e]=t}detachRef(e,t,n){const r=this,i=r._refListeners;null!=i&&i[e]&&(i[e](),delete i[e]),r[e]=null,delete r.byRef[e]}afterRecompose(){}compose(){return{class:wn.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,n=t.hierarchy,r=t.renderConfigs||t.getInherited("renderConfigs");let i,o,s,l,{composers:a}=t,c=null;if(e.recompose.suspend(),!a){for(t.composers=a=[],s=n.indexOf(ul);s<n.length;++s)l=n[s].prototype,el(l,"compose")&&a.push(l);el(r,Us)||(r[Us]={get(e){r[e]=!0}})}for(e.configObserver=r[Us],s=0;s<a.length;++s)i=a[s].compose.call(e,c),c=c?Lr.merge(c,i):i;return el(e,"compose")&&(i=e.compose)&&(i=i.call(e,c),Lr.merge(c,i)),e.configObserver=null,Lr.normalizeChildren(c,((t,n)=>{n&&(o="_"+t,o in e||e.addRefAccessor(t,o))}))}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,n=t.isComposable;return n&&(e=t.doCompose()),"string"==typeof e?e=Lr.createElementFromTemplate(e):Yt.isObject(e)?(e=Lr.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),n&&qs(t,e,e.lastDomConfig)):Lr.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):1!==e.nodeType&&(e=Lr.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&Lr.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:n}=e,{contentElement:r,contentElementCls:i,isComposable:o}=t,s=r!==e,l=!o&&e.querySelectorAll("[data-reference]"),a=o?[]:t.widgetClassList;let c=(s||!o)&&t.uiClasses;if(n&&a.unshift(n),t._hidden&&a.push("b-hidden"),t._readOnly&&a.push("b-readonly"),Te.noThrow(e,"remove"),c?(null!=i&&i.value&&(c=c.slice(),c.push(i.value)),c=c.join(" ")):c=null==i?void 0:i.value,c&&(s?r.className+=" "+c:a.push(c)),!t.parent){const{defaultCls:e}=t,{outerCls:n}=ul;a.push(...e?n.filter((t=>!(t in e)||e[t])):n)}if(e.className=a.join(" "),l)for(let e,n=0;n<l.length;++n)e=l[n],t.attachRef(e.getAttribute("data-reference"),e),e.removeAttribute("data-reference");t.adopt||t.scaleToFitWidth||t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,n=`${this.id}-aria-desc-el`;if(e){const r=this._ariaDescEl||(this._ariaDescEl=Lr.createElement({className:"b-aria-desc-element",id:n,parent:t}));r.innerText=e.match(ol)?this.L(e,this):e,t.setAttribute("aria-describedBy",r.id)}else t.getAttribute("aria-describedby")===n&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){Lr.setAttributes(this.ariaElement,{"aria-label":null!=e&&e.match(ol)?this.L(e,this):e})}updateAriaHasPopup(e){Lr.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){var t,n;e?null===(t=this.ariaElement)||void 0===t||t.setAttribute("role",e):null===(n=this.ariaElement)||void 0===n||n.removeAttribute("role")}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:Yt.getPath(this,e)}isCollapsified({collapsed:e,alt:t}){const{collapsify:n}=this,r=null==n;return t?"overlay"===n||r&&e:!1===n||"hide"===n||r&&!e}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await Lr.transition(Yt.assign({element:e.element,action(){Cs.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else Cs.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.resumeRecompose()}resumeRecompose(){this.recompose.resume()}changeElementRef(e){if("string"==typeof e){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let n=t||e.appendTo,{insertFirst:r,insertBefore:o}=e;return r&&(n=r,o=n.firstChild),o&&(n||(n=o.parentElement)),[n,o||i]}render(e,t=!0){const n=this,{element:r}=n,[i,o]=n.getRenderContext(n,e);n.emptyCache(),n.syncElement&&n.currentElement?Lr.sync(r,n.currentElement):(null==i||i.insertBefore(r,o),n.currentElement=r),ul.fromElement(r.parentElement)&&r.classList.remove(...ul.outerCls),super.render(i,t),n.rendered=!0,n.getConfig("role"),t&&(n.getConfig("contentRange"),n.triggerPaint()),n.setupFocusListeners()}template({tag:e,html:t,htmlCls:n,name:r}){var i;const o=this;"string"==typeof t&&cl.test(t)&&o.resolveCallback(t,o,!1)&&(t=o.callback(t,o,[o]));const s=null!==(i=t)&&void 0!==i&&i.call?t.call(o,o):t;return`<${e} class="${s?n:""}" ${r?`data-name="${r}"`:""}>${s||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&null!==(t=this.$meta.renderConfigs)&&void 0!==t&&t[e]&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return"style"===e?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return(null==e?void 0:e.depth)>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){Yt.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=Lr.createElement({html:" ",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...ul.outerCls)}get constrainTo(){var e;let t=this._constrainTo;if(t=t===i?r:(null===(e=t)||void 0===e?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?t.host||t.ownerDocument:t,this.positioned){const{offsetParent:e}=this.element;if(e&&"hidden"===Lr.getStyleValue(e,"overflow"))t=bn.from(e).moveTo(0,0);else if(t&&!t.isRectangle){const n=t===document||t===r;t=bn.from(t,e),n&&t.translate(r.pageXOffset,r.pageYOffset)}}return t}updateCentered(e){const{element:t,_anchorElement:n}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",null==n||n.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,n=e._contentRange||(e._contentRange=new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}fixRefOwnerId(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;for(let{childNodes:r}=e,i=r.length;i-- >0;)this.fixRefOwnerId(r[i],t,n)}}get placement(){const{element:e}=this;let t,n,r;if(null!=e&&e.offsetParent&&!Qs.test(Lr.getStyleValue(e,"position"))){const o=e.nextElementSibling,s=e.previousElementSibling,l=!o&&s;var i;if(n=Lr.getStyleValue(e.parentElement,"flex-direction"),n)n=n.startsWith("row")?"h":"v";else t=null===(i=o||s)||void 0===i?void 0:i.getBoundingClientRect(),r=t&&e.getBoundingClientRect(),n=t&&Math.abs(t.top-r.top)<Math.abs(t.left-r.left)?"h":"v";n+="h"===n?l?"r":"l":l?"b":"t"}return n}updateId(e,t){if(super.updateId(e,t),t){const{byRef:n,element:r}=this;for(const t in n)n[t].dataset&&(n[t].dataset.ownerCmp=e);r.id=e,this.fixRefOwnerId(r,e,t)}}get style(){const{element:e}=this;return(null==e?void 0:e.ownerDocument.defaultView.getComputedStyle(e))||this._style}updateStyle(e){this.element&&Lr.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t,n;const i=this,{lastAlignSpec:o,element:l}=i,{offsetParent:a,style:c,classList:d}=l;if(o&&(o.monitorIntersection&&i.intersectionObserver.unobserve(o.target),isFinite(o.zone)&&l.classList.remove(rl[o.zone])),!e)return i.removeTransientListeners(),void(i.anchor=i.lastAlignSpec=null);i.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||"Point"===e.$$name)&&(e={target:e}),i.releaseSizeConstraints();const{scrollable:u,constrainTo:h}=i,g=Lr.measureSize(Lr.getStyleValue(l,"minHeight"),l),p=Lr.measureSize(Lr.getStyleValue(l,"minWidth"),l),m=i.positioned&&"fixed"!==Lr.getStyleValue(l,"position"),f=i.scale||1,v=e.target,b=e.domEvent||e.event||v,y=null!=v&&v.isRectangle?v:(null==v?void 0:v.element)||v,C=(null==y?void 0:y.nodeType)===Element.ELEMENT_NODE,w=(null==b||null===(t=b.target)||void 0===t?void 0:t.nodeType)===Element.ELEMENT_NODE,x=(e=e.realignTarget?e:Yt.assign({aligningToEvent:w,aligningToElement:C,constrainTo:h,align:"b-t",axisLock:i.axisLock,anchor:i.anchor},i.align,e)).minWidth||p,S=e.minHeight||g;if(i.lastAlignSpec=e,w)delete e.target,e.domEvent=b,e.anchoredTo=b.target,e.position=new _n(b.clientX+1,b.clientY+1);else if(C&&(e.target=y,xr(y instanceof SVGElement?y.closest("svg"):y))){if((e=Object.setPrototypeOf({},e)).target=i.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?bn.from(y,m?a:null,!m):Lr.isInView(y,!1,i)),!e.target){const e=i.hide();return i.isDestroyed||(i.lastAlignSpec.targetOutOfView=!0),e}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),i.lastAlignSpec.anchoredTo=y}e.anchor&&(e.anchorSize=i.anchorSize,l.contains(i.anchorPathElement)||l.appendChild(i.anchorElement)),i.isAligning=!0,i.trigger("beforeAlign",e);const E=bn.from(l,m?a:null,!0),{width:R,height:T}=E;E.isAlignRectangle=!0,x&&(E.minWidth=x*f),S&&(E.minHeight=S*f),i.isAligning=!1,e.rtl=i.rtl,(e.align.includes("s")||e.align.includes("e"))&&(i.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const D=i.lastAlignSpec.result=E.alignTo(e);let{align:M,anchor:F,x:I,y:k,width:O,height:L,overlap:A}=D;if(i.lastAlignSpec.zone=D.zone,L!=T){const e=L<T;i.alignmentChanges=i.alignmentChanges|(e?1:2),c[i.alignedHeightStyle=dl[3&i.alignmentChanges]]=L/f+"px",e&&!i._minHeight&&g&&(c.minHeight=Math.min(L,g)/f+"px"),u&&(u.overflowY=e)}if(O!=R){const e=O<R;i.alignmentChanges=i.alignmentChanges|(e?4:8),c[i.alignedWidthStyle=dl[12&i.alignmentChanges]]=O/f+"px",e&&!i._minWidth&&p&&(c.minWidth=Math.min(O,p)/f+"px"),u&&(u.overflowX=e)}if(M&&i.alignmentChanges){const t=bn.from(l,m?a:null,!0);t.minWidth=D.minWidth,t.minHeight=D.minHeight,e.align=M;const n=i.lastAlignSpec.result=t.alignTo(e);F=n.anchor,I=n.x,k=n.y,O=n.width,L=n.height}if(i.centered||i.setXY(I,k),!D.overlap&&isFinite(D.zone)&&d.add(rl[D.zone]),null!==(n=F)&&void 0!==n&&n.edge){var P;const{edge:e}=F,{anchorElement:t}=i,{style:n}=t,r=bn.from(l),o=[];"top"===e||"bottom"===e?(o[0]=F.x,o[1]="top"===e?1:r.height-1):(o[0]="left"===e?1:r.width-1,o[1]=F.y),n.display="none";let s=Lr.childFromPoint(l,...o);if(null!==(P=s)&&void 0!==P&&P.matches(":hover,:focus")&&l.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(s=s.parentNode),s&&s!==document){let e=Lr.getStyleValue(s,"background-color");for(;e.match(Gs)&&"absolute"!==Lr.getStyleValue(s,"position")&&(s=s.parentNode,s!==document);)e=Lr.getStyleValue(s,"background-color");e.match(Gs)?i.anchorPathElement.setAttribute("fill",i.defaultAnchorBackgroundColor):i.anchorPathElement.setAttribute("fill",e)}n.transform=n.display="",t.className=`b-anchor b-anchor-${e}`,F.x&&(F.x/=f),F.y&&(F.y/=f),Lr.setTranslateXY(t,F.x,F.y),d.add("b-anchored")}else i._anchorElement&&(i.anchorElement.classList.add("b-hide-display"),d.remove("b-anchored"));if(!C){c.pointerEvents="none";const e=Lr.elementFromPoint(I,k);i.owns(e)||(i.lastAlignSpec.anchoredTo=e),c.pointerEvents=""}if(("realign"===i.scrollAction&&C||"hide"===i.scrollAction)&&!i.documentScrollListener){if(i.clearTimeout(i.scrollListenerTimeout),e.monitorTargetMutation&&!i.targetObserver){(i.targetObserver||(i.targetObserver=new MutationObserver(i.onTargetParentMutation.bind(i)))).observe(Lr.getRootElement(y),{childList:!0,attributes:!0,subtree:!0})}i.scrollListenerTimeout=i.setTimeout((()=>{var e,t;const n=null===(e=(t=C?y:i.lastAlignSpec.anchoredTo).getRootNode)||void 0===e?void 0:e.call(t);i.documentScrollListener=Gn.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:i}),null!=n&&n.mode&&(i.targetRootScrollListener=Gn.addListener(n,"scroll","doHideOrRealign",{capture:!0,thisObj:i}))}),"hide"===i.scrollAction?i.ignoreScrollDuration:0)}if(C&&(e.monitorResize&&!i.targetResizeListener&&(Rs.addResizeListener(y,i.onTargetResize),i.targetResizeListener=!0),e.monitorIntersection&&!(A||y.contains(l)||y.ownerSVGElement)&&i.intersectionObserver.observe(y)),!s.isAndroid&&!i.constrainListeners){const e=null!=h&&h.isRectangle?r:h;i.clearTimeout(i.resizeListenerTimeout),i.resizeListenerTimeout=i.setTimeout((()=>{i.constrainListeners=!0,Rs.addResizeListener(e||r,i.onAlignConstraintChange)}),i.ignoreScrollDuration)}}onTargetParentMutation(e){const{element:t,lastAlignSpec:n}=this;var r;null!=n&&n.aligningToElement&&(null!==(r=n.target)&&void 0!==r&&r.isConnected?e.some((({target:e})=>e.contains(n.target)&&!t.contains(e)))&&this.realign():this.hide())}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:s.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:n}=e.targetRect,{width:r,height:i}=e.target.getBoundingClientRect();r===t&&i===n||this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:n}){const{style:r}=this.contentElement,{overflowY:i}=r;this.setTimeout(this.realign,50),t&&n>t.height&&(r.overflowY="hidden",this.requestAnimationFrame((()=>r.overflowY=i)))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const n=t.target.contains(this.element),r=Lr.isInView(t.target,!1,e);if(!(t.allowTargetOut||xr(t.target)&&r))return e.hide(),void(e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0));t.realignTarget=n?null:r}Lr.addTemporaryClass(e.element,"b-realigning",e.realignTimeout,e),e.alignTo(t)}}rectangle(e,t,n){return this.rectangleOf("element",e,t,n)}rectangleOf(e,t,n,r){var o;return"string"!=typeof t?(r=n,n=t,t=""):"border"===t&&(t=""),"boolean"==typeof n&&(r=n,n=i),"element"!==e&&n===i&&(n=this.element),n=null!==(o=n)&&void 0!==o&&o.isWidget?n.element:n,bn[t||"from"](this[e],n,r)}releaseSizeConstraints(){const e=this,{scrollable:t,element:n,alignmentChanges:r}=e,{style:i}=n;12&r&&(Lr.setLength(n,e.alignedWidthStyle,e[`_last${A.capitalize(e.alignedWidthStyle)}`]||""),i.minWidth=e._minWidth||"",t&&(t.overflowY=t.config.overflowY)),3&r&&(Lr.setLength(n,e.alignedHeightStyle,e[`_last${A.capitalize(e.alignedHeightStyle)}`]||""),i.minHeight=e._minHeight||"",t&&(t.overflowX=t.config.overflowX)),e.alignmentChanges=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?null==e?void 0:e.parentNode:null,n=document.createDocumentFragment();if(this.containsFocus){for(let r,i=e.nextSibling;i;i=r)r=i.nextSibling,t.contains(i)&&!this.owns(i)&&n.appendChild(i);t.insertBefore(n,e)}else t.appendChild(e)}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return"string"==typeof e?{align:e}:e}changeScrollable(e,t){return"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):null==t||t.destroy(),e}handleReactElement(e){const t=this.closest((e=>e.reactComponent));null!=t&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const t=this,n=null==e,{element:r,contentElement:i,htmlCls:o}=t;if(r||!Lr.isReactElement(e)){if(r){t.updatingHtml=!0;const s=i===r&&t._anchorElement;o&&o.values.forEach((e=>r.classList[n?"remove":"add"](e))),s&&r.removeChild(s),e&&"object"==typeof e?Lr.isReactElement(e)?t.handleReactElement(e):Cs.sync({domConfig:{...e,onlyChildren:!0},targetElement:t.contentElement}):t.contentElement.innerHTML=n?"":e,t.getConfig("htmlMutationObserver"),s&&r.appendChild(s),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}else t.whenVisible((()=>t.handleReactElement(e)))}changeHtmlMutationObserver(e,t){const n=this,{contentElement:r}=n;if(null==t||t.disconnect(),e){const t=new MutationObserver((()=>{n.updatingHtml?n.updatingHtml=!1:n._html=r.innerHTML}));return t.observe(r,e),t}}updateContent(e){const t=this,n=null==e,{element:r,htmlCls:i}=t;if(r){const{contentRange:o}=t;i&&i.values.forEach((e=>r.classList[n?"remove":"add"](e))),r.isConnected?(o.deleteContents(),n||o.insertNode(Lr.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=o.startOffset,t.contentRangeEndOffset=o.endOffset,!t.floating&&!t.positioned||t.isAligning||t.realign()}}onThemeChange(){var e;null!==(e=this.anchorElement)&&void 0!==e&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const n=parseFloat(Lr.getStyleValue(e.element,"border-top-width")),r=Lr.getStyleValue(e.element,"border-top-color"),i=e.anchorElement,{className:o}=i,s=i.firstElementChild,l=e.anchorPathElement=s.lastElementChild,a=e._hidden;i.className="b-anchor b-anchor-top";let c=Lr.getStyleValue(e.contentElement,"background-color");c.match(Gs)&&(c=Lr.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=c,t=i.getBoundingClientRect();const[d,u]=t=e._anchorSize=[t.width,t.height];i.className=o,s.setAttribute("height",u+n),s.setAttribute("width",d),l.setAttribute("d",`M0,${u}L${d/2},0.5L${d},${u}`),n&&(l.setAttribute("stroke-width",n),l.setAttribute("stroke",r)),t[1]-=n,a&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=Rn.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,n=`${e.id}-shadow-filter`;e._anchorElement=Lr.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:n,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${n})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){const t=this,{element:n}=t;var r,i,o;e?(t.dragEventDetacher=Gn.addListener({element:n,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:t}),t.dragDetacher=Gn.on({element:n,mousedown(e){const{target:t}=e,r=ul.fromElement(t);(!e.target.closest(".b-field-inner")&&r===this||this.strips&&Object.values(this.strips).includes(r))&&n.setAttribute("draggable","true")},thisObj:t})):(null===(r=t.dragEventDetacher)||void 0===r||r.call(t),null===(i=t.dragOverEventDetacher)||void 0===i||i.call(t),null===(o=t.dragDetacher)||void 0===o||o.call(t))}onWidgetDragStart(e){var t;const n=this;if(!n.validateDragStartEvent(e))return;const{element:r,align:i,constrainTo:o}=n,l=n.positioned&&"fixed"!==Lr.getStyleValue(r,"position"),a=l?r.parentElement:n.rootElement,c=bn.from(r,l?a:null),d=e.clientX,u=e.clientY,h=document.scrollingElement||document.body,[g,p]=l?Lr.getOffsetXY(r,a):n.getXY(),m=null===(t=l?bn.content(a).moveTo(0,0):o&&(null!=o&&o.isRectangle?o:bn.from(o)))||void 0===t?void 0:t.deflate(i.constrainPadding||0),f={element:a,dragover:e=>{r.classList.remove("b-centered"),c.moveTo(g+e.clientX-d-(l?0:h.scrollLeft),p+e.clientY-u-(l?0:h.scrollTop)),m&&c.constrainTo(m),Lr.setTranslateXY(r,c.x,c.y)}};s.isTouchDevice&&(f.touchmove=e=>e.preventDefault()),n.floatRoot.appendChild(n.dragGhost),n.setDragImage(e),e.dataTransfer.effectAllowed="none",n.dragOverEventDetacher=Gn.addListener(f),n.alignTo()}validateDragStartEvent(e){const{element:t}=this,n=Lr.elementFromPoint(e.clientX,e.clientY),{handleSelector:r}=this.draggable;if(r){var i;const o=null===(i=Js.exec(r))||void 0===i?void 0:i[1];if(o){if(n.closest(`#${t.id} ${o}`))return e.preventDefault(),!1}else if(!n.closest(`#${t.id} ${r}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return Lr.applyStyle(this.element,Yt.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return Boolean(e)}changePositioned(e){return Boolean(e)}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[Lr.getPageX(this.element),Lr.getPageY(this.element)]}setXY(e,t){const n=this,{element:r}=n;if(n.floating||n.positioned){if(null!=e&&(n._x=e),null!=t&&(n._y=t),"fixed"===Lr.getStyleValue(r,"position")){const n=r.getBoundingClientRect(),[i,o]=Lr.getTranslateXY(r),s=e-n.x,l=t-n.y;Lr.setTranslateXY(r,i+s,o+l)}else Lr.setTranslateXY(r,n._x||0,n._y||0);n.isConstructing?n.centered=!1:r.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;Lr.setLength(t.element,"width",e),t._lastWidth=e,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return Lr.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){this._lastMaxWidth=e,Lr.setLength(this.element,"maxWidth",e)}get minWidth(){return Lr.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){Lr.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),"number"!=typeof e&&isNaN(e)||(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(null==e?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){Lr.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return Lr.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){this._lastMaxHeight=e,Lr.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return Lr.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){Lr.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:n,ariaElement:r}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),e&&(this.revertFocus(),this._disabled!==e)||(t&&(t.classList[e?"add":"remove"]("b-disabled"),n&&(n.disabled=e),r&&r.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=ws.request(e.floating?e.floatRoot:e.element);return ws.onFullscreenChange(e.onFullscreenChange),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return ws.exit()}onFullscreenChange(){ws.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){ws.unFullscreenChange(this.onFullscreenChange),this.element.classList.remove("b-fullscreen")}get tooltip(){const e=this;if(e._tooltip)return e._tooltip;{var t;const n=null===(t=ul.Tooltip)||void 0===t?void 0:t.getSharedTooltip(e.rootElement,e.eventRoot);if(n&&n.activeTarget===e._element&&n.isVisible)return n}}changeTooltip(e,t){const n=this,{element:r}=n;if(e){if(!n.preventTooltipOnTouch||!s.isTouchDevice){var i;if(e.isTooltip||"Object"===e.constructor.name||(e={html:"string"==typeof e?e:n.placeholder,textContent:!0}),!n.configureAriaDescription)n.ariaDescription=null!==(i=e.html)&&void 0!==i&&i.match(ol)?e.html.replace(ol,sl):e.html;if(!(null!=t&&t.isTooltip||e.newInstance))return r.dataset.btip=!0,void(n.tipConfig=e);e.type="tooltip",e.forElement||(e.forElement=r),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=ul.reconfigure(t,e,n),n.detachListeners("tooltipValueListener"),n.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:n})}}else if(t){if(null!=e||!t.isTooltip)return void(t.html=null);t.destroy()}else delete r.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription="string"==typeof e?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;return e?e.isTooltip?e.contentElement.innerText:"string"==typeof e?e:e.html:this.tipConfig?this.tipConfig.html:void 0}get isVisible(){const e=this,{element:t}=e;let n;return Boolean(t&&!e._hidden&&!e.isDestroying&&t.isConnected&&(!e.requireSize||xr(t))&&(!(n=e.containingWidget)||n.isVisible))}whenVisible(e,t=this,n,r=e){const i=this;i.isVisible&&i.isPainted?i.callback(e,t,n):(i.toCallWhenVisible||(i.toCallWhenVisible=new Map)).set(r,{callback:e,thisObj:t,args:n})}focus(){this.isFocusable&&Lr.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const n=this,{element:r,floating:i}=n,{style:o}=r,s=t&&n.showAnimation;let l,a,c=!n.isVisible;return c&&(c=n.trigger("beforeShow"),Yt.isPromise(c)&&(c=await c)),!1===c||n.internalBeforeShow&&!1===n.internalBeforeShow()?Promise.resolve():new Promise((t=>{if(n.cancelHideShowAnimation(),n.updateCentered(n._centered),i){const e=n.floatRoot;e.contains(r)||(n.rendered?e.appendChild(n.element):n.render(e,!1)),o.transform.includes("scale")&&(n.scale=null,o.transform=o.transformOrigin="");const t=n.closest(Zs);if(t){const{scale:e}=t;n.scale=e,o.transform=`scale(${e})`,o.transformOrigin="0 0"}}if(n._hidden=!1,r.classList.remove("b-hidden"),i&&!wr(r)&&(n.hide(!1),t()),n.onConfigChange({name:"hidden",value:!1,was:!0,config:n.$meta.configs.hidden}),s){l=Object.keys(s)[0],a=s[l];const e=n.currentAnimation={showing:!0,styleProp:l,resolve:t};n.isAnimating=!0,o.transition="none",o[l]=a.from,Lr.getStyleValue(r,l),n.currentAnimation.detacher=Gn.onTransitionEnd({element:r,property:l,duration:nl(a.duration)+20,handler:()=>n.afterHideShowAnimate(e),thisObj:n}),o.transition=`${l} ${a.duration} ease ${a.delay}`,o[l]=a.to}n.afterShow(e,s?null:t)}))}async showBy(e,t,n){const r=this,i=Array.isArray(e);if(i||"number"==typeof e){const r=i?e:[e,t];e=Object.assign({target:new _n(r[0]+1,r[1]+1),matchSize:!1,align:"t0-b0"},i?t:n)}if(r.requireSize=!0,!r.isVisible)return r.show({align:e});Lr.addTemporaryClass(r.element,"b-realigning",300,r),r.alignTo(e)}async showByPoint(){return P.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var n,r;const i=this;i.trigger("show"),i._configuredAnchorState=i.anchor,null===(n=i.owner)||void 0===n||null===(r=n.onChildShow)||void 0===r||r.call(n,i),i.triggerPaint(),(i.floating||i.positioned)&&(e?i.alignTo(e):i.centered?i.alignTo({target:i.constrainTo,align:"c-c"}):i.forElement&&i.alignTo(i.forElement)),null==t||t()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:n}=e,i=!e.isPainted;if(e.isVisible){if(i&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),Rs.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild),e.onConnectedCallback&&r.ResizeObserver&&(e.connectedObserver=new ResizeObserver((()=>{e.isElementConnected&&!t.isConnected?(e.onConnectedCallback(!1),e.isElementConnected=!1):!e.isElementConnected&&t.isConnected&&(e.onConnectedCallback(!0,null==e.isElementConnected),e.isElementConnected=!0)})),e.connectedObserver.observe(t))),e.eachWidget(Xs,!1),i&&(e.getConfig("tooltip"),!ul.Ripple&&ul.RippleClass&&(ul.Ripple=new ul.RippleClass({rootElement:e.rootElement})),r.DocsBrowser&&e.floating&&e.closest((e=>{var t;return null===(t=e.element)||void 0===t?void 0:t.closest(".fiddlePanelResult,.b-owned-by-fiddle")}))&&t.classList.add("b-owned-by-fiddle")),e.isPainted=!0,i&&e.triggerConfigs("paint"),e.trigger("paint",{firstPaint:i}),null!=n&&n.size){for(const{callback:t,thisObj:r,args:i}of n.values())e.callback(t,r,i);n.clear()}i&&e.monitorResize&&!e.scaleToFitWidth&&Rs.onElementResize([{target:t}])}}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:n}=e;t&&(e.isAnimating=!1,n.classList.contains("b-hiding")&&(n.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),n.style.transition=n.style[t.styleProp]="",e.currentAnimation=null,e.trigger((t.showing?"show":"hide")+"AnimationEnd"))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",il)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise((t=>{const n=this,{element:r,lastAlignSpec:i}=n,{style:o}=r,s=e&&n.hideAnimation;if(n.clearTimeout(n.scrollListenerTimeout),n.clearTimeout(n.resizeListenerTimeout),!n._hidden&&!1!==n.trigger("beforeHide",{animate:e})){if(n._hidden=!0,i&&(i.targetOutOfView=null,i.monitorIntersection&&(n.intersectionObserver.takeRecords(),n.intersectionObserver.unobserve(i.target))),n.onConfigChange({name:"hidden",value:!0,was:!1,config:n.$meta.configs.hidden}),!r)return void t();if(r.contains(Lr.getActiveElement(r))&&n.revertFocus(!0),n.isDestroyed)return void t();if(n.cancelHideShowAnimation(),s){const e=Object.keys(s)[0],i=s[e];if(Number(getComputedStyle(n.element)[e])!==i.to){const s=n.currentAnimation={hiding:!0,styleProp:e,resolve:t};r.classList.add("b-hiding"),n.isAnimating=!0,n.currentAnimation.detacher=Gn.onTransitionEnd({element:r,property:e,duration:nl(i.duration)+20,handler:()=>n.afterHideShowAnimate(s),thisObj:n}),o[e]=i.from,Lr.getStyleValue(r,e),o.transition=`${e} ${i.duration} ease ${i.delay}`,o[e]=i.to}else r.classList.add("b-hidden")}else r.classList.add("b-hidden");n.afterHide(!s&&t,s)}}))}doHideOrRealign({target:e,isTrusted:t}){const n=this,{lastAlignSpec:i,element:o}=n,s=null==i?void 0:i.anchoredTo,l=null==i?void 0:i.target,a=null==i?void 0:i.position,c=Lr.getActiveElement(n);if(!t||!xr(o)||e&&(o.contains(e)||e.nodeType===Element.ELEMENT_NODE&&n.owns(e)||e.nodeType===Element.DOCUMENT_NODE&&o.contains(c)&&Ys[c]&&r.innerHeight<document.body.offsetHeight))return;if(i.aligningToElement){const e=Lr.isInView(l,!1,n);if(e&&e.equals(i.targetRect))return}const d="hide"===n.scrollAction&&n.getXY();if(n.realign(),!n.isDestroyed&&wr(o)&&"hide"===n.scrollAction){const[t,r]=n.getXY(),o=t!==d[0]||r!==d[1];(null!=i&&i.aligningToEvent||(o||"Point"===(null==l?void 0:l.$$name)||a)&&(!s||!xr(s)||e&&Lr.isDescendant(e,s)))&&n.hide()}}afterHide(e=null,t=this.hideAnimation){var n,r;const i=this;i._anchor=i._configuredAnchorState,i.removeTransientListeners(),t||i.afterHideAnimation(),i.trigger("hide"),null===(n=i.owner)||void 0===n||null===(r=n.onChildHide)||void 0===r||r.call(n,i),e&&e()}removeTransientListeners(){var e,t;const n=this,{targetObserver:i,lastAlignSpec:o}=n;if(n.clearTimeout(n.resizeListenerTimeout),n.clearTimeout(n.scrollListenerTimeout),i&&(i.disconnect(),delete n.targetObserver),n.documentScrollListener=null===(e=n.documentScrollListener)||void 0===e?void 0:e.call(n),n.targetRootScrollListener=null===(t=n.targetRootScrollListener)||void 0===t?void 0:t.call(n),n.targetResizeListener&&(Rs.removeResizeListener(o.target,n.onTargetResize),n.targetResizeListener=!1),n.constrainListeners){var s;const e=null!==(s=o.constrainTo)&&void 0!==s&&s.isRectangle?r:o.constrainTo;Rs.removeResizeListener(e||r,n.onAlignConstraintChange),n.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let n;return t.isConfiguring?(n=Boolean(e),t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),n}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){let e=this.parent;if(!e){var t,n;const r=(null===(t=this.forElement)||void 0===t?void 0:t.nodeType)===Element.ELEMENT_NODE?this.forElement:null===(n=this.element)||void 0===n?void 0:n.parentNode;e=(null==r?void 0:r.closest(".b-widget"))&&ul.fromElement(r)}return e}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:n}=t,r=n?n.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return n?r[r.indexOf(t)+e]:ul.fromElement(r[r.indexOf(t.element)+e])}up(e,t,n){var r;const{owner:i}=this;return e?null==i||null===(r=i.closest)||void 0===r?void 0:r.call(i,e,t,n):i}closest(e,t,n){const r=typeof n,i="number"===r,o="string"===r;for(let r=this,s=1;r;r=r.owner,s++){if(ul.widgetMatches(r,e,t))return r;if(i&&s>=n)return;if(o&&ul.widgetMatches(r,n,t))return;if(r===n)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=ul.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(!1===e(t))return!1;t=t.owner}return!0}changeMaximizeOnMobile(e){const t=this;if(t.floating&&s.isMobile){const{initialConfig:n}=t;e?(t.centered=t.modal=!1,t.maximized=!0):(t.centered=n.modal,t.modal=n.centered,t.maximized=n.maximized)}}changeMonitorResize(e,t){const n=!this.scaleToFitWidth&&Boolean(e);if(n!==Boolean(t))return n}updateMonitorResize(e){const t=this;el(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),Rs[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=Boolean(e),Boolean(this._readOnly)!==e)return e}updateReadOnly(e){var t;null===(t=this.element)||void 0===t||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget((t=>{t.ignoreParentReadOnly||("_originalReadOnly"in t||(t._originalReadOnly=t.config.readOnly||!1),t.readOnly=e||t._originalReadOnly)}),!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const n=this.childItems,r=(null==n?void 0:n.length)||0,i={};for(let o=0;o<r;o++){const r=n[o];if(i.down=t,!1===e(r,i))return!1;if(i.down&&r.eachWidget&&!1===r.eachWidget(e,t))return!1}return!0}queryAll(e){const t=[];return this.eachWidget((n=>{e(n)&&t.push(n)})),t}query(e){let t=null;return this.eachWidget((n=>{if(e(n))return t=n,!1})),t}getWidgetByRef(e){var t,n;return e instanceof ul?e:(null==this||null===(t=this.widgetMap)||void 0===t?void 0:t[e])||(null==this||null===(n=this.owner)||void 0===n?void 0:n.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:n}=t;t.containsFocus=!0,t.focusInEvent=e,(t.floating||t.positioned)&&t.toFront(),n.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),n.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=Gn.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=Lr.getActiveElement(e),n=e.contains(t)&&e.captureFocusItem(t);return(r,i)=>{if(n&&!e.isDestroying){(Lr.getActiveElement(e)!==t||i)&&n(r)}}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():Lr.focusWithoutScrolling(e))}}contains(e,t){const{element:n}=this;if(e&&n)return e.isWidget&&(e=e.element),n.contains(e)&&(!t||n!==e)}revertFocus(e){var t,n;const r=this,i=Lr.getActiveElement(r);let o=null===(t=r.focusInEvent)||void 0===t?void 0:t.relatedTarget;(e||r.containsFocus&&(null===(n=o)||void 0===n?void 0:n.nodeType)===Element.ELEMENT_NODE&&r.element.contains(i))&&(o&&Lr.isFocusable(o)||(o=r.getFocusRevertTarget()),r._isRevertingFocus=!0,o&&Lr.isFocusable(o)?(o._isRevertingFocus=!0,Lr.focusWithoutScrolling(o),o._isRevertingFocus=!1):null==i||i.blur(),r._isRevertingFocus=!1)}getFocusRevertTarget(){const e=this,{owner:t,focusInEvent:n}=e,r=n&&n.backwards?1:-1;let i=n&&n.relatedTarget;const o=i&&ul.fromElement(i);if(t&&!t.isDestroyed&&(!i||!Lr.isFocusable(i)||o&&!o.isFocusable)){var s;if(i=null,t.eachWidget){const n=[];if(t.eachWidget((t=>{(t===e||t.isFocusable)&&n.push(t)}),!1),n.length>1){const t=n.indexOf(e);i=n[t+r]||n[t-r]}}!i&&t.isFocusable&&(i=t),i=i?i.focusElement:null===(s=t.getFocusRevertTarget)||void 0===s?void 0:s.call(t)}return i}getStaticWidgetClasses(e,t){const n=new wn,r=this.$meta.hierarchy;let i,o,s,l,a;for(o=r.indexOf(e);o<r.length;++o){var c;i=r[o],a=Reflect.getOwnPropertyDescriptor(i.prototype,"widgetClass"),null!==(c=a)&&void 0!==c&&c.get?l=a.get.call(this):(s=el(i,"$$name")||el(i,"$name")||el(i,"_$name")?i.$$name:i.name,(s.length<3||s.includes("$"))&&console.warn(`Class "${s}" extending "${i.$name}" should have "$name" static getter with no less than 3 chars.`),l=`b-${s.toLowerCase()}`),l&&n.add(t?l+t:l)}return n}get rootUiClass(){return ul}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(ul),s.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:n,uiClasses:r}=e;let{staticClassList:i}=e;(n||t)&&(i=i.clone(),n&&i.assign(n),t&&i.assign(t));const o=i.values;return r&&o.push(...r),e.floating&&o.push("b-floating"),"hide"===e.collapsify&&o.push("b-collapsify-hide"),o}changeCls(e){return wn.from(e)}updateCls(e,t){if(!this.isConfiguring&&!this.isComposable){const{element:n}=this;t&&Yt.getTruthyKeys(t).forEach((e=>n.classList.remove(e))),e.assignTo(n)}}changeContentElementCls(e){return wn.from(e)}changeHtmlCls(e){return wn.from(e)}changeDefaultCls(e){return wn.from(e,!0)}changeUi(e){return wn.from(e)}updateUi(e){var t;let n,r,i=null;if(e){const t=this.getStaticWidgetClasses(this.rootUiClass);for(r in e)if(e[r])for(n in t)t[n]&&((i||(i=new wn))[`${n}-ui-${r}`]=1)}this._uiClasses=null===(t=i)||void 0===t?void 0:t.values,this._uiClassList=i}fromCache(e,t=!1,n=this.element){if(!n)return null;const r=this;return r.cache[e]||(r.cache[e]=t?Lr.children(n,e):Lr.down(n,e)),r.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var n;if("trial"!==(null===(n=this.masked)||void 0===n?void 0:n.type)){if(!0!==e&&""!==e||(e=" "),t&&!t.isDestroyed)"string"==typeof e?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const t=ul.resolveType("mask");(e=t.mergeConfigs(this.maskDefaults,e)).owner=this,e=t.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,n,r,i){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){const n=this,{element:r}=n,i=n._width,o=n._height,s=r.offsetWidth,l=r.offsetHeight;n.floating&&t&&n.onFloatingWidgetResize(...arguments),n.suspendResizeMonitor||i===s&&o===l||(n.onInternalResize(r,s,l,i,o),n.trigger("resize",{width:s,height:l,oldWidth:i,oldHeight:o}))}onFloatingWidgetResize(e,t,n){const r=this,{lastAlignSpec:i,constrainTo:o}=r;if(r.isVisible&&i&&i.target){const e=!t||n.height!==t.height,s=!t||n.width!==t.width,l=o&&!bn.from(o).contains(bn.from(r.element,null,!0));(e&&2!==i.zone||s&&1!==i.zone||l)&&r.requestAnimationFrame((()=>r.realign()))}}updateScale(){const e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const r=bn.client(n).width/e.configuredWidth,i=e.scale=e.allowGrowWidth?Math.min(r,1):r;t.style.transform=`scale(${i})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&r>1&&(e.width=e.configuredWidth*r)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if("number"==typeof(e=e||0))return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const n=e.split(" "),r=n.length;return 1===r?n[1]=n[2]=n[3]=n[0]:2===r?(n[2]=n[0],n[3]=n[1]):3===r&&(n[3]=n[1]),[isFinite(n[0])?`${n[0]}${t}`:n[0],isFinite(n[1])?`${n[1]}${t}`:n[2],isFinite(n[2])?`${n[2]}${t}`:n[3],isFinite(n[3])?`${n[3]}${t}`:n[4]]}get documentRoot(){var e;return(null===(e=this.owner)||void 0===e?void 0:e.documentRoot)||this.element.getRootNode()}get eventRoot(){var e,t;return null!==(e=this.element)&&void 0!==e&&e.isConnected?Lr.getRootElement(this.element):(null===(t=this.owner)||void 0===t?void 0:t.eventRoot)||this._rootElement}get rootElement(){const e=this;if(!e._rootElement){var t,n;let r=(null===(t=e.owner)||void 0===t?void 0:t.rootElement)||Lr.getRootElement(e.forElement||(null!==(n=e.element)&&void 0!==n&&n.isConnected?e.element:e.getRenderContext()[0]||e.element));r||(r=document.body),e._rootElement=r}return e._rootElement}get floatRoot(){const{rootElement:e}=this;let{floatRoot:t}=e;if(t)e.contains(t)||e.appendChild(t);else{var n;const{outerCls:i}=ul,o=null===(n=Lr.getThemeInfo(null,e))||void 0===n?void 0:n.name;if(!Lr.isValidFloatRootParent(e))throw new Error("Attaching float root to wrong root");o&&i.push(`b-theme-${o.toLowerCase()}`),t=e.floatRoot=Lr.createElement({className:`b-float-root ${i.join(" ")}`,parent:e}),Ws.push(t),s.isAndroid&&(t.style.height=`${screen.height}px`,Gn.on({element:r,orientationchange:()=>t.style.height=`${screen.height}px`,thisObj:this})),Rn.ion({theme:({theme:e,prev:n})=>{t.classList.add(`b-theme-${e.toLowerCase()}`),t.classList.remove(`b-theme-${n.toLowerCase()}`)}})}return t}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach((t=>{const n=parseInt(getComputedStyle(t).zIndex||0,10);n>e&&(e=n)})),e}static resetFloatRootScroll(){Ws.forEach((e=>e.scrollTop=e.scrollLeft=0))}static get floatRoots(){return Ws}static removeFloatRoot(e){Ws.splice(Ws.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=s;return t&&e.push(`b-${t}`),s.isTouchDevice&&e.push("b-touch-events"),s.isMobile&&e.push("b-mobile"),Lr.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),s.isChrome?e.push("b-chrome"):s.isSafari?e.push("b-safari"):s.isFirefox&&e.push("b-firefox"),s.isPhone&&e.push("b-phone"),r.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:n}=t;t._isAnimatingCounter=Math.max(0,n+(e?1:-1)),0===n&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):1!==n||e||(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:n}=ul.identifiable;for(const r in n)if(ul.widgetMatches(n[r],e,t))return n[r];return null}static queryAll(e,t=!1){const{idMap:n}=ul.identifiable,r=[];for(const i in n)ul.widgetMatches(n[i],e,t)&&r.push(n[i]);return r}static fromElement(e,t,n){const r=typeof t;e&&!e.nodeType&&(e=e.target),("number"===r||t&&t.nodeType===Element.ELEMENT_NODE)&&(n=t,t=null);let i,o,s,l=e,a=0;for("number"!=typeof n&&(i=n,n=Number.MAX_VALUE),"string"===r&&(t=t.toLowerCase());l&&l.nodeType===Element.ELEMENT_NODE&&a<n&&l!==i;){if(o=l.dataset&&l.dataset.ownerCmp||l.id,o){if(s=ul.getById(o),s){if(!t)return s;if("function"===r){if(t(s))return s}else if(ul.widgetMatches(s,t,!0))return s}a++}l=l.parentNode}return null}static fromSelector(e){const t=document.querySelector(e);return t?ul.fromElement(t):null}triggerFieldChange(e,t=!0){var n;t&&this.trigger("change",e),null===(n=this.eachAncestor)||void 0===n||n.call(this,(t=>{var n,r;if(null===(n=t.onFieldChange)||void 0===n||n.call(t,e),null!==(r=t.isolateFieldChange)&&void 0!==r&&r.call(t,this))return!1}))}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){Rn.setupFocusListenersOnce(this.eventRoot,Gn)}static widgetMatches(e,t,n){return"*"===t||("function"==typeof t?t(e):ul.isType(e,t,n))}static attachTooltip(e,t){return"string"==typeof t&&(t={html:t}),ul.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return"start"===e?"left":"end"===e?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget((t=>{"rtl"in t.initialConfig||(t.rtl=e)}))}}const hl=ul.prototype;["compose","domSyncCallback"].forEach((e=>hl[e].$nullFn=!0)),ul.initClass(),ul.register("mask",Hs),Lr.Widget=ul,Rn.Widget=ul,Hs.identifiable.idMap=ul.identifiable.idMap,Object.assign(r.bryntum||(r.bryntum={}),{get:ul.getById.bind(ul),query:ul.query,queryAll:ul.queryAll,fromElement:ul.fromElement,fromSelector:ul.fromSelector}),ul._$name="Widget";class gl extends(fe.mixin(je,_i)){static type="default";static configurable={owner:null,containerCls:"b-auto-container",itemCls:null};static factoryable={defaultType:"default"};get contentElement(){var e;return null===(e=this.owner)||void 0===e?void 0:e.contentElement}onChildAdd(e){}onChildRemove(e){}renderChildren(){const e=this,{owner:t,itemCls:n}=e,{contentElement:r,items:i}=t,o=t.itemCls,s=null==i?void 0:i.length;if(s){t.textContent=!1;for(let e=0;e<s;e++){const s=i[e],{element:l}=s,{classList:a}=l;l.dataset.itemIndex=e,a.contains("b-outer")&&a.remove(...ul.outerCls),n&&a.add(n),o&&a.add(o),s.render(r,Boolean(t.isPainted))}}e.syncPendingConfigs(),e.syncChildCount()}removeChild(e){const t=this,{element:n}=e,{owner:r,itemCls:i}=t,{contentElement:o}=r,s=r.itemCls;o.contains(n)&&n.remove(),delete n.dataset.itemIndex,i&&n.classList.remove(i),s&&n.classList.remove(s),t.fixChildIndices(),t.syncChildCount()}appendChild(e){const{element:t}=e,{owner:n,itemCls:r}=this,{contentElement:i}=n,o=n.itemCls;t.dataset.itemIndex=n.indexOfChild(e),n.textContent=!1,r&&t.classList.add(r),o&&t.classList.add(o),e.render(i,Boolean(n.isPainted)),this.syncChildCount()}insertChild(e,t){const n=this,{element:r}=e,{owner:i,itemCls:o}=n,{contentElement:s}=i,l=Lr.getChild(s,`[data-item-index="${t}"]`),a=i.itemCls;i.textContent=!1,o&&r.classList.add(o),a&&r.classList.add(a),s.insertBefore(r,l),e.render(null,Boolean(i.isPainted)),n.fixChildIndices(),n.syncChildCount()}fixChildIndices(){this.owner.items.forEach(((e,t)=>{e.element.dataset.itemIndex=t}))}syncChildCount(){var e;const{owner:t}=this,{length:n}=t.items;null===(e=t.contentElement)||void 0===e||e.classList[1===n?"add":"remove"]("b-single-child")}syncConfigLater(e){const t=this.pendingConfigs||(this.pendingConfigs=[]);t.includes(e)||t.push(e)}syncConfigStyle({name:e,style:t,classes:n,map:r}){const i=this,o=`b-box-${e}-`,{contentElement:s}=i,l=i[e];let a=(null==r?void 0:r[l])||l;if(s){if(n){const{classList:e}=s;n.forEach((t=>{t!==a&&e.remove(o+t)})),n.includes(a)&&(e.add(o+a),a="")}s.style[t]=a}else i.syncConfigLater(e)}syncPendingConfigs(){const e=this,{pendingConfigs:t}=e;let n;if(t)for(e.pendingConfigs=null;n=t.pop();)e[e.$meta.configs[n].updater](e[n])}}gl.initClass(),gl._$name="Layout";let pl=0;const ml=e=>e.ripple;class fl extends ul{static $name="Ripple";static type="ripple";static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}afterConstruct(){super.afterConstruct(),Gn.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(e){var t;const n=this;n.show();const r=Lr.getStyleValue(n.circleElement,"animationName");n.hide(),null===(t=n.listenerDetacher)||void 0===t||t.call(n),r&&"none"!==r&&(n.listenerDetacher=Gn.on({mousedown:{element:n.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:n.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:n.circleElement,handler:"onAnimationEnd"},thisObj:n}),"mousedown"===e.type&&(n.onMousedown(e),Rn.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(e){pl=performance.now(),this.handleTriggerEvent(e)}onMousedown(e){performance.now()-pl>200&&this.handleTriggerEvent(e)}handleTriggerEvent(e){const t=ul.fromElement(e.target,ml);if(t){const n=t.ripple,r=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(r){const i=Yt.assign({event:e,target:r,radius:this.radius},n);if("string"==typeof i.clip&&(i.clip=t[i.clip]||e.target.closest(i.clip),!i.clip))return;this.ripple(i)}}}ripple({event:e,point:t=Gn.getClientPoint(e),target:n=e.target,clip:r=n,radius:i=this.radius,color:o=this.color}){this.clip=r;const s=this,l=(r=bn.from(r,null,!0)).getDelta(t),a=s.rippleElement.style,c=s.circleElement,d=Lr.getStyleValue(n,"border-radius");s.hide(),a.transform=`translateX(${l[0]}px) translateY(${l[1]}px)`,a.height=a.width=`${i}px`,s.element.style.borderRadius=d,c.setAttribute("r",i),c.setAttribute("fill",o),s.showBy({target:r,align:"c-c",matchSize:!0})}onAnimationEnd(e){"b-ripple-expand"===e.animationName&&this.hide()}}ul.RippleClass=fl,fl._$name="Ripple";const vl=Object.freeze({}),{isArray:bl}=Array,yl=e=>e.weight,Cl=({weight:e},{weight:t})=>"string"==typeof e||"string"==typeof t?String(e).localeCompare(String(t)):(e??Number.MAX_SAFE_INTEGER)-(t??Number.MAX_SAFE_INTEGER),wl=e=>e&&!e.hidden,xl=["display","flex-direction"],Sl={default:1,box:1};class El extends ul{static $name="Container";static type="container";static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,strictRecordMapping:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(e){const t=e.items||e.lazyItems;(this.hasItems=Boolean(t&&(bl(t)?t:Object.keys(t)).length))||(this.initialItems=!1),super.startConfigure(e)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(e){return this.ensureItems().at(e)}remove(...e){let t=!0;1===e.length&&(bl(e[0])?e=e[0]:t=!1);const n=this,{_items:r}=n,i=[];for(let t=0;t<e.length;t++){const o=e[t];r.includes(o)&&(r.remove(o),n.layout.removeChild(o),i.push(o),n.onChildRemove(o))}return t?i:i[0]}removeAll(){return this.remove(this.items)}add(...e){const t=this,n=t.ensureItems(),r=[];let i,o,s,l=!0;for(1===e.length&&(bl(e[0])?e=e[0]:l=!1),o=0;o<e.length;o++){var a;i=e[o],i.isWidget?i.parent=t:i=t.createWidget(i),null!=(null===(a=i)||void 0===a?void 0:a.weight)?(s=H.findInsertionIndex(i,n.values,Cl),r.push(t.insert(i,s))):i&&(n.includes(i)||(n.add(i),t.onChildAdd(i),t.layout.appendChild(i),r.push(i)))}return l?r:r[0]}ensureItems(){const e=this;return e.getConfig("items"),e.getConfig("lazyItems"),e._items||(e.items=[]),e._items}insert(e,t){const n=this,r=n.ensureItems();e instanceof ul?e.parent=n:e=n.createWidget(e),r.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,r.count);const i=r.values;return i.splice(t,0,e),r.values=i,n.onChildAdd(e),n.layout.insertChild(e,t),e}indexOfChild(e){return this.items.indexOf(e)}changeLazyItems(e){this.items=e,this.layout.renderChildren()}changeItems(e,t){const n=this,r=[],i=new To;return bl(e)?n.processItemsArray(e,r):e&&n.processItemsObject(e,n.namedItems,r),r.some(yl)&&r.sort(Cl),i.add(r),t&&t.forEach((e=>{n.remove(e),i.includes(e)||e._createdBy!==n||e.destroy()})),i}afterConstruct(){const{rtl:e}=this,{classList:t}=this.contentElement;t.toggle("b-rtl",!0===e),t.toggle("b-ltr",!1===e)}updateRtl(e){super.updateRtl(e);const{contentElement:t}=this;t&&(t.classList.toggle("b-rtl",!0===e),t.classList.toggle("b-ltr",!1===e))}updateItems(e,t){let n=0;e.forEach((e=>{this.onChildAdd(e),t&&!t.temporary&&this.layout.insertChild(e,n),++n})),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const e=this;if(e.getConfig("lazyItems"),!e._items){if(e.initializingItems)return[];e._items=new To,e._items.temporary=!0}return e._items.values}processItemsArray(e,t){const n=e.length;let r,i;for(r=0;r<n;r++)i=e[r],i instanceof ul?(i.parent=this,i.element.classList.remove(...ul.outerCls)):i=this.createWidget(i),i&&((i.ref||i.id)&&this.addDescendant(i),t.push(i))}processItemsObject(e,t,n){let r,i;for(i in e)r=e[i],r&&(t&&i in t&&(r="object"==typeof r?Yt.merge(Yt.clone(t[i]),r):t[i]),r&&(r instanceof ul?r.parent=this:(r instanceof Object&&(r.ref=i),r=this.createWidget(r)),r&&(r.ref=i,this.addDescendant(r),n.push(r))))}onChildAdd(e){if(e.innerItem&&this.readOnly&&!e.ignoreParentReadOnly&&(e.readOnly=!0),this.onChildAddLayout(e),e.ref||e.id)for(let t=this;t;t=t.parent)t.addDescendant(e);this.syncChildCount(!0)}onChildAddLayout(e){e.innerItem&&this.layout.onChildAdd(e)}onChildHide(e){var t;super.onChildHide(e),null!==(t=this._items)&&void 0!==t&&t.includes(e)&&this.syncChildCount(!0)}onChildShow(e){var t;super.onChildShow(e),null!==(t=this._items)&&void 0!==t&&t.includes(e)&&this.syncChildCount(!0)}syncChildCount(e){if(!this.isConfiguring){const t=this,{items:n,hasItems:r}=t,i=n.filter(wl),{length:o}=i;if(t.visibleChildCount=o,t.hideWhenEmpty&&e){const e=Boolean(!o);Boolean(t._hidden)!==e&&(t.hidden=e)}n.forEach((e=>e.element.classList.remove("b-last-visible-child","b-first-visible-child"))),o&&(i[0].element.classList.add("b-first-visible-child"),i[o-1].element.classList.add("b-last-visible-child")),t.hasItems=Boolean(t.childItems.length),t.contentElement.classList[o?"remove":"add"]("b-no-visible-children"),t.isComposable?r!==t.hasItems&&t.recompose():t.updateTextContent(t._textContent)}}syncFlexDirection(){const{contentElement:e,flexColCls:t,flexRowCls:n}=this,r=new wn(e.className),i=Lr.getStyleValue(e,xl);r[n]=r[t]=0,"flex"===i.display&&(r["row"===i["flex-direction"]?n:t]=1),Lr.syncClassList(e,r)}addDescendant(e){const t=e.ref||e.id,n=this._widgetMap||(this._widgetMap={});n[t]||(n[t]=e)}onChildRemove(e){const t=this,n=e.ref||e.id;if(n)for(let r=t;r;r=r.parent)r.widgetMap[n]===e&&delete r.widgetMap[n];t.layout.onChildRemove(e),t.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(e){return this._record=null==e?vl:null,e}updateRecord(e){var t;const n=this;null===(t=n.recordUpdateDetacher)||void 0===t||t.call(n),n.trigger("beforeSetRecord",{record:e}),n.setValues(e,{onlyName:n.strictRecordMapping,highlight:Boolean(n.$highlight)}),n.autoUpdateFields&&null!=e&&e.firstStore&&(n.recordUpdateDetacher=e.firstStore.ion({update:n.onRecordUpdated,thisObj:n}))}setRecord(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}onRecordUpdated({record:e}){e===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:e,userAction:t}){if(this.autoUpdateRecord&&t){const{record:t,strictRecordMapping:n}=this,{name:r,ref:i,isValid:o=!0,value:s}=e,l=n?r:r||i;t&&l&&o&&(t.isModel?t.setValue(l,s):t[l]=s)}}getValues(e){const t={};return this.eachWidget(((n,r)=>{n.isolateFields?r.down=!1:!("name"in n)||e&&!e(n)||(t[n.name]=n.value)}),!0),t}get values(){const e={};return this.gatherValue(e),e}set values(e){this.assignValue(e)}get isSettingValues(){return Boolean(this.assigningValues)}get assigningValues(){var e;return this._assigningValues||(null===(e=this.parent)||void 0===e?void 0:e.assigningValues)}set assigningValues(e){this._assigningValues=e}assignValue(e,t){super.assignValue(e,t),this.isolateFields||this.setValues(e,t)}gatherValue(e){super.gatherValue(e),this.isolateFields||this.gatherValues(e)}setValues(e,t=this.assignValueDefaults){this.assigningValues=t,this.eachWidget((n=>n.assignValue(e,t)),!1),this.assigningValues=!1}get hasNoChildren(){const e=this,{items:t,lazyItems:n}=e.initialConfig,r=t&&(bl(t)?t:Yt.values(t)),i=n&&(bl(n)?n:Yt.values(n)),o=e.isConfiguring?i||r:e.items;return!(null!=o&&o.filter(wl).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(e){const t=this;if(!t.isComposable){const n=Boolean(e&&t.hasNoChildren),{classList:r}=t.contentElement;n!==r.contains("b-text-content")&&(r[n?"add":"remove"]("b-text-content"),t.rendered&&t.realign())}}updateLayoutStyle(e){Lr.applyStyle(this.contentElement,e)}updateElement(e){if(super.updateElement(...arguments),e){const{classList:e}=this.contentElement,{containerCls:t}=this.layout;e.add("b-content-element"),t&&e.add(t)}}onPaint(){var e;null===(e=super.onPaint)||void 0===e||e.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(e,t){if(t&&(t.takeRecords(),t.disconnect()),e){const t=this,{element:n,contentElement:r}=t;(e=new MutationObserver((e=>t.onContentElMutation(e)))).observe(r,{attributes:!0}),r!==n&&e.observe(n,{attributes:!0}),t.syncFlexDirection()}return e}onContentElMutation(e){Sl[this.layout.type]&&this.isVisible&&e.some((e=>this.contentElement.contains(e.target)))&&this.syncFlexDirection()}changeLayout(e,t){return gl.reconfigure(t,e,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(e){return this.widgetMap[e]}processWidgetConfig(e){}setupWidgetConfig(e,t){const n=this;"string"==typeof e?e={html:e}:e.nodeType===Element.ELEMENT_NODE&&(e={element:e,id:e.id}),("string"==typeof t||!t&&(t=e.type))&&("checkbox"===t&&s.isMobile&&ul.resolveType("slidetoggle",!0)&&(t=e.type="slidetoggle"),t=ul.resolveType(t,!0));for(let r=(e=(t||ul).mergeConfigs(n.defaults,e,{parent:n})).parent;r;r=r.parent)if(!1===r.processWidgetConfig(e))return null;return!1===n.trigger("beforeWidgetCreate",{widgetConfig:e})?null:e}createWidget(e){const t=ul.create(this.setupWidgetConfig(e),this.defaultType);return t&&(t._createdBy=this),t}updateDefaults(e,t){if(!this.isConfiguring&&e){const n=Object.entries(e);this.eachWidget((e=>{n.forEach((([n,r])=>{t&&e[n]!==t[n]||(e[n]=r)}))}),!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const e=this.query(this.defaultFocus||(e=>{var t;return e.isFocusable&&"close"!==e.ref&&!(null!==(t=e.ref)&&void 0!==t&&t.endsWith("collapse"))}));return e?e.focusElement:super.focusElement}doDestroy(){var e;null===(e=this._items)||void 0===e||e.forEach((e=>{var t;return null===(t=e.destroy)||void 0===t?void 0:t.call(e)})),this.layout.destroy(),super.doDestroy()}get isValid(){let e=!0;return this.eachWidget((t=>{t.isVisible&&"isValid"in t&&!t.isValid&&(e=!1)}),!0),e}}El.initClass(),El._$name="Container";const{assign:Rl}=Yt,Tl=()=>performance.now(),Dl={start:!1},Ml=/^[.\d]+([^\d].*)?$/,Fl=e=>{const t=e.$bryntum||(e.$bryntum={});return t.transitions||(t.transitions=Object.create(null))},Il=(e,t)=>{var n;"string"==typeof e&&(t=null===(n=Ml.exec(e))||void 0===n?void 0:n[1],e=parseFloat(e));return e&&e*("s"===t||!t&&e<10?1e3:1)},kl=e=>{const t=Yt.values(Fl(e)).filter((e=>null==e.completed)).map((e=>e.toString()));e.style.transition=t.join(", ")},Ol=e=>class extends e{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...e){super(...e),this.id=++Ll}start(){this.startTime=Tl()}get delay(){var e;return Il(this._delay??(null===(e=this.owner)||void 0===e?void 0:e.delay)??0,this.unit)}set delay(e){this._delay=e}get duration(){const{owner:e,unit:t}=this;return Il(this._duration??(e?e.duration:Pl.defaultDuration),t)}set duration(e){this._duration=e}get elapsed(){return Tl()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var e;return this._retain??(null===(e=this.owner)||void 0===e?void 0:e.retain)}set retain(e){this._retain=e}get timing(){var e;return this._timing??(null===(e=this.owner)||void 0===e?void 0:e.timing)}set timing(e){this._timing=e}get unit(){var e;return this._unit??(null===(e=this.owner)||void 0===e?void 0:e.unit)}set unit(e){this._unit=e}};let Ll=0;class Al extends(fe.mixin(Ol)){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:n}=e;let{property:r}=e;[r,e.to]=Lr.unitize(r,e.to),e.from=Lr.unitize(r,e.from)[1],e.promissory=new _s,e.property=r;const i=n[r];n[r]=e;let{from:o}=e;i&&(e.from=i.to,o=null,i.destroy()),null===o&&(o=e.getCurrentStyleValue(),i||(e.from=o)),t.style[r]=o,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return null===(e=this.promissory)||void 0===e?void 0:e.promise}get transitions(){return Fl(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:n,promissory:r,property:i}=t;r&&(t.completed=e,t.promissory=null,r.resolve(e),n[i]===t?(delete n[i],e||(kl(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return Lr.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:n,from:r,property:i,_retain:o,_timing:s}=this;return new Al({element:n,property:i,retain:o,timing:s,duration:Math.round(Math.min(e,t)),reverting:this,to:r,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:n,element:r,property:i}=e;Gn.onTransitionEnd({element:r,property:i,duration:t+n+20,thisObj:e.owner,handler:()=>{var t;return null===(t=e.finish)||void 0===t?void 0:t.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:n,timing:r}=this;return`${n} ${t}ms ${r||"ease-in-out"}${e?` ${e}ms`:""}`}}Al.initClass();class Pl extends(fe.mixin(Ol)){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){Yt.isObject(e)?Yt.entries(e).forEach((e=>Pl.register(...e))):(Pl.fx[e]=t,Pl[e]=t=>(Lr.isElement(t)?t={element:t,[e]:{}}:delete(t={element:t.element,[e]:t})[e].element,Pl.run(t)))}static run(e){return new Pl(e).start()}constructor(e){var t;super(null);const n=this,r=[],i={};let o,s,l,a;if(Array.isArray(e))n.items=e;else for(l in e)(Pl.specialPropsRe.test(l)?n:i)[l]=e[l];Yt.keys(i).forEach((e=>{a=i[e],null!=a&&!1!==a&&a==a&&((s=Pl.fx[e])?(a=Rl(n.defaults,s(a,n,e)),a.owner=n,o=new Pl(a)):(a=Rl(n.defaults,"object"==typeof a?a:{to:a}),a.owner=n,a.property=e,o=new Al(a)),r.push(o))})),null===(t=n.items)||void 0===t||t.forEach((e=>{Yt.isInstantiated(e)?e.owner=n:((e=Rl(n.defaults,e)).owner=n,e=new Pl(e)),r.push(e)})),n.items=r,n.promise=(1===r.length?r[0].promise:Promise.all(r.map((e=>e.promise)))).then((e=>{var t;return null===(t=n.finish)||void 0===t||t.call(n,e),n.completed||!1}))}doDestroy(){this.items.forEach((e=>e.destroy())),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:n}=this;return e??(!t&&(!n||n.retain))}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,n;const r=this,{items:i}=r;for(kl(r.element),r.completed="boolean"==typeof e?e:!e.some((e=>!e)),null===(t=r.prefinalize)||void 0===t||t.call(r,r.completed,r);i.length;)i.pop().destroy();null===(n=r.finalize)||void 0===n||n.call(r,r.completed,r)}revert(e){const t=this,{reverting:n}=t,r=!e||(e.start??!0);let i=t.defaults;return n&&(n.finalize&&(i.finalize=n.finalize),n.prefinalize&&(i.prefinalize=n.prefinalize),i.retain=n._retain),i=Rl(i,e,{items:t.items.map((e=>e.revert(Dl))),reverting:t}),i=new Pl(i),r&&i.start(),i}start(){const{element:e,items:t}=this;return super.start(),t.length&&(kl(e),t.forEach((e=>e.start()))),this}}Pl.initClass().Transition=Al,Pl.specialPropsRe=new RegExp(`^(?:${Object.keys(Pl.prototypeProperties).concat(Object.keys(Pl.superclass.prototypeProperties)).map((e=>"_"===e[0]?e.substr(1):e)).join("|")})$`),Pl.defaultDuration=200,Pl.fx={},Pl.register({puff:e=>(!0===e?e={}:"object"!=typeof e?e={transform:`scale(${e})`}:e.scale&&((e=Yt.clone(e)).transform=`scale(${e.scale})`,delete e.scale),Rl({opacity:0,transform:"scale(8)"},e))}),Pl._$name="Animator";const _l=/^(?:undefined|null|LEFT|RIGHT)$/,$l={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},Nl=e=>{const t=null==e?void 0:e.toUpperCase();return[t,"LEFT"===t||"RIGHT"===t]};var Hl=e=>class extends(e||fe){static $name="Rotatable";static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:e}=this;return{class:{[`b-rotate-${(e||"").toLowerCase()}`]:e,"b-rotate-vertical":e}}}syncRotationToDock(e){if(_l.test(String(this.rotate))){const[t,n]=Nl(e);this.rotate=n?this.invertRotate?$l[t]:t:null}}get widgetClass(){return null}};class Vl extends(ul.mixin(Hl)){static $name="Tool";static type="tool";static configurable={align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null};compose(){const{align:e,href:t}=this;return{tag:null!=t?"a":"button",class:{[`b-align-${e||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var e,t;if(null!==(e=this.parent)&&void 0!==e&&e.isPanel&&null!==(t=this.element)&&void 0!==t&&t.parentNode.matches(".b-panel-header"))return this.parent}changeAlign(e){return e}onInternalClick(e){const t=this,{handler:n,panel:r}=t,i={domEvent:e,tool:t};t.disabled||(t.trigger("click",i),t.isDestroyed||(t.trigger("action",i),t.isDestroyed||!1===(null==r?void 0:r.trigger("toolClick",i))||n&&t.callback(n,r,[e,r,t])))}onInternalKeyDown(e){"Enter"===(e.key.trim()||e.code)&&(e.cancelBubble=!0,e.stopPropagation())}updateDisabled(e,t){var n;super.updateDisabled(e,t),e&&(null===(n=this.repeat)||void 0===n||n.cancel())}changeRepeat(e,t){return null==t||t.destroy(),e&&ci.new({element:this.element},e)}}Vl.initClass(),Vl._$name="Tool";const Bl=/right/i,zl=e=>(e.collapsed||e.collapsing)&&"top"===e.owner.expandedHeaderDock&&e.owner.collapsible.direction.match(Bl)?"start":"end";class Wl extends Vl{static $name="CollapseTool";static type="collapsetool";static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:e,direction:t}=this;return{class:{[`b-icon-collapse-${t}`]:1,"b-collapsed":e}}}changeAutoAlign(e){return!0===e?zl:e}syncAutoAlign(){const{autoAlign:e}=this;e&&(this.align=e(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}}Wl.initClass(),Wl._$name="CollapseTool";const jl=/^(?:UP|DOWN|LEFT|RIGHT)$/,Gl=/^(left|top)$/i,Ul={},Yl=/^b-dock-(top|left|right|bottom)$/,ql="b-panel-collapse-revealer",Kl=/^(?:left|right)$/i,Xl="b-collapse-unflex",{round:Jl}=Math,Ql=["up","down","left","right"].reduce(((e,t)=>(e[t.toUpperCase()]=e[t]=t,e)),{}),Zl={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},ea={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},ta={h:"w",w:"h"},na={up:"top",right:"right",down:"bottom",left:"left"},ra={top:!1,right:!0,bottom:!1,left:!0},ia={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},oa={top:e=>`translate(0, -${Jl(e.height||0)}px)`,bottom:e=>`translate(0, ${Jl(e.height||0)}px)`,right:e=>`translate(${Jl(e.width||0)}px, 0)`,left:e=>`translate(-${Jl(e.width||0)}px, 0)`};let sa=0;class la extends(fe.mixin(_i)){static $name="PanelCollapser";static type="inline";static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(e){var t;null===(t=this.collapsible)||void 0===t||t.onCollapseClick(e)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return"collapsing"===this.collapsingExpanding}get collapsingExpanding(){var e;const t=null===(e=this.currentOperation)||void 0===e?void 0:e.collapsing;return null==t?null:t?"collapsing":"expanding"}get currentDock(){var e,t,n;return(null===(e=this.panel)||void 0===e||null===(t=e.header)||void 0===t||null===(n=t.dock)||void 0===n?void 0:n.toLowerCase())??"top"}get expanding(){return"expanding"===this.collapsingExpanding}get collapseTool(){var e,t;return null===(e=this.panel)||void 0===e||null===(t=e.tools)||void 0===t?void 0:t.collapse}get collapseDim(){return Kl.test(this.collapseDir)?"width":"height"}getCollapseDir(e){let{direction:t,panel:n}=this;if(!t||jl.test(t)){const e=null==n?void 0:n.placement;var r;if(e)t=ea[e];else t=ia[(null==n||null===(r=n.header)||void 0===r?void 0:r.dock)||"top"]}return e?Ql[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:e}=this,t=e.hasHeader&&e.expandedHeaderDock;let n=na[this.collapseDir],r=!1;return t&&((r=ra[n]!==ra[t])||(n=t)),[n,r]}get toolsConfig(){const{direction:e,tool:t}=this;return t&&{collapse:Yt.assign({direction:e.toLowerCase()},t)}}beforeCollapse(e){const{panel:t}=this,{element:n}=t;n.contains(Lr.getActiveElement(n))&&t.revertFocus(!0)}changeTool(e){const t=this,{panel:n}=t;if(t.isConfiguring||t.isDestroying||!n||n.isDestroying)return e;n.tools={collapse:e}}collapse(e){var t,n;const r=this,{panel:i}=r,o={id:++sa,completed:!1,panel:i};let{currentOperation:s}=r;return e=e??!0,Yt.isObject(e)&&(o.collapsed=!0,Yt.assign(o,e),e=o.collapsed,delete o.collapsed),o.collapsing=e,o.previous=s??null,e!==r.collapsed?s?s.collapsing!==e&&(o.animation=s.animation.revert({finalize(){var e;null===(e=r.collapseFinalize)||void 0===e||e.call(r,o,!0)}}),o.collapsing=e,s=o):(o.animation=Yt.clone(("animation"in o?o:r).animation),!1!==r.beforeCollapse(o)&&(o.animation&&(o.animation.finalize=e=>{var t;return null===(t=r.collapseFinalize)||void 0===t?void 0:t.call(r,o,e)}),i.changingCollapse=!0,r[e?"collapseBegin":"expandBegin"](o),o.animation?s=o:(o.completed=!0,r[e?"collapseEnd":"expandEnd"](o)),i.changingCollapse=!1,o.animation||r.onComplete(e?"collapse":"expand"))):s&&s.collapsing!==e&&(r[e?"expandRevert":"collapseRevert"](o),o.animation=s.animation.revert({finalize(){var e;null===(e=r.collapseFinalize)||void 0===e||e.call(r,o,!1)}}),s=o),r.currentOperation=s,(null===(t=s)||void 0===t||null===(n=t.animation)||void 0===n?void 0:n.done())??Promise.resolve(e===r.collapsed)}collapseFinalize(e,t){const n=this,{currentOperation:r,panel:i}=n,o=i.collapsed?"expand":"collapse";r===e&&(n.currentOperation=null,e.completed=t,i.changingCollapse=!0,n[o+"End"](e),i.changingCollapse=!1,t&&n.onComplete(o))}applyHeaderDock(e,t=!0){const{currentDock:n,panel:r}=this,i=e?this.collapseDock:r.expandedHeaderDock;i!==n&&r.hasHeader&&(r.header={dock:i},t&&r.recompose.flush())}composeHeader(e){const{panel:t}=this,{class:n}=e,r=t.expandedHeaderDock||Object.keys(n).filter((e=>n[e]&&Yl.test(e))).map((e=>Yl.exec(e)[1][0]));return n[ql]=1,n[`b-collapsible-${r[0]}${this.collapseDir[0]}`]=1,e}composeTitle(e){return e.class[ql]=1,e}collapseBegin(e){var t;const n=this,{animation:r}=e,{collapseDim:i,collapseTool:o,panel:s}=n,{element:l,placement:a}=s,[c,d]=n.collapseInfo,u=null==o?void 0:o.element.classList,h=!a||"h"===a[0]&&"width"===i||"v"===a[0]&&"height"===i;n.configuredWidth=s._lastWidth,n.configuredHeight=s._lastHeight,n.transverseCollapse=d,n.applyHeaderDock(!0);const g=s.rectangle(),p=n.lockInnerSize().moveTo(0,0),m=p.clone(),f=Zl[c],v=null===(t=s.headerElement)||void 0===t?void 0:t.getBoundingClientRect(),b=Jl((null==v?void 0:v[i])||0);l.classList.toggle(Xl,h),r?(m[f[0]]=m[f[1]],l.classList.add("b-collapsing"),null==u||u.add("b-collapsed","b-collapsing"),o&&(o.collapsing=!0),u&&(u.remove("b-collapsed"),s.rectangle(),u.remove("b-collapsing"),u.add("b-collapsed")),r.element=l,r.retain=!0,r[i]={from:Jl(g[i]),to:b},r.items=[{element:n.innerElement,retain:!1,clip:{from:`rect(${p})`,to:`rect(${m})`}}],d&&r.items.push({element:s.headerElement,duration:r.duration,retain:!1,transform:{from:oa[c](v),to:"translate(0, 0)"}}),e.animation=Pl.run(r)):(l.style[i]=`${b}px`,o&&(u.add("b-collapsing","b-collapsed"),o.rectangle(),u.remove("b-collapsing")))}collapseEnd(e){const t=this,{collapseTool:n}=t;t.panel.element.classList.remove("b-collapsing"),n&&(n.collapsing=!1),e.completed?t.collapsed=!0:(t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}collapseRevert(e){var t;null===(t=this.collapseTool)||void 0===t||t.element.classList.remove("b-collapsed")}expandBegin(e){const t=this,{animation:n}=e,{collapseDim:r,collapseTool:i,panel:o}=t,[s,l]=t.collapseInfo,{element:a}=o,c=a.classList,d=c.contains(Xl),u=o.rectangle();c.remove("b-collapsed","b-collapsing"),o.element.style[r]="",t.restoreConfiguredSize(),t.lockInnerSize(!1);const h=o.rectangle(),g=t.lockInnerSize().moveTo(0,0),p=g.clone(),m=Zl[t.collapseDock];null==i||i.element.classList.remove("b-collapsed"),n&&(p[m[0]]=p[m[1]],c.add("b-collapsed","b-expanding"),d&&c.add(Xl),n.element=a,n[r]={from:Jl(u[r]),to:Jl(h[r])},n.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${p})`,to:`rect(${g})`}}],l&&n.items.push({element:o.headerElement,duration:n.duration,retain:!1,transform:{from:"translate(0, 0)",to:oa[s](u)}}),e.animation=Pl.run(n))}expandEnd(e){const t=this;t.panel.element.classList.remove("b-expanding"),e.completed&&(t.collapsed=!1,t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}expandRevert(e){var t;null===(t=this.collapseTool)||void 0===t||t.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:e}=this;const t=!0===e;return(t||null==e)&&(e=this.collapseDim[0],(t||"absolute"===Lr.getStyleValue(this.panel.element,"position"))&&(e+=ta[e])),e||""}lockInnerSize(e=!0){const t=this,{innerElement:n,panel:r}=t,i=e?t.supportAxis:"",o=r.element,s=r.headerElement,l=e&&s&&bn.from(s,o),a=e&&bn.from(t.innerSizeElement,o),c=n.style;return s&&(s.style.minWidth=i.includes("w")?`${l.width}px`:"",s.style.minHeight=i.includes("h")?`${l.height}px`:""),c.width=e?`${a.width}px`:"",c.height=e?`${a.height}px`:"",n.classList[e?"add":"remove"]("b-panel-collapse-size-locker"),a}onCollapseClick(e){let t=!this.collapsing&&(!!this.expanding||!this.collapsed);e.altKey&&(t={animation:null,collapsed:t}),this.collapse(t)}onComplete(e){var t;null===(t=this.panel)||void 0===t||t.trigger(e)}onHeaderClick({event:e}){0===e.button&&this.panel.collapsed&&e.target.classList.contains(ql)&&this.onRevealerClick()}onPanelConfigChange({name:e,value:t}){const n=this,{panel:r}=n;"collapsed"===e?r.isPainted&&(n.collapsed=t):"header"!==e||r.changingCollapse||n.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(e){const{configuredHeight:t,configuredWidth:n,panel:r}=this;e=e??"wh",r.element.classList.remove(Xl),null!=n&&e.includes("w")&&(r.width=n),null!=t&&e.includes("h")&&(r.height=t)}splitHeaderItems({as:e,dock:t}=Ul){var n;return null===(n=this.panel)||void 0===n?void 0:n.splitHeaderItems({as:e,dock:t,alt:!0})}syncDirection(){const e=this,{direction:t}=e;t&&!jl.test(t)||(e.direction=e.getCollapseDir())}changeCollapsed(e){return Boolean(e)}updateCollapsed(e){const{collapseTool:t,panel:n}=this;n&&(n.collapsed=e,n.element.classList[e?"add":"remove"]("b-collapsed")),t&&(t.collapsed=e)}updateDirection(e){const{collapseTool:t,panel:n}=this;t&&(t.direction=Ql[e]),null!=n&&n.rendered&&n.recompose()}updatePanel(e){var t;const n=this;n.syncDirection(),null===(t=n.panelChangeDetacher)||void 0===t||t.call(n),n.panelChangeDetacher=e&&Te.after(e,"onConfigChange","onPanelConfigChange",n,{return:!1})}wrapCollapser(e,t){var n;const r=this,[i,o]=r.collapseInfo;if(!o)return[e,t];const{collapseDir:s,panel:l}=r,{expandedHeaderDock:a,header:c,uiClassList:d}=l,u=null===(n=l.tools)||void 0===n?void 0:n.recollapse,[h,g]=r.splitHeaderItems({as:"element",dock:i}),p=l.hasHeader?l.title||(null==c?void 0:c.title)||" ":null,m=p&&{tag:"header",class:new wn({...d,[`b-dock-${a}`]:1,"b-panel-header":1,"b-panel-collapser-header":1},null==c?void 0:c.cls),children:[...h,{reference:"collapserTitleElement",html:p,class:{...d,[`b-align-${(null==c?void 0:c.titleAlign)||"start"}`]:1,"b-header-title":1}},...g]};return u&&(u.direction=s),["collapseWrapElement",{class:{...d,[`b-panel-collapser-header-${a}`]:1,[`b-panel-collapser-${s}`]:1,[`b-${ra[a]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1},children:Gl.test(a)?{collapserHeaderElement:m,[e]:t}:{[e]:t,collapserHeaderElement:m}}]}}la.maps={clipByDock:Zl,dockByDirection:na,dockIsHorz:ra},la.initClass(),la._$name="PanelCollapser";const aa=Symbol("pendingCreate");class ca extends fe{static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:"undefined"!=typeof Proxy,setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const e=this;let t=null;return e.proxyable&&(t=new Proxy(e.instances,{get:(t,n)=>e.get(n),set:(t,n,r)=>(e.set(n,r),!0),deleteProperty:(t,n)=>(e.set(n,null),!0)})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}get target(){return this.proxy||this.object}define(e,t){const n=this,{transform:r}=n,i=r?r(t,e):t,o=Yt.isInstantiated(i);n.instances[e]=aa,o||n.setDefaults(e,i),n.defineProp(e,!0),o&&n.set(e,i)}defineProp(e,t){const n=this,{object:r}=n;n.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(r):r,e,{configurable:!t,enumerable:!0,get:()=>n.get(e),set:t=>n.set(e,t)})}flush(){const e=this;try{var t;e.updating=!0;for(const t in e.defaults)e.get(t);e.afterConfigureOwner=null===(t=e.afterConfigureOwner)||void 0===t?void 0:t.call(e)}finally{e.updating=!1}}get(e){const{defaults:t,instances:n}=this;return n[e]===aa&&this.set(e,aa),n[e]||t[e]&&null}set(e,t){const n=this,{cleanup:r,configName:i,defaults:o,factory:s,instances:l,owner:a,setup:c,transform:d,updating:u}=n,h=a&&i&&!u,g=l[e]===aa?null:l[e],p=s.reconfigure(g,t===aa?{}:t||null,{cleanup:r&&(t=>r(t,e)),defaults:o[e]||n.setDefaults(e,{}),owner:n.owner,setup:c&&((t,n,r)=>c(t,e,n,r)),transform:d&&(t=>d(t,e))});if(p!==g){const t=h&&{...l};var m;if(l[e]=p,p)n.defineProp(e),null===(m=n.created)||void 0===m||m.call(n,p,e);else delete n.object[e],delete l[e];h&&a.onConfigChange({name:i,config:a.$meta.configs[i],value:n.target,was:t})}}setDefaults(e,t){const{defaults:n,factory:r,inferType:i,instances:o,owner:s,ownerName:l}=this,{typeKey:a}=r.factoryable;return t=!0===t?{}:Yt.assign({},t),("name"===i||!0===i&&!t[a])&&(t[a]=e),l&&(t[l]=s),t.beforeConfigure=t=>{o[e]=t},n[e]=t}update(e){const t=this,{owner:n}=t;let r,i;try{if(t.updating=!0,e)for(r in e)i=e[r],t.defaults[r]?t.set(r,i):i&&t.define(r,i);else for(r in t.instances)t.set(r,null)}finally{t.updating=!1}n&&(n.isConfiguring?t.afterConfigureOwner||(t.afterConfigureOwner=Te.before(n,"afterConfigure","flush",t)):t.flush())}}ca.initClass(),ca._$name="DynamicObject";const da=[],ua={},ha={align:1,weight:1};var ga=e=>class extends(e||ul){static $name="Toolable";static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(e,t){return(e.weight||0)-(t.weight||0)}byWeightReverseSortFn(e,t){return(t.weight||0)-(e.weight||0)}gatherTools({align:e,alt:t,refs:n}=ua){const{collapsed:r,tools:i}=this,o={collapsed:r,alt:t};let s,l,a,c,d,u=[];for(l in i){var h,g,p;d=i[l],s=(null===(h=d)||void 0===h||null===(g=h.align)||void 0===g?void 0:g.align)??(null===(p=d)||void 0===p?void 0:p.align)??"end",s===e&&d.isCollapsified(o)&&u.push(d)}if(u.sort(this["end"===e?"byWeightReverseSortFn":"byWeightSortFn"]),n){const e="widget"===n,t={};for(a=0;a<u.length;++a)c=u[a],t[c.ref]=e?c:c.element;u=t}return u}getEndTools({alt:e,refs:t}=ua){return this.gatherTools({align:"end",alt:e,refs:t})}getStartTools({alt:e,refs:t}=ua){return this.gatherTools({align:"start",alt:e,refs:t})}get childItems(){return[...this.getStartTools(),...this._items||da,...this.getEndTools()]}changeTools(e,t){const n=this,r=n.$tools||(n.$tools=new ca({configName:"tools",factory:ul,inferType:!1,owner:n,created(e){var t,i;e.innerItem=!1,null===(t=e.syncRotationToDock)||void 0===t||t.call(e,null===(i=n.header)||void 0===i?void 0:i.dock),Te.after(e,"onConfigChange",((e,{name:t})=>{ha[t]&&n.onConfigChange({name:"tools",value:r.target})})),n.onChildAdd(e)},setup:(e,t)=>((e=Yt.merge({},n.toolDefaults["*"],n.toolDefaults[t],e)).parent=n,e.ref=t,e)}));if(r.update(e),!t)return r.target}get widgetClass(){}};const pa=["b-hbox","b-vbox"],ma={name:"align",style:"alignItems"},fa={name:"contentAlign",style:"alignContent"},va={name:"direction",style:"flexDirection"},ba={name:"justify",style:"justifyContent",classes:["stretch"]},ya={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}};class Ca extends gl{static $name="Box";static type="box";static alias="hbox";static configurable={containerCls:"b-box-container",itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null};get vertical(){return!1===this.horizontal}set vertical(e){return this.horizontal=!e}updateAlign(){this.syncConfigStyle(ma)}updateContentAlign(){this.syncConfigStyle(fa)}updateDirection(){this.syncConfigStyle(va)}updateHorizontal(){var e;const t=this,n=null===(e=t.contentElement)||void 0===e?void 0:e.classList,r=Number(t.vertical);n?(n.remove(pa[1-r]),n.add(pa[r])):t.syncConfigLater("horizontal"),t.syncDirection()}updateJustify(){this.syncConfigStyle(ba)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(ya)}syncDirection(){const e=this,{reverse:t}=e;e.direction=t?`${e.vertical?"column":"row"}${t?"-reverse":""}`:null}}Ca.initClass(),Ca._$name="Box";class wa extends Ca{static $name="VBox";static type="vbox";static configurable={horizontal:!1}}wa.initClass(),wa._$name="VBox";var xa=e=>class extends(e||fe){static $name="Badge";static get configurable(){return{badge:null}}compose(){const{badge:e}=this;return{dataset:{badge:e},class:{"b-badge":null!=e&&""!==e}}}};const Sa=/(?:^|\s)b-icon-/,Ea=/(?:^|\s)b-fa-/,Ra=Symbol("defaultToggleable"),Ta=["items","type","widgets","html","listeners"],Da=Symbol("defaultListener");class Ma extends(ul.mixin(xa,Hl)){static $name="Button";static type="button";static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",behaviorType:"button",text:{value:null,$config:null,default:""},color:null,toggleable:Ra,pressed:!1,toggleGroup:null,supportsPressedClick:!1,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(e,t){var n,r,i;const o=this,{constructor:s}=o,l=super.updateElement(e,t),a=o.peekConfig("menu"),c=!!a&&(a.isWidget?a.role:(null===(n=s.resolveType(a.type))||void 0===n||null===(r=n.configurable)||void 0===r?void 0:r.role)||(null===(i=s.configurable.menuDefaults)||void 0===i?void 0:i.type)||"menu");return o.ariaHasPopup=c,l}compose(){const{color:e,href:t,icon:n,iconAlign:r,pressed:i,pressedIcon:o,target:s,text:l,toggleable:a,toggleGroup:c,menuIcon:d,behaviorType:u}=this,h=this.hasConfig("menu"),g=i&&o?o:n;return{tag:t?"a":"button",href:t,target:s,type:u,class:{[`b-icon-align-${r}`]:n,[e]:Boolean(e),"b-pressed":i&&a,"b-text":Boolean(l),"b-has-menu":h},"aria-pressed":i,dataset:{group:c},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(n||o)&&{"aria-hidden":!0,tag:"i",class:{...wn.normalize(g,"object"),"b-icon":Sa.test(g),"b-fa":Ea.test(g)}},label:l&&{tag:"label",for:this.id,text:l},menuIconElement:h&&d&&{tag:"i",class:{"b-icon":Sa.test(d),"b-fa":Ea.test(d),"b-button-menu-icon":1,[d]:1}}}}}configureOverflowTwin(e){const t=this,n=super.configureOverflowTwin(e);return n.text||(n.text=t.text||t.tooltipText),n}onHide(){var e;null===(e=this._menu)||void 0===e||e.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(e){var t;super.onFocusOut(e),null===(t=this.menu)||void 0===t||t.hide()}get focusElement(){return this.element}changeText(e){return null==e?"":e}changeToggleable(e){return e===Ra?this.toggleGroup||this.config.menu:e}changeMenu(e,t){const n=this,{element:r}=n;return e?(e.isWidget?(e.forElement=r,e.owner=n,e.constrainTo=n.rootElement):("object"!=typeof e||Ta.some((t=>t in e))||(e={lazyItems:e}),e=ul.reconfigure(t,e?Yt.merge({owner:n,constrainTo:n.rootElement,forElement:r},n.menuDefaults,e):null,n)),e.align.constrainPadding=10,n.detachListeners(Da),e.ion({name:Da,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):null==t||t.destroy(),e}onMenuBeforeShow({source:e}){return this.trigger("beforeShowMenu",{menu:e})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(e){this.toggleable=Boolean(e)}updatePressed(e){const t=this;if(!t.toggleable||t.isConfiguring)return;const{menu:n}=t;e&&Lr.forEachSelector(t.rootElement,`button[data-group=${t.toggleGroup}]`,(e=>{e!==t.element&&(ul.getById(e.id).pressed=!1)})),n&&(n.initialConfig.minWidth||(n.minWidth=t.width),n.align.minHeight=n._minHeight??100,n.align.minWidth=n._minWidth??100,n[e?"show":"hide"]()),t.trigger("toggle",{pressed:e,userAction:t._isUserAction})}onInternalMousedown(e){var t;null!==(t=this._menu)&&void 0!==t&&t.containsFocus&&this.pressed&&e.preventDefault()}onInternalClick(e){const t=this,n={event:e};if(!t.disabled){if(t._isUserAction=!0,t.toggleable){if(t.toggleGroup&&t.pressed&&!t.supportsPressedClick)return;if(t.toggleGroup&&t.pressed||t.toggle(!t.pressed),t.isDestroyed)return}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),t.href||(e.preventDefault(),e.stopPropagation()),t._isUserAction=!1}}toggle(e=!this.pressed){!1!==this.trigger("beforeToggle",{pressed:e,userAction:this._isUserAction})&&(this.pressed=e)}}Ma.initClass(),Ma._$name="Button";const Fa={refs:"element"},Ia=e=>e.element.style.margin="",ka=e=>e.isToolbar,Oa=e=>e[0]+(e[1].minifiable?0:9e9),La={hidden:!1,width:""},Aa={...La,flex:""},Pa=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],_a={delay:0,startRate:40,endRate:200,accelerateDuration:500},$a={menu:1,pressed:1};class Na extends(El.mixin(ga)){static $name="Toolbar";static type="toolbar";static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter((e=>"none"!==e.overflowable));return t.forEach(((e,n)=>t[n]=[n,e])),t.sort(((e,t)=>Oa(t)-Oa(e))),t}compose(){const e=this,{axisProps:t,dock:n}=e,r=e.getEndTools(Fa),i=e.getStartTools(Fa);return{class:{[`b-dock-${n}`]:1,[`b-${n}-toolbar`]:1,[`b-${t.box}`]:1},children:{...i,toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}},...r}}}get axisProps(){return Pa[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return null===(e=this.tools)||void 0===e?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return"string"==typeof e?e:null==e?void 0:e.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),null===(t=e.syncRotationToDock)||void 0===t||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){Te.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget((e=>this.processAddedLeafItem(e)))}onPaint({firstPaint:e}){var t;null===(t=super.onPaint)||void 0===t||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){const t=this,{layout:n}=t,{vertical:r}=n;if(n.vertical=Nl(e)[1],!t.initialItems){r!==n.vertical&&t.updateOverflow(t.overflow);for(const n of t.childItems){var i;null===(i=n.syncRotationToDock)||void 0===i||i.call(n,e)}}}updateOverflow(e,t){var n;const r=this,{axisProps:i,contentElement:o,overflowType:s}=r,{flexDir:l}=i,a=null===(n=r.overflowMenuButton)||void 0===n?void 0:n._menu,c={};var d;if(a&&(e?null==a||a.removeAll():a.eachWidget((e=>{e._overflowTwinOrigin.overflowTwin=null}))),"menu"===t?c.overflowMenuButton=null:"scroll"===t&&(c.overflowScrollStart=c.overflowScrollEnd=null),"menu"===s)null===(d=r.scrollable)||void 0===d||d.destroy(),o.style.overflow=o.style.overflowX=o.style.overflowY="",c.overflowMenuButton={cls:{[`b-${l}-menu`]:1}};else if("scroll"===s){const t="object"==typeof e&&(null==e?void 0:e.repeat)||_a;r.scrollable={[i.overflow]:"hidden-scroll",element:o,internalListeners:{scroll:"onContentScroll",thisObj:r}},c.overflowScrollStart={repeat:t,invertRotate:!0,cls:{[`b-${l}-start-scroller`]:1}},c.overflowScrollEnd={repeat:t,invertRotate:!0,cls:{[`b-${l}-end-scroller`]:1}}}r.tools=c,s?(o.classList.add("b-overflow"),r.monitorResize=!0,r.syncOverflowVisibility()):(o.classList.remove("b-overflow"),r.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:n,isVisible:r}=e,{clientSizeProp:i,edgeProp:o,sizeProp:s}=e.axisProps,{overflowMenuButton:l,overflowScrollStart:a,overflowScrollEnd:c}=e.tools,d=e.rtl&&e.layout.horizontal,u="menu"===t,h=()=>Math.ceil(n[i]+(!a||a.hidden?0:a.rectangle("outer")[s])+(!c||c.hidden?0:c.rectangle("outer")[s])),g=()=>{if(0===R.length)return 0;const e=R[R.length-1].rectangle(n);return Math.floor(d?n[i]-e.left:e[o])};let p,m,f,v,b,y,C,w,x,S,E,R;if(r&&t&&0!==e.items.length){if(e.inSyncOverflowVisibility=!0,null==l||l.hide(),e.eachWidget(((e,t)=>{C=e.minifiable,S=e.overflowable,S=C?S||C:S,e.floating?t.down=!1:(t.down=!S,e.innerItem&&(e._toolbarOverflow&&(e.hidden=e._toolbarOverflow=!1),e._toolbarMinified&&(e.minified=e._toolbarMinified=!1),e.isVisible&&(C&&(w||(w=[])).push(e),S&&(R||(R=[])).push(e))))})),R&&(p=h(),m=g()),R&&m>p)if(u){for(;m>p&&(b=null===(T=w)||void 0===T?void 0:T.pop());){var T;y=m,b._toolbarMinified=!0,b.minified=!0,m=g(),y-=m,(x||(x=[])).push([b,y])}if(m>p){for(f of(l.show(),p=h(),v=Na.getEvictionList(R),v))m>p&&(b=f[1],b._toolbarOverflowWidth=b.width,b._toolbarOverflow=!0,b.hidden=!0,R.splice(R.indexOf(b),1),(E||(E=[])).push(f),m=g());if(E){for(E.sort(((e,t)=>e[0]-t[0])).forEach(((e,t)=>E[t]=e[1]));null!==(D=x)&&void 0!==D&&D.length;){var D;[b,y]=x.pop(),m+y<=p&&!b._toolbarOverflow&&(m+=y,b.minified=b._toolbarMinified=!1)}e.syncOverflowMenuButton(E)}else l.hide()}}else c.show(),a.show(),e.syncScrollerState();else u||(null==c||c.hide(),null==a||a.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const n=this,{axisProps:r,overflowMenuButton:i}=n,o={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:r.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(n.addToMenu(o,e.filter((e=>n.overflowItemFilter(e)))),null!==(t=i._menu)&&void 0!==t&&t.isMenu){const e=i.menu,{toAdd:t,toRemove:n}=H.delta(o.items,e.items,1);if(e.remove(n),e.items.length)for(let n=t.length-1;n>=0;n--)e.insert(t[n],0);else e.add(t)}else i.menu=o}syncScrollerState(){const{axisProps:e,scrollable:t}=this,{overflowScrollStart:n,overflowScrollEnd:r}=this.tools,i=t[e.pos],o=t[e.max];n.disabled=!i,r.disabled=Math.abs(Math.ceil(i))>=Math.abs(o)}overflowItemFilter(e){const{filter:t}=this.overflow;return Boolean(t?t.call(this,e):Lr.getChildElementCount(e.element))}addToMenu(e,t){const n=this.horizontal?Aa:La;for(const r of t){const t=r.ensureOverflowTwin(n,Ia);e.items.push(t)}}onLeafItemConfigChange(e,{name:t,value:n}){const r=this,i=r.up(ka),o=i.hasConfig("overflow"),{overflowTwin:s}=r;!o||null!=i&&i.inSyncOverflowVisibility||"hidden"===t&&n===r._toolbarOverflow||(s&&!$a[t]&&(s[t]=n),null!=i&&i.isPainted&&"overflowMenuButton"!==r.ref&&(r.isTextField&&"value"===t&&(r.containsFocus||null!=s&&s.containsFocus)||i.syncOverflowVisibility()))}createWidget(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}Na.initClass(),Na._$name="Toolbar";const Ha=e=>!e.classList.contains("b-focus-trap")&&Lr.isFocusable(e)?Lr.NodeFilter.FILTER_ACCEPT:Lr.NodeFilter.FILTER_SKIP,Va=[],Ba={},za=[Va,Va],Wa=(e,t,n)=>{const{vertical:r}=e;return delete e.vertical,{...e,class:{...t,[`b-${r?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!n}}},ja=(e,t,n=!1)=>{const r={vertical:n,children:e?[e]:[]};return t&&(r.tag=t),r},Ga=(e,t)=>{null!=e&&e.classList?null==e||e.classList.add(t):null!=e&&e.class&&("string"==typeof e.class&&(e.class={[e.class]:1}),e.class[t]=1)},Ua={dock:1,hidden:1,weight:1},Ya={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},qa={header:1,"pre-header":1};class Ka extends(El.mixin(Ci,ga)){static $name="Panel";static type="panel";static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const n=super.updateElement(e,t);return this.titleElement&&Lr.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),n}compose(){const e=this,{collapsible:t,focusable:n,hasItems:r,revealed:i,tools:o}=e,s=e.composeHeader(),l=(null==s?void 0:s.class["b-dock-left"])||(null==s?void 0:s.class["b-dock-right"]);let a=e.composeBody(),c="bodyWrapElement";return t&&([c,a]=t.wrapCollapser(c,a)),{tabIndex:r&&!1!==n||n?0:null,class:{[`b-panel-collapsible-${null==t?void 0:t.type}`]:t,[`b-panel-collapse-${null==t?void 0:t.collapseDir}`]:t,[`b-${l?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":s,"b-panel-has-tools":o?1:0,"b-panel-overlay-revealed":i},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:s,[c]:a,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){var e,t;const n=this,{bodyCls:r,bodyConfig:i,bodyWrapTag:o,footer:s,uiClassList:l}=n,a=Yt.values(n.strips,((e,t)=>!Ya[null==t?void 0:t.dock])).sort(n.byWeightSortFn),c={top:null,right:null,bottom:null,left:null};let d,u,h,g,p,m,f;for(s&&(h=s.dock||"bottom",a.unshift({dock:h,element:{tag:"footer",reference:"footerElement",html:"string"==typeof s?s:s.html,class:{...l,[`b-dock-${h}`]:1,[`${s.cls||""}`]:1}}})),r&&(i[p="className"]||(p="class"),i[p]=new wn(i[p]).assign(r)),g=a.length;g-- >0;)d=a[g],[m,u]=Ya[d.dock],f?f.vertical!==m&&(f=ja(Wa(f,l),"",m)):f=ja(i,o,m),f.children[u?"unshift":"push"](d.element),c[d.dock]=d;Ga(c.top,"b-innermost"),Ga(c.right,"b-innermost"),Ga(c.bottom,"b-innermost"),Ga(c.left,"b-innermost");const v=Wa(f||ja(i,o),l,!0);return v.class[`${null===(e=n.layout)||void 0===e?void 0:e.containerCls}-panel`]=Boolean(null===(t=n.layout)||void 0===t?void 0:t.containerCls),v.class["b-panel-body-wrap"]=1,v.class[`b-${n.$$name.toLowerCase()}-body-wrap`]=1,v}get hasHeader(){if(!1===this.header)return!1;const{header:e,title:t,tools:n,parent:r}=this,i=this.maximizable||Object.values(n||{}).some((e=>!e.hidden));return e||!(null!=r&&r.suppressChildHeaders)&&(t||i)}get rootUiClass(){return Ka}composeHeader(e){var t;const n=this;if(!n.hasHeader&&!e)return;const r=n.header||{},i=r.dock||"top",[o,s]=n.splitHeaderItems({as:"element",dock:i}),l=n.$meta.hierarchy,a=n.composeTitle(r),c=new wn({[`b-dock-${i}`]:1,...n.uiClassList},r.cls);let d,u;for(d=l.indexOf(Ka);d<l.length;++d)u=l[d].$$name,"Grid"!==u&&(c[`b-${u.toLowerCase()}-header`]=1);const h={tag:"header",class:c,children:[...o,a,...s]};return(null===(t=n.collapsible)||void 0===t?void 0:t.composeHeader(h))||h}composeTitle(e){var t;const n="string"==typeof e?e:this.title||e.title,r={reference:"titleElement",id:`${this.id}-panel-title`,html:n??" ",class:{[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1,...this.uiClassList}};return Yt.isObject(n)&&(delete r.html,Yt.merge(r,n)),(null===(t=this.collapsible)||void 0===t?void 0:t.composeTitle(r))||r}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:n}=t;null===(e=t._headerClickDetacher)||void 0===e||e.call(t),t._headerClickDetacher=n&&Gn.on({element:n,click:e=>{var n;return null===(n=t.trigger)||void 0===n?void 0:n.call(t,"headerClick",{event:e})}})}onHeaderClick(e){var t;null===(t=this.collapsible)||void 0===t||t.onHeaderClick(e)}onPaint(){var e;super.onPaint(...arguments),null===(e=this.collapsible)||void 0===e||e.onPanelPaint(this)}splitHeaderItems({as:e,dock:t,alt:n}=Ba){const r=this,i="element"===e,{collapsed:o}=r,s=r.getEndTools({alt:n}),l=r.getStartTools({alt:n}),a=Yt.values(r.strips,((e,t)=>!qa[null==t?void 0:t.dock]&&t.isCollapsified({collapsed:o,alt:n})));let c,d,u,h=za;if(a.length+s.length+l.length){for(h=[d=[...l,...a.filter((e=>"pre-header"===e.dock)).sort(r.byWeightSortFn)],c=[...a.filter((e=>"header"===e.dock)).sort(r.byWeightReverseSortFn),...s]],u=0;u<d.length;++u){var g,p;t&&(null===(g=(p=d[u]).syncRotationToDock)||void 0===g||g.call(p,t)),i&&(d[u]=d[u].element)}for(u=0;u<c.length;++u){var m,f;t&&(null===(m=(f=c[u]).syncRotationToDock)||void 0===m||m.call(f,t)),i&&(c[u]=c[u].element)}}return h}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:t}=e,n=Yt.merge({reference:"bodyElement",className:{...e.getStaticWidgetClasses(Ka,"-content"),"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren}},e._bodyConfig);return t&&(n.tag=t),!e.initializingElement&&e._element||(n.html=e.content||e._html),n}changeBodyCls(e){return wn.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,n=Yt.values(t.strips,((e,t)=>!Ya[null==t?void 0:t.dock])).sort(t.byWeightSortFn),[r,i]=t.splitHeaderItems(),[o,s]=(null===(e=t.collapsible)||void 0===e?void 0:e.splitHeaderItems())||za;return[...r,...o,...i,...s,...n.filter((e=>Ya[e.dock][1])),...t._items||Va,...n.filter((e=>!Ya[e.dock][1])).reverse()]}changeStrips(e,t){const n=this,r=n.$strips||(n.$strips=new ca({configName:"strips",factory:ul,inferType:!1,owner:n,created(e){var t;const{dock:i}=e;if(!qa[i]&&!Ya[i])throw new Error(`Invalid dock value "${i}"; must be: top, left, right, bottom, header, or pre-header`);Te.after(e,"onConfigChange",((e,{name:t})=>{Ua[t]&&n.onConfigChange({name:"strips",value:r.target})})),e.innerItem=!1,n.onChildAdd(e),e.parent=n,null===(t=e.layout)||void 0===t||t.renderChildren(),e.hasItems&&(n.hasItems=!0)},setup:(e,t)=>((e=Yt.merge(Yt.clone(n.stripDefaults["*"]),n.stripDefaults[t],e)).parent=n,e.ref=t,e),transform:e=>(Array.isArray(e)&&(e={items:e}),e||null)}));if(r.update(e),!t)return r.target}get collapsing(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.collapsing}get collapsingExpanding(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.collapsingExpanding}get expanding(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:n}=t;if(t.recompose.flush(),e=Boolean(e),!n||t.changingCollapse||!t.isPainted)return e;null==n||n.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const n=this;return n.getConfig("tools"),e&&(!0===e?e={}:"string"==typeof e&&(e={[Ya[e]?"direction":"type"]:e})),la.reconfigure(t,e,{owner:n,defaults:{panel:n},cleanup(){n.collapsed&&(t.collapse({animation:null,collapsed:!1}),n._collapsed=1)}})}updateCollapsible(e){const t=this,n=null==e?void 0:e.toolsConfig;t.tools={collapse:(null==n?void 0:n.collapse)||null,recollapse:(null==n?void 0:n.recollapse)||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),1===t.collapsed&&(t.collapsed=!0)}_collapse(e,t){var n;return!0!==t&&t!==i&&(!1===t?e.collapsed=!e.collapsed:"number"==typeof t?e.animation={duration:t}:null===t?e.animation=t:!0===t||("animation"in t?Yt.merge(e,t):e.animation=t)),null===(n=this.collapsible)||void 0===n?void 0:n.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var e;return this._expandedHeaderDock??(null===(e=this.initialConfig.header)||void 0===e?void 0:e.dock)??"top"}set expandedHeaderDock(e){this._expandedHeaderDock=null==e?void 0:e.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=null==e?void 0:e.dock)}updateTrapFocus(e){var t;const n=this;n.element.classList[e?"add":"remove"]("b-focus-trapped"),n.focusTrapListener=null===(t=n.focusTrapListener)||void 0===t?void 0:t.call(n),e&&(n.focusTrapListener=Gn.on({element:n.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:n}),n.treeWalker||(n.treeWalker=this.setupTreeWalker(n.element,Lr.NodeFilter.SHOW_ELEMENT,Ha)))}setupTreeWalker(e,t,n){return document.createTreeWalker(e,t,n)}onFocusTrapped(e){const t=this,n=t.treeWalker;if(e.target===t.bottomFocusTrap)n.currentNode=t.topFocusTrap,n.nextNode();else{if(e.target!==t.topFocusTrap)return;n.currentNode=t.bottomFocusTrap,n.previousNode()}t.requestAnimationFrame((()=>n.currentNode.focus()))}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){const e=this,t=super.widgetClassList;var n;e.hasHeader&&t.push("b-panel-has-header",`b-header-dock-${(null===(n=e.header)||void 0===n?void 0:n.dock)||"top"}`);return e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}Ka.initClass(),Ka._$name="Panel";class Xa extends Ka{static $name="Popup";static type="popup";static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),Gn.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),!e.autoShow||t&&!Lr.isVisible(t)||(!0===e.autoShow?e.show():e.setTimeout((()=>e.show()),e.autoShow))}onPaint({firstPaint:e}){var t;null===(t=super.onPaint)||void 0===t||t.call(this,...arguments);const n=this;e&&n.headerElement&&Gn.on({element:n.headerElement,dblclick:n.onHeaderDblClick,thisObj:n})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":Boolean(t&&e)}}}close(){const e=this;if(!e._hidden&&!1!==e.trigger("beforeClose")||e._hidden&&"destroy"===e.closeAction)return e.modal&&"destroy"===e.closeAction&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout((()=>e.element.classList.add("b-using-keyboard")),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){Lr.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;"Escape"===e.key&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:n}=t,{target:r}=e;if("touchend"!==e.type&&null!=n&&n.isButton&&n._menu===t&&n.element.contains(r))return e.preventDefault(),!1;t.modal&&r===Xa.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):t.owns(r)||!t.autoClose||t.containsFocus||t.close()}get isTopModal(){return Lr.isVisible(Xa.modalMask)&&this.element.previousElementSibling===Xa.modalMask}onFocusIn(e){const t=Lr.getActiveElement(this);super.onFocusIn(e),Lr.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){r.visualViewport&&r.visualViewport.height<document.documentElement.clientHeight-1||this.modal||!this.autoClose||this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;t.autoClose&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),null===(e=super.onShow)||void 0===e||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=Rn.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:n}=e;if(n.setAttribute("aria-modal",Boolean(t)),t&&e.isVisible)"number"!=typeof e._x&&"number"!=typeof e._y&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),n.classList.add("b-modal");else if(e.isPainted){n.classList.remove("b-modal");const t=e.floatRoot.querySelectorAll(".b-modal"),r=t.length?Xa.fromElement(t[t.length-1],"popup"):null;r?r.syncModalMask():Xa.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const n=this;null===(e=n.mouseDownRemover)||void 0===e||e.call(n),n.mouseDownRemover=null,null===(t=super.onHide)||void 0===t||t.call(this),n.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=Xa;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=Lr.createElement({className:"b-modal-mask b-hide-display"}),Gn.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}}Xa.initClass(),Xa._$name="Popup";const Ja={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Qa={true:1,false:1},Za=Promise.resolve();class ec extends Xa{static $name="Tooltip";static type="tooltip";static get configurable(){return{mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:null,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=!1!==e.showOnHover,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=Gn.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;null===(e=this.pointerOverOutDetacher)||void 0===e||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&Lr.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:n}=t;n&&Lr.isTouchEvent&&e.pageX===n.pageX&&e.pageY===n.pageY&&t.activeTarget.contains(e.target)&&performance.now()-n.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:n,relatedTarget:r}=e,{forElement:i,forSelector:o,activeTarget:s}=t;let l;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled||t.allowOver&&t.element.contains(n))){if(o){if(l=t.filterTarget(n),null!=s&&s.contains(n)&&s.contains(r)&&l===s)return;if(l&&(null==r?void 0:r.closest(o))===l)return}else{if(i.contains(r))return;l=i}l?t.handleForElementOver(e,l):s&&t.handleForElementOut()}}filterTarget(e){return e.closest(this.forSelector)}onTransitionEnd(e){const t=this,{currentOverElement:n}=ec;if(Ja[e.propertyName]){var r;if(t.allowOver&&t.element.contains(n))return;null!==(r=t.activeTarget)&&void 0!==r&&r.contains(n)&&!t.trackMouse&&t.realign()}}async handleForElementOver(e,t){const n=this,{activeTarget:r,hideOnDelegateChange:i,anchorToTarget:o}=n,s=t!==r,l=s&&i;if(!1===n.trigger("pointerOver",{event:e,target:t}))n.internalOnPointerOut(e);else{if(n.triggeredByEvent=e,n.hasTimeout("hide")&&(n.abortDelayedHide(),!s))return;if(!i&&n.element.classList.contains("b-hiding")&&n.cancelHideShowAnimation(),!n._hidden&&l&&n.hide(!1),n.activeTarget=t,n.isVisible){const e=n.updateContent();if(m.isPromise(e)&&!n.loadingMsg&&await e,!1===n.trigger("beforeShow"))return n.hide();n.alignTo({[o?"target":"position"]:o?t:"mouse",overlap:!(o&&n.anchor)}),n.trigger("show"),n.afterShowByTarget()}else n.delayShow(t)}}async delayShow(e){var t;const n=this;if(null!==(t=n.currentAnimation)&&void 0!==t&&t.showing&&n.cancelHideShowAnimation(),n.isVisible||n.hasTimeout("show"))n.isVisible&&n.showByTarget(e);else if(!n.hoverDelay||n.forSelector&&Date.now()-n.lastHidden<n.quickShowInterval){const t=n.updateContent();m.isPromise(t)&&!n.loadingMsg&&await t,n.showByTarget(e)}else n.addDocumentMouseDownListener(),n.listeningForMouseMove||n.anchorToTarget||(n.mouseMoveRemover=Gn.on({element:n.rootElement,mousemove:"onMouseMove",thisObj:n})),n.setTimeout((async()=>{if(n.activeTarget===e&&e.isConnected){const t=n.updateContent();m.isPromise(t)&&!n.loadingMsg&&await t,n.showByTarget(e)}}),n.triggeredByEvent&&"pointerover"!==n.triggeredByEvent.type?0:n.hoverDelay,"show")}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){const t=this,{element:n}=t;var r;(n.classList.toggle("b-allow-over",Boolean(e)),e)?t.allowOverlisteners=Gn.on({element:n,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:t}):null===(r=t.allowOverlisteners)||void 0===r||r.call(t)}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return Boolean(Lr.isReactElement(this._html)||""!==this._html&&"string"==typeof this.html&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`\n                <div class="b-tooltip-loading">\n                    <i class="b-icon b-icon-spinner"></i>\n                    ${e}\n                </div>\n            `)}showByTarget(e){var t;const n=this,{anchorToTarget:r}=n;n.mouseMoveRemover=null===(t=n.mouseMoveRemover)||void 0===t?void 0:t.call(n),n.showBy({[r?"target":"position"]:r?e:"mouse",overlap:!(r&&n.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.element.parentNode&&e.toFront(),e.mouseMoveRemover||!e.trackMouse&&!e.updateContentOnMouseMove||(e.mouseMoveRemover=Gn.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||0!=e.configuredAllowOver&&e.childItems.some((e=>e.isVisible&&!e.disabled&&e.focusElement)),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const n=this,r=e.relatedTarget;n.allowOver&&n.element.contains(r)||n.element.contains(e.target)&&null!==(t=n.activeTarget)&&void 0!==t&&t.contains(r)||n.activeTarget&&!n.activeTarget.contains(r)&&n.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;!1!==e.trigger("pointerOut")?(e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())):e.activeTarget=null}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.isVisible&&(t.afterShowByTarget(),!t.forElement||t.transitionEndDetacher||t._hidden||(t.transitionEndDetacher=Gn.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t})))}hide(){const e=this;if(e.abortDelayedShow(),e._hidden)return Za;{var t,n;e.abortDelayedHide();const r=super.hide(...arguments);return e.lastHidden=Date.now(),e.activeTarget=null,null===(t=e.mouseMoveRemover)||void 0===t||t.call(e),e.mouseMoveRemover=null,null===(n=e.transitionEndDetacher)||void 0===n||n.call(e),e.transitionEndDetacher=null,r}}abortDelayedShow(){const e=this;var t,n,r;e.hasTimeout("show")&&(null===(t=e.mouseDownRemover)||void 0===t||t.call(e),e.mouseDownRemover=null,e.clearTimeout("show"),null===(n=e.mouseMoveRemover)||void 0===n||n.call(e),e.mouseMoveRemover=null,null===(r=e.transitionEndDetacher)||void 0===r||r.call(e),e.transitionEndDetacher=null)}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;e.isConfiguring||e.isVisible||null==t||!t.targetOutOfView||(t.allowTargetOut||Lr.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this,n=(t.mouseOffsetX||1)*(t.rtl?-1:1),i=t.mouseOffsetY||1,o=Math.max(Math.min(n,5),0),s=Math.max(Math.min(i,5),0);if(!t.isVisible)return;let l;t.anchorToTarget||"mouse"!==e.position||(l=new _n(t.triggeredByEvent.pageX-r.scrollX,t.triggeredByEvent.pageY-r.scrollY),e.position=new _n(l.x+(n||1)-(n<0?t.width:0),l.y+(i||1)-(i<0?t.height:0))),!e||t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target)||e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e),l&&t.lastAlignSpec.result.inflate(s,o).contains(l)&&(t.lastAlignSpec.position="mouse",t.mouseOffsetY=-i,t.mouseOffsetX=-n,t.realign(),t.mouseOffsetY=i,t.mouseOffsetX=n)}changeHtml(e){const t=this;return m.isPromise(e)?(t.showAsyncMessage(),e.target=t.activeTarget,void e.then((n=>{e.target===t.activeTarget&&(t.html=n)}))):("object"!=typeof e&&(e=null!=e?t.optionalL(String(e)):""),e)}updateHtml(e,t){const n=this;let r=""===e;r||(super.updateHtml(e,t),n.hasContent?(n.isVisible&&n.realign(),m.isPromise(e)||n.trigger("innerHtmlUpdate",{value:e})):r=!0),r&&n.hide()}onMouseMove(e){const t=this,{forElement:n,activeTarget:r}=t,i=t.hasTimeout("hide"),o=e.target;if(t.triggeredByEvent=e,!t._hidden){let s;const l=!(null==r?void 0:r.contains(o))&&t.forSelector&&r&&!i&&o.nodeType===Node.ELEMENT_NODE&&!o.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(o)),a=null!=n&&n.document?n.document.documentElement:n,c=a&&(a.contains?a.contains(o):16&a.compareDocumentPosition(o));if(l&&(s=t.handleForElementOut()),s||!i||c){if(t.dismissDelay&&!i&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:r,event:e}]),!t.html))return void t.hide();t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onElementUserAction(e){this.internalOnPointerOver(e)}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t,n){var r,i;let o=null===(r=t.bryntum)||void 0===r||null===(i=r.tooltip)||void 0===i?void 0:i.get(ec);if(!o&&!n){var s;null!==(s=t.bryntum)&&void 0!==s&&s.tooltip||Yt.setPath(t,"bryntum.tooltip",new Map);const n=t.bryntum.tooltip;n.set(ec,!0),o=new ec({forElement:t,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isShared:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:e,target:t}){for(const t in e.resetCfg)"listeners"===t?e.un(e.resetCfg[t].set):"html"!==t&&(e[t]=e.resetCfg[t].was);e.resetCfg={};const n=ul.getById(t.id),r=(null==n?void 0:n.tipConfig)||e.gatherDataConfigs(t.dataset);if(n&&n.element!==t||!n&&t.matches(".b-widget")||null!=n&&n.disabled&&!n.showTooltipWhenDisabled)return!1;e.owner=n;for(const t in r)e.resetCfg[t]={set:r[t],was:e[t]},"listeners"===t?e.ion(r[t]):e[t]=r[t]},hide({source:e}){e.owner=null}},gatherDataConfigs(e){const t=this,n={};for(const r in e)if(r.startsWith("btip"))if(r.length>4){const i=A.uncapitalize(r.substr(4));if(i in t.getDefaultConfiguration()){const t=e[r];n[i]=Qa[t]?"true"===t:isNaN(t)?t:parseInt(t,10)}}else n.html=e[r];return n},filterTarget(e){const t=e.closest(this.forSelector);if(t)return t;if(ec.showOverflow&&e.closest(".b-widget"))for(;(null===(n=e)||void 0===n?void 0:n.nodeType)===Element.ELEMENT_NODE;){var n;if("ellipsis"===Lr.getStyleValue(e,"text-overflow")&&e.clientWidth<e.scrollWidth)return this.html=A.encodeHtml(e.textContent),e;e=e.parentNode}}}),Gn.on({element:t,mouseenter:e=>ec.currentOverElement=e.target,keydown:e=>ec.currentOverElement=e.target,capture:!0,thisObj:o}),n.set(ec,o)}return o}static encodeConfig(e){const t={};if("string"==typeof e)t.btip=e;else for(const n in e)t[`btip${"html"===n?"":A.capitalize(n)}`]=e[n];return t}}ec.initClass(),Object.defineProperty(ul,"tooltip",{get:()=>ec.getSharedTooltip(document.body,document.body)}),ul.Tooltip=ec,ec._$name="Tooltip";var tc=e=>class extends(e||fe){static $name="Labelable";static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return Boolean(this.label)}compose(){const{hasLabel:e,labelPosition:t}=this;return{class:{[`b-label-${t}`]:e,"b-has-label":e}}}changeLabel(e){return e||""}setupLabel(e){return Yt.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${e.align||"start"}`},e)}updateLabelWidth(e){this.labelElement&&(this.labelElement.style.flex=`0 0 ${Lr.setLength(e)}`,this.inputWrap.style.flexBasis=null==e?"":"auto")}get widgetClass(){}};class nc extends El{static $name="FieldContainer";static type="fieldcontainer";static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){return this.owner.inline??1===this.ensureItems().count}changeCollapsed(e){if(this.togglingCollapse)return this.togglingCollapse=!1,e;this.toggleCollapse(Boolean(e))}updateCollapsed(e){var t;this.collapser=null===(t=this.collapser)||void 0===t?void 0:t.destroy(),this.setCollapsedCls(e)}updateCollapser(e,t){t&&null==t.completed&&(t.reverting&&e||t.destroy()),this.setOwnerCls("b-collapsing",e)}get collapsing(){const{collapser:e}=this;return null!=e&&e.collapsed}get collapsingExpanding(){return null!=this.collapser}get expanding(){const{collapser:e}=this;return null!=e&&!e.collapsed}collapse(e){this.toggleCollapse(!0,e)}expand(e){this.toggleCollapse(!1,e)}setCollapsedCls(e){this.setOwnerCls("b-collapsed",e)}setOwnerCls(e,t){var n,r;null===(n=this.owner)||void 0===n||null===(r=n.element)||void 0===r||r.classList[t?"add":"remove"](e)}syncChildConfigs(){const e=this,{owner:t,syncableConfigs:n}=e;if(n){let r,i;for(r in n)i=n[r](t),e.eachWidget((e=>{e[r]=i}),!1)}t.afterSyncChildConfigs(e)}syncContainer(){const{inline:e,layout:t}=this;this.autoLayout&&(t.horizontal=e,t.justify=e?"center":"stretch")}toggleCollapse(e,t){const n=this,{animation:r,collapser:i,inline:o}=n,{containerWrapElement:s}=n.owner,l=t=>{t&&(n.element.style.height="",n.togglingCollapse=!0,n.collapsed=e,n.collapser=null)};if(null==e&&(e=!n.collapsed),!1!==t&&null!==t&&(s&&n.isVisible?(!0===t?t={}:"number"==typeof t&&(t={duration:t}),t=r||t?Yt.merge({},r,t):null):t=null),t){if(i&&e!==i.collapsed)n.collapser=i.revert({finalize:l}),n.collapser.collapsed=e;else if(!i&&e!==n.collapsed){!e&&n.setCollapsedCls(!1);const{element:r}=n,{height:i}=r.getBoundingClientRect(),a=o?1:i;!e&&n.setCollapsedCls(!0),r.style.height=`${i}px`,n.collapser=Pl.run(Yt.merge({finalize:l,element:s,[o?"opacity":"height"]:{from:e?a:0,to:e?0:a}},t)),n.collapser.collapsed=e}}else n.togglingCollapse=!0,n.collapsed=e}}nc.initClass(),nc._$name="FieldContainer";const rc=(e,t)=>(e.weight||0)-(t.weight||0),ic=(e,t)=>(t.weight||0)-(e.weight||0),oc=[],sc={align:!0,weight:!0};class lc extends(ul.mixin(xa,tc)){static $name="Field";static type="field";static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,n;const r=this,{triggers:i}=r,o=r.isPainted&&lc.getSharedErrorTooltip(r.rootElement,!0);if(null===(e=r.inputListenerRemover)||void 0===e||e.call(r),null===(t=r.keyListenerRemover)||void 0===t||t.call(r),null===(n=r.container)||void 0===n||n.destroy(),super.doDestroy(),i)for(const e of Object.values(i))e.destroy();(null==o?void 0:o.field)===r&&o.hide()}get childItems(){const{container:e,triggers:t}=this,n=t?Object.values(t):[];return e?[...n,...e.childItems]:n}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var n;let r=null===(n=e.bryntum)||void 0===n?void 0:n.errorTooltip;return r||t||(e.bryntum=e.bryntum||{},r=new ec({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const e=this,t=ul.fromElement(e.activeTarget);if(t){const n=t.getErrors();if(n)return e.html=n.join("<br>"),e.field=t,!0}return!1}}),e.bryntum.errorTooltip=r),r}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){const t=this;let n={};e&&(t._fieldKeyMap?Yt.assign(n,t._fieldKeyMap):(t._fieldKeyMap=e,Yt.assign(n,e)));for(const e in t.triggers){var r;null!==(r=t.triggers[e])&&void 0!==r&&r.keyMap&&(n=t.mergeKeyMaps(n,t.triggers[e].keyMap,e))}return n}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=Yt.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return lc}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:n,label:r,labels:i,labelCls:o,readOnly:s,triggers:l}=e,a=Yt.values(l,((e,t)=>!t)),c=a.filter((e=>"start"===e.align)).sort(rc),d=a.filter((e=>"start"!==e.align)).sort(ic),u=e.setupLabel.bind(e),h=[...c.map((e=>e.element)),...n,...d.map((e=>e.element))];return{class:{"b-has-start-trigger":c.length,"b-no-input":!n.length,"b-readonly":s,"b-field-container":Boolean(t),"b-field-container-inline":null==t?void 0:t.inline},children:[...(i||oc).filter((e=>e&&"end"!==e.align)).map(u),r?u({reference:"labelElement",class:`b-label b-align-start ${o||""}`,html:r}):null,h.length?{class:"b-field-inner",reference:"inputWrap",children:h}:null,...(i||oc).filter((e=>"end"===(null==e?void 0:e.align))).map(u),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:oc]}}updateElement(e,t){var n;const r=this,i=r.initialConfig.value,{input:o}=r;super.updateElement(e,t),null!=i&&(r.value=i),r.syncEmpty(),r.updateInputReadOnly(r.inputReadOnly),r.syncInvalid();const s=o||r.focusElement;null===(n=r.keyListenerRemover)||void 0===n||n.call(r),r.keyListenerRemover=s&&Gn.on({element:s,thisObj:r,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:n,inputCls:r,inputType:i,name:o}=this,s=Yt.assign({reference:"input",tag:"input",type:i,name:o||n,id:`${n}-input`,retainElement:!0},t);r&&(s.class=r);for(let t,n,r=e.length;r-- >0;)t=e[r],n=this[t],null!=n&&(s[t]=n);return s}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){const e=this.input;let t;try{t=[e.selectionStart,e.selectionEnd,e.selectionDirection]}catch(r){var n;t=(null===(n=e.value)||void 0===n?void 0:n.length)||0,t=[t,t]}return t}set textSelection(e){"number"==typeof e?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,n]=this.textSelection,r=this.input.value;return`${r.substr(0,t)}${e}${r.substr(n||t)}`}select(e,t){const n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;n.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:n,element:r}=this,i=null===(e=this.triggers)||void 0===e?void 0:e.clear,o=t&&n;r&&(i&&i[o?"hide":"show"](),r.classList.toggle("b-empty",o))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:n,hintHtml:r}=e,i=null==t?void 0:t.parentElement;if(t){let o=r||n;const s=e.hintElement||o&&(e.hintElement=Lr.createElement({parent:i,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));s&&("function"==typeof o&&(o=o({source:e,value:e.value})),s.firstChild[r?"innerHTML":"textContent"]=o||""),e.element.classList[o?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:t,element:n,inputWrap:r}=e;if(n.classList[t?"remove":"add"]("b-invalid"),t){const t=e.constructor.getSharedErrorTooltip(e.rootElement,!0);null!=t&&t.isVisible&&t.field===e&&t.hide()}else{const t=e.errorTip;t&&(e.containsFocus||e.isVisible&&r.contains(ec.currentOverElement))&&(t.activeTarget===r&&t.isVisible?t.onBeforeShow():(t.activeTarget=r,t.showBy(r)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||!1===this.editable}updateInputReadOnly(e){const t=this,{input:n,inputListenerRemover:r}=t;n&&(n.readOnly=e?"readOnly":null,e?t.inputListenerRemover=null==r?void 0:r():r||(t.inputListenerRemover=Gn.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return Boolean(e)}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&Yt.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const n=this,r=n.$triggers||(n.$triggers=new ca({configName:"triggers",factory:lc.Trigger,inferType:!1,owner:n,created(e){Te.after(e,"onConfigChange",((e,{name:t})=>{sc[t]&&n.onConfigChange({name:"triggers",value:r.target})}))},setup(e,t){e.reference=e.ref=t,e.parent=n}}));if(!1===n.stepTriggers&&(e.back||e.forward)&&(delete(e=Yt.assign({},e)).back,delete e.forward),r.update(e),n.element&&(n.keyMap=n.keyMap),!t)return r.target}updateInputWidth(e){this.input.style.width=Lr.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return null==this.value||""===this.value}get isEmptyInput(){return!this.input||null==this.input.value||""===this.input.value}get validity(){const e=this.input;return null==e?void 0:e.validity}async setValue(e){this.value=e}changeValue(e,t){return null==e&&(e=this.nullValue),this.hasChanged(t,e)?e:(""===e&&this.syncRequired(),t)}updateValue(e,t){const n=this;n.isConfiguring||(n.syncRequired(),n.inputting||n.triggerChange()),n.inputting||(n._lastValue=e),n.syncInputFieldValue(),n.overflowTwin&&!n._overflowTwinSync&&(n._overflowTwinSync=!0,n.overflowTwin.value=e,n._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:n,parent:r,inputValueAttr:i,inputValue:o}=t;if(n&&!t.inputting&&n[i]!==o&&(n[i]=o,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(n.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),r){const{assigningValues:t}=r;!0!==t&&!1!==(null==t?void 0:t.highlight)||(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return null==this.value?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=Boolean(this._isUserAction)){const n=this,{value:r,_lastValue:i,isValid:o}=n;n.syncHint(),n.triggerFieldChange({value:r,oldValue:i,event:e,userAction:t,valid:o}),"change"===n.defaultAction&&n.trigger("action",{value:r,oldValue:i,event:e,userAction:t,valid:o})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const n=this;n.validateOnInput||n.errorTip.hide(),n.inputting=!0,n.fetchInputValue(),n.inputting=!1,n.trigger("input",{value:n.value,event:e}),null===(t=n.changeOnKeyStroke)||void 0===t||t.call(n,e)}get needsInputSync(){return this.input[this.inputValueAttr]!==String(this.inputValue??"")}internalOnKeyEvent(e){const t=this,{value:n}=t;let r=!1;if("keydown"===e.type&&"Escape"===e.key&&!t.readOnly&&!t.disabled){const e=t.isValid,i="initialValue"in t?t.initialValue:t.valueOnFocus,o=t.hasChanged(i,n),{needsInputSync:s}=t;t.revertOnEscape&&(!e||o||s)&&(o&&(t.value=i),s&&t.syncInputFieldValue(!0),t.clearError(),r=(o||s)&&t.isValid||e!==t.validOnFocus)}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:n}=t;(n!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;t.isConfiguring||t.focusing||!t.required||!t.isEmpty||null!==(e=t.parent)&&void 0!==e&&e.isSettingValues?t.clearError("L{fieldRequired}",t.updatingInvalid):t.setError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,n){const r=this;if((r.errors||(r.errors={}))[r.optionalL(e)]=1,t||r.syncInvalid(),n){const t=()=>{r.clearError(e),n()},n=r.ion({keydown:t,focusOut:t})}}clearError(e,t){const n=this;n.errors&&(e?delete this.errors[this.optionalL(e)]:n.errors={}),t||n.syncInvalid()}getErrors(){const e=this;if(!e.isValid){var t;const n=e.validity,r=Yt.keys(n).find((e=>"valid"!==e&&"customError"!==e&&n[e])),i=e.errors&&Object.keys(e.errors);let o;if(o=null!=i&&i.length?i:n.customError?[e.input.validationMessage]:r?[e.L(r,{min:e.min,max:e.max})]:[e.L(e.invalidValueError)],(null===(t=o)||void 0===t?void 0:t.length)>0)return o}}createOverflowTwin(e){const t=this,n=super.createOverflowTwin(e);return n.ion({change({value:e}){t._overflowTwinSync=!0,t.value=e,t._overflowTwinSync=!1}}),n}get containerCollapsed(){var e;return null===(e=this.container)||void 0===e?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e)&&!("items"in e))&&(e={items:e});const n=this,r=e&&Yt.merge({owner:n,layout:"box"},n.containerDefaults),i=ul.reconfigure(t,e,{owner:n,defaults:r});if(!i||(i.autoLayout="box"===(null==r?void 0:r.layout),i!==t))return i;i.syncContainer()}onConfigChange(e){var t,n;super.onConfigChange(e),null!==(t=this.container)&&void 0!==t&&null!==(n=t.syncConfigTriggers)&&void 0!==n&&n[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const{container:n,containValues:r}=this,i=this.getValueName(t);n&&!1!==r?e&&"nested"===r?e&&i in e&&(e=Yt.clone(e[i]),super.assignValue({[i]:e&&!("value"in e)||e.value},t),e&&delete e.value,n.assignValue(e,t)):(super.assignValue(e,t),n.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,t){const n=this,{container:r,containValues:i,valueName:o}=n,s=typeof i;t=t??o in e,r&&!1!==i&&("nested"===i?t&&(e[o]={value:e[o],...r.values}):(!0===i||null==i&&t||"string"===s&&n[i]||"function"===s&&i(n))&&r.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}}lc.Trigger=class extends ul{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:lc.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:i}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:n}=t;n.disabled||n.readOnly||(e.key&&e.preventDefault(),!1!==n.trigger("trigger",{trigger:t})&&t.handler&&n.callback(t.handler,n,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&Lr.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((()=>t.editable=!0),500)),e.preventDefault(),Lr.getActiveElement(t.input)!==t.input&&t.focus()}},lc.SpinTrigger=class extends lc.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;null===(t=this.clickRepeater)||void 0===t||t.destroy(),this.clickRepeater=e?ci.new({element:this.element},e):null}onClick(e){const t=this,{field:n}=t;n.disabled||n.readOnly||(e.target===t.upButton?n.doSpinUp(e.shiftKey):e.target===t.downButton&&n.doSpinDown(e.shiftKey))}},lc.Trigger.initClass(),lc.SpinTrigger.initClass(),ul.register(lc.Trigger,"trigger"),ul.register(lc.SpinTrigger,"spintrigger"),lc._$name="Field";class ac extends lc{static $name="TextField";static type="textfield";static alias="text";static get configurable(){return{nullValue:""}}construct(e){"hidden"===(null==e?void 0:e.inputType)&&(e.hidden=!0),super.construct(...arguments)}}ac.initClass(),ac._$name="TextField";class cc extends ac{static $name="PickerField";static type="pickerfield";static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var e;null===(e=this.globalTapListener)||void 0===e||e.call(this),super.doDestroy()}changeEditable(e){return s.isMobile&&!0!==this.initialConfig.editable&&(e=!1),e}updateEditable(e){const t=this,{element:n,ariaElement:i,nonEditableClickTarget:o}=t,{expand:l}=t.triggers,a=r.matchMedia("(max-width: 410px)").matches;var c;(super.updateEditable(...arguments),n.classList.toggle("b-not-editable",!e),!1===e)?(s.isMobile&&a&&(null==l||l.hide()),i.removeAttribute("aria-autocomplete"),null===(c=t.globalTapListener)||void 0===c||c.call(t),Gn.on({element:o,click:e=>{const n=o.getRootNode().elementFromPoint(e.clientX,e.clientY);e.target===o&&n===o&&t.onTriggerClick(e)},thisObj:t})):(null==l||l.show(),i.setAttribute("aria-autocomplete","list"),t.globalTapListener=Rn.ion({globaltap:"showKeyboard",thisObj:t}))}get nonEditableClickTarget(){return this.input}updateElement(e,t){var n;const r=super.updateElement(e,t),i=this.peekConfig("picker"),o=!!i&&(i.isWidget?i.role:null===(n=this.constructor.resolveType(i.type))||void 0===n?void 0:n.$meta.config.role);return this.ariaHasPopup=o,r}changePicker(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const e=super.childItems;return this._picker&&e.push(this.picker),e}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(e){const t=this;t.pickerVisible&&t.picker.requestAnimationFrame(t.picker.realign,null,t.picker),super.onElementResize(e)}internalOnKeyEvent(e){const t=this;let n=!0;if("keydown"===e.type&&!t.disabled&&!e.shiftKey&&!e.ctrlKey)if(t.pickerVisible){const{picker:r}=t;"Escape"===e.key?(e.preventDefault(),e.stopImmediatePropagation(),t.hidePicker(),n=!1):r.onInternalKeyDown?r.onInternalKeyDown(e):"ArrowDown"===e.key&&r.focusable&&r.focus()}else"ArrowDown"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));n&&super.internalOnKeyEvent(e)}onFocusIn(e){const t=this;super.onFocusIn(e),t.autoExpand&&(t.minChars=0,t.onTriggerClick(e),t.ignoreTriggerClick=!0,t.setTimeout((()=>t.ignoreTriggerClick=!1),100))}onTriggerClick(e){this.disabled||this.togglePicker("key"in e)}showKeyboard({event:e}){const t=this.input;Lr.isTouchEvent&&Lr.getActiveElement(t)===t&&e.target===t&&(Rn.suspendFocusEvents(),t.blur(),t.focus(),Rn.resumeFocusEvents())}togglePicker(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}showPicker(e){const t=this,{picker:n}=t;t.pickerHideShowListenersAdded||(n.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),Lr.setAttributes(t.ariaElement,{"aria-controls":n.id,"aria-expanded":!0}),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}onPickerShow(){const e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=Rn.ion({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=Gn.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}onPickerHide(){var e,t;const n=this;n.ariaElement.setAttribute("aria-expanded",!1),n.pickerVisible=!1,n.element.classList.remove("b-open"),n.trigger("togglePicker",{show:!1}),null===(e=n.pickerTapOutRemover)||void 0===e||e.call(n),null===(t=n.pickerKeyDownRemover)||void 0===t||t.call(n)}onPickerTapOut({event:e}){this.containsFocus||this.owns(e.target)||this.autoClosePicker()}onPickerKeyDown(e){if("Tab"===e.key&&!this.picker.trapFocus){const t=Lr.getActiveElement(this.input),n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),Lr.getActiveElement(this.input)===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const e=this.input;Lr.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout((()=>e.readOnly=!1),500)),super.focus()}}cc._$name="PickerField";const dc=/>[ \t\r\n]+</g,uc=/\s\s+/g;class hc{static tpl(e,...t){let n=0,r=t.map(((t,r)=>{let o=e[r];return Array.isArray(t)?o+=t.reduce(((e,t)=>e+(("string"==typeof t?t.trim():t)+"\n")),""):(t===i&&(t=""),o+="string"==typeof t?t.trim():t),n++,o})).join("");return n<=e.length&&(r+=e[e.length-1]),r.replace(dc,"><").replace(uc," ").trim()}static docsTpl(e,...t){let n=0,r=t.map(((t,r)=>{let o=e[r];return Array.isArray(t)?o+=t.reduce(((e,t)=>e+(("string"==typeof t?t.trim():t)+"\n")),""):(t===i&&(t=""),o+="string"==typeof t?t.trim():t),n++,o})).join("");return n<=e.length&&(r+=e[e.length-1]),r.replace(dc,"><").trim()}static repeat(e){return function(...t){return hc.tpl(...t).repeat(e)}}static loop(e){}}hc._$name="TemplateHelper";class gc extends(fe.mixin(je,_i)){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:e}=this;if(this.target.contains(e))return e;this._activeItem=null}updateOwnerCmp(e){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),Lr.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(e){const{owner:t}=this;this._navigationEvent=t.navigationEvent=e,e&&Promise.resolve(1).then((()=>this.navigationEvent=null))}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(e){const t=(e.key||"").trim()||e.code;return`${e.ctrlKey?"CTRL+":""}${e.shiftKey?"SHIFT+":""}${e.altKey?"ALT+":""}${t}`}onKeyDown(e){const t=this,{ownerCmp:n,itemSelector:r,activeItem:i,itemsTabbable:o}=t,{target:s}=e,l=t.target.querySelector(r),a=(e.key||"").trim()||e.code,c=t.constructor.getComposedKeyName(e),d=s.matches(r)||s===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(e=t.processEvent.call(n,e)),e&&!t.disabled&&l&&t.target.offsetParent&&d){if(!o){if(null==t.inlineFlow){const e=l.parentNode,n=Lr.getStyleValue(l,"position"),r=Lr.getStyleValue(l,"display"),i=Lr.getStyleValue(l,"float");t.inlineFlow="absolute"===n||"inline"===r||"inline-block"===r||"left"===i||"right"===i||"flex"===Lr.getStyleValue(e,"display")&&"row"===Lr.getStyleValue(e,"flex-direction")}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=e,i)switch(a){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigateNext(e);break;default:{var u;const r=null===(u=t.keys)||void 0===u?void 0:u[c];if(r&&!t.disabled){if(!1===t.callback(r,t.thisObj||n,[e]))return}else n.onInternalKeyDown&&n.onInternalKeyDown(e);if(Lr.getActiveElement(s)!==s&&e.preventDefault(),o)return}}else{if(o)return;a!==t.nextKey&&a!==t.prevKey||(t.activeItem=t.getDefaultNavigationItem(e))}t.activeItem!==i&&t.triggerNavigate(e)}}getDefaultNavigationItem(e){const{target:t,itemSelector:n,prevKey:r,nextKey:i}=this;return 4&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector(`${n}:last-of-type`):2&t.compareDocumentPosition(e.target)&&e.key===i?t.querySelector(`${n}`):void 0}navigatePrevious(e){const t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((()=>{t.activeItem=n,t.triggerNavigate(e)}))}navigateNext(e){const t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((()=>{t.activeItem=n,t.triggerNavigate(e)}))}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(e=1,t=this.activeItem){const n=this.treeWalker;if(n.currentNode=t,n[e<0?"previousNode":"nextNode"](),n.currentNode!==this.activeItem)return n.currentNode}onTargetFocusIn(e){const t=this,{target:n,relatedTarget:r}=e,{owner:i,itemsTabbable:o,skipScrollIntoView:s,previousActiveItem:l}=t;if(!n.matches(".b-focus-trap"))if(n.matches(t.itemSelector))t.skipScrollIntoView=!0,t.activeItem=n,t.skipScrollIntoView=s,t.activeItem&&o&&t.triggerNavigate(e);else if(n===t.target){var a;if((r?n.compareDocumentPosition(r):0)&Node.DOCUMENT_POSITION_CONTAINED_BY)null===(a=i.previousSibling)||void 0===a||a.focus();else t.activeItem=l&&t.target.contains(l)?l:0}}onTargetFocusOut(e){const t=this,{relatedTarget:n}=e;null!=n&&n.matches(".b-focus-trap")||n&&t.target.contains(n)&&n.matches(t.itemSelector)||t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}onTargetMouseDown(e){const t=this,n=e.target.closest(t.itemSelector);t.navigationEvent=e,t.itemsTabbable?n===t.activeItem&&t.triggerNavigate(e):!1===t.ownerCmp.itemsFocusable?t.onFocusGesture(e):n&&(e.preventDefault(),Lr.focusWithoutScrolling(n))}onTargetClick(e){var t;const n=this,{skipScrollIntoView:r}=n;n.skipNextClick||null!==(t=n.navigationEvent)&&void 0!==t&&t.ignoreNavigation?n.skipNextClick=!1:n.disabled||(n.skipScrollIntoView=!0,n.processEvent&&(e=n.processEvent.call(n.ownerCmp,e)),e&&(n.activeItem=e.target.closest(n.itemSelector),n.triggerNavigate(e)),n.skipScrollIntoView=r)}onFocusGesture(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}acceptNode(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?Lr.NodeFilter.FILTER_ACCEPT:Lr.NodeFilter.FILTER_SKIP}changeActiveItem(e){return null!=e&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}updateActiveItem(e,t){const n=this,{ownerCmp:r}=n,i=t&&n.target.contains(t),o=e&&Lr.isFocusable(e)&&e!==Lr.getActiveElement(e);if(i&&(n.previousActiveItem=t),t&&(t.classList.remove(n.focusCls),t.removeAttribute("id")),null!=e){var s;if(n.skipScrollIntoView)o&&Lr.focusWithoutScrolling(e);else null===(s=r.scrollable)||void 0===s||s.scrollIntoView(e,{block:"nearest",focus:o,silent:n.scrollSilently});if(e===t&&i)return;e.classList.add(n.focusCls),e.id=`${n.owner.id}-active-descendant`,n._activeItem=e}else n._activeItem=null,t===Lr.getActiveElement(t)&&r.revertFocus()}updateTarget(e,t){const n=this,r={element:e,thisObj:n,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:n.itemSelector}};n.itemsTabbable||n.itemsFocusable||(r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(n,"acceptNode")||(n.acceptNode=n.acceptNode.bind(n),n.acceptNode.acceptNode=n.acceptNode),Gn.on(r),n.treeWalker=n.setupTreeWalker(e,Lr.NodeFilter.SHOW_ELEMENT,n.acceptNode),n.keyEventTarget||(n.keyEventTarget=e),(n.targetMutationMonitor=new MutationObserver(n.onTargetChildListChange.bind(n))).observe(e,{childList:!0,subtree:!0})}setupTreeWalker(e,t,n){return document.createTreeWalker(e,t,n)}onTargetChildListChange(){const e=this,{activeItem:t,datasetIdProperty:n}=e;var r;t&&(e.target.contains(t)?t.classList.contains(e.focusCls)||t.classList.add(e.focusCls):e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${A.hyphenate(n)}="${t.dataset[n]}"]`)||(null===(r=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))||void 0===r?void 0:r[t.dataset.index])||null)}changeKeyEventTarget(e){this._keyEventTarget=e,Gn.on({element:e,keydown:"onKeyDown",thisObj:this})}triggerNavigate(e,t=this.activeItem){var n;const r={event:e,item:t,oldItem:this.previousActiveItem};this.trigger("navigate",r),null===(n=this.ownerCmp)||void 0===n||n.trigger("navigate",r)}}gc._$name="Navigator";const pc=document.createRange();class mc extends ul{static $name="List";static type="list";static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,selectAllItem:!1,itemTpl(e){let t=A.encodeHtml(e.getValue(this.displayField));return null!=t&&""!==t||(t="&nbsp;"),t},getItemStyle:null,getItemCls:null,groupHeaderTpl(e,t){let n=A.encodeHtml(t);return null!=n&&""!==n||(n="&nbsp;"),`${this.allowGroupSelect?this.itemIconTpl(e):""}${n}`},allowGroupSelect:!0,selected:{$config:"nullify",value:{}},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(e,...t){var n;const r=this;Array.isArray(e)&&(e={items:e}),super.construct(e,...t);const{element:i}=r,{classList:o}=i;r.multiSelect&&o.add("b-multiselect"),null!==(n=r.store)&&void 0!==n&&n.count?r.refresh():o.add("b-empty"),Gn.on({element:i,delegate:r.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:r})}doDestroy(){var e;this.detachListeners("store"),null===(e=this.navigator)||void 0===e||e.destroy(),super.doDestroy()}onFocusIn(e){var t;this.restoreActiveItem(null===(t=e._target)||void 0===t?void 0:t.closest(this.itemSelector)),super.onFocusIn(e)}contentTpl(){const e=this,t=e.store.records.map(((t,n)=>e.itemWrapperTpl(t,n)));return e.multiSelect&&!1!==e.selectAllItem&&t.unshift(e.selectAllItemTpl()),hc.tpl`${t}`}itemWrapperTpl(e,t){const{selected:n,getItemStyle:r}=this,i=r?`style="${this.callback(r,this,[e])}"`:"";return hc.tpl`<li ${i} class="${this.getItemClasses(e,t)}" role="option" aria-selected="${n.includes(e)}" data-index="${t}" data-id="${A.encodeHtml(e.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(e,t)}</li>`}itemContentTpl(e,t){return"groupRowFor"in e.meta?this.groupHeaderTpl(e,A.capitalize(e.groupChildren[0][e.meta.groupField])):`${this.itemIconTpl(e,t)}${this.itemTpl(e,t)}`}itemIconTpl(e,t){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const e=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${e}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.L("selectAll")}</div></li>`}getItemClasses(e){var t;const n=this,{getItemCls:r}=n,i=null===(t=n._navigator)||void 0===t?void 0:t.activeItem,o=(null==i?void 0:i.dataset.id)==e.id,s="groupRowFor"in e.meta?"b-list-item-group-header":"",l=n.selected.includes(e)||e.isSpecialRow&&e.groupChildren.every((e=>n.selected.includes(e))),a=r?this.callback(r,this,[e]):"";return`${n.itemCls} ${e.cls||""} ${a} ${l?n.selectedCls:""} ${o?n.navigator.focusCls:""} ${s}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:e,action:t,records:n,record:r,changes:i}){const o=this,{selected:s}=o;switch(t){case"dataset":s.match(e.storage,!o._externallyOwnedSelection);break;case"remove":s.remove(n);break;case"clear":o.deselectAll();break;case"update":{const{id:e}=i;return e&&Lr.setAttributes(o.contentElement.querySelector(A.encodeAttributeSelector("data-id",e.oldValue)),{"data-id":e.value}),void o.refreshItem(r)}}o.refresh()}onStoreRefresh(){this.refresh()}refresh(){const e=this;if(e.isVisible){var t;const n=null===(t=e.navigator)||void 0===t?void 0:t.activeItem;e.paintListener=null;const r=Lr.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(r),n&&e.restoreActiveItem(n),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){const n=e.contentElement.querySelectorAll(`${e.itemSelector}:not(.b-mask)`);pc.setStartBefore(t),pc.setEndAfter(n[n.length-1]),pc.deleteContents()}else n?(pc.setStartAfter(n),pc.setEndAfter(n)):(pc.setStart(e.contentElement,0),pc.setEnd(e.contentElement,0));return pc}refreshItem(...e){for(const t of e){const e=this.getItem(t);if(e){const n=this.store.indexOf(t),r=Lr.createElementFromTemplate(this.itemWrapperTpl(t,n));Lr.sync(r,e)}}}getItem(e){var t;if(null!=e)return"number"==typeof e?this.contentElement.querySelector(`[data-index="${e<0?this.store.count+e:e}"]`):(e.nodeType===Element.ELEMENT_NODE&&(e=e.dataset.id),null!=(null===(t=e)||void 0===t?void 0:t.id)&&(e=e.id),this.contentElement.querySelector(A.encodeAttributeSelector("data-id",e)))}getRecordFromElement(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}updateItems(e){const t=this;t.store&&t.store.autoCreated&&t.store.destroy(),t.store=ts.getStore(e)}updateDisabled(e){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=e)}changeSelected(e,t){if(e){let t;e.isCollection?this._externallyOwnedSelection=!0:(Array.isArray(e)?(t=e,e={}):e.values&&(t=e.values,e={...e,values:[]}),e=new So(e)),e.ion({change:"onSelectionChange",thisObj:this}),this.initialSelection=t}else null==t||t.destroy();return e}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}get store(){return this.getConfig("items"),this._store}changeStore(e){const t=this;if(e instanceof ts||(Array.isArray(e)&&(e={data:e}),e=new ts(e)),t.detachListeners("store"),e){const n={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:t};e.readUrl&&(n.beforeLoad="onBeforeStoreLoad",n.afterRequest="onAfterStoreRequest"),e.isGrouped&&(t.element.classList.add("b-grouped"),n.groupchange="onStoreRefresh"),e.ion(n)}return e}updateStore(e){const{initialSelection:t}=this;Array.isArray(t)&&(e.count?(this.select(t),this.selected.count||this.onSelectionChange({action:"clear",removed:[]})):e.ion({refresh:()=>this.select(t),once:!0})),this.refresh()}changeNavigator(e,t){const n=this,{element:r}=n;var i;r&&((null===(i=e=gc.reconfigure(t,e?gc.mergeConfigs({ownerCmp:n,disabled:n.disabled,target:r,keyEventTarget:r},e):null,n))||void 0===i?void 0:i.keyEventTarget)!==r||n.itemsTabbable||(r.tabIndex=0));return e}get minAlignHeight(){const e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return e?Math.min(e.offsetTop+e.offsetHeight,t):0}alignTo(...e){super.minHeight=this.minAlignHeight,super.alignTo(...e)}hide(...e){return this.navigator&&(this.navigator.activeItem=null),super.hide(...e)}show(){const{refreshCount:e}=this,{previousActiveItem:t}=this.navigator;super.minHeight=this._minHeight;const n=super.show(...arguments);return this.refreshCount===e&&this.restoreActiveItem(t,!0),n}restoreActiveItem(e=this.navigator.previousActiveItem,t="nearest"){const n=this,{navigator:r,lastAlignSpec:i}=n;if(null!=e){if("string"!=typeof t){const e=i?i.zone:1;t=1&e?"nearest":e?"start":"end"}(e=n.getItem(e))&&!n.disabled&&(n.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}onMouseOver(e){const t=this,n=e.currentTarget;!Lr.isTouchEvent&&n&&t.navigator&&t.activateOnMouseover&&t.setTimeout({fn:"handleMouseOver",delay:30,args:[n],cancelOutstanding:!0})}handleMouseOver(e){this.navigator.activeItem=e}onClick(e){const t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}onInternalKeyDown(e){const t=this.navigator.activeItem;if(!this.disabled)switch(e.key){case" ":if("INPUT"===e.target.nodeName.toUpperCase()&&!e.target.readOnly)break;case"Enter":t&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}}onItemClick(e,t){const n=this,{allowGroupSelect:r}=n,i=parseInt(e.dataset.index),o=n.store.getAt(i),s=null==o?void 0:o.isSpecialRow;if(!n.disabled&&!1!==n.trigger("beforeItem",{item:e,record:o,index:i,event:t,userAction:!0})){if(n._isUserAction=!0,e.contains(t.target.closest("[data-select-all]")))n.onSelectAllClick(e,t);else if(o&&!e.contains(t.target.closest("[data-noselect]"))&&(!s||r)){const{selected:i}=n,{groupParent:l}=o.instanceMeta(this.store);if(n.multiSelect){let a=i.includes(o),c=o;if(n.toggleAllIfCtrlPressed&&t.ctrlKey?c=n.store.records:r&&s&&(a=!o.groupChildren.some((e=>!i.includes(e))),e.classList.toggle("b-selected",!a),c=o.groupChildren),i[a?"remove":"add"](c),!s&&l&&r){n.getItem(l).classList.toggle("b-selected",l.groupChildren.every((e=>i.includes(e))))}}else i.splice(0,i.count,o)}n.isDestroyed||(n.lastClicked=o,n.trigger("item",{item:e,record:o,index:i,event:t,userAction:!0}),n._isUserAction=!1)}}onSelectionChange({action:e,removed:t,added:n,replaced:r}){const i=this,{selectedCls:o,unselectedCls:s}=i;let l,a;if("clear"===e)for(a of i.element.querySelectorAll(`.${o}`))a.classList.remove(o),a.setAttribute("aria-selected",!1),s&&a.classList.remove(s);else if("replaceValues"!==e){for(l of t)a=i.getItem(l),a&&(a.classList.remove(o),a.setAttribute("aria-selected",!1));for(l of n)a=i.getItem(l),a&&(a.classList.add(o),a.setAttribute("aria-selected",!0))}i.selectAllItem&&i.updateSelectAllState()}onSelectAllClick(e){e.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var e;null===(e=this.element.querySelector(".b-select-all-item"))||void 0===e||e.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:e,store:t}=this;return e.count&&(t.isFiltered?t.records.every((t=>e.includes(t))):t.count===e.count)}selectAll(e){const t=this;!t.multiSelect&&e||(t.selected.add(t.store.records),e&&!t.navigator.activeItem&&(t.navigator.activeItem=t.getItem(-1)))}deselectAll(){this.selected.clear()}select(e){const{store:t}=this,{modelClass:n}=t;e=H.asArray(e).reduce(((e,r)=>((r=t.getById(n.asId(r)))&&e.push(r),e)),[]),this.selected.add(e)}deselect(e){const{modelClass:t}=this.store;e=H.asArray(e).reduce(((e,n)=>((n=this.selected.get(t.asId(n)))&&e.push(n),e)),[]),this.selected.remove(e)}}mc.initClass(),mc.prototype.navigatorClass=gc,mc._$name="List";class fc extends mc{static $name="ChipView";static type="chipview";static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(e,t){const n=this;return hc.tpl`${n.iconTpl?this.iconTpl(e):""}
            ${n.itemTpl(e,t)}
            ${n.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(e){const t=this;t.closable&&t.selected.count&&("Delete"===e.key||"Backspace"===e.key)?t.callback(t.closeHandler,t.owner,[t.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(e)}updateClosable(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!e),this.isConfiguring||this.refresh()}onClick(e){const t=this,n=e.target.closest(`.${t.itemCls}`);if(t.closable&&e.target.classList.contains("b-close-icon")){const e=t.store.getAt(parseInt(n.dataset.index));t.closeHandler?t.callback(t.closeHandler,t.owner,[[e]]):t.store.remove(e)}else super.onClick(e)}}fc.initClass(),fc._$name="ChipView";const vc="L{Field.fieldRequired}",bc="L{Field.validateFilter}";class yc extends cc{static $name="Combo";static type="combo";static alias="combobox,dropdown";static delayable={filterOnInput:0};static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:i,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:e=>e.map((e=>e.value)),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(e){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(e){this.usingRecordAsValue=null===e.valueField,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const e=this;Yt.hasOwn(e,"_value")||(e._value=e.valueField===e.displayField?"":null,e._lastValue=e._lastValue||e._value)}get childItems(){const{_chipView:e,_picker:t}=this,n=super.childItems;return e&&n.push(e),t&&n.push(t),n}get innerElements(){var e;const t=null===(e=this._chipView)||void 0===e?void 0:e.element,{input:n,inputElement:r}=this;return t&&Cs.sync({targetElement:n,domConfig:r}),[t||r]}updateInlinePicker(e){e&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(e){return!e||e instanceof ts||(e=new ts(ts.mergeConfigs({storage:this.valueCollection},e))),e}updateChipStore(e,t){null==t||t.destroy()}changeChipView(e,t){const n=this;if(n.element.classList[e?"add":"remove"]("b-uses-chipview"),e){const{input:r}=n;return n.chipStore||(n.chipStore={}),Cc.reconfigure(t,e,{defaults:{parent:n,insertBefore:r,store:n.chipStore,closable:!n.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:r}}})}null==t||t.destroy()}updateChipView(e){var t;const n=this;n._chipViewEventDetacher=null===(t=n._chipViewEventDetacher)||void 0===t?void 0:t.call(n),n.chipStore=null==e?void 0:e.store,e&&(e.element.appendChild(n.input),n._chipViewEventDetacher=Gn.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:n}))}updateMultiSelect(e,t){const n=this,{input:r,element:i}=n,o=!n.isConfiguring;let{value:s}=n;if(i.classList[e?"add":"remove"]("b-multiselect"),e){const{chipView:e}=n,{parentNode:t}=r,i=null==e?void 0:e.element;i&&i!==t&&(t.insertBefore(i,r),i.appendChild(r),n.chipView.refresh()),r.value="",o&&(s=H.asArray(s))}else{const e=n._chipView,{parentNode:t}=r,a=null==e?void 0:e.element;var l;if(a===t&&(a.parentNode.insertBefore(r,a),a.remove(),i.classList.remove("b-uses-chipview")),o&&"string"!=typeof s)s=null!==(l=s)&&void 0!==l&&l.length?s[0]:null}o&&(n.value=s)}onChipViewMousedown(e){e.preventDefault(),this.containsFocus||this.focus()}onChipClose(e,t={}){(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}updateFilterParamName(e){!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))}updateHideTrigger(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(e){this.filterOnInput.delay=e}updateReadOnly(e){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!e)}updateDisabled(e){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!e)}updateFilterOperator(e){this.primaryFilter&&(this.primaryFilter.operator=e)}get minChars(){const e=this._minChars;return null!=e?e:this.remoteFilter?4:1}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(e){e&&(this.items=e.call(this))}changeItems(e){var t;const n=this;if(null==e){if(n.store&&!n.store.isItemStore)return;e=[]}if(!n.buildItems||null!==(t=e)&&void 0!==t&&t.length||(e=n.buildItems()),e instanceof ts)return void(n.store=e);const r=n.displayField;let i,o,s=n.valueField;if(Array.isArray(e)?o=e.map((e=>{let t=e;return e instanceof io?(i=e.constructor,s||(n.valueField=s=i.idField)):"string"==typeof e||"number"==typeof e?(s||(n.valueField=s=n.displayField),t={[s]:e,[r]:e}):(s||(n.valueField=s="value"),Array.isArray(e)&&(t={[s]:e[0],[r]:e[1]})),e.selected&&(n.value=t),t})):(s||(n.valueField=s="value"),o=[],Object.entries(e).forEach((([e,t])=>{o.push({[s]:e,[r]:t})}))),n.store)n.store.data=o;else{const e=s===r?{name:"value",dataSource:r}:s;if(!i){class t extends io{static get idField(){return n.valueField}static set idField(e){super.idField=e}static get fields(){return[e,r]}}i=t}n.store=new ts({isItemStore:!0,data:o,idField:s,verifyNoGeneratedIds:!1,modelClass:i})}}get value(){const e=this,{valueCollection:t,valueField:n}=e;if(null==n)return e.multiSelect?t.values.slice():t.first;let r;return r=e.multiSelect?t.count?t.map((e=>e[n])):e._lastValue||[]:t.count?t.first[n]:e._lastValue,r}set value(e){super.value=e}get needsInputSync(){return!this.usesChipView&&!this.editable}changeValue(e,t){const n=this;if(e===t)return void n.syncInputFieldValue(!0);if(!n.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");var r;(n.triggerConfig("items"),n.inputting)||(null===(r=n._chipView)||void 0===r||r.selected.clear());n.store||(n.items=[]);const{valueField:i,displayField:o,store:s,valueCollection:l,_picker:a}=n,{storage:c}=s,d=n.hidePickerOnSelect??!n.multiSelect,u=n._isUserAction||(null==a?void 0:a._isUserAction)||d&&n.pickerVisible||!1;if(!n.remoteFilter&&s.isAjaxStore&&!s.count)return s.ion({load:()=>n.value=e,once:!0,thisObj:n}),void(n._lastValue=e);let h;if(null!=e){const r=Array.isArray(e),a=r?e.slice():[e];if(n.remoteFilter){if(null!=e){if(Yt.isObject(e)||e.isModel)n.store.data=[e],n.valueCollection.splice(0,n.valueCollection.count,n.store.first);else{const t=n.isConfiguring;n.primaryFilter.setConfig({value:e,disabled:!1}),s.performFilter(!0).then((()=>{if(n.isDestroyed)return;const{isConfiguring:e}=n;n.isConfiguring=t,l.splice(0,l.count,s.allRecords),n.isConfiguring=e}))}return}}else s.isFiltered&&(n.primaryFilter.disabled=!0,s.filter());for(let e=0,t=a.length;e<t;e++){let n=a[e];if(n instanceof io)c.includes(n,!0)||s.add(n);else{const r=Yt.isObject(n);r&&(n=n[s.modelClass.fieldMap[i].dataSource]),h=c.getBy(o,n)||c.getBy(i,n)||l.getBy(o,n)||l.getBy(i,n),h instanceof Set&&(h=[...h][0]),h?(r&&h.set(a[e]),a[e]=h):(a.splice(e,1),t--,e--)}}const d=!a.length,g=l.generation;l.splice(0,l.count,a),d&&(n._value=r&&0===e.length?null:e,n._lastValue=n._value),(d||l.generation===g)&&n.syncInputFieldValue(),n.syncEmpty(),d&&!n.isConfiguring&&n.triggerFieldChange({value:e,oldValue:t,userAction:u,valid:n.isValid})}else if(l.count)l.clear();else{const t=n._value;n._value=null,n.syncInputFieldValue(),n.syncEmpty(),n.isConfiguring||n.triggerFieldChange({value:e,oldValue:t,userAction:u,valid:n.isValid})}n._lastValue=n._value}hasChanged(e,t){return this.multiSelect?!Yt.isEqual(e,t):super.hasChanged(...arguments)}onComboStoreChange({action:e}){"filter"!==e&&this.syncInputFieldValue(!0)}syncInputFieldValue(e){var t;this.usesChipView?null===(t=this.chipView)||void 0===t||t.refresh():super.syncInputFieldValue(e)}get usesChipView(){return Boolean(this.multiSelect&&this._chipView)}get isEmpty(){return 0===this.valueCollection.count}get inputValue(){const e=this;let t=e.selected?e.selected[e.displayField]:e.value;return e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),null==t?"":t}get nonEditableClickTarget(){var e;return this.multiSelect&&(null===(e=this.chipView)||void 0===e?void 0:e.element)||super.nonEditableClickTarget}changeValueCollection(e,t){if(null==t||t.destroy(),e)return e.isCollection||(e=new So({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}changePrimaryFilter(e){return e.isCollectionFilter?e.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):("function"==typeof e&&(e={filterBy:e}),e=new co({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive,...e})),e}changeStore(e){const t=this,n=[],{valueCollection:r,keyStrokeFilterDelay:i,filterParamName:o}=t;if(Array.isArray(e))return void(t.items=e);let s;if(e){if(e.isStore){const r=e.filters.get("primary");t.remoteFilter&&(e.filterParamName=o),s=e.remoteFilter||e.restfulFilter,r?t.primaryFilter=r:n.push(t.primaryFilter)}else"string"==typeof e?e=ts.getStore(e):(e=new(e.readUrl?os:ts)(e),t.destroyStore=!0),s=t.remoteFilter||e.restfulFilter,s&&o&&(e.filterParamName=o,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),n.push(t.primaryFilter);if(t.valueField||t.usingRecordAsValue||(t.valueField=e.modelClass.idField),t.filterSelected){const i=e=>!t.containsFocus||!r.includes(e);s?(e.storage.autoFilter=!0,e.storage.addFilter({id:`${t.id}-selected-filter`,filterBy:i})):(n.push(i),e.reapplyFilterOnAdd=!0)}r.addIndex({property:t.displayField,unique:!1}),r.addIndex({property:t.valueField,unique:!0}),n.forEach((t=>e.addFilter(t,!0))),t.keyStrokeFilterDelay=s?Math.max(300,i||0):i??10}return e}updateStore(e,t){const n=this,{_picker:r}=n;let i;n.destroyStore&&t&&t.destroy(),r&&(r.store=e),e.storage.addIndex({property:n.displayField,unique:!1}),e.storage.addIndex({property:n.valueField,unique:!0}),i={filter:"onStoreFilter"},n.displayValueRenderer&&((i||(i={})).change="onComboStoreChange"),n.detachListeners("store"),(null==e?void 0:e.storage)&&n.valueCollection.match(e.storage),n.syncInputFieldValue(),i&&(i.name="store",i.thisObj=n,e.ion(i))}get remoteFilter(){var e;return Boolean(this.filterParamName||(null===(e=this._store)||void 0===e?void 0:e.restfulFilter))}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:e}=this;return this.multiSelect?this.valueCollection.values.slice().sort(((t,n)=>e.indexOf(t)-e.indexOf(n)))[0]:this.valueCollection.first}onEditComplete(){const e=this,t=e.valueCollection.count;super.onEditComplete(),t&&(e.clearError(bc),e.syncInputFieldValue()),e.required&&!t&&e.setError(vc)}onTriggerClick(e){const t=this,n="key"in e;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter))if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled){var r;switch(null===(r=t.triggerAction)||void 0===r?void 0:r.toLowerCase()){case"all":t.doFilter(null,n);break;case"last":t.doFilter(t.lastQuery,n);break;default:t.doFilter(t.input.value,n)}}}internalOnInput(e){const t=this;t.syncEmpty(),t.syncInputWidth(),t.filterOnInput(e),t.trigger("input",{value:t.input.value,event:e})}filterOnInput(e){const t=this,{value:n}="input"===e.type?e.target:t.input,r=n.length;t.inputting=!0,t.inlinePicker||r>=t.minChars&&(!t.filterOnEnter||"Enter"===e.key)?t.doFilter(n):(t.validateFilter&&!t.remoteFilter&&t[r?"setError":"clearError"](bc),t.hidePicker()),t.inputting=!1}syncInputWidth(){const e=this;if(e.usesChipView){const t=e.input,n=e._inputPadding||(e._inputPadding=Lr.getEdgeSize(t,"padding","lr")),r=t.value||"",i=Lr.measureText(r+"W",t,!1,e.element)+n.width;t.style.flex=`1 1 ${Math.ceil(i)}px`}}doFilter(e,t){var n;const r=this,{store:i,picker:o}=r,s=null==e||""===e;r.lastQuery=e,r.primaryFilter.setConfig({value:e,disabled:s}),r.remoteFilter&&i.clear(!0);const l=()=>{const{navigator:e,isVisible:t}=o;i.count?!s&&e&&(e.activeItem=0):r.remoteFilter||s||(e&&(e.activeItem=null),r.validateFilter&&r.setError(bc)),t&&o.realign()};null===(n=r.filterPromise=i.filter())||void 0===n||n.then((()=>{r.filterPromise=null,l()})),r.inlinePicker||(null!=o&&o.isVisible?0===o.lastAlignSpec.zone&&o.realign():r.showPicker(t)),r.filterPromise||l()}onStoreFilter({source:e}){const t=this,n=t._picker,r=null==n?void 0:n.element.dataset,{count:i}=e;t.remoteFilter&&(i?n&&(n.navigator.activeItem=0):t.validateFilter&&t.setError(bc),t.filterSelected&&t.valueCollection.count&&(e.storage.onFiltersChanged({action:"splice",oldCount:1}),n&&n.refresh())),r&&(t.createOnUnmatched&&!i?r.addNewValue=t.L("L{addNewValue}")(t.primaryFilter.value):null==r||delete r.addNewValue)}onValueCollectionChange({source:e}){const t=this,{multiSelect:n,_picker:r}=t,i=t.hidePickerOnSelect??!n,o=n?e.values.slice():e.first,s=e.values.slice(),l=t._isUserAction||(null==r?void 0:r._isUserAction)||i&&t.pickerVisible||!1,a=t._value;i&&t.hidePicker(),!e.count&&t.required?t.setError(vc):(t.clearError(vc),t.clearError(bc)),t.validateFilter&&o&&t.clearError(bc),t.filterSelected&&(t.remoteFilter?(t.store.storage.onFiltersChanged({action:"splice",oldCount:1}),t._picker&&t._picker.refresh()):t.store.filter()),t._value=null,t._lastValue=null;const c=t.cacheCurrentValue(t.value);var d;(t.syncInputFieldValue(),t.syncEmpty(),t.isConfiguring)||(t.triggerFieldChange({value:c,oldValue:a,userAction:l,valid:t.isValid}),null===(d=t.trigger)||void 0===d||d.call(t,"select",{record:o,records:s,userAction:l}),"select"===t.defaultAction&&t.trigger("action",{value:c,record:o,records:s,userAction:l}))}cacheCurrentValue(e){return this._value=e}onValueCollectionNoChange({toAdd:e}){!this.inlinePicker&&!this.multiSelect&&e.length&&this.pickerVisible&&(this.picker.hide(),this.syncInputFieldValue())}showPicker(){const e=this,{picker:t}=e;if(!e.readOnly&&!e.inlinePicker){var n;if(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem)if(e.multiSelect)t.restoreActiveItem((null===(n=t.navigator)||void 0===n?void 0:n.previousActiveItem)||e.selected||0,!0);else t.restoreActiveItem(e.selected||0,!0);e.input.focus()}}changePicker(e,t){if(e){var n;const r=this,o=r.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width),s=mc.mergeConfigs({owner:r,store:r.store,selected:r.valueCollection,multiSelect:r.multiSelect,cls:r.listCls,displayField:r.displayField,forElement:r[r.pickerAlignElement],align:{matchSize:null==o,anchor:r.overlayAnchor,target:r[r.pickerAlignElement],minHeight:r.inlinePicker?null:40*Math.min(3,r.store.count)},[r.listItemTpl?"itemTpl":i]:r.listItemTpl,width:o,navigator:{keyEventTarget:r.input}},e);r.inlinePicker&&Object.assign(s,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:r.element}),(e=mc.reconfigure(t,e?s:null,r)).element.classList.add("b-combo-picker"),e.element.dataset.emptyText=r.emptyText?r.L(r.emptyText):r.L("L{noResults}"),e.ion({navigate:"onPickerNavigate",thisObj:r}),Gn.on({element:e.element,pointerdown:e=>r.onPickerNavigate({event:e}),thisObj:r})}else null==t||t.destroy();return e}onPickerNavigate({event:e}){e.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const e=this;super.onPickerHide(),e.multiSelect&&e.clearTextOnPickerHide&&(e.input.value="")}async internalOnKeyEvent(e){const t=this,n=t.input[t.inputValueAttr],r=n.length,{key:i}=e,{store:o,_picker:s,multiSelect:l}=t;if("keydown"===e.type&&null!=s&&s.isVisible&&s.navigator){const{activeItem:r}=s.navigator;if(r&&l&&i===t.multiValueSeparator)return t.input.value="",t.primaryFilter.setConfig({value:"",disabled:!0}),o.filter(),s.onItemClick(r,e),s.hide(),void e.preventDefault();if(!r&&t.createOnUnmatched&&(l&&i===t.multiValueSeparator||"Enter"===i))return e.preventDefault(),void await t.addNewRecord(n)}super.internalOnKeyEvent(...arguments),"keydown"===e.type&&"Enter"===i&&t.filterOnEnter&&r>=t.minChars&&(e.stopPropagation(),t.filterOnInput.now(e))}async addNewRecord(e){const t=this,{store:n,_picker:r,valueCollection:i,multiSelect:o,primaryFilter:s}=t,l=n.remoteFilter&&n.autoCommit;t.filterPromise&&await t.filterPromise,l||(s.setConfig({value:"",disabled:!0}),n.filter());const[a]=n.add(t.callback(t.createOnUnmatched,t,[e,t]));if(n.isCommitting){let e;try{await n.commitPromise}catch(t){var c,d;e=null===(c=t.response)||void 0===c||null===(d=c.parsedJson)||void 0===d?void 0:d.error}a.isPhantom&&(t.clearError(),t.setError(e||"L{Combo.recordNotCommitted}",!1,!0),n.remove(a),n.removed.remove(a))}l&&(s.setConfig({value:"",disabled:!0}),n.filter()),t.input.value="",n.includes(a)&&i.splice(o?i.count:0,o?0:i.count,a),null==r||r.hide()}changeCreateOnUnmatched(e){return!0===e&&(e=this.defaultRecordCreater),e}defaultRecordCreater(e){return this.store.createRecord({[this.displayField]:e})}updateLocalization(){super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:n}=e;if(!0===e.localizeDisplayFields){n||(e.localizedDisplayFieldsMap=n=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const i of e.items)if(i.id){var r;let o=n.get(i.id);!o&&null!==(r=i[t])&&void 0!==r&&r.startsWith("L{")&&(o=i[t],n.set(i.id,o)),o&&(i[t]=e.L(o))}e.syncInputFieldValue()}}}class Cc extends fc{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(e){return A.encodeHtml(e.getValue(this.owner.displayField))},scrollable:{overflowY:"auto"}}}}yc.initClass(),Cc.initClass(),class extends gc{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(e){const t=this,n=e.target.closest(t.itemSelector);n&&!e.target.classList.contains("b-close-icon")&&(e.shiftKey||n.contains(e.target.closest("[data-noselect]"))||t.ownerCmp.selected.clear(),t.inClickHandler=!0,t.activeItem=n,t.inClickHandler=!1)}onKeyDown(e){"Enter"===e.key||e.target.selectionStart||e.target.selectionEnd||super.onKeyDown(e)}updateActiveItem(e,t){const n=this.ownerCmp;super.updateActiveItem(e,t),e&&!this.inClickHandler&&n.selected.add(n.getRecordFromElement(e))}navigatePrevious(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?super.navigatePrevious(e):this.activeItem=null}navigateNext(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?super.navigateNext(e):this.activeItem=null}}.initClass(),yc._$name="Combo";N.apply(class{static get target(){return{class:yc}}changePicker(e,t){const n=this._overridden.changePicker.call(this,e,t);return null==n||n.element.setAttribute("tabindex","-1"),n}});const wc=wn.prototype.process;wn.prototype.process=function(e,t){return t=t.map((e=>{if("object"==typeof e&&"DOMTokenList"===e.constructor.name){const t={};return Array.from(e).forEach((e=>t[e]=1)),t}return e})),wc.call(this,e,t)};N.apply(class{static get target(){return{class:Lr}}static getActiveElement(e){var t,n,r;return null!==(t=e)&&void 0!==t&&t.isWidget&&(e=e.element),null===(n=e)||void 0===n||null===(r=n.getRootNode)||void 0===r?void 0:r.call(n).activeElement}});N.apply(class{static get target(){return{class:Lr}}static elementFromPoint(e,t){return document.elementsFromPoint(e,t)[0]}});N.apply(class{static get target(){return{class:Lr}}static getCommonAncestor(e,t){let n=this._overridden.getCommonAncestor.call(this,e,t);return null!=n&&n.isConnected&&!n.parentElement&&(n=n.firstChild),n}});N.apply(class{static target={class:Lr};static getViewportIntersection(e,t,n){const{parentNode:r}=e,{parentElement:i}=r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,o=i.ownerDocument.defaultView.getComputedStyle(i),s="visible"!==o.overflowX||"visible"!==o.overflowY,l=(a=e).ownerSVGElement?a.ownerSVGElement.parentNode:a.offsetParent;var a;let c=bn.from(e,null,!0);for(let r=s?e.parentNode:l;c&&r&&r!==document.documentElement;r=r.parentNode){for(;r&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE;){var d;r=null===(d=r.host)||void 0===d?void 0:d.parentNode}if(!r)break;const e=r===document.body,i=r.ownerDocument.defaultView.getComputedStyle(r),o=e?t:bn.inner(r,null,!0);(e||"visible"!==i.overflow)&&(c=o[n](c,!1,!0))}return c}});const xc=e=>{const t=e.ownerDocument.defaultView.getComputedStyle(e);return"none"!==t.getPropertyValue("display")&&"hidden"!==t.getPropertyValue("visibility")};N.apply(class{static get target(){return{class:Lr}}static isVisible(e){const t=e.ownerDocument;for(;e;e=(n=e).parentNode||n.host){if(e===t)return!0;if(e.nodeType===Element.ELEMENT_NODE&&!xc(e))return!1;if(!e.parentNode&&e.isConnected)return!0}var n;return!1}});var Sc=e=>class extends(e||fe){static get $name(){return"DragHelperContainer"}initContainerDrag(){const e=this;if(e.mode||(e.mode="container"),"container"===e.mode&&!e.containers)throw new Error("Container drag mode must specify containers")}grabContainerDrag(e){const t=this;if(!t.ignoreSelector||!e.target.closest(t.ignoreSelector)){const n=Lr.getAncestor(e.target,t.containers,t.outerElement);if(n){const r=n.getBoundingClientRect();t.context={element:n,valid:!0,action:"container",offsetX:e.pageX-r.left,offsetY:e.pageY-r.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}startContainerDrag(e){var t;const n=this,{context:r,floatRootOwner:i}=n,{element:o}=r,s=o.cloneNode(!0),l=null==i?void 0:i.element.closest(".b-outer");s.classList.add(n.dragProxyCls,n.draggingCls),((null==i?void 0:i.floatRoot)||Lr.getRootElement(o)).appendChild(s),r.dragProxy=s,r.dragging=o,o.classList.add(n.dropPlaceholderCls),null!=l&&null!==(t=l.parentElement)&&void 0!==t&&t.matches(".b-float-root")&&(s.style.zIndex=i.floatRootMaxZIndex+1)}onContainerDragStarted(e){const{context:t}=this,{element:n,dragProxy:r}=t,i=n.getBoundingClientRect();if(this.autoSizeClonedTarget)r.style.width=i.width+"px",r.style.height=i.height+"px",Lr.setTranslateXY(t.dragProxy,i.left,i.top);else{const n=r.getBoundingClientRect();Object.assign(t,{offsetX:n.width/2,offsetY:n.height/2}),Lr.setTranslateXY(r,e.clientX,e.clientY)}}updateContainerDrag(e){var t;const n=this,{context:r}=n;if(!r.started||!r.targetElement)return;const i=Lr.getAncestor(r.targetElement,n.containers,"b-gridbase"),o=null===(t=r.dragging)||void 0===t?void 0:t.contains(Lr.getActiveElement(r.dragging));i&&Lr.isDescendant(r.element,i)||(o&&Rn.suspendFocusEvents(),i&&r.valid?n.moveNextTo(i,e):n.revertPosition(),o&&Rn.resumeFocusEvents(),e.preventDefault())}finishContainerDrag(e){const t=this,{context:n}=t,{dragging:r,dragProxy:i,valid:o,draggedTo:s,insertBefore:l,originalPosition:a}=n;r&&(n.valid=Boolean(o&&(s||t.externalDropTargetSelector&&e.target.closest(t.externalDropTargetSelector))&&(r!==l||a.parent!==s)),n.finalize=(e=n.valid)=>{!e&&t.context&&t.revertPosition(),r.classList.remove(t.dropPlaceholderCls),i.remove(),t.reset()},n.async=!1,t.trigger("drop",{context:n,event:e}),n.async||n.finalize())}abortContainerDrag(e=!1,t=null,n=!1){const r=this,{context:i}=r;i.dragging&&(i.dragging.classList.remove(r.dropPlaceholderCls),i.dragProxy.remove(),r.revertPosition()),n||r.trigger(e?"drop":"abort",{context:i,event:t}),r.reset()}updateContainerProxy(e){const t=this,{context:n}=t,r=n.dragProxy;let i,o=e.pageX-n.offsetX,s=e.pageY-n.offsetY;if("number"==typeof t.minX&&(o=Math.max(t.minX,o)),"number"==typeof t.maxX&&(o=Math.min(t.maxX-r.offsetWidth,o)),"number"==typeof t.minY&&(s=Math.max(t.minY,s)),"number"==typeof t.maxY&&(s=Math.min(t.maxY-r.offsetHeight,s)),t.lockX?Lr.setTranslateY(r,s):t.lockY?Lr.setTranslateX(r,o):Lr.setTranslateXY(r,o,s),"touchmove"===e.type){const t=e.changedTouches[0];i=Lr.elementFromPoint(t.clientX,t.clientY)}else i=e.target;n.targetElement=i}moveNextTo(e,t){const{context:n}=this,r=n.dragging,i=e.parentElement;if(e!==r){const o=bn.from(e).center.x;this.isRTL&&t.pageX>o||!this.isRTL&&t.pageX<o?(i.insertBefore(r,e),n.insertBefore=e):e.nextElementSibling?e.nextElementSibling!==r?(n.insertBefore=e.nextElementSibling,i.insertBefore(r,e.nextElementSibling)):n.insertBefore||r.parentElement.lastElementChild===r||(n.insertBefore=e.nextElementSibling):(i.appendChild(r),n.insertBefore=null),n.draggedTo=i}}revertPosition(){const{context:e}=this,{dragging:t}=e,{parent:n,next:r}=e.originalPosition;if(r){r.previousSibling===t||!r&&t===n.lastChild||n.insertBefore(t,r)}else n.appendChild(t);e.draggedTo=null}};const Ec={pageXOffset:0,pageYOffset:0};var Rc=e=>class extends(ai(e||fe)){static get $name(){return"DragHelperTranslate"}static get configurable(){return{positioning:null,skipUpdatingElement:null}}initTranslateDrag(){const e=this;!e.isElementDraggable&&e.targetSelector&&(e.isElementDraggable=t=>t.closest(e.targetSelector))}grabTranslateDrag(e){const t=this.getTarget(e);return!!t&&(this.context={valid:!0,element:t,startPageX:e.pageX,startPageY:e.pageY,startClientX:e.clientX,startClientY:e.clientY},!0)}getTarget(e){return e.target.closest(this.targetSelector)}getX(e){return"absolute"===this.positioning?parseFloat(e.style.left,10):Lr.getTranslateX(e)}getY(e){return"absolute"===this.positioning?parseFloat(e.style.top,10):Lr.getTranslateY(e)}getXY(e){return"absolute"===this.positioning?[e.offsetLeft,e.offsetTop]:Lr.getTranslateXY(e)}setXY(e,t,n){this.skipUpdatingElement||("absolute"===this.positioning?(e.style.left=t+"px",e.style.top=n+"px"):Lr.setTranslateXY(e,t,n))}startTranslateDrag(e){const t=this,{context:n,outerElement:r,proxySelector:i}=t,o=t.dragWithin=t.dragWithin||t.cloneTarget&&document.body;let s=n.dragProxy||n.element;const l=s,a=s.parentElement;if(t.cloneTarget){const r=i?s.querySelector(i):s,{width:a,height:c,x:d,y:u}=bn.from(r,bn.outer(o));s=t.createProxy(s);let h=d,g=u;if(t.autoSizeClonedTarget&&(s.style.width=`${a}px`,s.style.height=`${c}px`),s.classList.add(t.dragProxyCls,t.draggingCls),s.classList.remove("b-hover","b-selected","b-focused"),o.appendChild(s),!t.autoSizeClonedTarget||i){const t=s.getBoundingClientRect(),{x:r,y:i}=o.getBoundingClientRect(),l=e.clientX-r,a=e.clientY-i+(o!==document.body?document.body.getBoundingClientRect().y:0);h=l-t.width/2,g=a-t.height/2,n.startPageX=e.pageX,n.startPageY=e.pageY}t.setXY(s,h,g),l.classList.add("b-drag-original"),t.hideOriginalElement&&l.classList.add("b-hidden")}s.classList.add(t.draggingCls),Object.assign(n,{element:s,grabbed:l,grabbedParent:a,grabbedNextSibling:s.nextElementSibling,elementStartX:t.getX(s),elementStartY:t.getY(s),elementX:Lr.getOffsetX(s,o||r),elementY:Lr.getOffsetY(s,o||r),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!t.cloneTarget||o===r}),o&&(n.parentElement=s.parentElement,o!==s.parentElement&&o.appendChild(s),t.updateTranslateProxy(e))}onTranslateDragStarted(){var e;const t=this,{context:n}=t;let{relatedElements:r}=n;if(t.unifiedProxy&&n.element.classList.add("b-drag-main","b-drag-unified-proxy"),(null===(e=r)||void 0===e?void 0:e.length)>0){n.relatedElStartPos=[],n.relatedElDragFromPos=[];const{proxySelector:e}=t;let[i,o]=[n.elementStartX,n.elementStartY];n.originalRelatedElements=r,r=n.relatedElements=r.map(((r,s)=>{const l=e?r.querySelector(e):r,{x:a,y:c,width:d,height:u}=bn.from(l,t.dragWithin),h=t.cloneTarget?t.createProxy(r):r;return h.classList.add(t.draggingCls),h.classList.remove("b-hover","b-selected","b-focused"),t.cloneTarget&&(t.setXY(h,a,c),t.dragWithin.appendChild(h),h.classList.add(t.dragProxyCls),t.autoSizeClonedTarget&&(h.style.width=`${d}px`,h.style.height=`${u}px`),t.hideOriginalElement&&r.classList.add("b-hidden"),r.classList.add("b-drag-original")),n.relatedElStartPos[s]=n.relatedElDragFromPos[s]=t.getXY(h),t.unifiedProxy&&(h.classList.add("b-drag-unified-animation","b-drag-unified-proxy"),i+=t.unifiedOffset,o+=t.unifiedOffset,t.setXY(h,i,o),n.relatedElDragFromPos[s]=[i,o],h.style.zIndex=100-s),h})),t.unifiedProxy&&r&&r.length>0&&Gn.onTransitionEnd({element:r[0],property:"transform",handler(){r.forEach((e=>e.classList.remove("b-drag-unified-animation")))},thisObj:t,once:!0})}}applyConstraints(e,t,n){const i=this,{constrain:o,dragWithin:s}=i,{pageXOffset:l,pageYOffset:a}=s===document.body?r:Ec;return s&&o&&(t<0&&(t=0),t+e.offsetWidth>s.scrollWidth&&(t=s.scrollWidth-e.offsetWidth),n<0&&(n=0),n+e.offsetHeight>s.scrollHeight&&(n=s.scrollHeight-e.offsetHeight)),"number"==typeof i.minX&&(t=Math.max(i.minX+l,t)),"number"==typeof i.maxX&&(t=Math.min(i.maxX+l,t)),"number"==typeof i.minY&&(n=Math.max(i.minY+a,n)),"number"==typeof i.maxY&&(n=Math.min(i.maxY+a,n)),{constrainedX:t,constrainedY:n}}updateTranslateProxy(e,t){const n=this,{lockX:r,lockY:o,context:s}=n,l=s.dragProxy||s.element,{relatedElements:a,relatedElDragFromPos:c}=s;s.scrollManagerElementContainsDragProxy&&t&&(s.scrollX=t.getRelativeLeftScroll(l),s.scrollY=t.getRelativeTopScroll(l)),s.pageX=e.pageX,s.pageY=e.pageY,s.clientX=e.clientX,s.clientY=e.clientY;let d=s.elementStartX+e.pageX-s.startPageX+s.scrollX,u=s.elementStartY+e.pageY-s.startPageY+s.scrollY;if(n.snapCoordinates){const e=n.snapCoordinates({element:l,newX:d,newY:u});d=e.x,u=e.y}const{constrainedX:h,constrainedY:g}=n.applyConstraints(l,d,u);if((s.started||h!==d||g!==u)&&n.setXY(l,r?i:h,o?i:g),a){const e=r?0:h-s.elementStartX,t=o?0:g-s.elementStartY;a.forEach(((r,i)=>{const[o,s]=c[i];n.setXY(r,o+e,s+t)}))}s.newX=h,s.newY=g}async finishTranslateDrag(e){const t=this,n=t.context,{target:r}=e,i=!t.lockX&&Math.round(n.newX)!==Math.round(n.elementStartX),o=!t.lockY&&Math.round(n.newY)!==Math.round(n.elementStartY),s=n.dragProxy||n.element,{relatedElements:l}=n;if(!t.ignoreSamePositionDrop||i||o)if(!1===n.valid)await t.abortTranslateDrag(!0,e);else{const i=!t.allowDropOutside&&bn.from(t.dragWithin||t.outerElement);i&&("number"!=typeof t.minX&&!0!==t.minX&&e.pageX<i.left||"number"!=typeof t.maxX&&!0!==t.maxX&&e.pageX>i.right||"number"!=typeof t.minY&&!0!==t.minY&&e.pageY<i.top||"number"!=typeof t.maxY&&!0!==t.maxY&&e.pageY>i.bottom)?await t.abortTranslateDrag(!0,e):(n.finalize=async(i=n.valid)=>{n.finalized?console.warn("DragHelper: Finalizing already finalized drag"):(n.finalized=!0,!i&&t.context&&await t.abortTranslateDrag(!0,null,!0),t.isDestroyed||(t.trigger("dropFinalized",{context:n,event:e,target:r}),t.reset()),t.cloneTarget||s.parentElement===n.grabbedParent||[s,...l||[]].forEach((e=>e.style.transform="")))},n.async=!1,await t.trigger("drop",{context:n,event:e,target:r}),n.async||await n.finalize())}else t.abortTranslateDrag(!1,e)}async abortTranslateDrag(e=!1,t=null,n=!1){var r,i;const o=this,{cloneTarget:s,context:l,proxySelector:a,dragWithin:c,draggingCls:d}=o,{relatedElements:u,relatedElStartPos:h,grabbed:g}=l,p=l.dragProxy||l.element;if(l.valid=!1,null===(r=o.scrollManager)||void 0===r||r.stopMonitoring(),l.aborted)return void console.warn("DragHelper: Aborting already aborted drag");let{elementStartX:m,elementStartY:f}=l;const v=m!==o.getX(p)||f!==o.getY(p);if(p&&l.started){if(!s&&c&&c!==l.grabbedParent&&l.grabbedParent.insertBefore(p,l.grabbedNextSibling),s&&a){const e=g.querySelector(a)||g,{x:t,y:n}=bn.from(e);m=t,f=n}p.classList.add("b-aborting"),o.setXY(p,m,f),null==u||u.forEach(((e,t)=>{e.classList.remove(d),e.classList.add("b-aborting"),o.setXY(e,h[t][0],h[t][1])})),n||o.trigger(e?"drop":"abort",{context:l,event:t}),p.isConnected&&!o.isDestroying&&v&&await Gn.waitForTransitionEnd({element:p,property:Lr.getPropertyTransitionDuration(p,"transform")?"transform":"all",thisObj:o,once:!0,runOnDestroy:!0}),o.isDestroyed||o.trigger("abortFinalized",{context:l,event:t})}null!==(i=o.context)&&void 0!==i&&i.started&&o.reset()}cleanUp(){const{context:e,cloneTarget:t,draggingCls:n,dragProxyCls:r}=this,i=e.dragProxy||e.element,{relatedElements:o,originalRelatedElements:s,grabbed:l}=e,a=t&&(this.removeProxyAfterDrop||!e.valid),c=[n,"b-aborting",r,"b-drag-main","b-drag-unified-proxy"];i.classList.remove(...c),a&&i.remove(),null==o||o.forEach((e=>{a?e.remove():e.classList.remove(...c)})),l.classList.remove("b-drag-original","b-hidden"),null==s||s.forEach((e=>e.classList.remove("b-hidden","b-drag-original")))}};const Tc="onMouseMove",Dc="onMouseUp",Mc="onDocumentClick",Fc="onTouchMove",Ic="onTouchEnd",kc="onKeyDown";class Oc extends(fe.mixin(je,Sc,Rc)){static get defaultConfig(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,unifiedProxy:null,monitoringConfig:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:"translateXY",isElementDraggable:null,targetSelector:null,dropTargetSelector:null,dropTargetCls:null,proxySelector:null,cloneTarget:!1,autoSizeClonedTarget:!0,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,scrollManager:null,snapCoordinates:null,unifiedOffset:5,removeProxyAfterDrop:!0,clickSwallowDuration:50,ignoreSamePositionDrop:!0,allowDropOutside:null,floatRootOwner:null,mouseMoveListenerElement:document,externalDropTargetSelector:null,testConfig:{transitionDuration:10,clickSwallowDuration:50,touchStartDelay:100},rtlSource:null,createProxy:null}}construct(e){const t=this;super.construct(e),t.initListeners(),t.isContainerDrag?t.initContainerDrag():t.initTranslateDrag(),t.onScrollManagerScrollCallback=t.onScrollManagerScrollCallback.bind(t)}doDestroy(){this.reset(!0),super.doDestroy()}initListeners(){const e=this,{outerElement:t}=e,n={element:t,pointerdown:"onPointerDown",thisObj:e};e.mouseMoveListenerElement=e.getMouseMoveListenerTarget(t),Gn.on(n)}getMouseMoveListenerTarget(e){const t=e.getRootNode();let n=this.mouseMoveListenerElement;return t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"closed"===t.mode&&(n=e.closest(".b-outer")||n),n}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}onPointerDown(e){const t=this;if(0!==e.button||t.context)return;if(t.isElementDraggable&&!t.isElementDraggable(e.target,e))return;t.startEvent=e;if(t.isContainerDrag?t.grabContainerDrag(e):t.grabTranslateDrag(e)){t.blurDetacher=Gn.on({element:r,blur:t.onWindowBlur,thisObj:t});const n={element:t.mouseMoveListenerElement,thisObj:t,capture:!0,keydown:kc};if("touch"===e.pointerType?(t.touchStartTimer=t.setTimeout((()=>t.touchStartTimer=null),t.touchStartDelay,"touchStartDelay"),n.touchmove={handler:Fc,passive:!1},n.touchend=n.pointerup=Ic):(n.pointermove=Tc,n.pointerup=Dc),t.dragListenersDetacher=Gn.on(n),t.dragWithin&&t.dragWithin!==t.outerElement&&t.outerElement.contains(t.dragWithin)){const e=bn.from(t.dragWithin,t.outerElement);t.minY=e.top,t.maxY=e.bottom,t.minX=e.left,t.maxX=e.right}}}async internalMove(e){var t;if(e.scrollInitiated)return;const n=this,{context:r}=n,i=Gn.getDistanceBetween(n.startEvent,e);if(n.touchStartTimer&&i>n.dragThreshold)n.abort(!0);else if(!n.touchStartTimer&&null!=r&&r.element&&(r.started||i>=n.dragThreshold)&&(null===(t=e.target)||void 0===t?void 0:t.nodeType)===Node.ELEMENT_NODE){if(!r.started){var o;if(!1===n.trigger("beforeDragStart",{context:r,event:e}))return n.abort();n.isContainerDrag?n.startContainerDrag(e):n.startTranslateDrag(e),r.started=!0,null===(o=n.scrollManager)||void 0===o||o.startMonitoring(Yt.merge({scrollables:[{element:n.dragWithin||n.outerElement}],callback:n.onScrollManagerScrollCallback},n.monitoringConfig)),r.outermostEl=Lr.getOutermostElement(e.target),r.outermostEl.classList.add("b-draghelper-active"),n.dropTargetSelector&&n.dropTargetCls&&Lr.getRootElement(n.outerElement).querySelectorAll(n.dropTargetSelector).forEach((e=>e.classList.add(n.dropTargetCls)));const t=n.trigger("dragStart",{context:r,event:e});Yt.isPromise(t)&&await t,r.moveUnblocked=!0,n.isContainerDrag?n.onContainerDragStarted(e):n.onTranslateDragStarted(e),n.trigger("afterDragStart",{context:r,event:e})}r.moveUnblocked?n._cachedMouseEvent?(n.update(e),n.update(n._cachedMouseEvent),delete n._cachedMouseEvent):n.update(e):n._cachedMouseEvent=e,"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation())}}onScrollManagerScrollCallback(e){var t;const{lastMouseMoveEvent:n}=this;null!==(t=this.context)&&void 0!==t&&t.element&&n&&(n.isScroll=!0,this.update(n,e))}onTouchMove(e){this.internalMove(e)}onMouseMove(e){this.internalMove(e)}update(e,t){const n=this,{context:r}=n,i=document.scrollingElement||document.body;let o=n.getMouseMoveEventTarget(e);if("touchmove"===e.type){const t=e.changedTouches[0];o=Lr.elementFromPoint(t.clientX+i.scrollLeft,t.clientY+i.scrollTop)}r.target=o;let s=n.allowDropOutside||!n.dragWithin||n.dragWithin.contains(e.target);var l;s&&n.dropTargetSelector&&(s=s&&Boolean(null===(l=o)||void 0===l?void 0:l.closest(n.dropTargetSelector)));n.isContainerDrag?n.updateContainerProxy(e,t):n.updateTranslateProxy(e,t),r.valid=s,n.trigger("drag",{context:r,event:e}),n.isContainerDrag&&n.updateContainerDrag(e,t),r.valid=r.valid&&s;for(const e of n.draggedElements)e.classList.toggle(n.invalidCls,!r.valid);e&&(n.lastMouseMoveEvent=e)}get draggedElements(){const{context:e}=this;return[e.dragProxy||e.element,...e.relatedElements??[]]}async abort(e=!1){var t,n;const r=this,{context:o}=r;null===(t=r.scrollManager)||void 0===t||null===(n=t.stopMonitoring)||void 0===n||n.call(t),r.removeListeners(),null!=o&&o.started&&!o.aborted?(o.element.getBoundingClientRect(),o.valid=!1,r.isContainerDrag?r.abortContainerDrag(i,i,e):r.abortTranslateDrag(i,i,e),o.aborted=!0):r.reset(!0)}removeListeners(){var e,t;null===(e=this.dragListenersDetacher)||void 0===e||e.call(this),null===(t=this.blurDetacher)||void 0===t||t.call(this)}reset(e){const t=this,{context:n}=t;if(null!=n&&n.started){for(const e of t.draggedElements)e.classList.remove(t.invalidCls);n.outermostEl.classList.remove("b-draghelper-active"),t.isContainerDrag?n.dragProxy.remove():t.cleanUp(),t.dropTargetSelector&&t.dropTargetCls&&Lr.getRootElement(t.outerElement).querySelectorAll(t.dropTargetSelector).forEach((e=>e.classList.remove(t.dropTargetCls)))}t.removeListeners(),e||t.trigger("reset"),t.context=t.lastMouseMoveEvent=null}onTouchEnd(e){this.onMouseUp(e)}onDocumentClick(e){e.stopPropagation()}onMouseUp(e){const t=this,{context:n}=t;var r;(t.removeListeners(),n)&&(null===(r=t.scrollManager)||void 0===r||r.stopMonitoring(),n.started?n.moveUnblocked?(e.stopPropagation(),n.finalizing=!0,t.isContainerDrag?t.finishContainerDrag(e):t.finishTranslateDrag(e),Gn.on({element:document,thisObj:t,click:Mc,capture:!0,expires:t.clickSwallowDuration,once:!0})):t.ion({drag(){t.onMouseUp(e)},once:!0}):t.reset(!0))}onKeyDown(e){var t;null!==(t=this.context)&&void 0!==t&&t.started&&"Escape"===e.key&&(e.stopImmediatePropagation(),this.abort())}onWindowBlur(){this.context&&!this.context.finalizing&&this.abort()}createProxy(e){this.proxySelector&&(e=e.querySelector(this.proxySelector)||e);const t=e.cloneNode(!0);return t.removeAttribute("id"),t}get isContainerDrag(){return"container"===this.mode}async animateProxyTo(e,t={align:"c-c"}){const{context:n,draggedElements:r}=this,{element:i}=n,o=e.isRectangle?e:bn.from(e);r.forEach((e=>{e.classList.add("b-drag-final-transition"),Lr.alignTo(e,o,t)})),await Gn.waitForTransitionEnd({element:i,property:"all",thisObj:this,once:!0}),r.forEach((e=>e.classList.remove("b-drag-final-transition")))}get isDragging(){var e;return Boolean(null===(e=this.context)||void 0===e?void 0:e.started)}getMouseMoveEventTarget(e){return e.isScroll?Lr.elementFromPoint(e.clientX,e.clientY):e.target}}Oc._$name="DragHelper";N.apply(class{static target={class:Oc};getMouseMoveListenerTarget(e){return Lr.getRootElement(e)}});const Lc=/-/,Ac=Symbol("props");let Pc;const _c=e=>e[Ac]?e:new Proxy((e=>{const t=Object.create(e),{relatedTarget:n}=e;n&&!n.nodeType&&Object.defineProperty(t,"relatedTarget",{get:()=>null,configurable:!0});const r=Object.create(null);for(const t in e)"function"!=typeof e[t]&&(r[t]=e[t]);return t[Ac]=r,t})(e),{get:(e,t)=>{const n=((e,t)=>Object.hasOwn(e,t)?e:t in e[Ac]?e[Ac]:Object.getPrototypeOf(e))(e,t),r=n[t];return"function"==typeof r?(...e)=>r.call(n,...e):r}});N.apply(class{static target={class:Gn};static getComposedPathTarget(e){let t;if(null==Pc)try{t=e.composedPath()[0],Pc=!1}catch{Pc=!0}return t=Pc?e.path?e.path[0]:e.target:e.composedPath()[0],t}static fixEvent(e){if((e=this._overridden.fixEvent.call(this,_c(e))).target&&e.path&&Lc.test(e.target.tagName)){const t=e.path[0],n=e.target;e.target!==t&&(Object.defineProperty(e,"target",{get:()=>t,configurable:!0}),Object.defineProperty(e,"originalTarget",{get:()=>n,configurable:!0}))}return e}});N.apply(class{static get target(){return{class:Gn}}static addListener(e,t,n,r){return 11===(null==e?void 0:e.nodeType)&&r&&"capture"in r&&delete r.capture,this._overridden.addListener.call(this,e,t,n,r)}static addElementListener(e,t,n,r){return 11===(null==e?void 0:e.nodeType)&&n&&(delete n.capture,delete n.once,delete n.passive),this._overridden.addElementListener.call(this,e,t,n,r)}});N.apply(class{static get target(){return{class:lc}}static get configurable(){const e=this._overridden.configurable;return e.autoComplete=null,e}}),Object.defineProperty(ws,"element",{get:()=>null});N.apply(class{static get target(){return{class:gc}}setupTreeWalker(...e){return Kr(...e)}acceptNode(e){var t;return e.offsetParent&&null!==(t=e.matches)&&void 0!==t&&t.call(e,this.itemSelector)?Nr.FILTER_ACCEPT:Nr.FILTER_SKIP}});N.apply(class{static get target(){return{class:m}}static isObject(e){return e!==r&&this._overridden.isObject.call(this,e)}});N.apply(class{static get target(){return{class:Ka}}setupTreeWalker(...e){return Kr(...e)}});const $c=Object.getOwnPropertyDescriptor(ul.prototype,"floatRoot").get;Object.defineProperty(ul.prototype,"floatRoot",{get:function(){var e;const t=this.rootElement||(null===(e=this.owner)||void 0===e?void 0:e.rootElement);let{floatRoot:n}=t;return n?Lr.getRootElement(n)!==t&&t.appendChild(n):n=$c.call(this),n}});N.apply(class{static get target(){return{class:ul}}setDragImage(){}});N.apply(class{static get target(){return{class:ul}}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?null==e?void 0:e.parentNode:null;let n;for(;e&&(n=e.nextSibling);)t.insertBefore(n,e)}});class Nc{static get(e,t){const n=e._domData||(e._domData={});return null!=t?n[t]:n}static remove(e,t){const{_domData:n}=e,r=null==n?void 0:n[t];return null==n||delete n[t],r}static set(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}static assign(e,t){Object.assign(e._domData||(e._domData={}),t)}}Nc._$name="DomDataStore";class Hc{constructor(e){if(e){if(e.isLocation)return e;if(e.nodeType===Node.ELEMENT_NODE){const t=ul.fromElement(e,"gridbase"),n=t&&e.closest(t.focusableSelector);if(n){const{dataset:r}=n.parentNode;this.init({grid:t,rowIndex:t.store.includes(r.id)?t.store.indexOf(r.id):r.index||-1,columnId:n.dataset.columnId}),this.initialTarget=e}}else this.init(e)}}init(e){var t;const n=this,r=n.grid=e.grid,{store:i,columns:o}=r,{visibleColumns:s}=o;if(e.target&&(n.actionTargets=[n._target=e.target]),e.record)n._id=e.record.id;else if("id"in e)n._id=e.id,null==e.id&&(n._rowIndex=-1);else{var l;const t=isNaN(e.row)?isNaN(e.rowIndex)?NaN:e.rowIndex:e.row;n._rowIndex=Math.max(Math.min(Number(t),i.count-1),r.hideHeaders?0:-1),n._id=null===(l=i.getAt(n._rowIndex))||void 0===l?void 0:l.id}if("_rowIndex"in n||(n._rowIndex=i.indexOf(n.id)),n.isSpecialRow=null===(t=n.record)||void 0===t?void 0:t.isSpecialRow,"columnId"in e)n._column=o.getById(e.columnId);else if("field"in e)n._column=o.get(e.field);else{const t=isNaN(e.column)?isNaN(e.columnIndex)?NaN:e.columnIndex:e.column;isNaN(t)?n._column="column"in e?isNaN(e.column)?e.column:s[e.column]:s[0]:(n._columnIndex=Math.min(Number(t),s.length-1),n._column=s[n._columnIndex])}"_columnIndex"in n||(n._columnIndex=s.indexOf(n._column))}get isLocation(){return!0}equals(e,t=!1){const n=this;return(null==e?void 0:e.isLocation)&&e.grid===n.grid&&(t?n.id===e.id&&n._column===e._column:e.record===n.record&&e.column===n.column&&e.target===n.target)}get rowIndex(){const{_id:e}=this,{store:t}=this.grid;return t.includes(e)?t.indexOf(e):Math.min(this._rowIndex,t.count-1)}get visibleRowIndex(){const{rowManager:e}=this.grid,{rowIndex:t}=this;return-1===t?t:Math.max(Math.min(t,e.lastFullyVisibleTow.dataIndex),e.firstFullyVisibleTow.dataIndex)}get isSelectable(){return this.grid.store.includes(this._id)&&!this.isSpecialRow}get record(){if(this._rowIndex>-1){const{store:e}=this.grid;return e.includes(this._id)?e.getById(this._id):e.getAt(this._rowIndex)}}get id(){return this._id}get column(){const{visibleColumns:e}=this.grid.columns;return null!=e&&e.includes(this._column)?this._column:null==e?void 0:e[this.columnIndex]}get columnId(){var e;return null===(e=this.column)||void 0===e?void 0:e.id}get columnIndex(){var e;return Math.min(this._columnIndex,(null===(e=this.grid.columns.visibleColumns)||void 0===e?void 0:e.length)-1)}move(e){const t=this,{record:n,column:r,grid:i}=t,{store:o}=i,s=i.columns.visibleColumns,l=new Hc;let a=o.includes(n)?o.indexOf(n):t.rowIndex,c=s.includes(r)?s.indexOf(r):t.columnIndex;const d=i.hideHeaders?0:-1,u=o.count-1,h=s.length-1,g=a===d,p=a===u,m=0===c,f=c===h;switch(e){case Hc.PREV_CELL:m?g||(c=h,a--):c--;break;case Hc.NEXT_CELL:f?p||(c=0,a++):c++;break;case Hc.UP:g||a--;break;case Hc.DOWN:p||(-1===a?a=i.rowManager.firstFullyVisibleRow.dataIndex:a++);break;case Hc.FIRST_COLUMN:c=0;break;case Hc.LAST_COLUMN:c=h;break;case Hc.FIRST_CELL:a=d,c=0;break;case Hc.LAST_CELL:a=u,c=h;break;case Hc.PREV_PAGE:a=Math.max(d,a-Math.floor(i.scrollable.clientHeight/i.rowHeight));break;case Hc.NEXT_PAGE:a=Math.min(u,a+Math.floor(i.scrollable.clientHeight/i.rowHeight))}return l.init({grid:i,rowIndex:a,columnIndex:c}),l}get cell(){const e=this,{grid:t,id:n,_cell:r}=e;if(r)return r;var i;if(null==n)return null===(i=t.columns.getById(e.columnId))||void 0===i?void 0:i.element;{const{row:n}=e;var o;if(n)return n.getCell(e.columnId)||n.getCell(null===(o=t.columns.getAt(e.columnIndex))||void 0===o?void 0:o.id)}}get row(){return this.grid.getRowById(this.id)||this.grid.getRow(this.rowIndex)}get target(){const{cell:e,_target:t}=this,{focusableFinder:n}=this.grid;if(e)return t||(n.currentNode=this.grid.focusableFinderCell=e,n.nextNode()||e)}get isActionable(){const{cell:e,_target:t}=this,n=e&&Lr.getActiveElement(e),r=n&&e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY;return Boolean(r||t&&t!==this.cell)}get isColumnHeader(){return this.cell&&-1===this.rowIndex}get isCell(){return this.cell&&this.record}}Hc.UP=1,Hc.NEXT_CELL=2,Hc.DOWN=3,Hc.PREV_CELL=4,Hc.FIRST_COLUMN=5,Hc.LAST_COLUMN=6,Hc.FIRST_CELL=7,Hc.LAST_CELL=8,Hc.PREV_PAGE=9,Hc.NEXT_PAGE=10,Hc._$name="Location";const Vc=document.createRange();class Bc extends fe{static $name="Row";static get configurable(){return{cls:{$config:{equal:(e,t)=>(null==e?void 0:e.isDomClassList)&&(null==t?void 0:t.isDomClassList)&&e.isEqual(t)}}}}construct(e){Object.assign(this,{_elements:{},_elementsArray:[],_cells:{},_allCells:[],_regions:[],lastHeight:0,lastTop:-1,_dataIndex:0,_top:0,_height:0,_id:null,forceInnerHTML:!1,isGroupFooter:!1,cellContext:new Hc({grid:e.grid,id:null,columnIndex:0})}),super.construct(e),"position"===this.grid.positionMode&&(this.translateElements=this.positionElements)}doDestroy(){const e=this;e.rowManager.isDestroying||(e.removeElements(),e.rowManager.idMap[e.id]===e&&delete e.rowManager.idMap[e.id]),super.doDestroy()}get index(){return this._index}set index(e){this._index=e}get dataIndex(){return this._dataIndex}set dataIndex(e){this._dataIndex!==e&&(this._dataIndex=e,this.eachElement((t=>{t.dataset.index=e,t.ariaRowIndex=this.grid.hideHeaders?e+1:e+2})))}get id(){return this._id}set id(e){const t=this,n={id:e},r=t.rowManager.idMap;t._id===e&&r[e]===t||(r[t._id]===t&&delete r[t._id],r[e]=t,t._id=e,t.eachElement((t=>{Nc.assign(t,n),t.dataset.id=e})),t.eachCell((e=>Nc.assign(e,n))))}addElement(e,t){const n=this;let r=t.firstElementChild;for(n._elements[e]=t,n._elementsArray.push(t),n._regions.push(e),Nc.assign(t,{index:n.index}),n._cells[e]=[];r;)n._cells[e].push(r),n._allCells.push(r),Nc.set(r,{column:r.dataset.column,columnId:r.dataset.columnId,rowElement:r.parentNode,row:n}),r=r.nextElementSibling;t.dataset.index=n.index,t.ariaRowIndex=n.grid.hideHeaders?n.index+1:n.index+2}getElement(e){return this._elements[e]}getRectangle(e){return bn.from(this.getElement(e))}eachElement(e){this._elementsArray.forEach(e)}eachCell(e){this._allCells.forEach(e)}get elements(){return this._elements}get element(){const e=Object.keys(this._elements)[0];return this._elements[e]}get cells(){return this._allCells}getCells(e){return this._cells[e]}getCell(e,t=!1){return this._allCells.find((n=>{const r=Nc.get(n);return r.columnId==e||!t&&r.column==e}))}removeElements(e=!1){const t=this;t.rowManager.trigger("removeRow",{row:t}),e||t.eachElement((e=>e.remove())),t._elements={},t._cells={},t._elementsArray.length=t._regions.length=t._allCells.length=t.lastHeight=t.height=0,t.lastTop=-1}get height(){return this._height}set height(e){this._height=e}get offsetHeight(){return this.height+this.grid._rowBorderHeight}updateElementsHeight(e){const t=this;e||t.rowManager.storeKnownHeight(t.id,t.height),t.lastHeight!==t.height&&(this.eachElement((e=>e.style.height=`${t.offsetHeight}px`)),t.lastHeight=t.height)}addCls(e){this.updateCls(this.cls.add(e))}removeCls(e){this.updateCls(this.cls.remove(e))}toggleCls(e,t){this.updateCls(this.cls[t?"add":"remove"](e))}assignCls(e){this.updateCls(this.cls.assign(e))}changeCls(e){return null!=e&&e.isDomClassList?e:new wn(e)}updateCls(e){this.eachElement((t=>Lr.syncClassList(t,e)))}setAttribute(e,t){this.eachElement((n=>n.setAttribute(e,t)))}removeAttribute(e){this.eachElement((t=>t.removeAttribute(e)))}get isFirst(){return 0===this.dataIndex}get top(){return this._top}get bottom(){return this._top+this._height+this.grid._rowBorderHeight}setTop(e,t){this._top!==e&&(this._top=e,this.translateElements(t))}setBottom(e,t){this.setTop(e-this.offsetHeight,t)}translate(e,t=!1){return this.setTop(e,t),e+this.offsetHeight}translateElements(e){const t=this,{top:n,_elementsArray:r}=t;if(t.lastTop!==n){for(let e=0,{length:t}=r;e<t;e++)r[e].style.transform=`translate(0,${n}px)`;!e&&t.rowManager.trigger("translateRow",{row:t}),t.lastTop=n}}positionElements(e){const t=this,{top:n,_elementsArray:r}=t;if(t.lastTop!==n){for(let e=0,{length:t}=r;e<t;e++)r[e].style.top=`${n}px`;!e&&t.rowManager.trigger("translateRow",{row:t}),t.lastTop=n}}offset(e){let t=this._top+e;return t<0&&(e-=t,t=0),this.setTop(t),e}render(e,t,n=!0,r=!1,i=!1){var o,s;const l=this,{cellContext:a,cls:c,elements:d,grid:u,rowManager:h,height:g,_id:p}=l,m=Nc.get(l._elementsArray[0]),f=h._rowHeight,{store:v}=u,{isTree:b}=v;let y,C=0;if(t||!1===t||(t=u.store.getById(m.id),e=u.store.indexOf(t)),!t)return;const w=null===(o=t)||void 0===o?void 0:o.cls,x=w?w.isDomClassList?w:new wn(w):null;c.assign({"b-grid-row-updating":n&&u.transitionDuration&&!i,"b-selected":u.isSelected(null===(s=t)||void 0===s?void 0:s.id),"b-readonly":t.readOnly,"b-linked":t.isLinked,"b-original":t.hasLinks}),l.lastRecordCls&&c.remove(l.lastRecordCls),x?(c.add(x),l.lastRecordCls=Object.assign({},x)):l.lastRecordCls=null,h.trigger("beforeRenderRow",{row:l,record:t,recordIndex:e,oldId:p}),u.beforeRenderRow({row:l,record:t,recordIndex:e,oldId:p}),l.updateCls(c),n&&u.transitionDuration&&!i&&u.setTimeout((()=>{l.isDestroyed||(c.remove("b-grid-row-updating"),l.updateCls(c))}),u.transitionDuration),l.id=t.id,l.dataIndex=e;const S=!u.fixedRowHeight&&u.getRowHeight(t)||f;let E=l.maxRequestedHeight=null;if(b)for(const e in d){const n=d[e];var R,T;if(n.id=`${u.id}-${e}-${l.id}`,Lr.setAttributes(n,{"aria-level":t.childLevel+1,"aria-setsize":t.parent.children.length,"aria-posinset":t.parentIndex+1}),t.isExpanded(v))Lr.setAttributes(n,{"aria-expanded":!0,"aria-owns":null!==(R=t.children)&&void 0!==R&&R.length?null===(T=t.children)||void 0===T?void 0:T.map((t=>`${u.id}-${e}-${t.id}`)).join(" "):null});else t.isLeaf?n.removeAttribute("aria-expanded"):n.setAttribute("aria-expanded",!1),n.removeAttribute("aria-owns")}for(a._record=t,a._id=t.id,a._rowIndex=e,C=0;C<u.columns.visibleColumns.length;C++){const e=u.columns.visibleColumns[C];a._columnId=e.id,a._column=e,a._columnIndex=C,a._cell=l.getCell(e.id,!0),a.height=S,a.maxRequestedHeight=E,a.updatingSingleRow=n,y=l.renderCell(a),h.fixedRowHeight||null!=y.height&&(E=Math.max(E,y.height),y.transient||(l.maxRequestedHeight=E))}const D=E??S;l.height=u.processRowHeight(t,D)??D,l.updateElementsHeight(i),n&&!i&&(g!==l.height&&h.translateFromRow(l,r),h.trigger("updateRow",{row:l,record:t,recordIndex:e,oldId:p}),h.trigger("renderDone")),u.afterRenderRow({row:l,record:t,recordIndex:e,oldId:p,oldHeight:g,isExport:i}),h.trigger("renderRow",{row:l,record:t,recordIndex:e,oldId:p,isExport:i}),g&&l.height!==g&&h.trigger("rowRowHeight",{row:l,record:t,height:l.height,oldHeight:g}),l.forceInnerHTML=!1}renderCell(e){var t,n;e.isLocation||(e=new Hc(e));let{cell:r,record:o}=e;const s=this,{grid:l,column:a,height:c,maxRequestedHeight:d,updatingSingleRow:u=!0,isMeasuring:h=!1}=e,g=null===(t=l.features)||void 0===t?void 0:t.cellEdit,p=Nc.get(r),m=p.rowElement,f=Nc.get(m);if(!o&&(o=e._record=l.store.getById(f.id),!o))return;let v=a.getRawValue(o);const b=o.fieldMap[a.field],y={configuredHeight:c,height:null,maxRequestedHeight:d},C=a.getCellClass(e),w={cellElement:r,dataField:b,rowElement:m,value:v,record:o,column:a,size:y,grid:l,row:p.row,updatingSingleRow:u,isMeasuring:h},x=a.renderer||a.defaultRenderer;l.beforeRenderCell(w),w.cellElement!==r&&(r=w.cellElement),Lr.syncClassList(r,C);let S=!0;x?(v=a.callback(x,a,[w]),v===i&&(o.generatedParent&&a.rendererReturningContent?v="":!1===a.alwaysClearCell&&(S=!1))):b&&(v=b.print(v));const E=null===(n=l.hasFrameworkRenderer)||void 0===n?void 0:n.call(l,{cellContent:v,column:a});E&&o.isSpecialRow&&(v="");const R=E&&!a.data.tree&&!o.isSpecialRow;if(S&&!R){var T;let t=r;null!=g&&null!==(T=g.editorContext)&&void 0!==T&&T.equals(e)&&!g.editor.isFinishing&&(t=s.moveContentFromCell(r,g.editor.element));const n=null!=v&&"object"==typeof v,i="string"==typeof v,o=n||null==v?"":String(v);if(s.forceInnerHTML&&(t.innerHTML="",delete t._content,r.lastDomConfig=null),n||!a.htmlEncode||a.disableHtmlEncode?!a.autoSyncHtml||i&&!Lr.getChildElementCount(t)?n?Cs.sync({targetElement:t,domConfig:{onlyChildren:!0,children:H.asArray(v)}}):t._content!==o&&(t.innerHTML=t._content=o):i?Lr.sync(o,t.firstElementChild):n&&Cs.sync({domConfig:v,targetElement:t}):r._hasHtml?(t.innerText=o,r._hasHtml=!1):Lr.setInnerText(t,o),t!==r){const{firstChild:e}=r;for(const n of t.childNodes)r.insertBefore(n,e)}}var D;o.isSpecialRow||(null===(D=l.processCellContent)||void 0===D||D.call(l,{cellElementData:p,rendererData:w,rendererHtml:w.rendererHtml||v}));return a.autoHeight&&null==y.height&&(r.classList.add("b-measuring-auto-height"),y.height=Math.max(r.offsetHeight,l.rowHeight),r.classList.remove("b-measuring-auto-height")),h||s.rowManager.trigger("renderCell",w),y}moveContentFromCell(e,t){Vc.setStart(e,0),Vc.setEndBefore(t);const n=document.createElement("div");return n.appendChild(Vc.extractContents()),n}}Bc.initClass(),Bc._$name="Row";N.apply(class{static target={class:Bc};moveContentFromCell(e,t){const{childNodes:n}=e,r=[];n.forEach((n=>{n!==t&&(r.push(n),e.removeChild(n))}));const i=document.createElement("div");return r.forEach((e=>{i.appendChild(e)})),i}});class zc extends(ai(fe)){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(e,t){return null==t||t.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return 0!==Object.keys(this.activeScroll).length}get rtl(){var e;return null===(e=this.owner)||void 0===e?void 0:e.rtl}startMonitoring(e={}){const t=this,{element:n,direction:r}=t,{scrollables:i=[],direction:o=r,callback:s}=e,l=[];return i.length||i.push({element:n}),i.forEach((e=>{const r=e.element;"string"==typeof r?Lr.forEachSelector(n,r,(n=>{t.createMonitor(n,e.direction||o,e.callback||s),l.push(n)})):(t.createMonitor(r,e.direction||o,e.callback||s),l.push(r))})),function(){var e;null===(e=t.stopMonitoring)||void 0===e||e.call(t,l)}}createMonitor(e,t,n){const{monitoring:r}=this;r.has(e)||r.set(e,new Wc({scrollManager:this,element:e,direction:t,callback:n}))}stopMonitoring(e){const t=this,{monitoring:n}=t;if(e=H.asArray(e),n){if(!e)return void n.forEach((e=>t.stopMonitoring(e.element)));e.forEach((e=>{const t=n.get(e);e.classList.remove("b-scrolling"),t&&(t.destroy(),n.delete(e))}))}}requestScroll(e,t){const{activeScroll:n}=this;return(!(e in n)||n[e]===t)&&(n[e]=t,!0)}releaseScroll(e){const{activeScroll:t={}}=this;Object.keys(t).forEach((n=>{t[n]===e&&delete t[n]}))}getRelativeScroll(e,t="left"){let n=0;return this.monitoring.forEach(((r,i)=>{Lr.isDescendant(i,e)&&(n+="left"===t?r.scrollRelativeLeft:r.scrollRelativeTop)})),n}}class Wc extends fe{construct(e){const{element:t}=e,n=t.scrollLeft,r=t.scrollTop;Object.assign(e,{startScrollLeft:n,startScrollTop:r}),super.construct(e),Gn.on({element:t,scroll:"onElementScroll",pointermove:"onMouseMove",capture:!0,thisObj:this}),Gn.on({element:t,pointerleave:"onPointerLeave",thisObj:this})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){const e=this;e.pendingScrollFinalize&&(e.scrollManager.releaseScroll(e),e.pendingScrollFinalize=!1),e.scrolling=!0,e.performScroll()}stopScroll(e=null){const t=this,n=()=>{t.pendingScrollFinalize=!1,t.isDestroyed||(t.scrollManager.releaseScroll(t),t.scrolling=!1)};t.scrollRequested&&(t.scrollManager.cancelAnimationFrame(t.frameId),t.scrollRequested=!1),t.scrollManager.clearTimeout(t.scrollTimeout),t.scrollTimeout=null,e||!t.ongoingScrollTop&&!t.ongoingScrollLeft?(t.ongoingScrollTop=t.ongoingScrollLeft=null,n()):(t.pendingScrollFinalize=!0,Promise.all([t.ongoingScrollTop,t.ongoingScrollLeft].filter(Boolean)).then((()=>t.pendingScrollFinalize&&n())))}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(e){const t=this,{scrollManager:n}=t,r=t.element.getBoundingClientRect(),i=n.zoneWidth,o=n.scrollSpeed;if(t.scrollDeltaX=t.scrollDeltaY=0,"vertical"!==t.direction){const{scrollLeft:s,scrollWidth:l,clientWidth:a}=t.element;n.rtl?e.clientX<r.left+i&&l+s-a>=1?t.scrollDeltaX=-Math.round((i+(r.left-e.clientX))/o)-1:e.clientX>r.right-i&&s<0&&(t.scrollDeltaX=Math.round((i-(r.right-e.clientX))/o)+1):e.clientX>r.right-i&&l-s-a>=1?t.scrollDeltaX=Math.round((i-(r.right-e.clientX))/o)+1:e.clientX<r.left+i&&s>0&&(t.scrollDeltaX=-Math.round((i+(r.left-e.clientX))/o)-1)}if("horizontal"!==t.direction){const{scrollTop:n,scrollHeight:s,clientHeight:l}=t.element;e.clientY>r.bottom-i&&s-n-l>=1?t.scrollDeltaY=Math.round((i-(r.bottom-e.clientY))/o)+1:e.clientY<r.top+i&&n>0&&(t.scrollDeltaY=-Math.round((i+(r.top-e.clientY))/o)-1)}0===t.scrollDeltaX||n.requestScroll("horizontal",t)||(t.scrollDeltaX=0),0===t.scrollDeltaY||n.requestScroll("vertical",t)||(t.scrollDeltaY=0),0===t.scrollDeltaX&&0===t.scrollDeltaY?t.scrolling&&t.stopScroll():t.scrollTimeout||(t.scrollTimeout=n.setTimeout((()=>t.startScroll()),n.startScrollDelay))}performScroll(){const e=this,{element:t}=e;if(e.scrolling&&!e.scrollRequested){if(0!==e.scrollDeltaX){const n=t.scrollLeft,r=Math.min(n+e.scrollDeltaX,t.scrollWidth-t.clientWidth);t.scrollLeft=r,t.scrollLeft!==n?e.ongoingScrollLeft=new Promise((e=>t.addEventListener("scroll",e,{once:!0}))):(e.ongoingScrollLeft=null,e.scrollDeltaX=0)}if(0!==e.scrollDeltaY){const n=t.scrollTop,r=Math.min(n+e.scrollDeltaY,t.scrollHeight-t.clientHeight);t.scrollTop=r,t.scrollTop!==n?e.ongoingScrollTop=new Promise((e=>t.addEventListener("scroll",e,{once:!0}))):(e.ongoingScrollTop=null,e.scrollDeltaY=0)}0!==e.scrollDeltaX||0!==e.scrollDeltaY?(e.scrollRequested=!0,e.frameId=e.scrollManager.requestAnimationFrame((()=>{e.scrollRequested=!1,e.performScroll(e)}))):e.stopScroll()}}onElementScroll(){var e,t;null===(e=this.config)||void 0===e||null===(t=e.callback)||void 0===t||t.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(e){return this.scrollManager.getRelativeScroll(e,"left")}getRelativeTopScroll(e){return this.scrollManager.getRelativeScroll(e,"top")}}zc._$name="ScrollManager";const jc=e=>"number"==typeof e||(null==e?void 0:e.endsWith("px"));class Gc extends(io.mixin(je,et)){static $name="Column";static type="column";static get fields(){return["type","text","field","renderer","width","flex","autoWidth","autoHeight",{name:"fitMode",defaultValue:"exact"},"readOnly",{name:"editor",defaultValue:{}},"cellEditor","finalizeCellEdit",{name:"revertOnEscape",defaultValue:!0},{name:"invalidAction",defaultValue:"block"},{name:"sortable",defaultValue:!0,convert(e,t,n){if(!e)return!1;if(!0===e)return!0;const r={};return"function"==typeof e?(r.originalSortFn=e,r.sortFn=e.bind(n)):"object"==typeof e&&(Object.assign(r,e),r.fn&&(r.sortFn=r.fn,delete r.fn)),r}},{name:"searchable",defaultValue:!0},{name:"collapsible",defaultValue:!1},{name:"collapsed",defaultValue:!1},{name:"collapseMode"},{name:"filterable",defaultValue:!0,convert(e){if(!e)return!1;if(!0===e)return!0;const t={columnOwned:!0};return"function"==typeof e?t.filterFn=e:"object"==typeof e&&Object.assign(t,e),t}},{name:"sealed"},{name:"hideable",defaultValue:!0},{name:"draggable",defaultValue:!0},{name:"groupable",defaultValue:!0},{name:"resizable",defaultValue:!0},"groupRenderer","headerRenderer","tooltip","tooltipRenderer","cellCls","cls","icon","align",{name:"minWidth",defaultValue:60},"maxWidth",{name:"hidden",defaultValue:!1},{name:"locked"},{name:"region"},{name:"mergeCells",type:"boolean"},{name:"mergeable",type:"boolean",defaultValue:!0},"mergedRenderer",{name:"showColumnPicker",defaultValue:!0},{name:"enableHeaderContextMenu",defaultValue:!0},{name:"enableCellContextMenu",defaultValue:!0},"headerMenuItems","cellMenuItems","sum","summaries","summaryRenderer","responsiveLevels","tags","touchConfig","tree","filterType",{name:"htmlEncode",defaultValue:!0},{name:"htmlEncodeHeaderText",defaultValue:!0},{name:"autoSyncHtml",defaultValue:!1},{name:"alwaysClearCell",defaultValue:!1},{name:"headerWidgets"},{name:"instantUpdate",defaultValue:!1},{name:"repaintOnResize",defaultValue:!1},"editTargetSelector",{name:"exportable",defaultValue:!0},{name:"exportedType"},{name:"ariaLabel",defaultValue:"L{Column.columnLabel}"},{name:"cellAriaLabel",defaultValue:"L{cellLabel}"}]}static get autoExposeFields(){return!1}construct(e,t){var n;const r=this;r.masterStore=t,t&&(r._grid=Array.isArray(t)?t[0].grid:t.grid),r.localizableProperties=J.mergeMethods.distinct(e.localizableProperties,["text","ariaLabel","cellAriaLabel"]),e.localeClass&&(r.localeClass=e.localeClass),super.construct(...arguments),r.isLeaf&&!("field"in r.data)&&(r.field="_"+(r.type||"")+ ++Gc.emptyCount,r.noFieldSpecified=!0),r.width||r.flex||r.children||r.set({width:Gc.defaultWidth,flex:null},null,!0),r.headerWidgets&&r.initHeaderWidgets(r.headerWidgets),r.isParent&&(r.meta.visibleChildren=new Set,r.collapsible&&(r.collapsible=!0)),r.rendererReturningContent=null===(n=r.renderer)||void 0===n?void 0:n.toString().includes("return ")}shouldSync(e){return e.isColumn&&e.text===this.text&&(e.field===this.field||String(e.renderer)===String(this.renderer))&&(!e.previousSibling&&!this.previousSibling||e.previousSibling.shouldSync(this.previousSibling))}get isCollapsible(){var e;return(null===(e=this.children)||void 0===e?void 0:e.length)>1&&this.collapsible}get collapsed(){return this.get("collapsed")}set collapsed(e){this.set("collapsed",e,!0),this.onCollapseChange(!e),this.trigger("toggleCollapse",{collapsed:e})}onCellFocus(e){this.location=e,this.updateHeaderAriaLabel(this.localizeProperty("ariaLabel")),-1!==e.rowIndex&&this.updateCellAriaLabel(this.localizeProperty("cellAriaLabel"))}updateHeaderAriaLabel(e){Lr.setAttributes(this.element,{"aria-label":e})}updateCellAriaLabel(e){var t,n,r;null!==(t=this.location)&&void 0!==t&&t.isSpecialRow||null===(n=this.location)||void 0===n||!n.cell||(null!==(r=e)&&void 0!==r&&r.length||(e=this.location.column.text),Lr.setAttributes(this.location.cell,{"aria-label":e}))}doDestroy(){var e,t,n;null===(e=this.data)||void 0===e||null===(t=e.editor)||void 0===t||null===(n=t.destroy)||void 0===n||n.call(t),this.destroyHeaderWidgets(),super.doDestroy()}set headerWidgets(e){this.initHeaderWidgets(e),this.set("headerWidgets",e)}get headerWidgets(){return this.get("headerWidgets")}initHeaderWidgets(e){this.destroyHeaderWidgets();const t=this.headerWidgetMap={};for(const n of e){const e=ul.create({owner:this,...n});t[e.ref||e.id]=e}}destroyHeaderWidgets(){for(const t of Object.values(this.headerWidgetMap||{})){var e;null===(e=t.destroy)||void 0===e||e.call(t)}}static generateAutoCls(){const e=[];for(let t=this;t!==Gc;t=t.superclass)t.type&&t.type!==t.superclass.type&&e.push(`b-${t.type.toLowerCase()}-cell`);const t=e.join(" ");return(Gc.autoClsMap||(Gc.autoClsMap=new Map)).set(this,t),t}getCellClass(e){var t,n;const{record:r,column:i}=e,{cellCls:o,internalCellCls:s,grid:l,constructor:a,align:c}=i,d=(null===(t=Gc.autoClsMap)||void 0===t?void 0:t.get(a))||a.generateAutoCls(),u=e.cell.classList.contains("b-editing"),h={[l.cellCls]:l.cellCls,[d]:d,[o]:o,[s]:s,"b-cell-dirty":r.isFieldModified(i.field)&&(i.compositeField||!1!==(null===(n=r.fieldMap[i.field])||void 0===n?void 0:n.persist)),[`b-grid-cell-align-${c}`]:c,"b-selected":l.selectionMode.cell&&l.isCellSelected(e),"b-focused":l.isFocused(e),"b-auto-height":i.autoHeight,"b-editing":u};return r.isSpecialRow&&h["b-checkbox-selection"]&&(h["b-checkbox-selection"]=!1),h}get locked(){return"locked"===this.data.region}set locked(e){this.region=e?"locked":"normal"}get region(){return this.parent.isRoot?this.get("region"):this.parent.region}set region(e){this.set("region",e)}get sortable(){return this.isLeaf&&this.data.sortable}set sortable(e){this.set("sortable",e)}get groupable(){return this.isLeaf&&this.field&&this.data.groupable}set groupable(e){this.set("groupable",e)}get editor(){const e=this;let{editor:t}=e.data;if(t&&!t.isWidget){const n=e.grid.processCellEditor({editor:t,field:e.field});n?t=e.data.editor=n.editor:("string"==typeof t&&(t={type:t}),t=e.data.editor=ul.create(Yt.merge(e.defaultEditor,{owner:e.grid,label:A.encodeHtml(e.text)},t)))}return t}set editor(e){this.data.editor=e}get defaultEditor(){return{type:"textfield",name:this.field}}getFilterableValue(e){return this.getRawValue(e)}get owner(){return this._owner||this.subGrid}set owner(e){this._owner=e}get grid(){var e;return this._grid||(null===(e=this.parent)||void 0===e?void 0:e.grid)}set subGrid(e){this._subGrid=e}get subGrid(){var e;return this._subGrid||(null===(e=this.grid)||void 0===e?void 0:e.getSubGridFromColumn(this))}get subGridElement(){return this.subGrid.element}get element(){return this.grid.getHeaderElement(this)}get previousVisibleSibling(){const e=this.region;let t=this.previousSibling;for(;t&&(t.hidden||t.region!==e);)t=t.previousSibling;return t}get nextVisibleSibling(){const e=this.region;let t=this.nextSibling;for(;t&&(t.hidden||t.region!==e);)t=t.nextSibling;return t}get isLastInSubGrid(){return!this.nextVisibleSibling&&(this.parent.isRoot||this.parent.isLastInSubGrid)}get allowDrag(){return!this.parent.isRoot||Boolean(this.nextVisibleSibling||this.previousVisibleSibling)}get textWrapper(){return Lr.getChild(this.element,".b-grid-header-text")}get textElement(){return Lr.down(this.element,".b-grid-header-text-content")}get contentElement(){return Lr.down(this.element,".b-grid-header-children")}get isSorted(){return this.grid.store.sorters.some((e=>e.field===this.field))}get isFocusable(){return this.isLeaf}static get text(){return this.$meta.fields.defaults.text}get headerText(){return this.htmlEncodeHeaderText?A.encodeHtml(this.text):this.text}get isVisible(){return!this.hidden&&(!this.parent||this.parent.isVisible)}hide(e=!1,t=!1){const n=this,{parent:r}=n;if(!n.hidden){if(n.hidden=!0,r&&!r.isRoot&&!r.isTogglingAll){r.children.some((e=>!0!==e.hidden))||r.hidden||(e=!0,r.hide())}n.isParent?n.children.forEach((e=>e.hide(!0,!0))):r.isRoot||r.meta.visibleChildren[t?"add":"delete"](n),e||n.stores.forEach((e=>e.trigger("columnHide",{column:n})))}}show(e=!1){const t=this,{parent:n}=t;if(t.hidden){var r;if(t.hidden=!1,null!=n&&n.hidden&&n.show(),t.isParent)null===(r=t.meta.visibleChildren)||void 0===r||r.forEach((e=>e.show(!0)));e||t.stores.forEach((e=>e.trigger("columnShow",{column:t})))}}toggle(e){return this.hidden&&e===i||!0===e?this.show():!this.hidden&&e===i||!1===e?this.hide():void 0}toggleChildren(e=this.children,t=i){var n,r;const o=this;null===(n=o.grid.columns)||void 0===n||n.beginBatch(),o.isTogglingAll=!0,e.forEach((e=>e.toggle(t))),o.isTogglingAll=!1,null===(r=o.grid.columns)||void 0===r||r.endBatch()}onCollapseChange(e=i){const t=this;if("toggleAll"===t.collapseMode)t.toggleChildren();else{var n,r;const{firstChild:i}=t;null!=i.flex&&t.collapsed?(i.oldFlex=i.flex,i.width=i.element.offsetWidth):!t.collapsed&&i.oldFlex&&(i.flex=i.oldFlex,i.oldFlex=null),null===(n=t.grid.columns)||void 0===n||n.beginBatch(),t.isTogglingAll=!0,t.children.slice(1).forEach((t=>t.toggle(e))),t.isTogglingAll=!1,null===(r=t.grid.columns)||void 0===r||r.endBatch()}}set collapsible(e){const t=this;if(t.set("collapsible",e),t.isParent){const{headerWidgets:n=[]}=t;if(e)n.push({type:"button",ref:"collapseExpand",toggleable:!0,pressed:t.collapsed,icon:"b-icon-collapse-"+(t.grid.rtl?"right":"left"),pressedIcon:"b-icon-collapse-"+(t.grid.rtl?"left":"right"),cls:"b-grid-header-collapse-button b-transparent",onToggle:({pressed:e})=>t.collapsed=e});else{const e=n.findIndex((e=>"collapseExpand"===e.ref));e>-1&&n.splice(e,1)}t.headerWidgets=n,t.collapsed&&t.onCollapseChange(!1)}}get collapsible(){return this.get("collapsible")}generateId(){return Gc.generatedIdIndex||(Gc.generatedIdIndex=0),(this.field?this.field.replace(/\./g,"-"):"col")+ ++Gc.generatedIdIndex}get allIndex(){return this.masterStore.indexOf(this)}measureSize(e){var t;return Lr.measureSize(e,null===(t=this.subGrid)||void 0===t?void 0:t.element)}get calcMinWidth(){const{width:e,minWidth:t}=this.data;return jc(e)&&jc(t)?Math.max(parseInt(e)||0,parseInt(t)||0):e}get width(){return this.data.width}set width(e){const t={width:e};e&&"flex"in this.data&&(t.flex=null),this.set(t)}set flex(e){const t={flex:e};e&&"width"in this.data&&(t.width=null),this.set(t)}get flex(){return this.data.flex}calculateMinWidth(){const e=this,t=e.measureSize(e.width),n=e.measureSize(e.minWidth);let r=0;return e.children&&(r=e.children.reduce(((e,t)=>e+t.calculateMinWidth()),0)),Math.max(t,n,r)}resizeToFitContent(e,t,n=!1){const i=this,{grid:o,element:s,fitMode:l}=i,{rowManager:a,store:c}=o,{count:d}=c;if(d<=0||"none"===i.fitMode||!i.fitMode)return;const[u]=a.rows,{rowElement:h,cellElement:g}=o.beginGridMeasuring(),p=new Hc({grid:o,column:i,id:null});let m,f,v,b,y,C,w=0,x={length:0,record:null};if(g._domData={columnId:i.id,row:u,rowElement:h},p._cell=g,p.updatingSingleRow=!0,p.isMeasuring=!0,g.innerHTML="",o.resizeToFitIncludesHeader&&!o.hideHeaders){if(!o.$headerPadding){const e=r.getComputedStyle(s);o.$headerPadding=parseInt(e.paddingLeft)}const e=s.querySelector(".b-grid-header-text-content");e.style.cssText="flex: none; width: auto",w=e.offsetWidth+2*o.$headerPadding+2,e.style.cssText=""}for(d>1e3?(m=Math.max(Math.min(a.topIndex+Math.round(a.rowCount/2)-500,d-1e3),0),f=m+1e3):(m=0,f=d),v=m;v<f;v++){if(b=c.getAt(v),y=i.getRawValue(b),"value"===l)C=String(y).length;else if(p._record=x.record,p._id=b.id,p._rowIndex=v,u.renderCell(p),"textContent"===l)C=g.textContent.length;else{const e=g.offsetWidth;e>w&&(w=e)}C>x.length&&(x={record:b,length:C,rowIndex:v})}return x.length>0&&("value"===l||"textContent"===l)&&(p._record=x.record,p._id=x.record.id,p._rowIndex=x.rowIndex,u.renderCell(p),w=Math.max(w,g.offsetWidth)),Array.isArray(e)&&([e,t]=e),w=Math.max(w,e||0),w=Math.min(w,t||1e6),n||o.endGridMeasuring(),i.width=i.maxWidth?w=Math.min(w,i.maxWidth):w,w}getState(){const e=this,t={id:e.id,hidden:e.hidden,region:e.region,locked:e.locked};return e.children||(t[e.flex?"flex":"width"]=e.flex||e.width),e.isCollapsible&&(t.collapsed=e.collapsed),t}applyState(e){const t=this;t.beginBatch(),"locked"in e&&(t.locked=e.locked),"width"in e&&(t.width=e.width),"flex"in e&&(t.flex=e.flex),"width"in e&&t.flex?t.flex=i:"flex"in e&&t.width&&(t.width=i),"region"in e&&(t.region=e.region),t.endBatch(),"hidden"in e&&t.toggle(!0!==e.hidden),"collapsed"in e&&(t.collapsed=e.collapsed)}remove(){const{subGrid:e,grid:t}=this,n=e&&(null==t?void 0:t.focusedCell);(null==n?void 0:n.columnId)===this.id&&(t.owns(Lr.getActiveElement(t))?t.navigateRight():t._focusedCell=new Hc({grid:t,rowIndex:n.rowIndex,column:e.columns.getAdjacentVisibleLeafColumn(this.id,!0,!0)})),super.remove()}getRawValue(e){return e.getValue(this.field)}refreshCell(e){this.grid.rowManager.refreshCell(e,this.id)}clearCell(e){e.innerHTML="",delete e._content}canEdit(e){if(e.isEditable){const t=e.isEditable(this.field);if(t!==i)return t}return!0}insertChild(e,t=null,n=!1){return(e=Array.isArray(e)?e:[e]).forEach((e=>{const{parent:t}=e;null!=t&&t.collapsed&&e===t.firstChild&&t.children.length>1&&1===t.children.filter((e=>!e.hidden)).length&&(e.nextSibling.hidden=!1)})),this.sealed&&!this.inProcessChildren?null:super.insertChild(...arguments)}canFillValue(){return!0}getCurrentConfig(e){var t;const n=super.getCurrentConfig(e);return null!==(t=this.sortable)&&void 0!==t&&t.originalSortFn&&(n.sortable=this.sortable.originalSortFn),n.renderer===this.internalRenderer&&delete n.renderer,n.headerRenderer===this.internalHeaderRenderer&&delete n.headerRenderer,delete n.ariaLabel,delete n.cellAriaLabel,n}}Gc.emptyCount=0,Gc.defaultWidth=100,Gc.exposeProperties(),Gc._$name="Column";const Uc={boolean:{type:"check"},date:{type:"date"},integer:{type:"number",format:{maximumFractionDigits:0}},number:{type:"number"}},Yc=[{field:"region"}];class qc extends(et(ts)){static get defaultConfig(){return{modelClass:Gc,tree:!0,autoAddField:!1,syncDataOnLoad:{threshold:1},sorters:Yc,reapplySortersOnAdd:!0}}construct(e){const t=this;e.grid&&(e.grid._columnStore=t,t.id=`${e.grid.id}-columns`,e.grid.ion({subGridCollapse:"clearSubGridCaches",subGridExpand:"clearSubGridCaches",thisObj:t})),super.construct(e),t.ion({change:t.onStoreChange,sort:()=>t.updateChainedStores(),thisObj:t,prio:1})}doDestroy(){const e=[];this.isChained||this.traverse((t=>e.push(t))),super.doDestroy(),this.isChained||e.forEach((e=>e.destroy()))}getById(e){return super.getById(e)||this.idRegister[e]}forEach(e,t=this){this.traverseWhile(((n,r)=>e.call(t,n,r)),!0)}get totalFixedWidth(){let e=0;for(const t of this)t.hidden||(t.children?t.children.forEach((t=>e+=this.calculateFixedWidth(t))):e+=this.calculateFixedWidth(t));return e}get hasFlex(){return this.visibleColumns.some((e=>e.flex))}calculateFixedWidth(e){return e.flex?e.measureSize(Gc.defaultWidth):Math.max(e.measureSize(e.width),e.measureSize(e.minWidth))}get topColumns(){return this.isChained?this.masterStore.rootNode.children.filter(this.chainedFilterFn):this.rootNode.children}get visibleColumns(){const e=this;return e._visibleColumns||(e._visibleColumns=e.leaves.filter((e=>e.isVisible&&(!e.subGrid||!e.subGrid.collapsed)))),e._visibleColumns}onStoreChange({action:e,changes:t}){("update"!==e||"hidden"in t)&&this.clearCaches()}clearSubGridCaches({subGrid:e}){e.columns.clearCaches(),this.clearCaches()}clearCaches(){var e;this._visibleColumns=null,null===(e=this.masterStore)||void 0===e||e.clearCaches()}onMasterDataChanged(e){super.onMasterDataChanged(e),("update"!==e.action||"hidden"in e.changes)&&this.clearCaches()}getAdjacentVisibleLeafColumn(e,t=!0,n=!1){const r=this.visibleColumns,i=e instanceof Gc?e:this.getById(e);let o=r.indexOf(i)+(t?1:-1);if(!r[o]){if(!n)return null;o=t?0:r.length-1}return r[o]}get bottomColumns(){return this.leaves}get(e){return this.findRecord("field",e,!0)}createRecord(e){var t,n;const{grid:r={}}=this,{store:i}=r,o=null==i||null===(t=i.modelClass)||void 0===t||null===(n=t.fieldMap)||void 0===n?void 0:n[e.field];let s=this.modelClass;if(null!=o&&o.column&&(e=m.merge({},o.column,e)),e.type&&(s=qc.getColumnClass(e.type),!s))throw new Error(`Column type '${e.type}' not registered`);e.locked&&(e.region="locked",delete e.locked);const l=new s(e,this);if(l.data.region||(l.data.region=r.defaultRegion||"normal"),this.autoAddField&&!l.noFieldSpecified&&i&&!o){let e=l.field;l.constructor.fieldType&&(e={name:l.field,type:l.constructor.fieldType}),i.modelClass.addField(e)}return l}indexOf(e){if(null==e)return-1;const t=super.indexOf(e);return t>-1?t:this.records.findIndex((t=>t.field===e))}removeAll(e=!1){const t=this;return t.some((e=>e.isTimeAxisColumn))?t.remove(t.query((e=>!e.isTimeAxisColumn)),e):super.removeAll(e)}get usesAutoHeight(){return this.find((e=>e.autoHeight))}get usesFlexAutoHeight(){return this.find((e=>e.autoHeight&&null!=e.flex))}resolveSyncNode(e){return e.id?super.resolveSyncNode(e):e.field?{id:e.field,node:this.allRecords.find((t=>t.field===e.field))}:e.type?{id:e.type,node:this.allRecords.find((t=>t.type===e.type))}:{id:null,node:null}}static registerColumnType(e,t=!1){e.simpleRenderer=t,(qc.columnTypes||(qc.columnTypes={}))[e.type]=e}static getColumnClass(e){return qc.columnTypes&&qc.columnTypes[e]}generateColumnForField(e,t){var n;"string"==typeof e&&this.grid&&(e=null===(n=this.grid.store)||void 0===n?void 0:n.modelClass.fieldMap[e]);let r=e.column||Uc[e.type]||{};return"string"==typeof r&&(r={type:r}),r=Object.assign({text:e.text||A.separate(e.name),field:e.name},t,r),null!=e.precision&&(r.format.maximumFractionDigits=e.precision),e.columnType&&(r.type=e.columnType),this.createRecord(r)}}qc.registerColumnType(Gc,!0),qc._$name="ColumnStore";class Kc extends io{static get fields(){return[{name:"iconCls",internal:!0},{name:"cls",internal:!0},{name:"rowHeight",internal:!0},{name:"href",internal:!0},{name:"target",internal:!0}]}}Kc.exposeProperties(),Kc._$name="GridRowModel";class Xc extends di{static get pluginConfig(){return{chain:["destroy"],assign:["topRow","bottomRow","firstVisibleRow","lastVisibleRow","firstFullyVisibleRow","lastFullyVisibleRow","getRowById","getRecordCoords","getRow","getRowFor","getRowFromElement"]}}static get defaultConfig(){return{rowClass:Bc,prependRowBuffer:5,appendRowBuffer:5,rowHeight:null,fixedRowHeight:null,autoHeight:!1}}static get properties(){return{idMap:{},topIndex:0,lastScrollTop:0,_rows:[],heightMap:new Map,totalKnownHeight:0,_totalHeight:0,averageRowHeight:0,scrollTargetRecordId:null,refreshDetails:{topRowIndex:0,topRowTop:0}}}construct(e){e.grid._rowManager=this,super.construct(e.grid,e)}doDestroy(){this._rows.forEach((e=>e.destroy())),super.doDestroy()}initWithHeight(e,t=!1){const n=this;return n.autoHeight&&(e=n.store.allCount*n.preciseRowOffsetHeight),n.viewHeight=e,n.calculateRowCount(t),e}reinitialize(e=!1){const t=this;t.calculateRowCount(!1,!0,!0),t.topIndex+t.rowCount-1>t.store.count&&(e=!0),e&&(t.topIndex=t.lastScrollTop=0),t.scrollTargetRecordId=null;const{topRow:n}=t;n&&(n.dataIndex=t.topIndex,n.setTop(t.calculateTop(t.topIndex),!0)),t.estimateTotalHeight(),t.renderFromRow(n)}matchRowCount(e=!1){const t=this,{rows:n,grid:r,rowClass:i}=t,o=n.length,s=o-t.rowCount;if(s)if(s<0){const s=[];for(let e=o,l=o?n[o-1].dataIndex+1:0;e<t.rowCount;e++,l++)s.push(i.new({cls:r.rowCls,rowManager:t,grid:r,index:e,dataIndex:l}));n.push.apply(n,s),t.trigger("addRows",{rows:s}),e||t.renderFromRow(n[Math.max(0,o-1)])}else{var l;const{focusedCell:e}=r,i=null!=(null==e?void 0:e.id)&&(null==e||null===(l=e.cell)||void 0===l?void 0:l.contains(Lr.getActiveElement(r))),c=n.splice(o-s,s);var a;if(i)s===o?r.onFocusedRowDerender():(null===(a=t.getRowFor(e._record))||void 0===a?void 0:a.index)>=n.length&&n[n.length-1].cells[e.columnIndex].focus();t.trigger("removeRows",{rows:c}),c.forEach((e=>e.destroy()))}}calculateRowCount(e=!1,t=!0,n=!1){var r;const i=this,{store:o}=i,s=Math.ceil(i.viewHeight/i.minRowOffsetHeight),l=s+i.prependRowBuffer+i.appendRowBuffer;if(null===(r=i.grid.columns)||void 0===r||!r.count||isNaN(s))return i.rowCount=0,0;if(l<i.rowCount&&!t)return i.rowCount;if(i.visibleRowCount=s,i.rowCount=Math.min(o.count,l),!e){var a;if(i.rows&&i.rowCount!==i.rows.length){if(i.matchRowCount(n),(null===(a=i.bottomRow)||void 0===a?void 0:a.dataIndex)>=o.count&&0!==i.topRow.dataIndex){const e=i.bottomRow.dataIndex-o.count+1;for(const t of i.rows)t.dataIndex-=e;i.topIndex-=e}}else i.rowCount||i.trigger("changeTotalHeight",{totalHeight:i.totalHeight});i.grid.toggleEmptyText()}return i.rowCount}removeAllRows(){const e=this,{topRow:t}=e,n=t?e.refreshDetails={topRowIndex:t.dataIndex,topRowTop:t.top}:e.refreshDetails,r=e.rows.slice();return e.trigger("removeRows",{rows:r}),e.rows.forEach((e=>e.destroy())),e.rows.length=0,e.idMap={},n}setPosition(e){const{topRow:t}=this,{topRowIndex:n,topRowTop:r}=e;t&&(t.setTop(r),t.dataIndex=n)}get store(){return this.client.store}get rows(){return this._rows}getRow(e){if(this.rowCount)return this.rows[e-this.topIndex]}getRowById(e){return e&&e.isModel&&(e=e.id),this.idMap[e]}getRowFromElement(e){return(e=e.closest(".b-grid-row"))&&this.getRow(e.dataset.index)}getRowAt(e,t=!1){return t||(e-=bn.from(this.grid.bodyContainer,null,!0).roundPx(1).top,e+=this.grid.scrollable.y),e=Lr.roundPx(e),this.rows.find((t=>e>=t.top&&e<t.bottom))}getRowFor(e){return e instanceof HTMLElement?this.getRowFromElement(e):this.getRowById(e)}getNextRow(e){const t="number"==typeof e?e:e.index;return this.getRow((t+1)%this.rowCount)}get topRow(){return this.rows[0]}get bottomRow(){const e=Math.min(this.rowCount,this.store.count);return this.rows[e-1]}get firstVisibleRow(){return this.rows.find((e=>e.bottom>Math.ceil(this.grid.scrollable.y)))}get firstFullyVisibleRow(){return this.rows.find((e=>e.top>=Math.ceil(this.grid.scrollable.y)))}get lastVisibleRow(){const{grid:e}=this;return H.findLast(this.rows,(t=>t.top<e.scrollable.y+e.bodyHeight))}get lastFullyVisibleRow(){const{grid:e}=this;return H.findLast(this.rows,(t=>t.bottom<e.scrollable.y+e.bodyHeight))}offsetRows(e){if(0!==e){const{rows:t}=this,{length:n}=t;for(let r=0;r<n;r++)t[r].offset(e)}this.trigger("offsetRows",{offset:e})}get prependBufferHeight(){return this.prependRowBuffer*this.rowOffsetHeight}get appendBufferHeight(){return this.appendRowBuffer*this.rowOffsetHeight}get rowHeight(){return this._rowHeight}set rowHeight(e){const t=this,{grid:n,fixedRowHeight:r}=t,i=t.rowHeight;if(i!==e){if(Yt.assertNumber(e,"rowHeight"),e<10&&(e=10),t.trigger("beforeRowHeight",{height:e}),t.minRowHeight=t._rowHeight=e,r&&(t.averageRowHeight=e),t.rows.length){const o=n.scrollable.y,s=t.getRowAt(o,!0),l=s?s.top-o:0;let a,c;r?(a=e,c=i):(c=a=t.averageRowHeight,t.clearKnownHeights(),a*=e/i),t.calculateRowCount(!1,!0,!0),t.topRow.setTop(t.topRow.dataIndex*(a+n._rowBorderHeight),!0),t.refresh();o*(a/c)!==o&&n.scrollRowIntoView(s.id,{block:"start",edgeOffset:l})}t.trigger("rowHeight",{height:e,oldHeight:i})}}get rowOffsetHeight(){return Math.floor(this.preciseRowOffsetHeight)}get preciseRowOffsetHeight(){return(this.averageRowHeight||this._rowHeight)+this.grid._rowBorderHeight}get minRowOffsetHeight(){return(this.minRowHeight||this._rowHeight)+this.grid._rowBorderHeight}get allHeightsKnown(){return this.fixedRowHeight||this.heightMap.size>=this.store.count}storeKnownHeight(e,t){const n=this,{heightMap:r}=n;n.fixedRowHeight||(r.has(e)&&(n.totalKnownHeight-=r.get(e)),r.set(e,t),n.totalKnownHeight+=t,t<n.minRowHeight&&(n.minRowHeight=t),n.averageRowHeight=n.totalKnownHeight/r.size)}getOffsetHeight(e){const t=this;return(e&&t.heightMap.get(e.id)||e&&t.grid.getRowHeight(e)||t.averageRowHeight||t.rowHeight)+t.grid._rowBorderHeight}invalidateKnownHeight(e){const t=this;if(!t.fixedRowHeight){const{heightMap:n}=t;(e=H.asArray(e)).forEach((e=>{e&&n.has(e.id)&&(t.totalKnownHeight-=n.get(e.id),n.delete(e.id))})),t.averageRowHeight=t.totalKnownHeight/n.size}}clearKnownHeights(){this.heightMap.clear(),this.averageRowHeight=this.totalKnownHeight=0}calculateTop(e){if(this.fixedRowHeight)return e*this.rowOffsetHeight;const{store:t}=this;let n=0;for(let r=0;r<e;r++){const e=t.getAt(r);n+=this.getOffsetHeight(e)}return Math.floor(n)}getRecordCoords(e,t=!1,n=!1){const r=this,i=r.getRowById(e);let o=r.client._bodyRectangle;return t||(o=r.client.refreshBodyRectangle()),i?new bn(o.x,t?Math.round(i.top):Math.round(i.top+o.y-r.client.scrollable.y),o.width,i.offsetHeight):r.getRecordCoordsByIndex(r.store.indexOf(e),t,n)}getRecordCoordsByIndex(e,t=!1,n=!1){const r=this,{topRow:i,bottomRow:o}=r,s=r.client._bodyRectangle,{id:l}=r.store.getAt(e),a=r.preciseRowOffsetHeight,c=i.dataIndex,d=o.dataIndex,u=e>d?{index:e-d-1,y:o.bottom,from:"bottomRow"}:e>c/2?{index:e-c,y:i.top,from:"topRow"}:{index:e,y:0,from:"top"},h=r.allHeightsKnown&&!n?r.calculateTop(e):Math.floor(u.y+u.index*a),g=Math.floor(r.heightMap.get(l)??a),p=t?"topRow"===u.from?h+a-g:h:h+s.y-r.client.scrollable.y,m=new bn(s.x,p,s.width,g);return m.virtual=!0,m.block=m.bottom<s.y?"start":m.y>s.bottom?"end":"nearest",m}get totalHeight(){return this._totalHeight}forEach(e){this.rows.forEach(e)}[Symbol.iterator](){return this.rows[Symbol.iterator]()}refreshCell(e,t){const n=new Hc({grid:this.grid,record:e,columnId:t});return Boolean(n.cell&&n.row.renderCell(n))}returnToTop(){const e=this;e.topIndex=0,e.lastScrollTop=0,e.topRow&&(e.topRow.dataIndex=0,e.topRow.setTop(0,!0)),e.refresh(),e.grid.scrollable.y=0}renderFromRecord(e){const t=this.getRowById(e.id);t&&this.renderFromRow(t)}renderFromRow(e=null){const t=this,{rows:n,store:r}=t,i=r.count;if(0===t.calculateRowCount(!1,i<n.length,!0))return void t.estimateTotalHeight(!0);const o=e?n.indexOf(e):0;let s=e?e.dataIndex:n[0].dataIndex;const l=i-s-1,a=Math.min(n.length-1,o+l);let c,d=n.length-a-1,u=o>0?n[o-1].bottom:n[o].top;for(let e=o;e<=a;e++)c=n[e],c.dataIndex=s,c.setTop(u,!0),c.render(s,r.getAt(s++),!1),u+=c.offsetHeight;for(;d-- >0;)t.displayRecordAtTop();t.bottomRow.bottom<t.viewHeight&&t.calculateRowCount(),t.estimateTotalHeight(!0),t.trigger("renderDone")}renderRows(e){let t,n=!1;(e=Array.from(e)).sort(((e,t)=>e.dataIndex-t.dataIndex));for(const r of e)t=r.height,r.render(null,null,!1),n|=r.height!==t;n&&this.translateFromRow(e[0]),this.trigger("renderDone")}translateFromRow(e,t=!1){const n=this;let r,i,o=e.bottom;for(i=e.dataIndex+1,r=n.getRow(i);r;r=n.getRow(++i))o=r.translate(o);t||n.estimateTotalHeight(!0)}refresh(){const e=this,{topRow:t}=e;t&&!e.grid.refreshSuspended&&(e.idMap={},e.renderFromRow(t),e.trigger("refresh"))}jumpToPosition(e,t){const n=this,{store:r,heightMap:i}=n,o=r.count;if(n.allHeightsKnown&&!n.fixedRowHeight){const t=e-n.prependBufferHeight,s=n.grid._rowBorderHeight;let l=0,a=0;for(;l<t;){const e=r.getAt(a);l+=i.get(e.id)+s,a++}const c=Math.max(Math.min(a,o-n.rowCount),0);n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=c,n.topRow.setTop(n.calculateTop(c),!1),n.refresh()}else{const r=n.preciseRowOffsetHeight,i=null==t?Math.floor(e/r)-n.prependRowBuffer:t-Math.floor(n.rowCount/2),s=Math.max(Math.min(i,o-n.rowCount),0),l=n.client.scrollable.y,a=Math.min(n.client._bodyRectangle.height+l+n.appendBufferHeight,n.totalHeight);if(n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=s,n.topRow.setTop(Math.floor(s*r),!1),n.refresh(),n.bottomRow.bottom<a)for(n.calculateRowCount(!1,!1,!1);n.bottomRow.bottom<a&&n._rows[n.prependRowBuffer].top<l&&n.bottomRow.dataIndex<o-1;)n.displayRecordAtBottom();n.estimateTotalHeight()}if(null!=t){const{scrollable:r}=n.grid,i=n.getRow(t),o=i&&bn.from(i._elementsArray[0]).center.y,s=r.viewport.center.y;i&&(r.y=e=Math.floor(r.y+(o-s)))}return e}warpIfNeeded(e){const t=this,n={newScrollTop:e,deltaTop:e-t.lastScrollTop};if(Math.abs(n.deltaTop)>t.rowCount*t.rowOffsetHeight*3){let r;t.scrollTargetRecordId&&(r=t.store.indexOf(t.scrollTargetRecordId)),t.grid.onFocusedRowDerender(),n.newScrollTop=t.jumpToPosition(e,r),n.deltaTop=0}return n}updateRenderedRows(e,t,n=!1){const r=this,i=r.client._bodyRectangle;if(0===r.rowCount)return 0;let o=r.totalHeight;if(t||Math.abs(e-r.lastScrollTop)>=r.rowOffsetHeight||r.topRow.top>e||r.bottomRow.bottom<e+i.height){const t=r.warpIfNeeded(e);r.scrollTargetRecordId=null,r.lastScrollTop=t.newScrollTop,t.deltaTop>0?r.fillBelow(t.newScrollTop):t.deltaTop<0&&r.fillAbove(t.newScrollTop),r.fixedRowHeight||n||r.correctError(t,i,e),o=r.estimateTotalHeight()}return o}correctError(e,t,n){const r=this;let i=0;(r.allHeightsKnown||e.deltaTop<0&&n<2*t.height||e.deltaTop>0&&n>r.totalHeight-2*t.height-3)&&(i=r.topRow.top-r.calculateTop(r.topRow.dataIndex)),i&&(r.offsetRows(-i),r.grid.scrollable.y=r.lastScrollTop=r.grid.scrollable.y-i)}fillAbove(e){const t=this,n=e-t.topRow.top-t.prependBufferHeight;let r=0;for(;r>n&&t.topIndex>0;)r-=t.displayRecordAtTop();t.trigger("renderDone")}fillBelow(e){const t=this,n=e-t.topRow.top-t.prependBufferHeight,r=t.store.count,i=t.rowCount;let o=0;for(;o<n&&t.topIndex+i<r&&t.topRow.top+t.topRow.offsetHeight<e;)o+=t.displayRecordAtBottom();t.trigger("renderDone")}estimateTotalHeight(e=!1){const t=this;if(t.grid.renderingRows)return;const n=t.store.count,r=n-t.heightMap.size,{bottomRow:i}=t;let o;if(t.fixedRowHeight)o=n*t.rowOffsetHeight;else{if(o=t.totalKnownHeight+t.heightMap.size*t.grid._rowBorderHeight+r*t.preciseRowOffsetHeight,i&&r){const e=i.bottom;(e>o||t.topIndex+t.rowCount>=n&&o>e&&e>0)&&(o=e,i.dataIndex<n-1&&(o+=(n-1-i.dataIndex)*t.preciseRowOffsetHeight))}o=Math.floor(o)}return o!==t.totalHeight&&!1!==t.trigger("changeTotalHeight",{totalHeight:o,immediate:e})&&(t._totalHeight=o),o}displayRecordAtTop(){var e;const t=this,{grid:n}=t,r=t.topIndex-1,i=t.store.getAt(r),o=t.bottomRow,s=o.top;return t.trigger("beforeTranslateRow",{row:o,newRecord:i}),o.dataIndex===(null===(e=n.focusedCell)||void 0===e?void 0:e.rowIndex)&&n.onFocusedRowDerender(),o._top=t.topRow.top-t.getOffsetHeight(i),o.estimatedTop=!t.fixedRowHeight,o.render(r,i,!1),o._top=s,o.setBottom(t.topRow.top),o.estimatedTop=!1,t.topIndex--,t._rows.unshift(t._rows.pop()),o.offsetHeight}displayRecordAtBottom(){var e;const t=this,{grid:n}=t,r=t.topIndex+t.rowCount,i=t.store.getAt(r),o=t.topRow;return t.trigger("beforeTranslateRow",{row:o,newRecord:i}),o.dataIndex===(null===(e=n.focusedCell)||void 0===e?void 0:e.rowIndex)&&n.onFocusedRowDerender(),o.dataIndex=r,o.setTop(t.bottomRow.bottom),o.render(r,i,!1),t.topIndex++,t._rows.push(t._rows.shift()),o.offsetHeight}}Xc.featureClass="",Xc._$name="RowManager";const Jc={x:1},Qc=e=>e.isSubGrid;class Zc extends Ps{addScroller(e){(this.xScrollers||(this.xScrollers=[])).push(e)}addPartner(e,t=Jc){if("string"==typeof t&&(t={[t]:1}),t.x){e.owner.initScroll();const t=this.widget.items.filter(Qc),n=e.widget.items.filter(Qc);for(let e=0,{length:r}=t;e<r;e++)t[e].scrollable.addPartner(n[e].scrollable,"x")}t.y&&super.addPartner(e,"y")}removePartner(e){this.xScrollers.forEach(((t,n)=>{t.isDestroyed||t.removePartner(e.xScrollers[n])})),super.removePartner(e)}updateOverflowX(e){var t;const n=!1===e;null===(t=this.xScrollers)||void 0===t||t.forEach((e=>e.overflowX=n?"hidden":"hidden-scroll")),this.widget.virtualScrollers.classList.toggle("b-hide-display",n)}scrollIntoView(e,t){if(e.nodeType!==Element.ELEMENT_NODE||!this.element.contains(e))return super.scrollIntoView(e,t);for(const n of this.xScrollers)if(n.element.contains(e))return n.scrollIntoView(e,t)}hasOverflow(e="y"){return"y"===e&&this.scrollHeight>this.clientHeight}set x(e){this.xScrollers&&(this.xScrollers[0].x=e)}get x(){return this.xScrollers?this.xScrollers[0].x:0}}Zc._$name="GridScroller";class ed extends ul{static get $name(){return"Bar"}static get type(){return"gridbar"}static get defaultConfig(){return{htmlCls:"",scrollable:{overflowX:"hidden-scroll"}}}get columns(){return this._columns||this.subGrid.columns}set columns(e){this._columns=e}fixCellWidths(){const e=this,{hasFlex:t}=e.columns;let n;e.columns.traverse((t=>{const r=e.getBarCellElement(t.id),i=Lr.setLength(t.width),o=Lr.setLength(t.minWidth),s=Lr.setLength(t.maxWidth);if(r){if(n=i,r.style.maxWidth=s,t.isParent&&null==t.width&&null==t.flex){const e=t.children.reduce(((e,t)=>e+(!t.hidden&&t.flex||0)),0);r.style.flex=e>0?`${e} 0 auto`:"",r.style.minWidth=null,e>0&&t.traverse((e=>e.data.minWidth=null))}else if(parseInt(t.minWidth)>=0&&(r.style.minWidth=o),r.style.flex=r.style.flexBasis=r.style.width="",t.flex)!isNaN(parseInt(t.flex))&&t.children?r.style.flex=`${t.flex} 0 auto`:r.style.flex=t.flex;else if(parseInt(t.width)>=0){const o=t.parent;!e.isHeader||o.isRoot||o.width?r.style.flexBasis=n:r.style.width=i}t.height>=0&&(r.style.height=Lr.setLength(t.height))}})),e.scrollable.element.classList.toggle("b-has-flex",t)}getLrPadding(e){if(!this.cellLrPadding){const t=e.ownerDocument.defaultView.getComputedStyle(e);this.cellLrPadding=parseInt(t.getPropertyValue("padding-left"))+parseInt(t.getPropertyValue("padding-right"))+parseInt(t.getPropertyValue("border-left-width"))+parseInt(t.getPropertyValue("border-right-width"))}return this.cellLrPadding}getBarCellElement(e){return this.element.querySelector(`[data-column-id="${e}"]`)}}ed.initClass(),ed._$name="Bar";class td extends ed{static $name="Header";static type="gridheader";get subGrid(){return this._subGrid}set subGrid(e){this._subGrid=this.owner=e}get region(){var e;return null===(e=this.subGrid)||void 0===e?void 0:e.region}changeElement(e,t){const{region:n}=this;return this.getConfig("columns"),super.changeElement({className:{"b-grid-header-scroller":1,[`b-grid-header-scroller-${n}`]:n},children:[{reference:"headersElement",className:{"b-grid-headers":1,[`b-grid-headers-${n}`]:n},dataset:{region:n,reference:"headersElement",maxDepth:this.maxDepth}}]},t)}get overflowElement(){return this.headersElement}getColumnConfig(e){const{id:t,align:n,resizable:r,isLeaf:i,isParent:o,isLastInSubGrid:s,cls:l,childLevel:a,field:c,tooltip:d,children:u,isFocusable:h,grid:g}=e,p=null==g?void 0:g.focusedCell,m=-1===(null==p?void 0:p.rowIndex)&&(null==p?void 0:p.column)===e;if(e.isVisible)return{className:{"b-grid-header":1,"b-grid-header-parent":o,[`b-level-${a}`]:1,[`b-depth-${e.meta.depth}`]:1,[`b-grid-header-align-${n}`]:n,"b-grid-header-resizable":r&&i,[l]:l,"b-collapsible":e.collapsible,"b-last-parent":o&&s,"b-last-leaf":i&&s},role:h?"columnheader":"presentation","aria-sort":"none","aria-label":e.ariaLabel,[h?"tabIndex":""]:m?0:-1,dataset:{...ec.encodeConfig(d),columnId:t,[c?"column":""]:c},children:[{className:"b-grid-header-text",children:[{[g&&h?"id":""]:`${null==g?void 0:g.id}-column-${e.id}`,className:"b-grid-header-text-content"}]},u?{className:"b-grid-header-children",children:u.map((e=>this.getColumnConfig(e))),syncOptions:{syncIdField:"columnId"}}:null,{className:"b-grid-header-resize-handle"}]}}calculateMinWidthForSafari(){let e=0;return this.columns.visibleColumns.forEach((t=>{e+=t.calculateMinWidth()})),e}fixHeaderWidths(){this.fixCellWidths()}refreshHeaders(){const e=this;e.columns.traverse((t=>{const n=e.getBarCellElement(t.id);if(n){let r=t.headerText;t.headerRenderer&&(r=t.headerRenderer.call(t.thisObj||e,{column:t,headerElement:n})),t.headerWidgetMap&&Object.values(t.headerWidgetMap).forEach((e=>{e.render(t.textWrapper)})),t.icon&&(r=`<i class="${A.encodeHtml(t.icon)}"></i>`+(r||""));const i=n.querySelector(".b-grid-header-text-content");i&&(i.innerHTML=r||"")}})),e.fixHeaderWidths()}get columns(){const e=this,t=super.columns;return e.columnsDetacher||(e.columnsDetacher=t.ion({change(){e.initDepths()},thisObj:e}),e.initDepths()),t}set columns(e){super.columns=e}initDepths(e=this.columns.topColumns,t=null){const n=this;let r=0;null!=t&&t.meta&&t.meta.depth++;for(const i of e){const{meta:e}=i;e.depth=0,i.children&&(n.initDepths(i.children.filter(n.columns.chainedFilterFn),i),e.depth&&t&&(t.meta.depth+=e.depth)),e.depth>r&&(r=e.depth)}return t||(n.maxDepth=r),r}getHeader(e){return this.getBarCellElement(e)}get contentElement(){return this.element.firstElementChild}refreshContent(){const e=this;Cs.sync({domConfig:{children:e.columns.topColumns.map((t=>e.getColumnConfig(t))),onlyChildren:!0},targetElement:e.contentElement,strict:!0,syncIdField:"columnId",releaseThreshold:0}),e.refreshHeaders()}onPaint({firstPaint:e}){e&&this.refreshContent()}}td.initClass(),td._$name="Header";class nd extends ed{static get $name(){return"Footer"}static get type(){return"gridfooter"}get subGrid(){return this._subGrid}set subGrid(e){this._subGrid=this.owner=e}refreshContent(){this.element.firstElementChild.innerHTML=this.contentTemplate(),this.fixFooterWidths()}onPaint({firstPaint:e}){e&&this.refreshContent()}template(){const e=this.subGrid.region;return hc.tpl`
            <div class="b-grid-footer-scroller b-grid-footer-scroller-${e}" role="presentation">
                <div data-reference="footersElement" class="b-grid-footers b-grid-footers-${e}" data-region="${e}" role="presentation"></div>
            </div>
        `}get overflowElement(){return this.footersElement}getFooter(e){return this.getBarCellElement(e)}contentTemplate(){return this.columns.visibleColumns.map((e=>hc.tpl`
                <div
                    class="b-grid-footer ${e.align?`b-grid-footer-align-${e.align}`:""} ${e.cls||""}"
                    data-column="${e.field||""}" data-column-id="${e.id}" data-all-index="${e.allIndex}"
                    role="presentation">
                    ${e.footerText||""}
                </div>`)).join("")}fixFooterWidths(){this.fixCellWidths()}}nd.initClass(),nd._$name="Footer";const rd={touchstart:"onElementTouchStart",touchmove:"onElementTouchMove",touchend:"onElementTouchEnd",pointerover:"onElementMouseOver",mouseout:"onElementMouseOut",mousedown:"onElementMouseDown",mousemove:"onElementMouseMove",mouseup:"onElementMouseUp",click:"onHandleElementClick",dblclick:"onElementDblClick",keyup:"onElementKeyUp",keypress:"onElementKeyPress",contextmenu:"onElementContextMenu",pointerdown:"onElementPointerDown",pointerup:"onElementPointerUp"},id=["pageX","pageY","clientX","clientY","screenX","screenY"];function od(e,t=!0){null==e||e.classList.toggle("b-hover",t)}function sd(e,t,n=!0){t&&e&&od(t.getCell(e),n)}var ld=e=>class extends(e||fe){static get $name(){return"GridElementEvents"}static get configurable(){return{hoveredCell:null,longPressTime:400,enableUndoRedoKeys:!0,keyMap:{"Ctrl+z":"undoRedoKeyPress","Ctrl+Shift+z":"undoRedoKeyPress"," ":{handler:"clickCellByKey",weight:1e3}}}}initInternalEvents(){const e=Object.keys(rd),t=e.length,n={element:this.bodyElement,thisObj:this};for(let r=0;r<t;r++){const t=e[r];n[t]={handler:"handleEvent"},t.startsWith("touch")&&(n[t].passive=!1)}Gn.on(n),Gn.on({focusin:"onGridBodyFocusIn",element:this.bodyElement,thisObj:this,capture:!0})}getCellDataFromEvent(e,t=!1){const n=this,{columns:r}=n,{target:o}=e;let s=o.closest(".b-grid-cell");if(!s&&t&&!o.classList.contains("b-grid-row")&&!o.classList.contains("b-grid-subgrid")){const{top:t,left:o,right:a,bottom:c}=n.bodyContainer.getBoundingClientRect();let d,{x:u,y:h}=e;var l;if(u>=o&&u<=a?h=d=Math.ceil(n[(h<t?"first":"last")+"FullyVisibleRow"].element.getBoundingClientRect().y):h>=t&&h<=c&&(u=d=Math.ceil(r.visibleColumns[u<o?0:r.visibleColumns.length-1].element.getBoundingClientRect().x)),d!==i)s=null===(l=Lr.childFromPoint(e.target,e.offsetX,e.offsetY))||void 0===l?void 0:l.closest(".b-grid-cell")}if(s){const e=Nc.get(s),{id:t,columnId:i}=e,o=n.store.getById(t),l=r.getById(i);return o?{cellElement:s,cellData:e,columnId:i,id:t,record:o,column:l,cellSelector:{id:t,columnId:i}}:null}}getHeaderDataFromEvent(e){const t=e.target.closest(".b-grid-header");if(t){const e=Yt.assign({},t.dataset),{columnId:n}=e,r=this.columns.getById(n);return r?{headerElement:t,headerData:e,columnId:n,column:r}:null}}handleEvent(e){!this.disabled&&rd[e.type]&&this[rd[e.type]](e)}onElementTouchStart(e){const t=this,n=t.getCellDataFromEvent(e);Lr.isTouchEvent=!0,1===e.touches.length&&(t.longPressTimeout=t.setTimeout((()=>{t.onElementLongPress(e),e.preventDefault(),t.longPressPerformed=!0}),t.longPressTime)),n&&!e.defaultPrevented&&t.onFocusGesture(e)}onElementTouchMove(e){const t=this,{lastTouchTarget:n}=t,r=e.changedTouches[0],{pageX:i,pageY:o}=r,s=document.elementFromPoint(i,o);if(t.longPressTimeout&&(t.clearTimeout(t.longPressTimeout),t.longPressTimeout=null),s!==n){if(n){const t=new MouseEvent("mouseout",Yt.copyProperties({relatedTarget:s,pointerType:"touch",bubbles:!0},r,id));t.preventDefault=()=>e.preventDefault(),null==n||n.dispatchEvent(t)}if(s){const t=new MouseEvent("mouseover",Yt.copyProperties({relatedTarget:n,pointerType:"touch",bubbles:!0},r,id));t.preventDefault=()=>e.preventDefault(),null==s||s.dispatchEvent(t)}}t.lastTouchTarget=s}onElementTouchEnd(e){const t=this;t.longPressPerformed&&(e.cancelable&&e.preventDefault(),t.longPressPerformed=!1),t.longPressTimeout&&(t.clearTimeout(t.longPressTimeout),t.longPressTimeout=null)}onElementLongPress(e){}triggerCellMouseEvent(e,t,n=this.getCellDataFromEvent(t)){const r=this;if(n){const o=r.columns.getById(n.columnId),s={grid:r,record:n.record,column:o,cellSelector:n.cellSelector,cellElement:n.cellElement,target:t.target,event:t};var i;if(r.trigger("cell"+A.capitalize(e),s),"click"===e)null===(i=o.onCellClick)||void 0===i||i.call(o,s)}}onElementMouseDown(e){const t=this,n=t.getCellDataFromEvent(e);t.skipFocusSelection=!0,t.isScrollbarOrRowBorderOrSplitterClick(e)?e.preventDefault():(t.triggerCellMouseEvent("mousedown",e,n),n&&!e.defaultPrevented&&t.onFocusGesture(e))}isScrollbarOrRowBorderOrSplitterClick({target:e,x:t,y:n}){if(e.closest(".b-grid-splitter")||e.matches(".b-grid-row, .b-virtual-width"))return!0;if(e.matches(".b-vertical-overflow")){return t>e.getBoundingClientRect().right-Lr.scrollBarWidth}if(e.matches(".b-horizontal-overflow")){return n>e.getBoundingClientRect().bottom-Lr.scrollBarWidth-1}}onElementMouseMove(e){this.mouseMoveEvent=e}onElementMouseUp(e){}onElementPointerDown(e){}onElementPointerUp(e){}onHandleElementClick(e){!1!==this.trigger("beforeElementClick",{event:e})&&this.onElementClick(e)}onElementClick(e){const t=this,n=t.getCellDataFromEvent(e);n&&t.triggerCellMouseEvent("click",e,n)}onFocusGesture(e){const t=this,{navigationEvent:n}=t,{target:i}=e,o=2===e.button,l=!o&&i.matches(".b-icon-tree-expand, .b-icon-tree-collapse"),a=!document.hasFocus()&&s.isMac&&o;if(l||a)e.preventDefault();else{var c;t.navigationEvent=e;const s=new Hc(i);if(o||null!==(c=t.focusedCell)&&void 0!==c&&c.equals(s)){let o;r.TouchEvent&&e instanceof MouseEvent&&n instanceof TouchEvent&&i===n.target&&(o={doSelect:!1}),t.focusCell(s,o)}}}onElementDblClick(e){const{target:t}=e;if(this.triggerCellMouseEvent("dblClick",e),t.classList.contains("b-grid-header-resize-handle")){const e=t.closest(".b-grid-header");this.columns.getById(e.dataset.columnId).resizeToFitContent()}}onElementMouseOver(e){if(!this.scrolling){const n=this,{hoveredCell:r}=n,i=("number"!=typeof e.buttons||0===e.buttons)&&"touch"!==e.pointerType;let o=e.target.closest(".b-grid-cell");var t;if(!o&&e.target.classList.contains("b-grid-row"))o=null===(t=Lr.childFromPoint(e.target,e.offsetX,e.offsetY-2))||void 0===t?void 0:t.closest(".b-grid-cell");o&&(i&&(n.hoveredCell=o),!r&&n.hoveredCell&&n.triggerCellMouseEvent("mouseOver",e)),n.trigger("mouseOver",{event:e})}}onElementMouseOut(e){const t=this,{hoveredCell:n}=t,{target:r,relatedTarget:i}=e;var o;null!=i&&i.closest(".b-grid-cell")&&r.matches(".b-grid-row")||(i&&r.matches(".b-grid-cell")&&!r.contains(i)?null!=i&&i.matches(".b-grid-row")||(t.hoveredCell=i.closest(".b-grid-cell")):null!=i&&i.matches(".b-grid-row,.b-grid-cell")||null!==(o=t.hoveredCell)&&void 0!==o&&o.contains(i)||(t.hoveredCell=null));t.scrolling||(n&&!t.hoveredCell&&t.triggerCellMouseEvent("mouseOut",e),t.trigger("mouseOut",{event:e}))}updateHoveredCell(e,t){var n,r;const i=this,{selectionMode:o}=i,s=o.rowNumber&&(null===(n=i.columns.find((e=>"rownumber"==e.type)))||void 0===n?void 0:n.id),l=o.checkbox&&(null===(r=i.checkboxSelectionColumn)||void 0===r?void 0:r.id);if(t){od(t,!1);const e=Nc.get(t),{row:n}=e;var a;if(n&&!n.isDestroyed&&(sd(s,n,!1),sd(l,n,!1)),null!=e&&e.columnId)od(null===(a=i.columns.getById(e.columnId))||void 0===a?void 0:a.element,!1)}if(i._hoveredRow&&!i._hoveredRow.isDestroyed&&i._hoveredRow.removeCls("b-hover"),i._hoveredRow=null,e&&!i.scrolling){const t=Nc.get(e),{row:n}=t;var c;if(n)if(o.cell&&t.columnId!==s&&t.columnId!==l)od(e),sd(l,n),sd(s,n),od(null===(c=i.columns.getById(t.columnId))||void 0===c?void 0:c.element);else i._hoveredRow=n,n.addCls("b-hover");else i.hoveredCell=null}}keyMapOnKeyDown(e){this.element.contains(e.target)&&(this.onElementKeyDown(e),super.keyMapOnKeyDown(e))}onElementKeyDown(e){if(e.handled||!this.element.contains(e.target))return;const t=this,n=t.focusedCell;if(null!=n&&n.isCell&&!n.isActionable){var r,i;const o=n.cell;null===(r=(i=t.columns.getById(o.dataset.columnId)).onCellKeyDown)||void 0===r||r.call(i,{event:e,cellElement:o})}}undoRedoKeyPress(e){var t;const{stm:n}=this.store;return!(!n||!this.enableUndoRedoKeys||null!==(t=this.features.cellEdit)&&void 0!==t&&t.isEditing)&&(n.onUndoKeyPress(e),!0)}clickCellByKey(e){const t=this,n=t.focusedCell,r=null==n?void 0:n.cell,i=t.columns.getById(r.dataset.columnId);return!(null==n||!n.isCell||n.isActionable||!i.onCellClick)&&(i.onCellClick({grid:t,column:i,record:t.store.getById(n.id),cellElement:r,target:e.target,event:e}),!0)}onElementKeyPress(e){}onElementKeyUp(e){}onElementContextMenu(e){const t=this,n=t.getCellDataFromEvent(e);n&&(t.triggerCellMouseEvent("contextMenu",e,n),Lr.isTouchEvent&&t.onFocusGesture(e))}onInternalResize(e,t,n,i,o){const s=this;s._devicePixelRatio&&s._devicePixelRatio!==r.devicePixelRatio&&Lr.resetScrollBarWidth(),s._devicePixelRatio=r.devicePixelRatio,s._bodyRectangle=bn.client(s.bodyContainer),super.onInternalResize(...arguments),n!==o&&(s._bodyHeight=s.bodyContainer.offsetHeight,s.isPainted&&s.rowManager.initWithHeight(s._bodyHeight)),s.refreshVirtualScrollbars(),t!==i&&s.setTimeout((()=>{s.isDestroyed||s.updateResponsive(t,i)}),0)}get widgetClass(){}};const ad=new Map,cd=new Map,dd="Grid",ud={Grid:"GridBase",Scheduler:"SchedulerBase",SchedulerPro:"SchedulerProBase",Gantt:"GanttBase"},hd=/\$\d+$/;class gd{static registerFeature(e,t=!1,n=null,r=null){r=(r=A.uncapitalize(r||Object.prototype.hasOwnProperty.call(e,"$name")&&e.$$name||e.name)).replace(hd,""),Array.isArray(n)||(n=[n||dd]),n.forEach((n=>{const i=ud[n]||n,o=ad.get(i)||new Map,s=cd.get(i)||new Map;o.set(r,e),s.set(e,t),ad.set(i,o),cd.set(i,s)}))}static getTypeNameFeatures(e=dd){const t=ud[e]||e,n=ad.get(t),r={};return n&&n.forEach(((e,t)=>r[t]=e)),r}static getTypeNameDefaultFeatures(e=dd){const t=ud[e]||e,n=ad.get(t),r=cd.get(t),i={};return n&&r&&n.forEach(((e,t)=>{r.get(e)&&(i[t]=e)})),i}static getInstanceFeatures(e){return e.$meta.names.reduce(((e,t)=>Object.assign(e,this.getTypeNameFeatures(t))),{})}static getInstanceDefaultFeatures(e){return e.$meta.names.reduce(((e,t)=>Object.entries(this.getTypeNameFeatures(t)).reduce(((e,[n,r])=>(this.isDefaultFeatureForTypeName(r,t)?e[n]=r:delete e[n],e)),e)),{})}static isDefaultFeatureForTypeName(e,t=dd){const n=ud[t]||t,r=cd.get(n);return r&&r.get(e)||!1}static isDefaultFeatureForInstance(e,t){const n=t.$meta.names.slice().reverse();let r=null;for(let t=0,i=n.length;t<i&&null===r;++t){const i=cd.get(n[t]);i&&i.has(e)&&(r=i.get(e))}return r||!1}static reset(){ad.clear(),cd.clear()}}const pd={string:1,object:1,function:1};var md=e=>class extends(e||fe){static get $name(){return"GridFeatures"}set features(e){const t=this,n=gd.getInstanceDefaultFeatures(this);e=t._features=Yt.assign({},e),n&&Object.keys(n).forEach((t=>{t in e||(e[t]=!0)}));const i=gd.getInstanceFeatures(this);for(const n of Object.keys(e)){const o=e[n];if(o){const s=!r.__bryntum_code_editor_changed;if(A.uncapitalize(n)!==n){const e=`Invalid feature name '${n}', must start with a lowercase letter`;if(s)throw new Error(e);console.error(e),t._errorDuringConfiguration=e}const l=i[n];if(!l){const e=`Feature '${n}' not available, make sure you have imported it`;if(s)throw new Error(e);return console.error(e),void(t._errorDuringConfiguration=e)}Reflect.defineProperty(e,n,t.createFeatureInitializer(e,n,l,o))}}}get features(){return this._features}createFeatureInitializer(e,t,n,r){const i=[this],o=n.prototype.construct;return!0===r&&(r={}),pd[typeof r]&&(i[1]=r),{configurable:!0,get:()=>(delete e[t],n.prototype.construct=function(...r){e[t]=this,o.apply(this,r),n.prototype.construct=o},new n(...i))}}hasFeature(e){const{features:t}=this;if(t){const t=Object.getOwnPropertyDescriptor(this.features,e);if(t)return Boolean(t.value||t.get)}return!1}hasActiveFeature(e){var t,n;return Boolean((null===(t=this.features)||void 0===t?void 0:t[e])&&!(null!==(n=this.features)&&void 0!==n&&n[e].disabled))}getConfigValue(e,t){if("features"===e){const e={};for(const o in this.features){var n,r,i;const s=null===(n=this.features[o])||void 0===n||null===(r=(i=n).getCurrentConfig)||void 0===r?void 0:r.call(i,t);s?Yt.isEmpty(s)?gd.isDefaultFeatureForInstance(this.features[o].constructor,this)||(e[o]=!0):e[o]=s:e[o]=!1}return e}return super.getConfigValue(e,t)}get widgetClass(){}};const fd=Object.freeze({}),vd=Object.freeze({x:!1,y:!1}),bd=function(e){return this.focusableFinderCell.contains(e)?Lr.isFocusable(e)&&!e.disabled?Lr.NodeFilter.FILTER_ACCEPT:Lr.NodeFilter.FILTER_SKIP:Lr.NodeFilter.FILTER_REJECT};var yd=e=>class extends(e||fe){static get $name(){return"GridNavigation"}static configurable={focusable:!1,focusableSelector:".b-grid-cell,.b-grid-header.b-depth-0",isNested:!1,keyMap:{ArrowUp:{handler:"navigateUp",weight:10},ArrowRight:{handler:"navigateRight",weight:10},ArrowDown:{handler:"navigateDown",weight:10},ArrowLeft:{handler:"navigateLeft",weight:10},"Ctrl+Home":"navigateFirstCell",Home:"navigateFirstColumn","Ctrl+End":"navigateLastCell",End:"navigateLastColumn",PageUp:"navigatePrevPage",PageDown:"navigateNextPage",Enter:"activateHeader",Escape:{handler:"onEscape",weight:10},"Shift+Tab":{handler:"onShiftTab",preventDefault:!1,weight:200},Tab:{handler:"onTab",preventDefault:!1,weight:200}," ":{handler:"onSpace",preventDefault:!1}}};onStoreRecordIdChange(e){var t;null===(t=super.onStoreRecordIdChange)||void 0===t||t.call(this,e);const{focusedCell:n}=this,{oldValue:r,value:i}=e;n&&n.id===r&&(n._id=i)}onFocusedRowDerender(){const e=this,{focusedCell:t}=e;if(null!=(null==t?void 0:t.id)&&t.cell){const n=t.cell.contains(Lr.getActiveElement(e));if(e.hideHeaders)n&&e.revertFocus();else{const r=e.normalizeCellContext({rowIndex:-1,columnIndex:n?t.columnIndex:0});n?e.focusCell(r):r.cell.tabIndex=0}t.cell.tabIndex=-1}}navigateFirstCell(){this.focusCell(Hc.FIRST_CELL)}navigateFirstColumn(){this.focusCell(Hc.FIRST_COLUMN)}navigateLastCell(){this.focusCell(Hc.LAST_CELL)}navigateLastColumn(){this.focusCell(Hc.LAST_COLUMN)}navigatePrevPage(){this.focusCell(Hc.PREV_PAGE)}navigateNextPage(){this.focusCell(Hc.NEXT_PAGE)}activateHeader(e){if(e.target.classList.contains("b-grid-header")&&this.focusedCell.isColumnHeader){var t;const{column:n}=this.focusedCell;null===(t=n.onKeyDown)||void 0===t||t.call(n,e),this.getHeaderElement(n.id).click()}return!1}onEscape(e){var t,n;const r=this,{focusedCell:i}=r;!e.target.closest(".b-dragging")&&null!=i&&i.isActionable?(e.stopImmediatePropagation(),r._focusedCell=null,r.focusCell({rowIndex:i.rowIndex,column:i.column},{disableActionable:!0})):!r.isNested||!r.owner||null!==(t=(n=r.owner).catchFocus)&&void 0!==t&&t.call(n,{source:r})||r.revertFocus(!0)}onTab(e){const{target:t}=e,{focusedCell:n,bodyElement:r}=this,{isActionable:i,actionTargets:o}=n;if(i&&Lr.isEditable(t)&&!t.readOnly&&t===o[o.length-1])e.preventDefault(),this.navigateRight(e);else if(!i||t===o[o.length-1])return r.style.display="none",this.requestAnimationFrame((()=>r.style.display="")),!1}onShiftTab(e){const t=this,{target:n}=e,{focusedCell:r,bodyElement:i}=t,{cell:o,isActionable:s,actionTargets:l}=r,a=s&&Lr.isEditable(n)&&!n.readOnly,c=0===r.columnIndex&&r.rowIndex===(t.hideHeaders?0:-1);if(!c&&a&&n===l[0])e.preventDefault(),t.navigateLeft(e);else if(!s||n===l[0]){const e=!c&&!t.hideHeaders&&t.focusCell({rowIndex:-1,column:0},{disableActionable:!0});return e?(e.cell.tabIndex=-1,o.tabIndex=0,t._focusedCell=r):(i.style.display="none",t.requestAnimationFrame((()=>i.style.display=""))),!1}}onSpace(e){return this.focusedCell.isActionable||e.preventDefault(),!1}get focusedCell(){return this._focusedCell}get isActionableLocation(){var e;return null===(e=this._focusedCell)||void 0===e?void 0:e.isActionable}set focusedCell(e){this.focusCell(e)}get focusedRecord(){var e;return null===(e=this._focusedCell)||void 0===e?void 0:e.record}get cellCSSSelector(){const e=this._focusedCell;return e?`[data-index=${e.rowIndex}] [data-column-id=${e.columnId}]`:""}afterHide(){super.afterHide(...arguments),this.lastFocusedCell=null}isFocused(e){var t;return Boolean(null===(t=this._focusedCell)||void 0===t?void 0:t.equals(this.normalizeCellContext(e)))}get focusElement(){if(!this.isDestroying){let t;var e;if(this.store.count&&this._focusedCell)t=this._focusedCell.target;else t=this.normalizeCellContext({rowIndex:-1,columnIndex:(null===(e=this._focusedCell)||void 0===e?void 0:e.columnIndex)||0}).target;const n=super.focusElement;return!n||t&&t.compareDocumentPosition(n)!==Node.DOCUMENT_POSITION_PRECEDING?t:n}}onPaint({firstPaint:e}){var t;const n=this;null===(t=super.onPaint)||void 0===t||t.call(this,...arguments);const r=this.normalizeCellContext({rowIndex:n.hideHeaders?0:-1,column:n.hideHeaders?0:n.columns.find((e=>!e.hidden&&e.isFocusable))});if(r.cell){r._isDefaultFocus=!0,n._focusedCell=r;const{target:e}=r;e===r.cell&&(r.cell.tabIndex=0)}}onGridBodyFocusIn(e){const t=this,{bodyElement:n}=t,r=t.focusedCell,i=(null==r?void 0:r.initialTarget)||(null==r?void 0:r.target),{target:o,relatedTarget:s}=e,l=o.closest(t.focusableSelector);if(l&&(!Rn.currentMouseDown||Rn.isMouseDown(0)||Rn.isMouseDown(2))){var a;const u=new Hc(o),{cell:h}=u,g=null==r?void 0:r.cell,p=u.actionTargets=t.findFocusables(l),m=(!t._fromFocusCell||t.selectOnFocus)&&(o===h||t._selectActionCell)&&!(null!=o&&o._isRevertingFocus);if(!t.store.getById(l.parentNode.dataset.id)&&h!==l)return void h.focus({preventScroll:!0});if(o.matches(t.focusableSelector)){if(t.disableActionable)u._target=h;else if(p.length){var c;return t._selectActionCell=(null===(c=Rn.currentMouseDown)||void 0===c?void 0:c.target)===o,p[0].focus(),void delete t._selectActionCell}}else{var d;if(null!=r&&r.target&&s&&(!Rn.isMouseDown()||!n.contains(null===(d=Rn.currentMouseDown)||void 0===d?void 0:d.target))&&!n.contains(s)&&!u.equals(r))return void i.focus();u._target=o}if(g&&(g.classList.remove("b-focused"),g.tabIndex=-1),h&&(h.classList.add("b-focused"),u.column.onCellFocus(u),h===o&&(h.tabIndex=0),h.contains(e.relatedTarget)&&i===o))return;t._focusedCell=u,null===(a=t.onCellNavigate)||void 0===a||a.call(t,t,r,u,m),t.trigger("navigate",{lastFocusedCell:r,focusedCell:u,event:e})}else o.closest(".b-rowexpander-body")||null==i||i.focus()}findFocusables(e){const{focusableFinder:t}=this,n=[];t.currentNode=this.focusableFinderCell=e;for(let e=t.nextNode();e;e=t.nextNode())n.push(e);return n}get focusableFinder(){const e=this;return e._focusableFinder||(e._focusableFinder=e.setupTreeWalker(e.bodyElement,Lr.NodeFilter.SHOW_ELEMENT,{acceptNode:bd.bind(e)})),e._focusableFinder}restoreActiveItem(e=this._focusedCell){if(this.rowManager.count)return isNaN(e)?e.isModel||(e=this.store.getById(e)):e=this.store.getAt(e),this.focusCell(e)}focusCell(e,t=fd){var n,r;const i=this,{_focusedCell:o}=i,{scroll:s,disableActionable:l}=t,a=e===Hc.DOWN,c=e===Hc.UP;if(-1===(null===(n=e)||void 0===n?void 0:n.rowIndex)&&i.hideHeaders)return void i.revertFocus();e="number"==typeof e&&null!=o&&o.isLocation?o.move(e):i.normalizeCellContext(e);const d="doSelect"in t?t.doSelect:!e.isActionable||e.initialTarget===e.cell;if(e.equals(o)){var u,h,g;if(i.isNested&&(a||c))null!==(u=i.owner)&&void 0!==u&&null!==(h=u.catchFocus)&&void 0!==h&&h.call(u,{source:i,navigationDirection:a?"down":"up"})||i.revertFocus(!0);else null===(g=i.onCellNavigate)||void 0===g||g.call(i,i,o,e,d);return o}const p=i.getSubGridFromColumn(e.columnId),{cell:m}=e,f=m||i.getCell({rowIndex:i.rowManager.topIndex,columnId:e.columnId}),v=bn.from(p.element),b=bn.from(i.bodyElement),y=bn.from(f).moveTo(null,v.y);return!1===s||-1===e.rowIndex?t=Object.assign({},t,vd):(t=Object.assign({},t,s),y.width>v.width||y.height>b.height?t.x=t.y=!1:t.column=e.columnId,i.scrollRowIntoView(e.id,t)),(i._hoveredRow||i.hoveredCell)&&(i.hoveredCell=null),i.disableActionable=l,i.selectOnFocus=d,i._fromFocusCell=!0,null===(r=e[l?"cell":"target"])||void 0===r||r.focus({preventScroll:!0}),i.disableActionable=i.selectOnFocus=!1,delete i._fromFocusCell,e}blurCell(e){const t=this.getCell(e);t&&t.classList.remove("b-focused")}clearFocus(e){const t=this;t._focusedCell&&(t.lastFocusedCell=e?null:t._focusedCell,t.blurCell(t._focusedCell),t._focusedCell=null)}catchFocus(){}internalNextPrevCell(e=!0){const t=this,n=t._focusedCell;return n?t.focusCell({id:n.id,columnId:t.columns.getAdjacentVisibleLeafColumn(n.column,e,!0).id}):null}navigateRight(){var e;return null!==(e=arguments[0])&&void 0!==e&&e.fromKeyMap?this.focusCell(this.rtl?Hc.PREV_CELL:Hc.NEXT_CELL):(arguments[0]&&P.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevCell(!this.rtl))}navigateLeft(){var e;return null!==(e=arguments[0])&&void 0!==e&&e.fromKeyMap?this.focusCell(this.rtl?Hc.NEXT_CELL:Hc.PREV_CELL):(arguments[0]&&P.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevCell(Boolean(this.rtl)))}internalNextPrevRow(e,t=!0,n=!0){const r=this,i=r._focusedCell;if(!i)return!1;const o=r.store["get"+(e?"Next":"Prev")](i.id,!1,t);return o?r.focusCell({id:o.id,columnId:i.columnId,scroll:{x:!1}}):(e||!n||i.isColumnHeader||(this.clearFocus(),this.getHeaderElement(i.columnId).focus()),!1)}navigateDown(){var e;return null!==(e=arguments[0])&&void 0!==e&&e.fromKeyMap?this.focusCell(Hc.DOWN):(arguments[0]&&P.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevRow(!0,!1))}navigateUp(){var e;return null!==(e=arguments[0])&&void 0!==e&&e.fromKeyMap?this.focusCell(Hc.UP):(arguments[0]&&P.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevRow(!1,!1))}get widgetClass(){}},Cd=e=>class extends(e||fe){static get $name(){return"GridResponsive"}static get defaultConfig(){return{responsiveLevels:Object.freeze({small:400,medium:600,large:"*"})}}getClosestBiggerLevel(e){const t=this,n=Object.keys(Yt.assign({},t.responsiveLevels));let r=null,i=99995,o=null;return n.forEach((n=>{let s=t.responsiveLevels[n];if(["number","string"].includes(typeof s)||(s=s.levelWidth),"*"===s)o=n;else if(e<s){const t=s-e;t<i&&(i=t,r=n)}})),r||o}get responsiveLevel(){return this.getClosestBiggerLevel(this.width)}updateResponsive(e,t){const n=this,r=n.getClosestBiggerLevel(t),i=n.getClosestBiggerLevel(e);if(0===t||r!==i){const o=n.responsiveLevels[i];["number","string"].includes(typeof o)||n.applyState(o),n.columns.forEach((e=>{const t=e.responsiveLevels;t&&(t[i]?e.applyState(t[i]):t["*"]&&e.applyState(t["*"]))})),n.element.classList.remove("b-responsive-"+r),n.element.classList.add("b-responsive-"+i),n.trigger("responsive",{level:i,width:e,oldLevel:r,oldWidth:t})}}get widgetClass(){}};class wd extends Gc{static $name="RowNumberColumn";static type="rownumber";static get defaults(){return{groupable:!1,sortable:!1,filterable:!1,searchable:!1,resizable:!1,draggable:!1,minWidth:50,width:50,align:"center",text:"#",editor:!1,readOnly:!0}}construct(e){super.construct(...arguments);const t=this,{grid:n}=t;t.internalCellCls="b-row-number-cell",t.externalHeaderRenderer=t.headerRenderer,t.headerRenderer=t.internalHeaderRenderer,n&&(n.ion({bindStore:"bindStore",thisObj:t}),t.bindStore({store:n.store,initial:!0}),n.store.count&&!n.rendered&&n.ion({paint:"resizeToFitContent",thisObj:t,once:!0}))}get groupHeaderReserved(){return!0}bindStore({store:e,initial:t}){const n=this;n.detachListeners("grid"),e.ion({name:"grid",[`change${n.grid.asyncEventSuffix}`]:"onStoreChange",thisObj:n}),t||n.resizeToFitContent()||n.measureOnRender()}onStoreChange({action:e,isMove:t}){if("dataset"===e||"add"===e||"remove"===e||"removeall"===e){if("remove"===e&&t)return;const n=this.resizeToFitContent();"dataset"===e&&!n&&this.grid.store.count&&this.measureOnRender()}}measureOnRender(){this.grid.rowManager.ion({renderDone(){this.resizeToFitContent()},once:!0,thisObj:this})}renderer({record:e,grid:t}){return e.isSpecialRow?"":t.store.indexOf(e,!0)+1}resizeToFitContent(){const e=this,{store:t,element:n}=e.grid,{count:r}=t;if(r&&!e.hidden){const t=n.querySelector(`.b-grid-cell[data-column-id="${e.id}"]`);if(t){const n=t.isConnected?parseInt(Lr.getStyleValue(t,"padding-left")):e._cachedCellPadding||0,i=Lr.measureText(r,t);return e.width=Math.max(e.minWidth,i+2*n),e._cachedCellPadding=n,!0}}return!1}set flex(e){}internalHeaderRenderer({headerElement:e,column:t}){var n;return e.classList.add("b-rownumber-header"),(null===(n=t.externalHeaderRenderer)||void 0===n?void 0:n.call(this,...arguments))||t.headerText}}qc.registerColumnType(wd,!0),wd._$name="RowNumberColumn";const xd={string:1,number:1},Sd={dataset:1,batch:1};var Ed=e=>class extends(e||fe){static get $name(){return"GridSelection"}static configurable={selectionMode:{cell:!1,multiSelect:!0,checkboxOnly:!1,checkbox:!1,checkboxPosition:null,showCheckAll:!1,deselectFilteredOutRecords:!1,includeChildren:!1,includeParents:!1,preserveSelectionOnPageChange:!1,preserveSelectionOnDatasetChange:!0,deselectOnClick:!1,dragSelect:!1,selectOnKeyboardNavigation:!0,column:!1,rowNumber:!1,selectRecordOnCell:!0},keyMap:{"Shift+ArrowUp":"extendSelectionUp","Shift+ArrowDown":"extendSelectionDown","Shift+ArrowLeft":"extendSelectionLeft","Shift+ArrowRight":"extendSelectionRight"," ":{handler:"toggleSelection",weight:10}},selectedRecordCollection:{}};construct(e){this._selectedCells=[],this._selectedRows=[],super.construct(e),null!=e&&e.selectedRecords&&(this.selectedRecords=e.selectedRecords)}getDefaultGridSelection(e){return"GridSelection"===e.$name?e.configurable.selectionMode:e.superclass?this.getDefaultGridSelection(e.superclass):void 0}changeSelectionMode(e){const t=this;return t.selectionMode?(Yt.assign(t.selectionMode,e),t.selectionMode):(t.$defaultGridSelection=t.getDefaultGridSelection(t.constructor),new Proxy(e,{set(e,n,r){const i=Yt.assign({},e);return e[n]=r,t.updateSelectionMode(e,i),!0}}))}updateSelectionMode(e,t=this.$defaultGridSelection){const n=this,{columns:r,checkboxSelectionColumn:o}=n,s={},{rowReorder:l}=n.features;for(const n in e)e[n]!=t[n]&&(s[n]=e[n]);var a,c;(e.rowCheckboxSelection&&!e.checkboxOnly&&(e.checkboxOnly=!0,delete e.rowCheckboxSelection),s.column&&(e.cell=!0,e.multiSelect=!0),s.cell&&(e.checkboxOnly=!1),!1===s.cell&&(e.column=!1),s.checkboxOnly&&(e.checkbox||(e.checkbox=!0),e.cell=!1),!1===s.checkbox&&(s.checkboxOnly=!1,s.showCheckAll=!1),s.showCheckAll&&(e.checkbox=e.checkbox||!0,e.multiSelect=!0),(s.includeChildren||s.includeParents)&&(e.multiSelect=!0),!1===s.multiSelect&&(e.column=e.showCheckAll=e.dragSelect=e.includeChildren=e.includeParents=!1),s.dragSelect&&(null!=l&&l.enabled&&!0!==l.gripOnly&&(l.showGrip=l.gripOnly=!0),e.multiSelect=!0,n._selectionListenersDetachers={}),!1===s.dragSelect&&n._selectionListenersDetachers)&&(null===(a=(c=n._selectionListenersDetachers).selectiondrag)||void 0===a||a.call(c),delete n._selectionListenersDetachers.selectiondrag);!t||s.cell===i&&s.deselectFilteredOutRecords===i&&s.multiSelect===i||n.deselectAll(),s.rowNumber?r.findRecord("type","rownumber")||(r.insert(0,{..."object"==typeof e.rowNumber?e.rowNumber:{},type:"rownumber"}),n._selectionAddedRowNumberColumn=!0):!1===s.rowNumber&&n._selectionAddedRowNumberColumn&&(r.remove(r.findRecord("type","rownumber")),delete n._selectionAddedRowNumberColumn),(e.checkbox!==(null==t?void 0:t.checkbox)||e.checkbox&&e.showCheckAll!==(null==t?void 0:t.showCheckAll))&&(n.isConfiguring?n.shouldInitCheckboxSelection=!0:(t&&n.deselectAll(),n.initCheckboxSelection())),t&&e.checkbox&&t.checkbox&&e.checkboxIndex!==t.checkboxIndex&&o&&o.parent.insertChild(o,r.getAt(n.checkboxSelectionColumnInsertIndex)),n.trigger("selectionModeChange",Yt.clone(e)),n.afterSelectionModeChange(e)}afterConfigure(){this.shouldInitCheckboxSelection&&(this.shouldInitCheckboxSelection=!1,this.initCheckboxSelection()),super.afterConfigure()}initCheckboxSelection(){const e=this,{selectionMode:t,columns:n,checkboxSelectionColumn:r}=e,{checkbox:i}=t;if(r&&(e.checkboxSelectionColumn=null,n.remove(r)),i){var o,s;const r=qc.getColumnClass("check"),l=!0===i?null:i;if(!r)throw new Error("CheckColumn must be imported for checkbox selection mode to work");const a=e.checkboxSelectionColumn=new r(Yt.assign({id:`${e.id}-selection-column`,width:"4em",minWidth:"4em",field:null,sortable:!1,filterable:!1,hideable:!1,cellCls:"b-checkbox-selection",region:null===(o=e.items)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.region,showCheckAll:t.showCheckAll,draggable:!1,resizable:!1,widgets:[{type:"checkbox",valueProperty:"checked",ariaLabel:"L{Checkbox.toggleRowSelect}"}]},l),n,{isSelectionColumn:!0});a.meta.depth=0,a._grid=e;const c=a.renderer;a.renderer=t=>{t.value=e.isSelected(t.record),c.call(a,t)},a.ion({toggle:"onCheckChange",toggleAll:"onCheckAllChange",thisObj:e}),n.insert(e.checkboxSelectionColumnInsertIndex,a)}}get checkboxSelectionColumnInsertIndex(){const{columns:e}=this;let{checkboxIndex:t}=this.selectionMode;return t?"string"==typeof t&&(t=e.indexOf(e.getById(t))):t=e.indexOf(e.findRecord("type","rownumber"))+1,t}afterSelectionChange(){}afterSelectionModeChange(){}changeSelectedRecordCollection(e){return null!=e&&e.isCollection?(e.owner||(e.owner=this),e):So.new(e,{owner:this})}updateSelectedRecordCollection(e){e.ion({change:"onSelectedRecordCollectionChange",thisObj:this})}onSelectedRecordCollectionChange({added:e=[],removed:t}){this.selectedRecordCollection._fromSelection!==this&&(e=e.filter((e=>this.isSelectable(e))),this.performSelection({selectedCells:[],deselectedCells:[],selectedRecords:e,deselectedRecords:t}))}changeSelectedRecordCollectionSilent(e){this.selectedRecordCollection._fromSelection=this;const t=e(this.selectedRecordCollection);return delete this.selectedRecordCollection._fromSelection,t}bindStore(e){var t;this.detachListeners("selectionStoreFilter"),e.ion({name:"selectionStoreFilter",filter:"onStoreFilter",thisObj:this}),null===(t=super.bindStore)||void 0===t||t.call(this,e)}unbindStore(e){this.detachListeners("selectionStoreFilter"),super.unbindStore(e)}onStoreFilter({source:e}){const t=this,n=[];for(const r of t.selectedRows)e.includes(r)||n.push(r);const r=t.prepareSelection(t.selectionMode.deselectFilteredOutRecords?n:[]);if(t.isCellSelectionMode){const{deselectedCells:e}=t.prepareSelection(t.getSelectedCellsForRecords(n));null!=e&&e.length&&(r.deselectedCells=(r.deselectedCells||[]).concat(e))}(r.deselectedCells.length||r.deselectedRecords.length)&&(t.performSelection(r,!1),t.updateCheckboxHeader())}onStoreRecordIdChange({record:e,oldValue:t}){var n;null===(n=super.onStoreRecordIdChange)||void 0===n||n.call(this,...arguments);this.selectedRecordCollection.get(t)===e&&this.selectedRecordCollection.rebuildIndices()}onStoreRemove(e){var t;if(null===(t=super.onStoreRemove)||void 0===t||t.call(this,e),!e.isCollapse){const t=this,n=e.records.filter((e=>this.isSelected(e)));if(n.length){const e=t.prepareSelection(n);if(t.isCellSelectionMode){const{deselectedCells:r}=t.prepareSelection(t.getSelectedCellsForRecords(n));null!=r&&r.length&&(e.deselectedCells=(e.deselectedCells||[]).concat(r))}t.performSelection(e)}}}onStoreDataChange({action:e,source:t}){var n;const r=this,{selectionMode:i}=r;let o;if(null===(n=super.onStoreDataChange)||void 0===n||n.call(this,...arguments),"pageLoad"===e)i.preserveSelectionOnPageChange||(o=r.prepareSelection(null,null,!0)),r.updateCheckboxHeader();else if(Sd[e]){const e=[];if(!1===i.preserveSelectionOnDatasetChange)o=r.prepareSelection(null,null,!0);else{e.push(...r.changeSelectedRecordCollectionSilent((e=>e.match(t.storage))));for(const n of r._selectedCells)t.getById(n.id)||e.push(n);o=r.prepareSelection(e)}}o&&(o.deselectAll||o.deselectedCells.length||o.deselectedRecords.length||o.selectedCells.length||o.selectedRecords.length)&&(r.performSelection(o,!1),r.updateCheckboxHeader())}onStoreRemoveAll(){var e;null===(e=super.onStoreRemoveAll)||void 0===e||e.call(this),this.performSelection(this.prepareSelection(null,null,!0),!1)}onCheckChange({checked:e,record:t,checkbox:n}){const r=this,i=!r.selectionMode.multiSelect&&e,o=i||e?null:[t],s=e?[t]:null;e&&!Rn.shiftKeyDown&&(r._lastSelectionChecked=t),e&&r._lastSelectionChecked&&Rn.shiftKeyDown?r.performSelection(r.internalSelectRange(r._lastSelectionChecked,t,!0)):!1===r.performSelection(r.prepareSelection(o,s,i,!0))&&(n.checked=!n.checked)}updateCheckboxHeader(){const{selectionMode:e,checkboxSelectionColumn:t,store:n}=this;if(e.checkbox&&e.showCheckAll&&null!=t&&t.headerCheckbox){const e=n.count&&!n.some((e=>this.isSelectable(e)&&!this.isSelected(e)));t.headerCheckbox.checked!==e&&(t.suspendEvents(),t.headerCheckbox.checked=e,t.resumeEvents())}}onCheckAllChange({checked:e}){this[e?"selectAll":"deselectAll"](this.store.isPaged&&this.selectionMode.preserveSelectionOnPageChange)}get selectionDragMouseEventListenerElement(){return r}onSelectionDrag(e){const t=this,{_selectionStartCell:n}=t;if(Rn.isMouseDown()||t.onSelectionEnd(),!n)return;const{items:r,_lastSelectionDragRegion:i}=t,o=t.getCellDataFromEvent(e,!0),s=null==o?void 0:o.column.region,l=(null==o?void 0:o.cellSelector)&&t.normalizeCellContext(o.cellSelector);if(l&&!l.equals(t._lastSelectionDragCell,!0)){if(t._isSelectionDragging||t.enableScrollingCloseToEdges(r),t._clearSelectionOnSelectionDrag&&!n.equals(l,!0)&&(t.deselectAll(),delete t._clearSelectionOnSelectionDrag),i&&s!==i){var a;const e=t.subGrids[i],n=t.subGrids[s],o=e.scrollable,l=n.scrollable,c=r.indexOf(e)-r.indexOf(n)<0;if(l.x=c?0:l.maxX,c?o.x<o.maxX-1:o.x>1)return;const d=null===(a=t.scrollManager._activeScroll)||void 0===a?void 0:a.horizontal;d&&d.element!==l.element&&d.stopScroll(!0)}t._lastSelectionDragRegion=s,t._lastSelectionDragCell=l,t._isSelectionDragging=!0;const e=t._lastSelectionDragChange=t.internalSelectRange(n,l,t.isRowNumberSelecting(l)||t.isRowNumberSelecting(n));e.deselectedCells=e.deselectedCells.filter((e=>!t.isCellSelected(e))),e.deselectedRecords=e.deselectedRecords.filter((e=>!t.isSelected(e))),t.refreshGridSelectionUI(e),t.trigger("dragSelecting",e)}}onSelectionEnd(){var e,t;const n=this,r=n._lastSelectionDragChange;n._isSelectionDragging&&!n._selectionStartCell.equals(n._lastSelectionDragCell,!0)&&r&&n.performSelection(r,!1),n.disableScrollingCloseToEdges(n.items),n._isSelectionDragging=!1,n._lastSelectionDragChange=n._lastSelectionDragCell=n._lastSelectionDragRegion=null,null===(e=(t=n._selectionListenersDetachers).selectiondrag)||void 0===e||e.call(t),delete n._selectionListenersDetachers.selectiondrag}onHandleElementClick(e){const t=this;t.selectionMode.rowNumber&&e.target.closest(".b-rownumber-header")?(e.handled=!0,t.store.count&&t.store.some((e=>!t.isSelected(e)))?t.selectAll():t.deselectAll()):t.selectionMode.column&&e.target.closest(".b-grid-header")&&(e.handled=!0,t.selectColumn(e,e.ctrlKey)),super.onHandleElementClick(e)}selectColumn(e,t=!1){const n=this,{store:r}=n,{columnId:i}=n.getHeaderDataFromEvent(e);n._shiftSelectRange=null,e.shiftKey||(n._shiftSelectColumn=i);const o=e.shiftKey&&n._shiftSelectColumn||i,s=n.internalSelectRange(n.normalizeCellContext({id:r.first.id,columnId:o}),n.normalizeCellContext({id:r.last.id,columnId:i}));t&&!s.selectedCells.some((e=>!n.isCellSelected(e)))&&(s.deselectedCells=s.selectedCells,s.selectedCells=[]),t||(s.deselectedCells=n._selectedCells),n.cleanSelectionChange(s),n.performSelection(s)}isSelected(e){var t;return null!==(t=e)&&void 0!==t&&t.id&&(e=e.id),!!xd[typeof e]&&this.selectedRows.some((t=>t.id===e))}isCellSelected(e,t){return e=this.normalizeCellContext(e),this.isCellSelectionMode&&this._selectedCells.some((t=>e.equals(t,!0)))||t&&this.isSelected(e)}isSelectable(e){return this.normalizeCellContext({id:e.id||e}).isSelectable}get selectedRecord(){return this.selectedRecords[this.selectedRecords.length-1]||null}set selectedRecord(e){this.selectRow({record:e})}get selectedRecords(){return this.selectedRecordCollection.values}set selectedRecords(e){this.selectRows(e)}get selectedRows(){return[...this._selectedRows]}set selectedRows(e){this.selectRows(e)}spliceSelectedRecords(e,t,n){const r=this;if("number"==typeof t){const i=[...r.selectedRecords];i.splice(e,t,...H.asArray(n)),r.performSelection(r.prepareSelection(null,i,!0,!0))}else r.performSelection(r.prepareSelection(t,n,!1,!0))}selectRow(e){"number"!=typeof e&&!e.isModel&&"record"in e||(e={records:[e]}),Yt.assignIf(e,{scrollIntoView:!0}),this.selectRows(e)}selectRows(e){(!e||Array.isArray(e)||e.isModel||"number"==typeof e||!("records"in e)&&!("record"in e))&&(e={records:H.asArray(e)||[]});const t=this,{store:n}=t,r=[],{records:i=(e.record?[e.record]:[]),column:o=t.columns.visibleColumns[0],scrollIntoView:s,addToSelection:l=arguments[1]}=e;for(let e of i)e=n.getById(e),e&&r.push(e);l||(t._shiftSelectRange=null),t.performSelection(t.prepareSelection(null,r,!l,!0)),r.length&&s&&t.scrollRowIntoView(r[0].id,{column:o})}selectAll(e=!1){const{store:t}=this,n=(t.isGrouped?t.allRecords:t.records).filter((e=>!e.isSpecialRow));this.performSelection(this.prepareSelection(null,n,!1,!0),!0,e)}deselectAll(e=!1,t=!1){const{store:n}=this,r=e?(n.isGrouped?n.allRecords:n.records).filter((e=>!e.isSpecialRow)):null;this.performSelection(this.prepareSelection(r,null,!e),!0,t)}deselectRow(e){this.deselectRows(e)}deselectRows(e){const{store:t}=this,n=H.asArray(e).map((e=>t.getById(e))).filter((e=>e));this.performSelection(this.prepareSelection(n))}selectRange(e,t,n=!1){const r=this,{store:i}=r,o=r.internalSelectRange(i.getById(e),i.getById(t),!0);r._shiftSelectRange=null,r.performSelection(o)}get selectedCell(){return this._selectedCells[this._selectedCells.length-1]}set selectedCell(e){this.selectCells([e])}get selectedCells(){return[...this._selectedCells]}set selectedCells(e){this.selectCells(e)}get selectedCellCSSSelector(){const e=this.selectedCell,t=e&&this.getRowById(e.id);return e&&t?`[data-index=${t.dataIndex}] [data-column-id=${e.columnId}]`:""}selectCell(e){var t;return"id"in e&&(e={cell:e},e=Object.assign({scrollIntoView:arguments[1],addToSelection:arguments[2],silent:arguments[3]},e)),null===(t=this.selectCells(e))||void 0===t?void 0:t[0]}selectCells(e){Array.isArray(e)&&(e={cells:e});const t=this,{cells:n=(e.cell?[e.cell]:[]),scrollIntoView:r=!0,addToSelection:i=!1,silent:o=!1}=e,s=t.prepareSelection(null,n,!i);return i||(t._shiftSelectRange=null),t.performSelection(s,!0,o),r&&t.scrollRowIntoView(n[0].id,{column:n[0].columnId}),t.isCellSelectionMode?s.selectedCells:s.selectedRecords}deselectCell(e){var t;return null===(t=this.deselectCells([e]))||void 0===t?void 0:t[0]}deselectCells(e){const t=this.prepareSelection(e);return this.performSelection(t),this.isCellSelectionMode?t.deselectedCells:t.deselectedRecords}toggleSelection(e){const t=this,{_focusedCell:n,selectionMode:r}=t,i=t.isRowNumberSelecting(n),o=t.isCellSelected(n,!0);if(!0===r.selectOnKeyboardNavigation||n.isActionable)return!1;t.performSelection(t.prepareSelection(o?n:null,o?null:n,!r.multiSelect,i)),e.preventDefault()}selectCellRange(e,t){this.performSelection(this.internalSelectRange(e,t))}getSelection(){return this.isRowSelectionMode?this.selectedRecords:this.selectedCells}cleanSelectionChange(e){var t,n;const{deselectedRecords:r,deselectedCells:i,selectedCells:o,deselectedCellRecords:s}=e,l=null===(t=e.selectedRecords)||void 0===t?void 0:t.map((e=>e.id)),a=null===(n=e.selectedCellRecords)||void 0===n?void 0:n.map((e=>e.id));return null!=r&&r.length&&null!=l&&l.length&&(e.deselectedRecords=r.filter((e=>!l.includes(e.id)))),null!=i&&i.length&&null!=o&&o.length&&(e.deselectedCells=i.filter((e=>!o.some((t=>e.equals(t,!0)))))),s.length&&(a.length||null!=l&&l.length)&&(e.deselectedCellRecords=s.filter((e=>!a.includes(e.id)&&!l.includes(e.id)))),e}getSelectedCellsForRecords(e){return this._selectedCells.filter((t=>t.id&&e.some((e=>e.id===t.id))))}delayUntilMouseUp(e){const t=Gn.on({element:r,blur:n=>e(n,t),mouseup:n=>e(n,t),thisObj:this,once:!0})}get isRowSelectionMode(){return!this.isCellSelectionMode}get isCellSelectionMode(){return!0===this.selectionMode.cell}isRowNumberSelecting(...e){return this.selectionMode.rowNumber&&!e.some((e=>"rownumber"!==e.column.type))}extendSelectionLeft(){this.extendSelection("Left")}extendSelectionRight(){this.extendSelection("Right")}extendSelectionUp(){this.extendSelection("Up")}extendSelectionDown(){this.extendSelection("Down")}extendSelection(e){this._isKeyboardRangeSelecting=!0,this["navigate"+e](),this._isKeyboardRangeSelecting=!1}onCellNavigate(e,t,n,i){var o;const{selectionMode:s,_selectionListenersDetachers:l}=e,{multiSelect:a,deselectOnClick:c,dragSelect:d}=s,{ctrlKeyDown:u,shiftKeyDown:h}=Rn,g=Rn.isMouseDown(),p=Rn.isMouseDown(2),m=Rn.currentMouseDown||Rn.currentKeyDown;if(n=e.normalizeCellContext(n),!i||-1===n.rowIndex||null!==(o=n.record)&&void 0!==o&&o.isGroupHeader||null!=m&&m.fromKeyMap&&!s.selectOnKeyboardNavigation||e.columns.getById(n.columnId)===e.checkboxSelectionColumn||s.checkboxOnly||!0===(null==m?void 0:m.handled))return;h||(e._isAddingToSelection=u&&a,e._selectionStartCell=n),a&&d&&g&&!l.selectiondrag&&!e.preventDragSelect&&(l.selectiondrag=Gn.on({name:"selectiondrag",element:e.selectionDragMouseEventListenerElement,blur:"onSelectionEnd",mouseup:{handler:"onSelectionEnd",element:r},mousemove:"onSelectionDrag",thisObj:e})),e.preventDragSelect=!1;const f=e._selectionStartCell,v=e._isAddingToSelection;if((h&&g||e._isKeyboardRangeSelecting)&&f&&a)e.performSelection(e.internalSelectRange(f,n,e.isRowNumberSelecting(f,n)));else{var b;let t,r=!1,i=!0;if(e.isCellSelected(n,!0)){if(p)return;if(v||c)t=c?null:[n],i=!1;else if(e.selectedRecords.length+(e.isCellSelectionMode?e._selectedCells.length:0)<=1)return;r=c||a}t||v||(t=null,d&&r&&l.selectiondrag&&(e._clearSelectionOnSelectionDrag=!0));const o=(r,o)=>{var s;if(null==o||o(),(null==r||null===(s=r.target)||void 0===s?void 0:s.nodeType)===Node.ELEMENT_NODE){const e=new Hc(r.target);if(null!=e&&e.grid&&!e.equals(n,!0))return}h||(e._shiftSelectRange=null),e.performSelection(e.prepareSelection(t,i&&[n],null===t,i&&e.isRowNumberSelecting(n)))};if(null!==(b=e.features.rowReorder)&&void 0!==b&&b.isDragging)return;r?e.delayUntilMouseUp(o):o()}}prepareSelection(e,t,n=!1,r=!1){const i=this,o=i._isSelectionDragging,{includeParents:s,selectRecordOnCell:l}=i.selectionMode,a=[],c=n?i._selectedCells:[],d=[],u=n?i._selectedRows:[],h=H.keyBy(u,"id",(()=>1)),g=n?i.selectedRecords.filter((e=>!h[e.id])):[];let p=[];if(!n&&e)for(const t of H.asArray(e)){const e=i.normalizeCellContext(t),n=(null==e?void 0:e.record)||(t.isModel?t:i.store.getById(e.id));var m;if(!e.isSpecialRow)if(c.push(e),n&&!h[n.id])if(o||i.isSelected(n)?(u.push(n),h[n.id]=1):l&&i.selectedRecordCollection.get(n.id)&&!g.some((e=>e.id===n.id))&&g.push(n),i.selectionMode.includeChildren&&i.selectionMode.multiSelect&&!n.isLeaf&&null!==(m=n.allChildren)&&void 0!==m&&m.length)for(const e of n.allChildren)h[e.id]||!o&&!i.isSelected(e)||(u.push(e),h[n.id]=1)}if(t){const e={};for(const n of H.asArray(t)){const t=i.normalizeCellContext(n),o=(null==t?void 0:t.record)||(n.isModel?n:i.store.getById(t.id));var f;if(o&&!t.isSpecialRow)if(i.isCellSelectionMode&&!r&&a.push(t),(i.isRowSelectionMode||r)&&!e[o.id])if(d.push(o),e[o.id]=1,i.selectionMode.includeChildren&&i.selectionMode.multiSelect&&!o.isLeaf&&null!==(f=o.allChildren)&&void 0!==f&&f.length)for(const t of o.allChildren)e[t.id]||(d.push(t),e[t.id]=1)}l&&a.length&&(p=H.unique(a.map((e=>e.record))).filter((t=>!e[t.id])))}if(s&&(u.length||d.length)){const e=[...u,...d];H.unique(e.filter((t=>t.parent&&!t.allChildren.some((t=>e.includes(t))))).map((e=>e.parent))).forEach((e=>i.toggleParentSelection(e,d,u)))}return i.cleanSelectionChange({selectedCells:a,selectedRecords:d,deselectedCells:c,deselectedRecords:u,deselectAll:n,action:null!=d&&d.length||null!=a&&a.length?"select":"deselect",selectedCellRecords:p,deselectedCellRecords:g})}toggleParentSelection(e,t,n){if(!e||e.isRoot)return;const r=this.isSelected(e),i=t.includes(e),o=n.includes(e),s=e=>this.isSelected(e)&&!n.includes(e)||t.includes(e);"some"===this.selectionMode.includeParents?e.allChildren.some(s)?r&&!o||i||t.push(e):r&&!o&&n.push(e):r?o||i||!e.allChildren.some((e=>n.includes(e)))||n.push(e):i||e.allChildren.every(s)&&t.push(e),e.parent&&this.toggleParentSelection(e.parent,t,n)}internalSelectRange(e,t,n=!1){const r=this,i=r.isRowSelectionMode||n,o=r.prepareSelection(r._shiftSelectRange,r.getRange(e,t,i),!1,n);return r._shiftSelectRange=o["selected"+(i?"Records":"Cells")],o}getRange(e,t,n=!1){const r=this,{store:i}=r,o=r.normalizeCellContext(e),s=r.normalizeCellContext(t),l=Math.min(o.rowIndex,s.rowIndex),a=Math.max(o.rowIndex,s.rowIndex),c=[],d=Math.min(o.columnIndex,s.columnIndex),u=Math.max(o.columnIndex,s.columnIndex);if(-1===l||-1===a)throw new Error("Record not found in selectRange");if(n){const e=i.getRange(l,a+1,!1);s.rowIndex<o.rowIndex&&e.reverse(),c.push(...e)}else for(let e=l;e<=a;e++)for(let t=d;t<=u;t++)c.push({rowIndex:e,columnIndex:t});return c.map((e=>r.normalizeCellContext(e)))}performSelection(e,t=!0,n=!1){const r=this,{selectedRecords:i=[],selectedCells:o=[],selectedCellRecords:s=[],deselectedRecords:l=[],deselectedCells:a=[],deselectedCellRecords:c=[],action:d}=e,u=[...i,...s],h=[...l,...c],g=r.isRowSelectionMode;if(!1===r.trigger("beforeSelectionChange",{mode:g?"row":"cell",action:d,selected:u,deselected:h,selection:r.selectedRecords,selectedCells:o,deselectedCells:a,cellSelection:r.selectedCells}))return!1;if(r._selectedCells===a)r._selectedCells=[];else{const e=[];for(const t of r._selectedCells)a.some((e=>t.equals(e,!0)))||e.push(t);r._selectedCells=e}if(e.deselectedRecords=[...e.deselectedRecords],l===r._selectedRows)r.changeSelectedRecordCollectionSilent((e=>e.clear())),r._selectedRows.length=0;else{const e=[],t=[],n=H.keyBy(h,"id",(()=>1));for(const i of r.selectedRecords)n[i.id]||(r.isSelected(i)?e.push(i):t.push(i));r.changeSelectedRecordCollectionSilent((n=>n.values=[...e,...t])),r._selectedRows=e}if(o.length)for(const e of o)r._selectedCells.some((t=>t.equals(e,!0)))||r._selectedCells.push(e);i.length&&(r.changeSelectedRecordCollectionSilent((e=>e.add(...i))),r._selectedRows.push(...i.filter((e=>!r._selectedRows.some((t=>t.id===e.id)))))),s.length&&r.changeSelectedRecordCollectionSilent((e=>e.add(...s))),t&&r.refreshGridSelectionUI(e),r.afterSelectionChange(e),n||r.triggerSelectionChangeEvent(e)}refreshGridSelectionUI({selectedRecords:e,selectedCells:t,deselectedRecords:n,deselectedCells:r}){const i=this,{checkboxSelectionColumn:o}=i;null==o||o.suspendEvents(),i.updateGridSelectionRecords(e,!0),i.updateGridSelectionRecords(n,!1),i.updateCheckboxHeader(),null==o||o.resumeEvents(),i.isCellSelectionMode&&(i.updateGridSelectionCells(t,!0),i.selectionMode.column&&i.updateGridSelectionColumns(t)),i.updateGridSelectionCells(r,!1)}updateGridSelectionRecords(e,t){const{checkboxSelectionColumn:n}=this;if(null!=e&&e.length)for(let r=0;r<e.length;r++){const i=this.getRowFor(e[r]);i&&(i.toggleCls("b-selected",t),i.setAttribute("aria-selected",t),!n||n.hidden||e[r].isSpecialRow||(i.getCell(n.id).widget.checked=t))}}updateGridSelectionCells(e,t){if(null!=e&&e.length)for(let n=0;n<e.length;n++){const r=this.getCell(e[n]);r&&(r.setAttribute("aria-selected",t),r.classList.toggle("b-selected",t))}}updateGridSelectionColumns(e){const{count:t}=this.store;for(const r of this.columns.visibleColumns){var n;null===(n=r.element)||void 0===n||n.classList.toggle("b-selected",(null==e?void 0:e.filter((e=>e.columnId===r.id)).length)===t)}}triggerSelectionChangeEvent(e){const{selectedRecords:t=[],selectedCells:n=[],selectedCellRecords:r=[],deselectedRecords:i=[],deselectedCells:o=[],deselectedCellRecords:s=[]}=e,l=[...t,...r],a=[...i,...s],c=this.isRowSelectionMode;this.trigger("selectionChange",{mode:c?"row":"cell",action:e.action,selected:l,deselected:a,selection:this.selectedRecords,selectedCells:n,deselectedCells:o,cellSelection:this.selectedCells})}doDestroy(){var e;(null===(e=this.selectedRecordCollection)||void 0===e?void 0:e.owner)===this&&this.selectedRecordCollection.destroy(),this._selectedCells.length=0,this._selectedRows.length=0;for(const e in this._selectionListenersDetachers)this._selectionListenersDetachers[e]();super.doDestroy()}get widgetClass(){}};class Rd extends ul{static $name="Toast";static type="toast";static get configurable(){return{testConfig:{destroyTimeout:1,timeout:1e3},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}compose(){const{appendTo:e,color:t,html:n,showProgress:r,style:i,timeout:o}=this;return{parent:e||this.floatRoot,class:{...wn.normalize(t,"object"),"b-toast-hide":1},html:n,style:i,children:{progressElement:r&&{style:`animation-duration:${o/1e3}s;`,class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}doDestroy(){this.untoast(),super.doDestroy()}get nextBottom(){const{bottomMargin:e,element:t}=this;return parseInt(t.style.bottom,10)+t.offsetHeight+e}async show(){await super.show(...arguments);const e=this,{element:t}=e,{toasts:n}=Rd;var r;n.includes(e)||(t.style.bottom=((null===(r=n[0])||void 0===r?void 0:r.nextBottom)??e.bottomMargin)+"px",n.unshift(e),t.getBoundingClientRect(),t.classList.remove("b-toast-hide"),e.timeout>0&&(e.hideTimeout=e.setTimeout("hide",e.timeout)))}async hide(){const e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}untoast(){const{toasts:e}=Rd;e.includes(this)&&e.splice(e.indexOf(this),1)}static hideAll(){Rd.toasts.slice().reverse().forEach((e=>e.hide()))}static show(e){const t=Rd.new({autoDestroy:!0,rootElement:document.body},"string"==typeof e?{html:e}:e);return t.show(),t}}Rd.toasts=[],Rd.initClass(),Rd._$name="Toast";class Td{static getById(e){return ul.getById(e)}static fromElement(e,t,n){return ul.fromElement(e,t,n)}static createWidget(e={}){return e.isWidget?e:ul.create(e)}static append(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||"string"==typeof t)&&(t={appendTo:t}),t.insertFirst){const e="string"==typeof t.insertFirst?document.getElementById(t.insertFirst):t.insertFirst;e.firstChild?t.insertBefore=e.firstChild:t.appendTo=e}return e.map((e=>ul.create(Yt.assign({},t||{},e))))}static openPopup(e,t){return ul.create(Yt.assign({forElement:e},"string"==typeof t?{html:t}:t),"popup")}static showContextMenu(e,t){const n=this;return n.currentContextMenu&&n.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:(t.forElement=document.body,Array.isArray(e)&&(e=new _n(...e)),e instanceof _n&&(t.align={position:e})),t.internalListeners={destroy:n.currentContextMenu=null},n.currentContextMenu=ul.create(t,"menu")}static attachTooltip(e,t){return ul.attachTooltip(e,t)}static hasTooltipAttached(e){return ul.resolveType("tooltip").hasTooltipAttached(e)}static destroyTooltipAttached(e){return ul.resolveType("tooltip").destroyTooltipAttached(e)}static mask(e,t="Loading"){if(e)return e instanceof HTMLElement&&(e={target:e,text:t}),Hs.mask(e,e.target)}static unmask(e,t=!0){e.mask&&(t?e.mask.close():e.mask.hide())}static toast(e){return Rd.show(e)}}Td._$name="WidgetHelper";const Dd=e=>e.columns.suspendEvents(),Md=e=>e.columns.resumeEvents(),Fd=e=>{e.columns.clearCaches(),e.columns.fillFromMaster()},Id=(e,t)=>e.stateSortIndex-t.stateSortIndex;var kd=e=>class extends(e||fe){static get $name(){return"GridState"}static get configurable(){return{statefulEvents:["subGridCollapse","subGridExpand","horizontalScrollEnd","stateChange"]}}updateStore(e,t){var n;null===(n=super.updateStore)||void 0===n||n.call(this,e,t),this.detachListeners("stateStoreListeners"),null==e||e.ion({name:"stateStoreListeners",filter:"triggerUpdate",group:"triggerUpdate",sort:"triggerUpdate",thisObj:this})}updateColumns(e,t){var n;null===(n=super.updateColumns)||void 0===n||n.call(this,e,t),this.detachListeners("stateColumnListeners"),e.ion({name:"stateColumnListeners",change:"triggerUpdate",thisObj:this})}updateRowManager(e,t){var n;null===(n=super.updateRowManager)||void 0===n||n.call(this,e,t),this.detachListeners("stateRowManagerListeners"),e.ion({name:"stateRowManagerListeners",rowHeight:"triggerUpdate",thisObj:this})}triggerUpdate(){this.trigger("stateChange")}finalizeInit(){super.finalizeInit(),this.ion({selectionChange:"triggerUpdate",thisObj:this})}getState(){const e=this,t=e.element.style.cssText,n={rowHeight:e.rowHeight};if(t&&(n.style=t),e.selectedCell){const{id:t,columnId:r}=e.selectedCell;n.selectedCell={id:t,columnId:r}}return n.selectedRecords=e.selectedRecords.map((e=>e.id)),n.columns=e.columns.allRecords.map((e=>e.getState())),n.store=e.store.state,n.scroll=e.storeScroll(),n.subGrids={},e.eachSubGrid((e=>{const t=n.subGrids[e.region]=n.subGrids[e.region]||{};e.isPainted?null==e.flex&&(t.width=e.width):null!=e.config.width?t.width=e.config.width:t.flex=e.config.flex,t.collapsed=e.collapsed??!1,t.collapsed&&(t._beforeCollapseState=e._beforeCollapseState)})),n}applyState(e){const t=this;if(t.suspendRefresh(),"columns"in e){let n=!1,r=!1;t.columns.suspendEvents(),t.eachSubGrid(Dd),e.columns.forEach(((e,i)=>{const o=t.columns.getById(e.id);if(o){const s=o.generation;"region"in e&&!(e.region in t.subGrids)&&(delete e.region,delete e.locked),o.applyState(e),n=n||o.generation!==s,o.stateSortIndex=i,o.allIndex!==i&&(r=n=!0)}})),n&&t.eachSubGrid(Fd),r&&(t.eachSubGrid((e=>{e.columns.records.sort(Id),e.columns.allRecords.sort(Id)})),t.columns.sort({fn:Id,ascending:!0})),t.isPainted&&n&&t.renderContents(),t.columns.resumeEvents(),t.eachSubGrid(Md)}"subGrids"in e&&t.eachSubGrid((t=>{if(t.region in e.subGrids){const n=e.subGrids[t.region];"width"in n?t.width=n.width:"flex"in n&&(t.flex=n.flex),"collapsed"in n&&(t.collapsed=n.collapsed,t._beforeCollapseState=n._beforeCollapseState)}t.clearWidthCache()})),"rowHeight"in e&&(t.rowHeight=e.rowHeight),"style"in e&&(t.style=e.style),"selectedCell"in e&&(t.selectedCell=e.selectedCell),"store"in e&&(t.store.state=e.store),"selectedRecords"in e&&(t.selectedRecords=e.selectedRecords),t.resumeRefresh(!0),t.whenVisible((()=>t.applyScrollState(e)))}applyScrollState(e){const t=this;t.eachSubGrid((e=>e.refreshFakeScroll())),"scroll"in e&&(t.restoreScroll(e.scroll),e.scroll.scrollTop&&t.element.querySelectorAll(".b-resize-monitored").forEach((e=>{const t=Td.fromElement(e);t&&t.onElementResize(e)})))}get widgetClass(){}};const Od=Promise.resolve(),Ld={block:"nearest"};class Ad extends Ps{static configurable={propagate:!1,overflowX:"hidden-scroll",yScroller:null};updateYScroller(e){null==e||e.addScroller(this)}scrollIntoView(e,t=Ld){const{xDelta:n,yDelta:r}=this.getDeltaTo(e,t);let i=n||r?this.scrollBy(n,r,t):Od;if(t.highlight||t.focus){const o=i;i=i.then((()=>{var i;o.cancelled||(e=e instanceof bn?e:(null===(i=t.elementAfterScroll)||void 0===i?void 0:i.call(t))??e,t.highlight&&(e instanceof bn?e.translate(-n,-r).highlight():Lr.highlight(e)),t.focus&&Lr.focusWithoutScrolling(e))})),i.cancel=()=>{var e;return null===(e=o.cancel)||void 0===e?void 0:e.call(o)}}return i}scrollBy(e,t,n){const r=t&&this.yScroller.scrollBy(0,t,n),i=e&&super.scrollBy(e,0,n),o=Promise.all([i,r]);return o.cancel=()=>{var e,t;null==i||null===(e=i.cancel)||void 0===e||e.call(i),null==r||null===(t=r.cancel)||void 0===t||t.call(r),o.cancelled=!0},null!=i&&i.cancel&&null!=r&&r.cancel&&(n.force=!0),o}scrollTo(e,t,n){const r=null!=t&&this.yScroller.scrollTo(null,t,n),i=null!=e&&super.scrollTo(e,null,n);n&&n.animate||this.syncPartners();const o=Promise.all([i,r]);return o.cancel=()=>{var e,t;null==i||null===(e=i.cancel)||void 0===e||e.call(i),null==r||null===(t=r.cancel)||void 0===t||t.call(r),o.cancelled=!0},null!=i&&i.cancel&&null!=r&&r.cancel&&(n.force=!0),o}get viewport(){const e=bn.from(this.element);return e.intersect(bn.from(this.yScroller.element))||new bn(e.x,e.y,e.width,0)}set y(e){this.yScroller&&(this.yScroller.y=e)}get y(){return this.yScroller?this.yScroller.y:0}get maxY(){return this.yScroller?this.yScroller.maxY:0}get scrollHeight(){return this.yScroller?this.yScroller.scrollHeight:0}get clientHeight(){return this.yScroller?this.yScroller.clientHeight:0}suspendEvents(){var e;super.suspendEvents(),null===(e=this.yScroller)||void 0===e||e.suspendEvents()}resumeEvents(){var e;super.resumeEvents(),null===(e=this.yScroller)||void 0===e||e.resumeEvents()}}Ad._$name="SubGridScroller";const Pd=(e,t)=>e+t.getBoundingClientRect().width;class _d extends ul{static get $name(){return"SubGrid"}static get type(){return"subgrid"}static get defaultConfig(){return{insertRowsBefore:null,appendTo:null,monitorResize:!0,headerClass:null,footerClass:null,weight:null,collapsed:null,scrollable:{overflowX:"hidden-scroll"},scrollerClass:Ad,hasCalculatedWidth:null,sealedColumns:null}}static get configurable(){return{element:!0,header:{},footer:{},virtualScrollerElement:!0,splitterElement:!0,headerSplitter:!0,scrollerSplitter:!0,footerSplitter:!0,resizable:null,role:"presentation"}}static delayable={hideOverlayScroller:1e3};construct(e){const t=this;if(super.construct(e),this.rowManager.ion({addRows:"onAddRow",thisObj:this}),s.isFirefox){const{element:e}=t,n=t.grid.scrollable;let r=0;e.addEventListener("wheel",(({ctrlKey:i,deltaY:o,deltaX:s})=>{const l=Math.abs(o)>Math.abs(s);i||!l||t.scrollEndDetacher||n.y===r||(e.style.pointerEvents="none",r=n.y,t.scrollEndDetacher=n.ion({scrollEnd:async()=>{r=n.y,e.style.pointerEvents="",t.scrollEndDetacher=null},once:!0}))}))}P.isTestEnv&&(t.hideOverlayScroller.delay=50)}doDestroy(){var e;const t=this;t.header.destroy(),t.footer.destroy(),null===(e=t.fakeScroller)||void 0===e||e.destroy(),t.virtualScrollerElement.remove(),t.splitterElements.forEach((e=>e.remove())),super.doDestroy()}get barConfig(){const e=this,{width:t,flex:n}=e.element.style,r={subGrid:e,parent:e,maxWidth:e.maxWidth||i,minWidth:e.minWidth||i};return n?r.flex=n:t&&(r.width=t),r}changeHeader(e){return new this.headerClass(Yt.assign({id:this.id+"-header"},this.barConfig,e))}changeFooter(e){return new this.footerClass(Yt.assign({id:this.id+"-footer"},this.barConfig,e))}get splitterElements(){return[this.splitterElement,this.headerSplitter,this.scrollerSplitter,this.footerSplitter]}toggleSplitterCls(e,t=!0){this.splitterElements.forEach((n=>null==n?void 0:n.classList[t?"add":"remove"](e)))}hideSplitter(){this.splitterElements.forEach((e=>e.classList.add("b-hide-display"))),this.$showingSplitter=!1}showSplitter(){this.splitterElements.forEach((e=>e.classList.remove("b-hide-display"))),this.$showingSplitter=!0}changeElement(e,t){const{region:n}=this;return super.changeElement({"aria-label":n,className:{"b-grid-subgrid":1,[`b-grid-subgrid-${n}`]:n,"b-grid-subgrid-collapsed":this.collapsed},dataset:{region:n}},t)}get rowElementConfig(){const{grid:e}=this;return{role:"row",className:e.rowCls,children:this.columns.visibleColumns.map(((t,n)=>({role:"gridcell","aria-colindex":n+1,tabIndex:e.cellTabIndex,className:"b-grid-cell",dataset:{column:t.field||"",columnId:t.id}})))}}changeVirtualScrollerElement(){const e=Lr.createElement({role:"presentation",reference:"virtualScrollerElement",className:"b-virtual-scroller",tabIndex:-1,dataset:{region:this.region},children:[{reference:"virtualScrollerWidth",className:"b-virtual-width"}]});return this.virtualScrollerWidth=e.virtualScrollerWidth,e.virtualScrollerElement}changeSplitterElement(){const e=Lr.createElement({reference:"splitterElement",className:{"b-grid-splitter":1,"b-grid-splitter-collapsed":this.collapsed,"b-hide-display":1},dataset:{region:this.region},children:[s.isTouchDevice?{className:"b-splitter-touch-area"}:null,{className:"b-grid-splitter-inner b-grid-splitter-main",children:[{className:"b-grid-splitter-buttons",reference:"splitterButtons",children:[{className:"b-grid-splitter-button-collapse",children:[s.isTouchDevice?{className:"b-splitter-button-touch-area"}:null,{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",className:"b-grid-splitter-button-icon b-gridregion-collapse-arrow",viewBox:"0 0 256 512",children:[{tag:"path",d:"M192 448c-8.188 0-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L77.25 256l137.4 137.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448z"}]}]},{className:"b-grid-splitter-button-expand",children:[s.isTouchDevice?{className:"b-splitter-button-touch-area"}:null,{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",className:"b-grid-splitter-button-icon b-gridregion-expand-arrow",viewBox:"0 0 256 512",children:[{tag:"path",d:"M64 448c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L41.38 118.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l160 160c12.5 12.5 12.5 32.75 0 45.25l-160 160C80.38 444.9 72.19 448 64 448z"}]}]}]}]}]});return this.splitterButtons=e.splitterButtons,e.splitterElement}get splitterConfig(){return{className:this.splitterElement.className.trim(),children:[s.isTouchDevice?{className:"b-splitter-touch-area"}:null,{className:"b-grid-splitter-inner"}],dataset:{region:this.region}}}changeHeaderSplitter(){return Lr.createElement(this.splitterConfig)}changeScrollerSplitter(){return Lr.createElement(this.splitterConfig)}changeFooterSplitter(){return Lr.createElement(this.splitterConfig)}render(...e){const t=this;super.render(...e),t.grid&&(t.updateHasFlex(),t.element.parentNode.insertBefore(t.splitterElement,t.element.nextElementSibling),t.splitterElements.forEach((e=>Gn.on({element:e,mouseenter:"onSplitterMouseEnter",mouseleave:"onSplitterMouseLeave",thisObj:t}))),t._collapsed&&t.collapse())}toggleHeaders(e){const t=this;if(e)t.headerSplitter.remove(),t.header.element.remove(),t.scrollable.removePartner(t.header.scrollable,"x");else{const{grid:e}=t;if(!t.isConfiguring){const n=2*e.items.indexOf(t);Lr.insertAt(e.headerContainer,t.headerSplitter,n),Lr.insertAt(e.headerContainer,t.header.element,n),t.refreshHeader()}t.scrollable.addPartner(t.header.scrollable,"x")}}refreshHeader(){this.header.refreshContent()}refreshFooter(){var e;null===(e=this.footer)||void 0===e||e.refreshContent()}eachWidget(e,t=!0){const n=[this.header,this.footer];for(let r=0;r<n.length;r++){const i=n[r];if(!1===e(i))return;t&&i.eachWidget&&i.eachWidget(e,t)}}fixCellWidths(e){const{visibleColumns:t}=this.columns;let n=e.firstElementChild,r=0;for(;n;){const e=t[r],{element:i}=e;e.minWidth&&(n.style.minWidth=Lr.setLength(e.minWidth)),e.maxWidth&&(n.style.maxWidth=Lr.setLength(e.maxWidth)),e.flex?e.childLevel&&i?(n.style.flex=`0 0 ${i.getBoundingClientRect().width}px`,n.style.width=""):(n.style.flex=e.flex,n.style.width=""):e.width?n.style.width=Lr.setLength(e.width):n.style.flex=n.style.width=n.style.minWidth="",n=n.nextElementSibling,r++}}get totalFixedWidth(){return this.columns.totalFixedWidth}fixWidths(){const e=this,{element:t,header:n,footer:r}=e;if(!e.collapsed){if(e.flex)n.flex=e.flex,r&&(r.flex=e.flex),t.style.flex=e.flex;else{if(e.hasCalculatedWidth&&!e.columns.some((e=>!e.hidden&&e.flex))&&e.totalFixedWidth!==e.width)return e.width=e.totalFixedWidth,void(e.hasCalculatedWidth=!0);let i=e.width;if(!i&&e.hasCalculatedWidth){i=0;for(const t of e.columns)t.flex||t.hidden||(i+=t.width)}t.style.width=`${i}px`,n.width=i,r&&(r.width=i)}e.handleHorizontalScroll(!1)}}fixRowWidthsInSafariEdge(){if(s.isSafari){const e=this,{region:t,header:n}=e,r=n.calculateMinWidthForSafari();e.rowManager.forEach((e=>{const n=e.getElement(t);n&&(n.style.width=`${r}px`)})),n.headersElement.style.width=`${r}px`}}set width(e){const t=this;var n,r;(t.hasCalculatedWidth=!1,super.width=e,t.header.width=e,t.footer.width=e,t.isPainted&&t.onElementResize(),t.isExpanding||t.isCollapsing||t.isConfiguring)||(null===(n=(r=t.grid).syncSplits)||void 0===n||n.call(r,(n=>n.subGrids[t.region]&&(n.subGrids[t.region].width=e))))}get width(){return super.width}set flex(e){const t=this;var n,r;(t.hasCalculatedWidth=!1,t.header.flex=e,t.footer.flex=e,super.flex=e,t.isPainted&&t.onElementResize(),t.isExpanding||t.isCollapsing||t.isConfiguring)||(null===(n=(r=t.grid).syncSplits)||void 0===n||n.call(r,(n=>n.subGrids[t.region]&&(n.subGrids[t.region].flex=e))))}get flex(){return super.flex}onInternalResize(e,t,n,r,i){const o=this,{grid:s}=o;super.onInternalResize(...arguments),null!=s&&s.isPainted&&(o.syncSplitterButtonPosition(),t!==r&&(o.trigger("beforeInternalResize",o),s.trigger("horizontalScroll",{grid:s,subGrid:o,scrollLeft:o.scrollable.scrollLeft,scrollX:o.scrollable.x}),s.trigger("horizontalScrollEnd",{subGrid:o}),o.fakeScroller&&o.refreshFakeScroll(),s.syncFlexedSubCols(),o.fixRowWidthsInSafariEdge()),n!==i&&s.onHeightChange(),o.trigger("afterInternalResize",o))}syncParallelSplitters(e){const t=this,{grid:n}=t;if(t.splitterElement&&t.$showingSplitter)t.toggleSplitterCls("b-grid-splitter-collapsed",e);else{const r=n.getSubGrid(n.getPreviousRegion(t.region));r&&r.splitterElement&&r.syncParallelSplitters(e)}}onSplitterMouseEnter(){const e=this,{nextSibling:t}=e;e.collapsed||t&&t.collapsed||e.toggleSplitterCls("b-hover"),e.startSplitterButtonSyncing()}onSplitterMouseLeave(){const e=this,{nextSibling:t}=e;e.toggleSplitterCls("b-hover",!1),e.collapsed||t&&t.collapsed||e.stopSplitterButtonSyncing()}startSplitterButtonSyncing(){const e=this;e.splitterElement&&(e.syncSplitterButtonPosition(),e.splitterSyncScrollListener||(e.splitterSyncScrollListener=e.grid.scrollable.ion({scroll:"syncSplitterButtonPosition",thisObj:e})))}stopSplitterButtonSyncing(){this.splitterSyncScrollListener&&(this.splitterSyncScrollListener(),this.splitterSyncScrollListener=null)}syncSplitterButtonPosition(){const{grid:e}=this;this.splitterButtons.style.top=`${e.scrollable.y+(e.bodyHeight-(this.headerSplitter?e.headerHeight:0))/2}px`}get viewRectangle(){const{scrollable:e}=this;return new bn(e.x,e.y,this.width||0,this.rowManager.viewHeight)}updateHasFlex(){this.scrollable.element.classList.toggle("b-has-flex",this.columns.hasFlex)}updateResizable(e){this.splitterElements.forEach((t=>Lr.toggleClasses(t,["b-disabled"],!e)))}resizeColumnsToFitContent(){this.grid.beginGridMeasuring(),this.columns.visibleColumns.forEach((e=>{e.resizeToFitContent(null,null,!0)})),this.grid.endGridMeasuring()}get overflowingHorizontally(){return!this.collapsed&&this.scrollable.hasOverflow("x")}get overflowingVertically(){return!1}refreshFakeScroll(){const e=this,{element:t,virtualScrollerElement:n,virtualScrollerWidth:r,header:i,footer:o,scrollable:s}=e,l=[...i.contentElement.children].reduce(Pd,0);s.scrollWidth=l,n.style.width=t.style.width,n.style.flex=t.style.flex,n.style.minWidth=t.style.minWidth,n.style.maxWidth=t.style.maxWidth,i.scrollable.syncOverflowState(),o.scrollable.syncOverflowState(),e.collapsed||(e.overflowingHorizontally?(r.style.width=`${s.scrollWidth||0}px`,e.grid.virtualScrollers.classList.remove("b-hide-display")):r.style.width=0)}initScroll(){const e=this,{scrollable:t,virtualScrollerElement:n,grid:r}=e;s.isFirefox&&t.element.addEventListener("wheel",(e=>{e.deltaX&&(t.x+=e.deltaX,e.preventDefault())})),e.fakeScroller=new Ps({element:n,overflowX:!0,widget:e}),t.ion({scroll:"onSubGridScroll",scrollend:"onSubGridScrollEnd",thisObj:e}),r.hideHorizontalScrollbar||(t.addPartner(e.fakeScroller,"x"),e.refreshFakeScroll()),r.hideHeaders||t.addPartner(e.header.scrollable,"x"),r.hideFooters||t.addPartner(e.footer.scrollable,"x")}onSubGridScrollEnd(e){const t=this,{grid:n}=t;t.scrollingToCenter=null==e?void 0:e.scrollingToCenter,t.scrolling=!1,t.handleHorizontalScroll(!1),Lr.scrollBarWidth||(n.virtualScrollers.classList.remove("b-scrolling"),t.hideOverlayScroller()),n.trigger("horizontalScrollEnd",{subGrid:t})}onSubGridScroll(e){this.scrollingToCenter=null==e?void 0:e.scrollingToCenter,this.handleHorizontalScroll()}showOverlayScroller(){this.hideOverlayScroller.cancel(),this.virtualScrollerElement.classList.add("b-show-virtual-scroller")}hideOverlayScroller(){this.virtualScrollerElement.classList.remove("b-show-virtual-scroller")}set scrolling(e){this._scrolling=e}get scrolling(){return this._scrolling}handleHorizontalScroll(e=!0){const t=this,{grid:n}=t;!t.scrolling&&e&&(t.scrolling=!0,Lr.scrollBarWidth||(n.virtualScrollers.classList.add("b-scrolling"),t.showOverlayScroller())),n.trigger("horizontalScroll",{subGrid:t,grid:n,scrollLeft:t.scrollable.scrollLeft,scrollX:t.scrollable.x,scrollingToCenter:null==t?void 0:t.scrollingToCenter})}scrollColumnIntoView(e,t){const{columns:n,header:r}=this,i=r.scrollable;if(e=e instanceof Gc?e:n.get(e)||n.getById(e)||n.getAt(e)){const n=r.getHeader(e.id);if(n)return i.scrollIntoView(bn.from(n,null,!0),t)}}onAddRow({rows:e,isExport:t}){const n=this,r=n.rowElementConfig,i=document.createDocumentFragment();e.forEach((e=>{const t=Lr.createElement(r);i.appendChild(t),e.addElement(n.region,t),n.fixCellWidths(t)})),t||(n.fixRowWidthsInSafariEdge(),n.element.insertBefore(i,n.insertRowsBefore))}get rowElements(){return this.fromCache(".b-grid-row",!0)}clearRows(){this.emptyCache();const e=this.element.querySelectorAll(".b-grid-row"),t=document.createRange();e.length&&(t.setStartBefore(e[0]),t.setEndAfter(e[e.length-1]),t.deleteContents())}addNewRowElement(){const e=Lr.append(this.element,this.rowElementConfig);return this.fixCellWidths(e),e}get store(){return this.grid.store}get rowManager(){var e;return null===(e=this.grid)||void 0===e?void 0:e.rowManager}toggleTransitionClasses(e=!1){const t=this,n=t.grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=n.resolveSplitter(r);r.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),r.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),i.classList[e?"remove":"add"]("b-grid-splitter-animate")}get collapsed(){return this._collapsed}set collapsed(e){this.isConfiguring?this._collapsed=e:e?this.collapse():this.expand()}async collapse(){var e;const t=this,{grid:n,element:r}=t,i=n.getSubGrid(n.getNextRegion(t.region)),o=t.splitterElement?t:t.previousSibling;let{_beforeCollapseState:s}=t,l=0;if(!n.rendered||!0!==t._collapsed){if(t.isCollapsing=!0,n.eachSubGrid((e=>{e!==t&&!e._collapsed&&++l})),null===(e=n.syncSplits)||void 0===e||e.call(n,(e=>{var n;return null===(n=e.subGrids[t.region])||void 0===n?void 0:n.collapse()})),0===l){if(!i)return;await i.expand()}return new Promise((e=>{if(s)e();else{s=t._beforeCollapseState={};let n=!1;t.width&&(n=!0,t.ion({afterinternalresize:()=>{e(t)},thisObj:t,once:!0})),s.width=t.width,s.elementWidth=r.style.width,""===i.element.style.flex&&(s.nextRegionWidth=i.width,i.width="",i.flex="1"),""!==r.style.flex&&(s.flex=r.style.flex,t.header.element.style.flex=r.style.flex=""),r.classList.add("b-grid-subgrid-collapsed"),t.virtualScrollerElement.classList.add("b-collapsed"),t.header.element.classList.add("b-collapsed"),t.footer.element.classList.add("b-collapsed"),t._collapsed=!0,t.width="",n||(t.syncParallelSplitters(!0),e(!1))}n.trigger("subGridCollapse",{subGrid:t}),n.afterToggleSubGrid({subGrid:t,collapsed:!0}),t.isCollapsing=!1})).then((e=>{var r;t.isDestroyed||!1!==e&&(n.refreshVirtualScrollbars(),t.syncParallelSplitters(!0),null===(r=o.startSplitterButtonSyncing)||void 0===r||r.call(o))}))}}async expand(){var e;const t=this,{grid:n,_beforeCollapseState:r}=t,i=n.getSubGrid(n.getNextRegion(t.region)),o=t.splitterElement?t:t.previousSibling;if(!n.rendered||!0===t._collapsed)return t.isExpanding=!0,null===(e=n.syncSplits)||void 0===e||e.call(n,(e=>{var n;return null===(n=e.subGrids[t.region])||void 0===n?void 0:n.expand()})),new Promise((e=>{if(null!=r){let n=!1;t.width!==r.elementWidth&&(n=!0,t.ion({afterinternalresize(){t.setTimeout((()=>e(t)),10)},thisObj:t,once:!0})),r.nextRegionWidth&&(i.width=r.nextRegionWidth,i.flex=null),t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,t.virtualScrollerElement.classList.remove("b-collapsed"),t.header.element.classList.remove("b-collapsed"),t.footer.element.classList.remove("b-collapsed"),r.flex?(t.width=r.width,t.header.flex=t.flex=r.flex,t.footer.flex=r.flex,t._width=null):t.width=r.elementWidth,t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,n?(o.stopSplitterButtonSyncing(),t.syncParallelSplitters(!1)):e(!1),delete t._beforeCollapseState}else e();n.trigger("subGridExpand",{subGrid:t}),n.afterToggleSubGrid({subGrid:t,collapsed:!1}),t.isExpanding=!1}))}hide(){var e,t;return null===(e=this.header)||void 0===e||e.hide(),null===(t=this.footer)||void 0===t||t.hide(),this.hideSplitter(),super.hide()}show(){var e,t;const n=this;return null===(e=n.header)||void 0===e||e.show(),null===(t=n.footer)||void 0===t||t.show(),n.region!==n.grid.regions[n.grid.regions.length-1]&&n.showSplitter(),super.show()}}_d.initClass(),_d._$name="SubGrid";var $d=e=>class extends(e||fe){static get $name(){return"GridSubGrids"}static get properties(){return{subGrids:{}}}changeSubGridConfigs(e){const t=this,n=new Set;for(const r of t.columns){const{region:t}=r;t&&(e[t]||(e[t]={}),n.add(t))}e.normal&&Yt.isEmpty(e.normal)&&(e.normal=jd.defaultConfig.subGridConfigs.normal);for(const r of n)t.createSubGrid(r,e[r]);return t.items=t.subGrids,e}createSubGrid(e,t=null){const n=this,r=n.columns.makeChained((t=>t.region===e),["region"]),i=Yt.assign({type:"subgrid",id:`${n.id}-${e}Subgrid`,parent:n,grid:n,region:e,headerClass:n.headerClass,footerClass:n.footerClass,columns:r,weight:e,scrollable:{yScroller:n.scrollable}},t||n.subGridConfigs[e]);let o=!1;i.flex||i.width||(i.width=r.totalFixedWidth,o=!0);const s=n.subGrids[e]=_d.create(i);return s.hasCalculatedWidth=o,e===n.regions[0]&&(s.isFirstRegion=!0),s}onChildAdd(e){if(e.isSubGrid){const t=this,{items:n,headerContainer:r,virtualScrollers:i,footerContainer:o}=t,s=2*n.indexOf(e);t.hideHeaders||(Lr.insertAt(r,e.headerSplitter,s),Lr.insertAt(r,e.header.element,s)),Lr.insertAt(i,e.scrollerSplitter,s),Lr.insertAt(i,e.virtualScrollerElement,s),Lr.insertAt(o,e.footerSplitter,s),Lr.insertAt(o,e.footer.element,s),n.forEach(((e,t)=>{t<n.length-1&&e.showSplitter()})),0===s&&t.emptyTextEl&&e.element.appendChild(t.emptyTextEl)}return super.onChildAdd(e)}onChildRemove(e){if(super.onChildRemove(e),e.isSubGrid){const{items:t}=this;delete this.subGrids[e.region],H.remove(this.regions,e.region),e.destroy(),t.length&&t[t.length-1].hideSplitter()}}doDestroy(){this.eachSubGrid((e=>e.destroy())),super.doDestroy()}eachSubGrid(e,t=null){this.items.forEach(((n,r)=>{n.isSubGrid&&e.call(t||n,n,r++)}))}callEachSubGrid(e,...t){let n=null;return this.items.forEach(((r,i)=>{if(r.isSubGrid&&r[e]){const o=r[e](...t);0===i&&(n=o)}})),n}get regions(){return this.items.map((e=>e.region))}getLastRegions(){const e=this.regions.slice(-2);return 2===e.length?e:[e[0],e[0]]}getNextRegion(e){const t=this.regions;return t[t.indexOf(e)+1]||t[t.length-2]}getPreviousRegion(e){return this.regions[this.regions.indexOf(e)-1]}getSubGrid(e){return this.subGrids[e]}getSubGridFromColumn(e){return e=e instanceof Gc?e:this.columns.getById(e)||this.columns.get(e),this.getSubGrid(e.region)}resolveSplitter(e){const t=this.getLastRegions();let n=e instanceof _d?e.region:e;return t[1]===n&&(n=t[0]),this.subGrids[n].splitterElement}get widgetClass(){}},Nd=e=>class extends e{static $name="LoadMaskable";static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const e=this,{loadMask:t}=e;return t&&(e.masked=Hs.mergeConfigs(e.loadMaskDefaults,t)),e.masked}applyMaskError(e){const{loadMaskError:t,masked:n}=this;return!1===t?n.hide():n&&(Yt.assign(n.errorDefaults,t),n.error=e),n}get widgetClass(){}};const Hd={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",ColumnPicker:{column:"Column",columnsMenu:"Columns",hideColumn:"Hide column",hideColumnShort:"Hide",newColumns:"New columns"},Filter:{applyFilter:"Apply filter",filter:"Filter",editFilter:"Edit filter",on:"On",before:"Before",after:"After",equals:"Equals",lessThan:"Less than",moreThan:"More than",removeFilter:"Remove filter",disableFilter:"Disable filter"},FilterBar:{enableFilterBar:"Show filter bar",disableFilterBar:"Hide filter bar"},Group:{group:"Group",groupAscending:"Group ascending",groupDescending:"Group descending",groupAscendingShort:"Ascending",groupDescendingShort:"Descending",stopGrouping:"Stop grouping",stopGroupingShort:"Stop"},HeaderMenu:{moveBefore:e=>`Move before "${e}"`,moveAfter:e=>`Move after "${e}"`,collapseColumn:"Collapse column",expandColumn:"Expand column"},ColumnRename:{rename:"Rename"},MergeCells:{mergeCells:"Merge cells",menuTooltip:"Merge cells with same value when sorted by this column"},Search:{searchForValue:"Search for value"},Sort:{sort:"Sort",sortAscending:"Sort ascending",sortDescending:"Sort descending",multiSort:"Multi sort",removeSorter:"Remove sorter",addSortAscending:"Add ascending sorter",addSortDescending:"Add descending sorter",toggleSortAscending:"Change to ascending",toggleSortDescending:"Change to descending",sortAscendingShort:"Ascending",sortDescendingShort:"Descending",removeSorterShort:"Remove",addSortAscendingShort:"+ Ascending",addSortDescendingShort:"+ Descending"},Split:{split:"Split",unsplit:"Unsplit",horizontally:"Horizontally",vertically:"Vertically",both:"Both"},Column:{columnLabel:e=>`${e.text?`${e.text} column. `:""}SPACE for context menu${e.sortable?", ENTER to sort":""}`,cellLabel:new String},Checkbox:{toggleRowSelect:"Toggle row selection",toggleSelection:"Toggle selection of entire dataset"},RatingColumn:{cellLabel:e=>{var t;return`${e.text?e.text:""} ${null!==(t=e.location)&&void 0!==t&&t.record?`rating : ${e.location.record.get(e.field)||0}`:""}`}},GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!",unspecifiedFailure:"Unspecified failure",networkFailure:"Network error",parseFailure:"Failed to parse server response",serverResponse:"Server response:",noRows:"No records to display",moveColumnLeft:"Move to left section",moveColumnRight:"Move to right section",moveColumnTo:e=>`Move column to ${e}`},CellMenu:{removeRow:"Delete"},RowCopyPaste:{copyRecord:"Copy",cutRecord:"Cut",pasteRecord:"Paste",rows:"rows",row:"row"},CellCopyPaste:{copy:"Copy",cut:"Cut",paste:"Paste"},PdfExport:{"Waiting for response from server":"Waiting for response from server...","Export failed":"Export failed","Server error":"Server error","Generating pages":"Generating pages...","Click to abort":"Cancel"},ExportDialog:{width:"40em",labelWidth:"12em",exportSettings:"Export settings",export:"Export",exporterType:"Control pagination",cancel:"Cancel",fileFormat:"File format",rows:"Rows",alignRows:"Align rows",columns:"Columns",paperFormat:"Paper format",orientation:"Orientation",repeatHeader:"Repeat header"},ExportRowsCombo:{all:"All rows",visible:"Visible rows"},ExportOrientationCombo:{portrait:"Portrait",landscape:"Landscape"},SinglePageExporter:{singlepage:"Single page"},MultiPageExporter:{multipage:"Multiple pages",exportingPage:({currentPage:e,totalPages:t})=>`Exporting page ${e}/${t}`},MultiPageVerticalExporter:{multipagevertical:"Multiple pages (vertical)",exportingPage:({currentPage:e,totalPages:t})=>`Exporting page ${e}/${t}`},RowExpander:{loading:"Loading",expand:"Expand",collapse:"Collapse"},TreeGroup:{group:"Group by",stopGrouping:"Stop grouping",stopGroupingThisColumn:"Ungroup column"}};Ge.publishLocale(Hd);const Vd=new Promise((e=>e())),Bd="GridBase:store",zd={block:"nearest",inline:"nearest"},Wd={dataset:1,pageLoad:1,filter:1};class jd extends(Ka.mixin(ui,Ci,ld,md,yd,Cd,Ed,kd,$d,Nd)){static get $name(){return"GridBase"}static get type(){return"gridbase"}static get delayable(){return{onGridVerticalScroll:{type:"raf"},bufferedAfterColumnsResized:250,bufferedElementResize:250}}static get configurable(){return{autoHeight:null,enableSticky:null,enableTextSelection:null,fillLastColumn:!0,positionMode:"translate",showDirty:null,subGridConfigs:{normal:{flex:1}},store:{value:{},$config:"nullify"},rowManager:{value:{},$config:["nullify","lazy"]},scrollManager:{value:{},$config:["nullify","lazy"]},columns:{value:[],$config:"nullify"},minHeight:"10em",hideHeaders:null,hideFooters:!0,hideHorizontalScrollbar:null,contentElMutationObserver:!1,trapFocus:!1,ariaElement:"bodyElement",cellTabIndex:-1,rowCls:{value:"b-grid-row",$config:{merge:this.mergeCls}},cellCls:{value:"b-grid-cell",$config:{merge:this.mergeCls}},emptyText:"L{noRows}",sortFeatureStore:"store",rowHeight:null,preserveScroll:!1}}static get defaultConfig(){return{fixedRowHeight:null,defaultRowHeight:45,fullRowRefresh:!0,preserveScrollOnDatasetChange:null,preserveFocusOnDatasetChange:!0,data:null,defaultRegion:"normal",destroyStore:null,maskDefaults:{cover:"body",target:"element"},columnLines:!0,resizeToFitIncludesHeader:!0,animateRemovingRows:!0,disableGridRowModelWarning:null,headerClass:td,footerClass:nd,testPerformance:!1,rowScrollMode:"move",monitorResize:!0,features:!0,scrollable:{overflowY:!0},scrollerClass:Zc,refreshSuspended:0,transitionDuration:500,contextMenuTriggerEvent:"contextmenu",localizableProperties:["emptyText"],asyncEventSuffix:"",fixElementHeightsBuffer:350,testConfig:{transitionDuration:50,fixElementHeightsBuffer:50}}}static get properties(){return{_selectedRecords:[],_verticalScrollHeight:0,virtualScrollHeight:0,_scrollTop:null}}static bindStoreChangeset=!0;finishConfigure(e){const t=this,{initScroll:n}=t;t.initScroll=()=>!t.scrollInitialized&&n.call(t),P.isTestEnv&&(t.bufferedAfterColumnsResized.delay=50,t.bufferedElementResize.delay=50),super.finishConfigure(e),Ye.ion({locale:"onBeforeLocaleChange",prio:1,thisObj:t}),Ye.ion({locale:"onLocaleChange",prio:-1,thisObj:t}),Rn.ion({theme:"onThemeChange",thisObj:t}),t.ion({subGridExpand:"onSubGridExpand",prio:-1,thisObj:t}),t.bufferedFixElementHeights=t.buffer("fixElementHeights",t.fixElementHeightsBuffer,t),t.setGridClassList(t.element.classList),t.verticalScroller.classList.remove("b-content-element","b-auto-container"),t.bodyWrapElement.classList.remove("b-auto-container-panel")}onSubGridExpand(){this.renderContents()}onBeforeLocaleChange(){this._suspendRenderContentsOnColumnsChanged=!0}onLocaleChange(){this._suspendRenderContentsOnColumnsChanged=!1,this.isPainted&&this.renderContents()}finalizeInit(){super.finalizeInit(),this.store.isLoading&&this.onStoreBeforeRequest()}changeScrollManager(e,t){return null==t||t.destroy(),e?zc.new({element:this.element,owner:this},e):null}doDestroy(){var e;const t=this;t.detachListeners(Bd),null===(e=t.scrollManager)||void 0===e||e.destroy();for(const e of Object.values(t.features)){var n;null===(n=e.destroy)||void 0===n||n.call(e)}t._focusedCell=null,t.columns.destroy(),super.doDestroy()}setGridClassList(e){Object.values(this.features).forEach((t=>{if(t.disabled||!1===t)return;let n;n=Object.prototype.hasOwnProperty.call(t.constructor,"featureClass")?t.constructor.featureClass:`b-${t instanceof fe?t.$$name:t.constructor.name}`,n&&e.add(n.toLowerCase())}))}compose(){const{autoHeight:e,enableSticky:t,enableTextSelection:n,fillLastColumn:r,positionMode:i,showDirty:o}=this;return{class:{[`b-grid-${i}`]:1,"b-enable-sticky":t,"b-grid-notextselection":!n,"b-autoheight":e,"b-fill-last-column":r,"b-show-dirty":o}}}get cellCls(){const{_cellCls:e}=this;return e.value||e}get bodyConfig(){const{autoHeight:e,hideFooters:t,hideHeaders:n}=this;return{reference:"bodyElement",className:{"b-autoheight":e,"b-grid-panel-body":1},[this.hasHeader?"ariaLabelledBy":""]:`${this.id}-panel-title`,children:{headerContainer:{tag:"header",role:"row","aria-rowindex":1,className:{"b-grid-header-container":1,"b-hidden":n}},bodyContainer:{className:"b-grid-body-container",tabIndex:-1,role:"presentation",children:{verticalScroller:{className:"b-grid-vertical-scroller"}}},virtualScrollers:{className:"b-virtual-scrollers b-hide-display",style:s.isFirefox&&Lr.scrollBarWidth?{height:`${Lr.scrollBarWidth}px`}:i},footerContainer:{tag:"footer",className:{"b-grid-footer-container":1,"b-hidden":t}}}}}get contentElement(){return this.verticalScroller}get overflowElement(){return this.bodyContainer}updateHideHeaders(e){var t;e=Boolean(e),null===(t=this.headerContainer)||void 0===t||t.classList.toggle("b-hidden",e),this.eachSubGrid((t=>t.toggleHeaders(e)))}updateHideFooters(e){var t;e=Boolean(e),null===(t=this.footerContainer)||void 0===t||t.classList.toggle("b-hidden",e),this.eachSubGrid((t=>{t.scrollable[e?"removePartner":"addPartner"](t.footer.scrollable,"x")}))}updateHideHorizontalScrollbar(e){e=Boolean(e),this.eachSubGrid((t=>{t.virtualScrollerElement.classList.toggle("b-hide-display",e),t.scrollable[e?"removePartner":"addPartner"](t.fakeScroller,"x"),e||t.refreshFakeScroll()}))}changeColumns(e,t){const n=this;if(!e&&t)return n.isDestroying?t.owner===n&&t.destroy():t.removeAll(),t;if(e.isStore)return(null==t?void 0:t.owner)===n&&t.destroy(),e.grid=n,e;if(Array.isArray(e)){if(t){const n=t.allRecords.slice();t.data=e;for(const e of n)t.includes(e)||e.destroy();return t}e={data:e}}if(t)throw new Error("Replacing ColumnStore is not supported");return qc.new({grid:n,owner:n},e)}updateColumns(e,t){var n,r;const i=this;var o,l;null===(n=super.updateColumns)||void 0===n||n.call(this,e,t),e.ion({refresh:i.onColumnsChanged,sort:i.onColumnsChanged,change:i.onColumnsChanged,move:i.onColumnsChanged,thisObj:i}),e.ion((o=i.onColumnsResized,l=i,{update:({store:e,record:t,changes:n})=>{let r=!0;return("width"in n||"minWidth"in n||"maxWidth"in n||"flex"in n)&&(r=o.call(l,{store:e,record:t,changes:n})),r}})),s.isTouchDevice&&(i.touch=!0,e.forEach((e=>{const{touchConfig:t}=e;t&&e.applyState(t)}))),null===(r=i.bodyElement)||void 0===r||r.setAttribute("aria-colcount",e.visibleColumns.length)}onColumnsChanged({type:e,action:t,changes:n,record:r,records:i,isMove:o}){const s=this,{columns:l,checkboxSelectionColumn:a}=s,c=n&&1===Object.keys(n).length;if((o=!0===o||o&&Object.values(o).some((e=>e)))||"refresh"===e&&"batch"!==t&&"sort"!==t||"update"===t&&c&&"parentIndex"in n||"sort"===t&&l.isSyncingDataOnLoad)return;const d="add"===t&&i.some((e=>e.region&&!s.subGrids[e.region]));if(!s.isConfiguring&&(d||s.isPainted&&(!o||"remove"!==t))){if("add"===t)for(const e of i){const{region:t}=e;var u;if(!s.subGrids[t])s.add(s.createSubGrid(t,null===(u=s.subGridConfigs)||void 0===u?void 0:u[t]))}if("update"===t){if(("width"in n||"minWidth"in n||"maxWidth"in n||"flex"in n)&&!("region"in n)){const{region:e}=r;return l.visibleColumns.forEach((t=>{t.region===e&&t.repaintOnResize&&s.refreshColumn(t)})),void s.afterColumnsChange({action:t,changes:n,column:r})}if("text"in n&&c)return void r.subGrid.refreshHeader();if("hidden"in n){const e=s.getSubGridFromColumn(r.id);e.header.fixHeaderWidths(),e.footer.fixFooterWidths(),e.updateHasFlex()}}if("dataset"===t||"batch"===t||"update"===t&&"region"in n){const e=l.getDistinctValues("region",!0),{toRemove:t,toAdd:n}=H.delta(e,s.regions,!0);s.remove(t.map((e=>s.getSubGrid(e)))),s.add(n.map((e=>s.createSubGrid(e,s.subGridConfigs[e]))))}if(a&&!l.includes(a)){const e=l.indexOf(l.findRecord("type","rownumber"))+1;l.insert(e,a,!0)}s._suspendRenderContentsOnColumnsChanged||s.renderContents(),s.syncFlexedSubCols(),s.bodyElement.setAttribute("aria-colcount",l.visibleColumns.length),s.afterColumnsChange({action:t,changes:n,column:r,columns:i})}}onColumnsResized({changes:e,record:t}){const n=this;if(n.isConfiguring)return;const r=Lr.setLength(t.width),i=Lr.setLength(t.minWidth),o=Lr.setLength(t.maxWidth),s=n.getSubGridFromColumn(t.id);if(s.header.fixHeaderWidths(),s.footer.fixFooterWidths(),s.updateHasFlex(),!t.flex||!t.childLevel){n.cellEls&&t===n.lastColumnResized||(n.cellEls=Lr.children(n.element,`.b-grid-cell[data-column-id="${t.id}"]`),n.lastColumnResized=t);for(const s of n.cellEls)"width"in e&&(s.style.width=r),"minWidth"in e&&(s.style.minWidth=i),"maxWidth"in e&&(s.style.maxWidth=o),"flex"in e&&(s.style.flex=t.flex??null)}n.resizingColumns||n.afterColumnsResized(t),n.syncFlexedSubCols()}afterColumnsResized(e){const t=this;t.eachSubGrid((t=>{t.collapsed||e&&e.region!==t.region||(t.fixWidths(),t.fixRowWidthsInSafariEdge())})),t.lastColumnResized=t.cellEls=null,t.bufferedAfterColumnsResized(e),t.onHeightChange()}syncFlexedSubCols(){const e=this.columns.query((e=>e.flex&&e.childLevel&&e.element));if(e)for(const t of e){const e=t.element.getBoundingClientRect().width,n=Lr.children(this.element,`.b-grid-cell[data-column-id="${t.id}"]`);for(const t of n)t.style.flex=`0 0 ${e}px`}}bufferedAfterColumnsResized(e){this.columns.usesAutoHeight&&this.refreshRows(),this.refreshVirtualScrollbars(),this.eachSubGrid((t=>{t.collapsed||e&&e.region!==t.region||t.refreshFakeScroll()}))}bufferedElementResize(){this.refreshRows()}onInternalResize(e,t,n,r,i){Lr.scrollBarWidth&&t<r&&this.eachSubGrid((e=>{e.flex&&e.onElementResize(e.element)})),super.onInternalResize(...arguments),this.isPainted&&t!==r&&this.columns.usesFlexAutoHeight&&this.bufferedElementResize()}changeRowManager(e,t){const n=this;if(n._isRowMeasured||n.measureRowHeight(),null==t||t.destroy(),e){const t=Xc.new({grid:n,rowHeight:n.rowHeight,rowScrollMode:n.rowScrollMode||"move",autoHeight:n.autoHeight,fixedRowHeight:n.fixedRowHeight,internalListeners:{changeTotalHeight:"onRowManagerChangeTotalHeight",requestScrollChange:"onRowManagerRequestScrollChange",thisObj:n}},e);return n.relayEvents(t,["beforeRenderRow","renderRow"]),n._rowManager=null,t}}updateRowHeight(e){!this.isConfiguring&&this.rowManager&&(this.rowManager.rowHeight=e)}get rowHeight(){var e;return(null===(e=this._rowManager)||void 0===e?void 0:e.rowHeight)??this._rowHeight}getRowHeight(e){return e.rowHeight}processRowHeight(e,t){}getAsyncEventSuffixForStore(e){return this.asyncEventSuffix}bindStore(e){const t=this.getAsyncEventSuffixForStore(e),{bindStoreChangeset:n}=this.constructor;e.ion({name:Bd,[`refresh${t}`]:"onStoreDataChange",[`add${t}`]:"onStoreAdd",[`remove${t}`]:"onStoreRemove",[`replace${t}`]:"onStoreReplace",[`removeAll${t}`]:"onStoreRemoveAll",[`move${t}`]:e.tree?null:"onFlatStoreMove",change:"relayStoreDataChange",idChange:"onStoreRecordIdChange",update:"onStoreUpdateRecord",beforeRequest:"onStoreBeforeRequest",afterRequest:"onStoreAfterRequest",exception:"onStoreException",commit:"onStoreCommit",loadSync:"onStoreLoadSync",startApplyChangeset:n?"internalOnStoreStartApplyChangeset":null,endApplyChangeset:n?"internalOnStoreEndApplyChangeset":null,thisObj:this}),super.bindStore(e)}unbindStore(e){this.detachListeners(Bd),this.destroyStore&&e.destroy()}changeStore(e){if(null==e)return null;var t;("string"==typeof e&&(e=ts.getStore(e)),e.isStore)||((e=Yt.assign({data:this.data,tree:Boolean(null===(t=this.initialConfig.features)||void 0===t?void 0:t.tree)},e)).data||delete e.data,e.modelClass||(e.modelClass=Kc),e=new(e.readUrl?os:ts)(e));return e}updateStore(e,t){var n;const r=this;var i;(null===(n=super.updateStore)||void 0===n||n.call(this,e,t),t&&r.unbindStore(t),e&&(t&&r.deselectAll(),r.bindStore(e)),r.trigger("bindStore",{store:e,oldStore:t}),r.isDestroying||!r.isPainted||r.refreshSuspended)||(null===(i=r._rowManager)||void 0===i||i.reinitialize())}onStoreLoadSync(){this.rowManager.renderFromRow(this.topRow)}onStoreUpdateRecord({source:e,record:t,changes:n}){const r=this;if(!r.refreshSuspended&&!e.isSyncingDataOnLoad)if(r.forceFullRefresh)r.rowManager.refresh(),r.forceFullRefresh=!1;else{let i;if(t.isFieldModified("id")&&(i=r.getRowFor(t.meta.modified.id)),i=i||r.getRowFor(t),!i)return;if(r.fullRowRefresh||t.isSpecialRow){const n=e.indexOf(t);-1!==n&&i.render(n,t)}else r.columns.visibleColumns.forEach((e=>{const t=e.field;if(!(e.constructor.simpleRenderer&&!Object.prototype.hasOwnProperty.call(e.data,"renderer"))||n[t]){const e=i.getCell(t);e&&i.renderCell(e)}}))}}refreshFromRowOnStoreAdd(e,t){const n=this,{rowManager:r}=n;r.renderFromRow(e),r.trigger("changeTotalHeight",{totalHeight:r.totalHeight}),1===n.store.count&&n.callEachSubGrid("refreshFakeScroll")}onMaskAutoClose(e){super.onMaskAutoClose(e),this.toggleEmptyText()}onStoreAdd({source:e,records:t,index:n,oldIndex:r,isChild:i,oldParent:o,parent:s,isMove:l,isExpandAll:a}){var c;const d=this,{rowManager:u}=d;if(!d.isPainted||a||d.refreshSuspended||e.isSyncingDataOnLoad||null!==(c=e.project)&&void 0!==c&&c.applyingChangeset)return;const h=l&&t.some((t=>{if(l[t.id]){const n=e.getById(t.meta.modified.parentId);return(null==n?void 0:n.isExpanded(e))&&(null==n?void 0:n.ancestorsExpanded(e))}}));if(i&&!t[0].ancestorsExpanded(e)&&!h){if(!s.isLeaf){const e=u.getRowById(s);e&&u.renderRows([e])}return}u.calculateRowCount(!1,!0,!0),e.isFiltered&&(n=e.indexOf(t[0]));const{topIndex:g,rows:p,rowCount:m}=u,f=u.topIndex+u.rowCount-1,v=n,b=n+t.length-1,y=f>=e.count-t.length-1;o||r>-1||i&&l&&Object.values(l).some((e=>e))?u.refresh():v>=g&&v<g+m?d.refreshFromRowOnStoreAdd(p[v-g],...arguments):b>=g&&b<g+m?u.refresh():(y&&n>f&&u.fillBelow(d._scrollTop||0),u.estimateTotalHeight(!0))}onStoreException({action:e,type:t,response:n,exceptionType:r,error:i}){var o;const s=this;let l;switch(t){case"server":l=n.message||s.L("L{unspecifiedFailure}");break;case"exception":l="network"===r?s.L("L{networkFailure}"):(null==i?void 0:i.message)||(null==n||null===(o=n.parsedJson)||void 0===o?void 0:o.message)||s.L("L{parseFailure}")}s.applyMaskError(`<div class="b-grid-load-failure">\n                <div class="b-grid-load-fail">${s.L("read"===e?"L{loadFailedMessage}":"L{syncFailedMessage}")}</div>\n                ${null!=n&&n.url?`<div class="b-grid-load-fail">${n.url}</div>`:""}\n                <div class="b-grid-load-fail">${s.L("L{serverResponse}")}</div>\n                <div class="b-grid-load-fail">${l}</div>\n            </div>`)}onStoreDataChange({action:e,changes:t,source:n,syncInfo:r}){var i;null===(i=super.onStoreDataChange)||void 0===i||i.call(this,...arguments);const o=this;if(o.refreshSuspended||!o.rowManager||n.isSyncingDataOnLoad)return;if("dataset"===e&&(o.rowManager.clearKnownHeights(),n.isTree&&n.isFiltered))return;const s=n.isGrouped&&t&&n.groupers.some((e=>e.field in t));o.isPainted&&!s&&o.renderRows(Boolean(!(e in Wd)||o.preserveScrollOnDatasetChange)),o.toggleEmptyText()}onStoreRecordIdChange(){var e;null===(e=super.onStoreRecordIdChange)||void 0===e||e.call(this,...arguments)}onStoreBeforeRequest(){this.applyLoadMask()}onStoreAfterRequest(e){this.loadMask&&!e.exception&&(this.masked=null,this.toggleEmptyText())}needsFullRefreshOnStoreRemove({isCollapse:e}){const t=this._features;return(null==t?void 0:t.group)&&!t.group.disabled||(null==t?void 0:t.groupSummary)&&!t.groupSummary.disabled||this.store.tree&&!e&&this.store.modelClass.convertEmptyParentToLeaf}onStoreRemove({source:e,records:t,isCollapse:n,isChild:r,isMove:i,isCollapseAll:o}){var s;if(!this.isPainted||i||o)return;null===(s=super.onStoreRemove)||void 0===s||s.call(this,...arguments);const l=this,{rowManager:a}=l;if(a.invalidateKnownHeight(t),!e.isSyncingDataOnLoad){if(l.animateRemovingRows&&!n&&!r){const e=t.reduce(((e,t)=>{const n=a.getRowById(t.id);return n&&e.push(n),e}),[]);if(e.length){const t=e[0];return l.isAnimating=!0,Gn.onTransitionEnd({element:t._elementsArray[0],property:"left",duration:l.transitionDuration,thisObj:l,handler:()=>{l.isAnimating=!1,e.forEach((e=>!e.isDestroyed&&e.removeCls("b-removing"))),a.refresh(),l.trigger("rowRemove"),l.afterRemove(arguments[0])}}),void e.forEach((e=>e.addCls("b-removing")))}}if(l.needsFullRefreshOnStoreRemove(...arguments))a.refresh(),l.afterRemove(arguments[0]);else{const e=a.topIndex;if(a.calculateRowCount(!1,!0,!0),a.topIndex!==e)a.renderFromRow(a.topRow);else{const{rows:e}=a,n=t.reduce(((t,n)=>{const r=a.getRowById(n.id);return r&&(t=Math.min(t,e.indexOf(r))),t}),e.length);e[n]?!l.refreshSuspended&&a.renderFromRow(e[n]):a.trigger("changeTotalHeight",{totalHeight:a.totalHeight})}l.trigger("rowRemove",{isCollapse:n}),l.afterRemove(arguments[0])}}}onFlatStoreMove({from:e,to:t}){const{rowManager:n,store:r}=this,{topIndex:i,rowCount:o}=n,[s,l]=[e,t].sort(((e,t)=>e-t)),a=r.indexOf(r.getAt(s,!0)),c=r.indexOf(r.getAt(l,!0));a>=i&&a<i+o?n.renderFromRow(n.rows[a-i]):c>=i&&c<i+o&&n.refresh()}onStoreReplace({records:e,all:t}){const{rowManager:n}=this;if(t)n.clearKnownHeights(),n.refresh();else{const t=e.reduce(((e,[,t])=>{const n=this.getRowFor(t);return n&&e.push(n),e}),[]);n.invalidateKnownHeight(e),n.renderRows(t)}}relayStoreDataChange(e){var t;if(null===(t=this.ariaElement)||void 0===t||t.setAttribute("aria-rowcount",this.store.count+1),!this.project)return this.trigger("dataChange",{...e,store:e.source,source:this})}onStoreRemoveAll(){var e;null===(e=super.onStoreRemoveAll)||void 0===e||e.call(this,...arguments),this.isPainted&&(this.rowManager.clearKnownHeights(),this.renderRows(!1),this.toggleEmptyText())}onStoreCommit({changes:e}){if(this.showDirty&&e.modified.length){const t=[];e.modified.forEach((e=>{const n=this.rowManager.getRowFor(e);n&&t.push(n)})),this.rowManager.renderRows(t)}}internalOnStoreStartApplyChangeset(){this.captureScrollTargetRow()}internalOnStoreEndApplyChangeset(){this.restoreScrollTargetRow()}captureScrollTargetRow(){const e=this;if(e.preserveScroll){const{firstFullyVisibleRow:t,lastFullyVisibleRow:n}=e.rowManager;if(t){e.lastVisibleRowIds=[t.id];for(let r=t.dataIndex+1;r<=n.dataIndex;r++)e.lastVisibleRowIds.push(e.rowManager.getRow(r).id);e.lastTopRowOffset=e.scrollable.getDeltaTo(t.element,{block:"start",x:!1})}}}restoreScrollTargetRow(){const e=this;if(e.preserveScroll){if(e.lastVisibleRowIds){e.rowManager.refresh();const t=e.lastVisibleRowIds.find((t=>e.store.getById(t)));t!=i&&t!==e.rowManager.firstFullyVisibleRow.id&&e.scrollRowIntoView(t,{block:"start",edgeOffset:e.lastTopRowOffset.yDelta,x:!1})}e.lastVisibleRowIds=i,e.lastTopRowOffset=i}}get data(){return this._store?this._store.records:this._data}set data(e){this._store?this._store.data=e:this._data=e}populateHeaderMenu({column:e,items:t}){const n=this,{subGrids:r,regions:i}=n,{parent:o}=e;let s=!0;Object.entries(r).forEach((([l,a])=>{if(!a.sealedColumns&&e.draggable&&l!==e.region&&(!o&&r[e.region].columns.count>1||o&&o.children.length>1)){const o=a.element.compareDocumentPosition(r[e.region].element)===document.DOCUMENT_POSITION_PRECEDING,c=n.rtl?!o:o,d=i.length>2?n.L("L{moveColumnTo}",n.optionalL(l)):n.L(c?"L{moveColumnRight}":"L{moveColumnLeft}");t[`${l}Region`]={targetSubGrid:l,text:d,icon:"b-fw-icon b-icon-column-move-"+(c?"right":"left"),separator:s,disabled:!e.allowDrag,onItem:({item:t})=>{e.traverse((e=>e.region=l)),n.columns.insert(n.columns.indexOf(r[t.targetSubGrid].columns.last)+1,e),n.scrollColumnIntoView(e)}},s=!1}}))}populateCellMenu({record:e,items:t}){}getColumnDragToolbarItems(e,t){return t}normalizeCellContext(e){const t=this,{columns:n}=t;return e.isLocation?e:e.isModel?new Hc({grid:t,id:e.id,columnId:n.visibleColumns[0].id}):new Hc(Yt.assign({grid:t},e))}getCell(e){const{store:t,columns:n}=this,{visibleColumns:r}=this.columns,i=isNaN(e.row)?isNaN(e.rowIndex)?t.indexOf(e.record||e.id):e.rowIndex:e.row,o=isNaN(e.column)?isNaN(e.columnIndex)?r.indexOf(e.column||n.getById(e.columnId)||n.get(e.field)||r[0]):e.columnIndex:e.column;return i>-1&&i<t.count&&o>-1&&o<r.length&&this.normalizeCellContext(e).cell||null}getHeaderElement(e){return e.isModel&&(e=e.id),this.fromCache(`.b-grid-header[data-column-id="${e}"]`)}getHeaderElementByField(e){const t=this.columns.get(e);return t?this.getHeaderElement(t):null}get bodyHeight(){return this._bodyHeight}get headerHeight(){const e=this;return e.isPainted&&!e._headerHeight&&(e._headerHeight=e.headerContainer.offsetHeight),e._headerHeight}get footerHeight(){const e=this;return e.isPainted&&!e._footerHeight&&(e._footerHeight=e.footerContainer.offsetHeight),e._footerHeight}get isTreeGrouped(){var e;return Boolean(null===(e=this.features.treeGroup)||void 0===e?void 0:e.isGrouped)}getRecordFromElement(e){const t=e.closest(".b-grid-row");return t?this.store.getAt(t.dataset.index):null}getColumnFromElement(e){const t=e.closest(".b-grid-cell, .b-grid-header");if(!t)return null;if(t.matches(".b-grid-header"))return this.columns.getById(t.dataset.columnId);const n=Nc.get(t);return this.columns.getById(n.columnId)}updateAutoHeight(e){Yt.assertBoolean(e,"autoHeight")}get columnLines(){return this._columnLines}set columnLines(e){Yt.assertBoolean(e,"columnLines"),Lr.toggleClasses(this.element,"b-no-column-lines",!e),this._columnLines=e}get keyMapElement(){return this.bodyElement}fixSizes(){this.callEachSubGrid("fixWidths");const e=this.headerContainer.querySelectorAll(".b-grid-header.b-depth-0");for(let t=0,{length:n}=e;t<n;t++)e[t].setAttribute("aria-colindex",t+1)}onRowManagerChangeTotalHeight({totalHeight:e,immediate:t}){return this.refreshTotalHeight(e,t)}refreshTotalHeight(e=this.rowManager.totalHeight,t=!1){const n=this;if(n.renderingRows||!n.isVisible)return!1;const r=n.scrollable,i=Math.abs(n.virtualScrollHeight-e),o=n._bodyRectangle.height;if(i){const s=e-o-n._scrollTop<2*o||n._verticalScrollHeight&&n._verticalScrollHeight-o<n._scrollTop;r.scrollHeight=n.virtualScrollHeight=e,n.isPainted&&(n.scrolling&&!s||i<100)&&!t?n.bufferedFixElementHeights():(n.virtualScrollHeightDirty&&n.virtualScrollHeightDirty(),n.bufferedFixElementHeights.cancel(),n.fixElementHeights())}}fixElementHeights(){const e=this,t=e.virtualScrollHeight,n=`${t}px`;e._verticalScrollHeight=t,e.verticalScroller.style.height=n,e.virtualScrollHeightDirty=!1,e.autoHeight&&(e.bodyContainer.style.height=n,e._bodyHeight=t,e.refreshBodyRectangle()),e.refreshVirtualScrollbars()}refreshBodyRectangle(){return this._bodyRectangle=bn.client(this.bodyContainer)}set scrolling(e){this._scrolling=e}get scrolling(){return this._scrolling}enableScrollingCloseToEdges(e){this.scrollManager.startMonitoring({scrollables:[{element:this.scrollable.element,direction:"vertical"},...H.asArray(e||[]).map((e=>({element:("string"==typeof e?this.subGrids[e]:e).scrollable.element})))],direction:"horizontal"})}disableScrollingCloseToEdges(e){this.scrollManager.stopMonitoring([this.scrollable.element,...H.asArray(e||[]).map((e=>("string"==typeof e?this.subGrids[e]:e).element))])}onRowManagerRequestScrollChange({bottom:e}){this.scrollable.y=e-this.bodyHeight}initScroll(){const e=this,{scrollable:t}=e;e.scrollInitialized||(e.scrollInitialized=!0,t.contentElement=e.contentElement,t.ion({scroll:"onGridVerticalScroll",scrollend:"onGridVerticalScrollEnd",thisObj:e}),e.callEachSubGrid("initScroll"),s.isMobileSafari&&(t.element.style.transform="translate3d(0, 0, 0)"))}onGridVerticalScroll({source:e}){const t=this,{y:n}=e;n!==t._scrollTop&&(t._scrollTop=n,t.scrolling||(t.scrolling=!0,t.eachSubGrid((e=>e.suspendResizeMonitor=!0))),t.rowManager.updateRenderedRows(n),t.afterScroll({scrollTop:n}),t.trigger("scroll",{scrollTop:n}))}onGridVerticalScrollEnd(){this.scrolling=!1,this.eachSubGrid((e=>e.suspendResizeMonitor=!1))}async scrollRowIntoView(e,t=zd){const n=this,r=t.block||"nearest",{rowManager:i}=n,o=n.store.getById(e);if(o){let e;if(-1===n.store.indexOf(o))return Vd;let l=n.scrollable,a=n.getRecordCoords(o);const c=bn.from(l.element);if(a.virtual){const d=a.block,u="nearest"!==r?t:{block:d};if(e=l.scrollIntoView(a,{block:"center"}),i.scrollTargetRecordId=o,i.updateRenderedRows(l.y,!0),a=n.getRecordCoords(o),i.lastScrollTop=l.y,a.virtual)return Vd;var s;if(t.animate)l.suspendEvents(),"end"===r||"nearest"===r&&"end"===d?l.y-=c.bottom-a.bottom:("start"===r||"nearest"===r&&"start"===d)&&(l.y+=a.y-c.y),i.updateRenderedRows(l.y,!1,!0),"end"===d?l.y-=i.appendRowBuffer*i.rowHeight-1:l.y+=i.prependRowBuffer*i.rowHeight-1,await l.scrollIntoView(n.getRecordCoords(o),Object.assign({},t,u)),l.resumeEvents();else t.recursive||await e,await(null===(s=n.scrollRowIntoView)||void 0===s?void 0:s.call(n,o,Object.assign({recursive:!0},t,u)))}else{let{column:e}=t;if(e){if(e.isModel||(e=n.columns.getById(e)||n.columns.get(e)),e){l=n.getSubGridFromColumn(e).scrollable;const t=bn.from(i.getRowFor(o).getCell(e.id));a.x=t.x,a.width=t.width}}else t=Yt.assign({},t,{x:!1});await l.scrollIntoView(a,t)}}}scrollColumnIntoView(e,t){return e=e instanceof Gc?e:this.columns.get(e)||this.columns.getById(e)||this.columns.getAt(e),this.getSubGridFromColumn(e).scrollColumnIntoView(e,t)}scrollCellIntoView(e,t){return this.scrollRowIntoView(e.id,Object.assign({column:e.columnId},"boolean"==typeof t?{animate:t}:t))}scrollToBottom(e){return this.scrollRowIntoView(this.store.last,e)}scrollToTop(e){return this.scrollable.scrollBy(0,-this.scrollable.y,e)}storeScroll(){const e=this,t=e.storedScrollState={scrollTop:e.scrollable.y,scrollLeft:{}};return e.eachSubGrid((e=>{t.scrollLeft[e.region]=e.scrollable.x})),t}restoreScroll(e=this.storedScrollState){this.eachSubGrid((t=>{const n=e.scrollLeft[t.region];var r;null!=n&&(t.scrollable.updateX(n),t.header.scrollable.updateX(n),t.footer.scrollable.updateX(n),null===(r=t.fakeScroller)||void 0===r||r.updateX(n))})),this.scrollable.updateY(e.scrollTop)}beginGridMeasuring(){const e=this;if(e.$measureCellElements||(e.$measureCellElements=Lr.createElement({className:"b-grid-subgrid "+(!e._isRowMeasured&&e.hasFeature("stripe")?"b-stripe":""),reference:"subGridElement",style:{position:"absolute",top:"-10000px",left:"-100000px",visibility:"hidden",contain:"strict"},children:[{className:"b-grid-row",reference:"rowElement",children:[{className:"b-grid-cell",reference:"cellElement",style:{width:"auto",contain:s.isFirefox?"layout paint":"layout style paint"}}]}]})),e.getConfig("element"),e.verticalScroller.appendChild(e.$measureCellElements.subGridElement),!e.rendered){const t=e.appendTo||e.insertBefore||document.body,n=Lr.getRootElement("string"==typeof t?document.getElementById(t):t)||document.body;e.adopt&&n.contains(e.element)||(n.appendChild(e.element),e.$removeAfterMeasuring=!0)}return e.$measureCellElements}endGridMeasuring(){this.$removeAfterMeasuring&&(this.element.remove(),this.$removeAfterMeasuring=!1),this.$measureCellElements.subGridElement.remove()}measureRowHeight(){const e=this,{rowElement:t}=e.beginGridMeasuring(),n=Lr.getStyleValue(t,["height","border-top-width","border-bottom-width"]),i=parseInt(n.height),o=s.isFirefox?r.devicePixelRatio/Math.max(Math.trunc(r.devicePixelRatio),1):1,l=n["border-top-width"]?Math.round(o*parseFloat(n["border-top-width"])):0,a=n["border-bottom-width"]?Math.round(o*parseFloat(n["border-bottom-width"])):0;null!=e.rowHeight&&e.rowHeight!==e._rowHeightFromStyle||(e.rowHeight=!isNaN(i)&&i?i:e.defaultRowHeight,e._rowHeightFromStyle=e.rowHeight),e._rowBorderHeight=l+a,e._isRowMeasured=!0,e.endGridMeasuring()}onThemeChange({theme:e}){this.whenVisible("measureRowHeight"),this.trigger("theme",{theme:e})}refreshRows(e=!1){const{element:t,rowManager:n}=this;t.classList.add("b-notransition"),e?n.returnToTop():n.refresh(),t.classList.remove("b-notransition")}refreshColumn(e){e.isVisible&&(e.isLeaf?this.rowManager.forEach((t=>t.renderCell(t.getCell(e.id)))):e.children.forEach((e=>this.refreshColumn(e))))}refreshVirtualScrollbars(){const e=this,{headerContainer:t,footerContainer:n,virtualScrollers:r,scrollable:i,hasVerticalOverflow:o}=e,{classList:s}=r,l=!s.contains("b-hide-display"),a=Object.values(e.subGrids).some((e=>e.overflowingHorizontally)),c=a!==l;if(c&&r.classList.toggle("b-hide-display",!a),Lr.scrollBarWidth){const s=o||"scroll"===i.overflowY;t.classList.toggle("b-show-yscroll-padding",s),n.classList.toggle("b-show-yscroll-padding",s),r.classList.toggle("b-show-yscroll-padding",s),c&&(a&&e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange())}}get hasVerticalOverflow(){return this.scrollable.hasOverflow("y")}get contentHeight(){const e=this.rowManager;return Math.max(e.totalHeight,e.bottomRow?e.bottomRow.bottom:0)}onContentChange(){const e=this,t=e.rowManager;e.isVisible?(t.estimateTotalHeight(),e.paintListener=null,e.refreshTotalHeight(e.contentHeight),e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()):e.paintListener||(e.paintListener=e.ion({paint:"onContentChange",once:!0,thisObj:e}))}triggerPaint(){this.isPainted||this.refreshBodyRectangle(),super.triggerPaint()}onHeightChange(){const e=this;e.refreshBodyRectangle(),e._bodyHeight=e.autoHeight?e.contentHeight:e.bodyContainer.offsetHeight}suspendRefresh(){this.refreshSuspended++}resumeRefresh(e){this.refreshSuspended&&!--this.refreshSuspended&&(e&&this.refreshRows(),this.trigger("resumeRefresh",{trigger:e}))}renderRows(e=!0){const t=this,n=e&&t.storeScroll();t.refreshSuspended||(t.trigger("beforeRenderRows"),t.renderingRows=!0,t.element.classList.add("b-grid-refreshing"),e||(t.scrollable.y=t._scrollTop=0),t.rowManager.reinitialize(!e),t.trigger("renderRows"),t.renderingRows=!1,t.onContentChange(),e&&t.restoreScroll(n),t.element.classList.remove("b-grid-refreshing"))}renderContents(){const e=this,{element:t,headerContainer:n,footerContainer:r,rowManager:i}=e;if(e.emptyCache(),e.isPainted){e._headerHeight=null,e.callEachSubGrid("refreshHeader",n),e.callEachSubGrid("refreshFooter",r),e.renderHeader(n,t),e.renderFooter(r,t),e.fixSizes();const o=i.removeAllRows();i.calculateRowCount(!1,!0,!0),i.rowCount&&(i.setPosition(o),e.renderRows())}}onPaintOverride(){}onPaint({firstPaint:e}){var t;const n=this;if(n.ariaElement.setAttribute("aria-rowcount",n.store.count+1),null===(t=super.onPaint)||void 0===t||t.call(this,...arguments),n.onPaintOverride()||!e)return;const{rowManager:r,store:i,element:o,headerContainer:s,bodyContainer:l,footerContainer:a}=n,c=Lr.scrollBarPadElement;let d,u=0;n.role=null!=i&&i.isTree?"treegrid":"grid",n.columns.ion({change:()=>d=!0,once:!0}),n.updateResponsive(n.width,0),d&&(n.callEachSubGrid("refreshHeader",s),n.callEachSubGrid("refreshFooter",a)),n.renderHeader(s,o),n.renderFooter(a,o),Lr.append(s,c),Lr.append(a,c),Lr.append(n.virtualScrollers,c),n.refreshBodyRectangle();const h=n.bodyContainer.offsetHeight;if(n.autoHeight?(n._bodyHeight=r.initWithHeight(o.offsetHeight-s.offsetHeight-a.offsetHeight,!0),l.style.height=n.bodyHeight+"px"):(n._bodyHeight=h,r.initWithHeight(n._bodyHeight,!0)),n.eachSubGrid((e=>{e.header.maxDepth>u&&(u=e.header.maxDepth)})),s.dataset.maxDepth=u,n.fixSizes(),!i.count&&i.isLoading||n.renderRows(),n.columns.usesAutoHeight){const{fonts:e}=document;"loaded"!==(null==e?void 0:e.status)&&e.ready.then((()=>!n.isDestroyed&&n.refreshRows()))}n.initScroll(),n.initInternalEvents()}render(){const e=this;var t;(e.requireSize=Boolean(e.owner),super.render(...arguments),e.setupFocusListeners(),e.autoHeight)||(e.headerContainer.offsetHeight&&!e.bodyContainer.offsetHeight&&console.warn("Grid element not sized correctly, please check your CSS styles and review how you size the widget"),e.splitFrom||null!==(t=e.features.split)&&void 0!==t&&t.owner||"minHeight"in e.initialConfig||"height"in e.initialConfig||parseInt(r.getComputedStyle(e.element).minHeight)!==e.height||console.warn(`The ${e.$$name} is sized by its predefined minHeight, likely this is not intended. Please check your CSS and review how you size the widget, or assign a fixed height in the config. For more information, see the "Basics/Sizing the component" guide in docs.`))}renderHeader(e,t){}renderFooter(e,t){}beforeRenderCell(){}beforeRenderRow(){}afterRenderRow(){}afterScroll(){}processCellEditor(e){}afterColumnsChange(){}afterRemove(e){}afterToggleGroup(){}afterToggleSubGrid(){}onConfigChange(e){super.onConfigChange(e),this.isConfiguring||this.afterConfigChange(e)}afterConfigChange(e){}afterAddListener(e,t){}afterRemoveListener(e,t){}syncMaskCover(e=this.masked){if(e){const t="body"===e.cover&&this.rectangleOf("bodyContainer"),n=t&&this.rectangleOf("virtualScrollers"),{style:r}=e.element;r.marginTop=t?`${t.y}px`:"",r.height=t?`${t.height+((null==n?void 0:n.height)||0)}px`:""}}maskBody(e){let t;return this.bodyContainer&&(this.masked=Hs.mergeConfigs(this.loadMaskDefaults,e),t=this.masked),t}unmaskBody(){this.masked=null}updateEmptyText(e){var t,n;null===(t=this.emptyTextEl)||void 0===t||t.remove(),this.emptyTextEl=Lr.createElement({parent:null===(n=this.firstItem)||void 0===n?void 0:n.element,className:"b-empty-text",[null!=e&&e.includes("<")?"html":"text"]:e})}toggleEmptyText(){const{bodyContainer:e,store:t}=this;null==e||e.classList.toggle("b-grid-empty",!(t.count>0||t.isLoading||t.isCommitting))}updateReadOnly(e,t){if(super.updateReadOnly(e,t),!this.isConfiguring)for(const t of this.columns.bottomColumns){var n;null===(n=t.updateReadOnly)||void 0===n||n.call(t,e)}}getCurrentConfig(e){const t=super.getCurrentConfig(e),{store:n}=this,r=n.getInlineData(e),i=n.getCurrentConfig(e)||t.store;return r.length&&(t.data=r),i&&n.originalModelClass===Kc&&delete i.modelClass,Yt.isEmpty(i)||(t.store=i),t.store&&delete t.store.data,t}}jd.initClass(),P.setVersion("grid","5.5.4"),jd._$name="GridBase";N.apply(class{static get target(){return{class:jd}}refreshBodyRectangle(){const{_bodyRectangle:e}=this,t=bn.client(this.bodyContainer);return 0===t.height&&e?this._bodyRectangle:this._bodyRectangle=t}get selectionDragMouseEventListenerElement(){return this.rootElement}});const Gd=()=>{throw new Error("Abstract method call!")};class Ud extends fe{get type(){return this.constructor.name}undo(){Gd()}redo(){Gd()}}Ud._$name="ActionBase";const Yd=()=>{throw new Error("Abstract method call!")},qd=()=>{throw new Error("Method cannot be called at this state!")};class Kd extends fe{canUndo(e){Yd()}canRedo(e){Yd()}onUndo(e){Yd()}onRedo(e){Yd()}onStartTransaction(e){Yd()}onStopTransaction(e){Yd()}onStopTransactionDelayed(e){Yd()}onRejectTransaction(e){Yd()}onEnable(e){Yd()}onDisable(e){Yd()}onAutoRecordOn(e){Yd()}onAutoRecordOff(e){Yd()}onResetQueue(e){Yd()}onModelUpdate(e){Yd()}onStoreModelAdd(e){Yd()}onStoreModelInsert(e){Yd()}onStoreModelRemove(e){Yd()}onStoreModelRemoveAll(e){Yd()}onModelInsertChild(e){Yd()}onModelRemoveChild(e){Yd()}}Kd._$name="StateBase";const Xd=Symbol("STATE_PROP"),Jd=Symbol("STORES_PROP"),Qd=Symbol("QUEUE_PROP"),Zd=Symbol("POS_PROP"),eu=Symbol("TRANSACTION_PROP"),tu=Symbol("TRANSACTION_TIMER_PROP"),nu=Symbol("AUTO_RECORD_PROP"),ru=Symbol("IS_APPLYING_STASH");Object.freeze([Xd,Jd,Qd,Zd,eu,tu,nu,ru]);const iu=new Map;var ou=(e,t)=>{iu.set(e,t)},su=e=>("string"==typeof e&&(e=iu.get(e)),e);const lu=(e,t)=>{const{undo:n,redo:r}=t;let i;return i=n&&!r?{[Qd]:e[Qd].slice(e.position),[Zd]:0}:r&&!n?{[Qd]:e[Qd].slice(0,e.position)}:{[Qd]:[],[Zd]:0},[i,()=>{e.notifyStoresAboutQueueReset(t)}]};const au=new class extends Kd{canUndo(){return!1}canRedo(){return!1}onUndo(){qd()}onRedo(){qd()}onEnable(e){return e.autoRecord?"autoreadystate":"readystate"}onDisable(){qd()}onAutoRecordOn(){return{[nu]:!0}}onAutoRecordOff(){return{[nu]:!1}}onStartTransaction(){qd()}onStopTransaction(){qd()}onStopTransactionDelayed(){qd()}onRejectTransaction(){qd()}onResetQueue(e,t){return lu(e,t)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}};ou("disabledstate",au);const cu=Symbol("ACTION_QUEUE_PROP");class du extends fe{get defaultConfig(){return{title:null}}construct(...e){this[cu]=[],super.construct(...e)}get queue(){return this[cu].slice(0)}get length(){return this[cu].length}addAction(e){this[cu].push(e)}undo(){const e=this[cu];for(let t=e.length-1;t>=0;--t)e[t].undo()}redo(){const e=this[cu];for(let t=0,n=e.length;t<n;++t)e[t].redo()}}du._$name="Transaction";class uu extends Kd{canUndo(e){return 0<e.position&&e.position<=e.length}canRedo(e){return 0<=e.position&&e.position<e.length}onUndo(e,t){let n=e.position;const r=e[Qd],i=Math.max(0,n-t);return[{[Xd]:"restoringstate",[Zd]:i},()=>{e.notifyStoresAboutStateRestoringStart();const t=[];for(;n!==i;){const e=r[--n];e.undo(),t.push(e)}return[e.autoRecord?"autoreadystate":"readystate",()=>{e.notifyStoresAboutStateRestoringStop({cause:"undo",transactions:t})}]}]}onRedo(e,t){let n=e.position;const r=e[Qd],i=Math.min(r.length,n+t);return[{[Xd]:"restoringstate",[Zd]:i},()=>{e.notifyStoresAboutStateRestoringStart();const t=[];do{const e=r[n++];e.redo(),t.push(e)}while(n!==i);return[e.autoRecord?"autoreadystate":"readystate",()=>{e.notifyStoresAboutStateRestoringStop({cause:"redo",transactions:t})}]}]}onEnable(){qd()}onDisable(){return"disabledstate"}onAutoRecordOn(){return{[Xd]:"autoreadystate",[nu]:!0}}onAutoRecordOff(){qd()}onStartTransaction(e,t){const n=new du({title:t});return[{[Xd]:"recordingstate",[eu]:n},()=>{e.notifyStoresAboutStateRecordingStart(n)}]}onStopTransaction(){qd()}onStopTransactionDelayed(){qd()}onRejectTransaction(){qd()}onResetQueue(e,t){return lu(e,t)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}}const hu=new uu;ou("readystate",hu);class gu extends Kd{canUndo(){return!1}canRedo(){return!1}onEnable(){}onDisable(e){const t=e[eu];return e.notifyStoresAboutStateRecordingStop(t,{disabled:!0}),{[Xd]:"disabledstate",[eu]:null}}onAutoRecordOn(e){return[{[Xd]:"autorecordingstate",[nu]:!0},()=>{e.stopTransactionDelayed()}]}onAutoRecordOff(){qd()}onStartTransaction(){qd()}onStopTransaction(e,t){const n=e[eu],r=e[Qd];let i=e[Zd];return n.length&&(n.title||t||!e.getTransactionTitle?t&&(n.title=t):n.title=e.getTransactionTitle(n),r[i]=n,r.length=++i),[{[Xd]:"readystate",[Zd]:i,[eu]:null},()=>{e.notifyStoresAboutStateRecordingStop(n,{stop:!0})}]}onRejectTransaction(e){const t=e[eu];return[{[Xd]:"restoringstate",[eu]:null},()=>(t.length&&t.undo(),["readystate",()=>{e.notifyStoresAboutStateRecordingStop(t,{rejected:!0})}])]}onStopTransactionDelayed(){qd()}onResetQueue(e,t){return lu(e,t)}onModelUpdate(e,t,n,r,i){e[eu].addAction(e.makeModelUpdateAction(t,n,r,i))}onModelInsertChild(e,t,n,r,i,o){e[eu].addAction(e.makeModelInsertChildAction(t,n,r,i,o))}onModelRemoveChild(e,t,n,r){e[eu].addAction(e.makeModelRemoveChildAction(t,n,r))}onStoreModelAdd(e,t,n,r){e[eu].addAction(e.makeStoreModelAddAction(t,n,r))}onStoreModelInsert(e,t,n,r,i,o){e[eu].addAction(e.makeStoreModelInsertAction(t,n,r,i,o))}onStoreModelRemove(e,t,n,r,i){e[eu].addAction(e.makeStoreModelRemoveAction(t,n,r,i))}onStoreRemoveAll(e,t,n,r){e[eu].addAction(e.makeStoreRemoveAllAction(t,n,r))}}const pu=new gu;ou("recordingstate",pu);const mu=new class extends Kd{static get $name(){return"RestoringStateClass"}canUndo(){return!1}canRedo(){return!1}onUndo(){qd()}onRedo(){qd()}onEnable(){qd()}onDisable(){qd()}onAutoRecordOn(){return{[nu]:!0}}onAutoRecordOff(){return{[nu]:!1}}onStartTransaction(){qd()}onStopTransaction(){qd()}onStopTransactionDelayed(){qd()}onRejectTransaction(){qd()}onQueueReset(){qd()}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}};ou("restoringstate",mu);const fu=new class extends uu{onAutoRecordOn(){qd()}onAutoRecordOff(){return{[Xd]:"readystate",[nu]:!1}}onStartTransaction(e,t){const n=new du({title:t});return[{[Xd]:"autorecordingstate",[eu]:n},()=>{e.notifyStoresAboutStateRecordingStart(n),e.stopTransactionDelayed()}]}onModelUpdate(e,t,n,r){e.startTransaction(),e.onModelUpdate(t,n,r)}onModelInsertChild(e,t,n,r,i){e.startTransaction(),e.onModelInsertChild(t,n,r,i)}onModelRemoveChild(e,t,n,r){e.startTransaction(),e.onModelRemoveChild(t,n,r)}onStoreModelAdd(e,t,n,r){e.startTransaction(),e.onStoreModelAdd(t,n,r)}onStoreModelInsert(e,t,n,r,i,o){e.startTransaction(),e.onStoreModelInsert(t,n,r,i,o)}onStoreModelRemove(e,t,n,r,i){e.startTransaction(),e.onStoreModelRemove(t,n,r,i)}onStoreRemoveAll(e,t,n,r){e.startTransaction(),e.onStoreRemoveAll(t,n,r)}};ou("autoreadystate",fu);class vu extends(gu.mixin(ai)){onDisable(e){const t=e[eu],n=e[tu];return n&&this.clearTimeout(n),e.notifyStoresAboutStateRecordingStop(t,{disabled:!0}),{[Xd]:"disabledstate",[eu]:null,[tu]:null}}onAutoRecordOn(e){qd()}onAutoRecordOff(e){const t=e[tu];return t&&this.clearTimeout(t),{[Xd]:"recordingstate",[nu]:!1,[tu]:null}}onStopTransaction(e,t){const n=e[eu],r=e[tu],i=e[Qd];let o=e[Zd];return r&&this.clearTimeout(r),n.length&&(n.title||t||!e.getTransactionTitle?t&&(n.title=t):n.title=e.getTransactionTitle(n),i[o]=n,i.length=++o),[{[Xd]:"autoreadystate",[Zd]:o,[eu]:null,[tu]:null},()=>{e.notifyStoresAboutStateRecordingStop(n,{stop:!0})}]}onStopTransactionDelayed(e){let t=e[tu];return t&&this.clearTimeout(t),t=this.setTimeout((()=>{e.stopTransaction()}),e.autoRecordTransactionStopTimeout),{[Xd]:bu,[tu]:t}}onResetQueue(e,t){return lu(e,t)}onRejectTransaction(e){const t=e[eu],n=e[tu];return n&&this.clearTimeout(n),[{[Xd]:"restoringstate",[eu]:null,[tu]:null},()=>(t.length&&t.undo(),["autoreadystate",()=>{e.notifyStoresAboutStateRecordingStop(t,{rejected:!0})}])]}onModelUpdate(e,...t){super.onModelUpdate(e,...t),e.stopTransactionDelayed()}onModelInsertChild(e,...t){super.onModelInsertChild(e,...t),e.stopTransactionDelayed()}onModelRemoveChild(e,...t){super.onModelRemoveChild(e,...t),e.stopTransactionDelayed()}onStoreModelAdd(e,...t){super.onStoreModelAdd(e,...t),e.stopTransactionDelayed()}onStoreModelInsert(e,...t){super.onStoreModelInsert(e,...t),e.stopTransactionDelayed()}onStoreModelRemove(e,...t){super.onStoreModelRemove(e,...t),e.stopTransactionDelayed()}onStoreRemoveAll(e,...t){super.onStoreRemoveAll(e,...t),e.stopTransactionDelayed()}}const bu=new vu;ou("autorecordingstate",bu);const yu=Symbol("MODEL_PROP"),Cu=Symbol("NEW_DATA_PROP"),wu=Symbol("OLD_DATA_PROP");class xu extends Ud{static get defaultConfig(){return{model:i,newData:i,oldData:i,isInitialUserAction:!1}}get type(){return"UpdateAction"}get model(){return this[yu]}set model(e){this[yu]=e}get newData(){return this[Cu]}set newData(e){this[Cu]={...e}}get oldData(){return this[wu]}set oldData(e){this[wu]={...e}}undo(){const{model:e,oldData:t}=this;e.$&&Object.assign(e,t),e.set(t,null,null,null,Boolean(e.$))}redo(){const{model:e,newData:t}=this;e.$&&Object.assign(e,t),e.set(t,null,null,null,Boolean(e.$))}}xu._$name="UpdateAction";const Su=Symbol("PARENT_MODEL_PROP"),Eu=Symbol("CHILD_MODELS_PROP"),Ru=Symbol("INSERT_INDEX_PROP"),Tu=Symbol("CONTEXT_PROP");class Du extends Ud{static get defaultConfig(){return{parentModel:i,childModels:i,insertIndex:i,context:i}}get type(){return"InsertChildAction"}get parentModel(){return this[Su]}set parentModel(e){this[Su]=e}get childModels(){return this[Eu]}set childModels(e){this[Eu]=e.slice(0)}get insertIndex(){return this[Ru]}set insertIndex(e){this[Ru]=e}get context(){return this[Tu]}set context(e){this[Tu]=e}undo(){const{parentModel:e,context:t,childModels:n}=this,r=new Map,i=new Set;for(const o of n){const n=t.get(o);if(n){let t=r.get(n.parent);t||(t={moveRight:[],moveLeft:[],moveFromAnotherParent:[]},r.set(n.parent,t)),n.parent===e?n.index>o.parentIndex?t.moveRight.push({parent:n.parent,model:o,index:n.index+1}):t.moveLeft.push({parent:n.parent,model:o,index:n.index}):t.moveFromAnotherParent.push({parent:n.parent,model:o,index:n.index})}else i.add(o)}for(const e of r.values()){const{moveRight:t,moveLeft:n}=e;n.sort(((e,t)=>e.index-t.index)),t.sort(((e,t)=>t.index-e.index))}i.forEach((e=>e.parent.removeChild(e)));for(const e of r.values()){const{moveRight:t,moveLeft:n,moveFromAnotherParent:r}=e;n.forEach((e=>{e.parent.insertChild(e.model,e.index)})),t.forEach((e=>{e.parent.insertChild(e.model,e.index)})),r.forEach((e=>{e.parent.insertChild(e.model,e.index)}))}}redo(){var e;const{parentModel:t,insertIndex:n,childModels:r}=this,i=t.children[n];t.insertChild(r,i,!1,{orderedBeforeNode:null==i||null===(e=i.previousSibling)||void 0===e?void 0:e.nextOrderedSibling})}}Du._$name="InsertChildAction";const Mu=Symbol("PARENT_MODEL_PROP"),Fu=Symbol("CHILD_MODELS_PROP"),Iu=Symbol("CONTEXT_PROP");class ku extends Ud{static get defaultConfig(){return{parentModel:i,childModels:i,context:i}}get type(){return"RemoveChildAction"}get parentModel(){return this[Mu]}set parentModel(e){this[Mu]=e}get childModels(){return this[Fu]}set childModels(e){this[Fu]=e.slice(0)}get context(){return this[Iu]}set context(e){this[Iu]=e}undo(){const{parentModel:e,context:t,childModels:n}=this;n.sort(((e,n)=>t.get(e)-t.get(n))),n.forEach((n=>{const r=t.get(n);e.insertChild(n,r.parentIndex,i,{orderedParentIndex:r.orderedParentIndex})}))}redo(){this.parentModel.removeChild(this.childModels)}}ku._$name="RemoveChildAction";const Ou=Symbol("STORE_PROP"),Lu=Symbol("MODEL_LIST_PROP");class Au extends Ud{static get defaultConfig(){return{store:i,modelList:i,silent:!1}}get type(){return"AddAction"}get store(){return this[Ou]}set store(e){this[Ou]=e}get modelList(){return this[Lu]}set modelList(e){this[Lu]=e.slice(0)}undo(){this.store.remove(this.modelList,this.silent)}redo(){this.store.add(this.modelList,this.silent)}}Au._$name="AddAction";const Pu=Symbol("STORE_PROP"),_u=Symbol("MODEL_LIST_PROP"),$u=Symbol("INSERT_INDEX_PROP"),Nu=Symbol("CONTEXT_PROP");class Hu extends Ud{static get defaultConfig(){return{store:i,modelList:i,insertIndex:i,context:i,silent:!1}}get type(){return"InsertAction"}get store(){return this[Pu]}set store(e){this[Pu]=e}get modelList(){return this[_u]}set modelList(e){this[_u]=e.slice(0)}get insertIndex(){return this[$u]}set insertIndex(e){this[$u]=e}get context(){return this[Nu]}set context(e){this[Nu]=e}undo(){const{store:e,modelList:t,context:n,silent:r}=this;t.sort(((e,t)=>{const r=n.get(e),o=n.get(t);return r!==i&&o!==i?r-o:0})),t.forEach((t=>{const o=n.get(t);t._undoingInsertion=!0,o!==i?e.insert(o,t,r):e.remove(t,r),t._undoingInsertion=!1}))}redo(){const e=this;e.store.insert(e.insertIndex,e.modelList,e.silent)}}Hu._$name="InsertAction";const Vu=Symbol("STORE_PROP"),Bu=Symbol("MODEL_LIST_PROP"),zu=Symbol("CONTEXT_PROP");class Wu extends Ud{static get defaultConfig(){return{store:i,modelList:i,context:i,silent:!1}}get type(){return"RemoveAction"}get store(){return this[Vu]}set store(e){this[Vu]=e}get modelList(){return this[Bu]}set modelList(e){this[Bu]=e.slice(0)}get context(){return this[zu]}set context(e){this[zu]=e}undo(){const{store:e,context:t,modelList:n,silent:r}=this;n.sort(((e,n)=>t.get(e)-t.get(n))),n.forEach((n=>{const i=t.get(n);e.insert(i,n,r)}))}redo(){this.store.remove(this.modelList,this.silent)}}Wu._$name="RemoveAction";const ju=Symbol("STORE_PROP"),Gu=Symbol("ALL_RECORDS_PROP");class Uu extends Ud{static get defaultConfig(){return{store:i,allRecords:i,silent:!1}}get type(){return"RemoveAllAction"}get store(){return this[ju]}set store(e){this[ju]=e}get allRecords(){return this[Gu]}set allRecords(e){this[Gu]=e.slice(0)}undo(){const{store:e,allRecords:t,silent:n}=this;e.add(t,n)}redo(){this.store.removeAll(this.silent)}}Uu._$name="RemoveAllAction";const Yu=(e,t,n,r)=>new xu({model:e,newData:t,oldData:n,isInitialUserAction:r}),qu=(e,t,n,r)=>new Du({parentModel:e,childModels:n,insertIndex:t,context:r}),Ku=(e,t,n)=>new ku({parentModel:e,childModels:t,context:n}),Xu=(e,t,n)=>new Au({store:e,modelList:t,silent:n}),Ju=(e,t,n,r,i)=>new Hu({store:e,insertIndex:t,modelList:n,context:r,silent:i}),Qu=(e,t,n,r)=>new Wu({store:e,modelList:t,context:n,silent:r}),Zu=(e,t,n)=>new Uu({store:e,allRecords:t,silent:n}),eh=(e,t,...n)=>{const r=e.state,i=t.call(e[Xd],e,...n);if("string"==typeof i)e[Xd]=su(i);else if(i instanceof Kd)e[Xd]=i;else if(Array.isArray(i)){const[t,r]=i;"string"==typeof t?e[Xd]=su(t):t instanceof Kd?e[Xd]=t:t&&"object"==typeof t&&((e=Object.assign(e,t))[Xd]=su(e[Xd])),"function"==typeof r&&eh(e,r,...n)}else i&&"object"==typeof i&&((e=Object.assign(e,i))[Xd]=su(e[Xd]));r!==hu&&r!==fu&&i!==hu&&i!==fu&&e.trigger("ready")};class th extends(je(fe)){static get defaultConfig(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:Yu,makeModelInsertChildAction:qu,makeModelRemoveChildAction:Ku,makeStoreModelAddAction:Xu,makeStoreModelInsertAction:Ju,makeStoreModelRemoveAction:Qu,makeStoreRemoveAllAction:Zu,getTransactionTitle:null}}construct(...e){Object.assign(this,{[Xd]:hu,[Jd]:[],[Qd]:[],[Zd]:0,[eu]:null,[tu]:null,[nu]:!1,[ru]:!1,stashedTransactions:{}}),super.construct(...e)}get state(){return this[Xd]}get position(){return this[Zd]}get length(){return this[Qd].length}get stores(){return Array.from(this[Jd])}hasStore(e){return this[Jd].includes(e)}addStore(e){this.hasStore(e)||(this[Jd].push(e),e.stm=this,e.forEach((e=>e.stm=this)),e.isTree&&(e.rootNode.stm=this))}removeStore(e){this.hasStore(e)&&(this[Jd]=this[Jd].filter((t=>t!==e)),e.stm=null,e.forEach((e=>e.stm=null)))}forEachStore(e){this[Jd].forEach((t=>e(t,t.id)))}get disabled(){return this.state===au}set disabled(e){const t=this;t.disabled!==e&&(eh(t,e?t.state.onDisable:t.state.onEnable,t),t.trigger("stmDisabled",{disabled:e}),t.trigger("disabled",{disabled:e}))}get enabled(){return!this.disabled}enable(){this.disabled=!1}disable(){this.disabled=!0}get isReady(){return this.state===hu||this.state===fu}waitForReadiness(){return this.await("ready",!1)}get isRecording(){return this.state===pu||this.state===bu}get isApplyingStash(){return this[ru]}get autoRecord(){return this[nu]}set autoRecord(e){const t=this;t.autoRecord!=e&&eh(t,e?t.state.onAutoRecordOn:t.state.onAutoRecordOff,t)}startTransaction(e=null){eh(this,this.state.onStartTransaction,e)}stopTransaction(e=null){eh(this,this.state.onStopTransaction,e)}stopTransactionDelayed(){eh(this,this.state.onStopTransactionDelayed)}rejectTransaction(){eh(this,this.state.onRejectTransaction)}get transaction(){return this[eu]}get queue(){return this[Qd].map((e=>e.title))}get rawQueue(){return this[Qd]}get isRestoring(){return this.state===mu||this.isApplyingStash}get canUndo(){return this.state.canUndo(this)}get canRedo(){return this.state.canRedo(this)}async undo(e=1){this.isReady||await this.waitForReadiness(),eh(this,this.state.onUndo,e)}async undoAll(){this.isReady||await this.waitForReadiness(),this.undo(this.length)}async redo(e=1){this.isReady||await this.waitForReadiness(),eh(this,this.state.onRedo,e)}async redoAll(){this.isReady||await this.waitForReadiness(),this.redo(this.length)}resetQueue(e={undo:!0,redo:!0}){eh(this,this.state.onResetQueue,e)}resetUndoQueue(){this.resetQueue({undo:!0})}resetRedoQueue(){this.resetQueue({redo:!0})}notifyStoresAboutStateRecordingStart(e){this.forEachStore((t=>{var n;return null===(n=t.onStmRecordingStart)||void 0===n?void 0:n.call(t,this,e)})),this.trigger("recordingStart",{stm:this,transaction:e})}notifyStoresAboutStateRecordingStop(e,t){this.forEachStore((n=>{var r;return null===(r=n.onStmRecordingStop)||void 0===r?void 0:r.call(n,this,e,t)})),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}notifyStoresAboutStateRestoringStart(){this.forEachStore((e=>{var t;return null===(t=e.onStmRestoringStart)||void 0===t?void 0:t.call(e,this)})),this.trigger("restoringStart",{stm:this})}notifyStoresAboutStateRestoringStop({cause:e,transactions:t}){this.forEachStore((e=>{var t;return null===(t=e.onStmRestoringStop)||void 0===t?void 0:t.call(e,this)})),this.trigger("restoringStop",{stm:this,cause:e,transactions:t})}notifyStoresAboutQueueReset(e){this.forEachStore((t=>{var n;return null===(n=t.onStmQueueReset)||void 0===n?void 0:n.call(t,this,e)})),this.trigger("queueReset",{stm:this,options:e})}onModelUpdate(e,t,n,r){eh(this,this.state.onModelUpdate,e,t,n,r)}onModelInsertChild(e,t,n,r){eh(this,this.state.onModelInsertChild,e,t,n,r)}onModelRemoveChild(e,t,n){eh(this,this.state.onModelRemoveChild,e,t,n)}onStoreModelAdd(e,t,n){eh(this,this.state.onStoreModelAdd,e,t,n)}onStoreModelInsert(e,t,n,r,i){eh(this,this.state.onStoreModelInsert,e,t,n,r,i)}onStoreModelRemove(e,t,n,r){eh(this,this.state.onStoreModelRemove,e,t,n,r)}onStoreRemoveAll(e,t,n){eh(this,this.state.onStoreRemoveAll,e,t,n)}onUndoKeyPress(e){const t=this;t.enabled&&(e.shiftKey?t.canRedo&&(e.preventDefault(),t.redo()):t.canUndo&&(e.preventDefault(),t.undo()))}stash(){const e=this;if(this.transaction){const t=ho.generateId("_stashedTransactionGeneratedId_");return e.stashedTransactions[t]=e.transaction,e.rejectTransaction(),t}}applyStash(e){const t=this,n=t.stashedTransactions[e];t[ru]=!0,n&&(t.startTransaction(n.title),n.redo(),delete t.stashedTransactions[e]),t[ru]=!1}}th._$name="StateTrackingManager";const nh=/^b-icon-/,rh=/^b-fa-/;class ih extends ul{static $name="MenuItem";static type="menuitem";static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(e,t){const n=super.updateElement(e,t);return"boolean"==typeof this.checked&&(this.role="menuitemcheckbox"),this.ariaHasPopup=!!this.hasMenu&&"menu",n}compose(){var e;const t=this,{checked:n,href:r,hasMenu:i,separator:o,target:s,text:l,toggleGroup:a}=t,c="boolean"==typeof n,d=t.icon||(c?"b-fw-icon":""),u="b-icon-"+(a?"radio-":""),h="object"==typeof l;return{tag:r?"a":"div",tabIndex:-1,href:r,target:s,class:{"b-has-submenu":i,"b-checked":n,"b-separator":o||(null===(e=t.cls)||void 0===e?void 0:e["b-separator"])},dataset:{group:t.toggleGroup},[c?"aria-checked":""]:n,[i?"aria-expanded":""]:!1,children:{iconElement:d&&{"aria-hidden":!0,tag:"i",class:{"b-fa":rh.test(d),"b-icon":nh.test(d),"b-menuitem-icon":1,[`${u}checked`]:!0===n,[`${u}unchecked`]:!1===n,...wn.normalize(d,"object")}},textElement:{tag:"span",html:h?null:l,class:{"b-menu-text":1,"b-menu-custom-content":h},children:h?[l]:null},subMenuIcon:i&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(e){const t=this,n=this.parent,r={menu:n,item:t,element:t.element,bubbles:!0,domEvent:e};if("boolean"==typeof t.checked){const e=!t.checked;t.toggleGroup&&!e||(t.checked=!t.checked)}t.trigger("beforeItem",r),t.trigger("item",r),t.closeParent&&n&&(n.rootMenu.close(),e&&!t.href&&e.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:e}=this;return e&&this.isVisible&&(e===document.body||e.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:e}=this;return e?[e]:[]}get text(){return this.html}set text(e){this.html=e}onFocusIn(e){super.onFocusIn(e),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(e){this.clearTimeout("openMenu"),super.onFocusOut(e),this._menu&&(this.menu.closeTimer=this.menu.setTimeout((()=>this.closeMenu()),this.closeMenuDelay))}openMenu(e){const{menu:t}=this;!this.disabled&&t&&(t.focusOnToFront=e,t.show())}onChildShow(e){super.onChildShow(e),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof ul&&this.menu.close()}onChildHide(e){super.onChildHide(e),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(e){return e&&"boolean"!=typeof this.checked&&(this.checked=!1),e}changeChecked(e,t){if(this.isConfiguring||"boolean"==typeof t)return Boolean(e)}updateChecked(e){const t=this;t.isConfiguring||(t.toggleGroup&&t.uncheckToggleGroupMembers(),t.element.setAttribute("aria-checked",e),t.trigger("toggle",{menu:t.owner,item:t,element:t.element,bubbles:!0,checked:e}))}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:n,element:r}=e,i=[];return t&&n&&Lr.forEachSelector(e.rootElement,`[data-group=${n}]`,(e=>{if(e!==r){const t=ul.fromElement(e);t&&i.push(t)}})),i}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((e=>e.checked=!1))}get closeParent(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}changeMenu(e,t){const n=this,{constrainTo:r,scrollAction:i}=n.owner;return!e||"object"!=typeof e||"items"in e||"widgets"in e||"html"in e||(e={lazyItems:e}),sh.reconfigure(t,e,{owner:n,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:n.element,owner:n,ariaLabel:n.text,constrainTo:r,scrollAction:i}})}}ih.initClass(),ih._$name="MenuItem";const oh={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1};class sh extends Xa{static $name="Menu";static type="menu";static get configurable(){return{layout:"vbox",focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(e){Array.isArray(e)&&(e={lazyItems:e}),super.construct(e),Gn.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(){const{items:e,element:t}=this;e.some((e=>Boolean(e._menu)))&&t.classList.add("b-menu-with-submenu");e.some((e=>e.icon))&&t.classList.add("b-menu-with-icon"),super.afterShow(...arguments)}createWidget(e){return"string"==typeof e&&(e={text:e}),super.createWidget(e)}get focusElement(){var e;const t=this,n=null===(e=t.parentMenu)||void 0===e?void 0:e.element.contains(Lr.getActiveElement(t.parentMenu)),r=t.items[0];return!n&&!Lr.usingKeyboard&&r instanceof ih?t.element:super.focusElement}onDocumentMouseDown({event:e}){if(!this.parentMenu||!this.parentMenu.owns(e.target))return super.onDocumentMouseDown(...arguments)}hide(e){const t=this;var n,r;(super.hide(e),t.isVisible)||(null===(n=t.currentSubMenu)||void 0===n||null===(r=n.hide)||void 0===r||r.call(n,e),t.parentMenu&&(t.parentMenu.currentSubMenu=null))}show(){super.show(...arguments);const{parentMenu:e}=this;this.isVisible&&e&&(e.currentSubMenu=this)}onMouseClick(e){const t=e.target.closest(".b-menuitem");t&&this.triggerElement(t,e)}onMouseOver(e){if(!1!==this.focusOnHover){var t;const n=null===(t=e.relatedTarget)||void 0===t?void 0:t.closest(".b-widget"),r=e.target.closest(".b-widget"),i=ul.fromElement(r);!Lr.isTouchEvent&&r&&r!==n&&i.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[i],cancelOutstanding:!0})}}handleMouseOver(e){e.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(e){const t=this,{relatedTarget:n}=e,r=n&&t.owns(n);let i=n instanceof HTMLElement&&ul.fromElement(n),o=!r;if(i){for(;i.ownerCmp;)i=i.ownerCmp;o&=!Lr.getAncestor(i.element,[e.target])}!r&&o&&(t.currentSubMenu&&!t.currentSubMenu.closeTimer&&t.currentSubMenu.hide(),t.element.contains(Lr.getActiveElement(t))&&Lr.getActiveElement(t).matches(".b-menuitem")&&t.focusElement.focus())}onInternalKeyDown(e){const t=ul.fromElement(e),n=t&&t!==this&&!(t instanceof ih);if("Escape"===e.key)return void(n?this:this.rootMenu).close();if(super.onInternalKeyDown(e),n)return;oh[e.key]&&e.preventDefault();const r=this.element,i=Lr.getActiveElement(r);this.navigateFrom(i!==r&&r.contains(i)?i:null,e.key,e)}navigateFrom(e,t,n){const r=this,{treeWalker:i}=r,o=e&&r.getItem(e),s=r.rtl?"ArrowLeft":"ArrowRight",l=r.rtl?"ArrowRight":"ArrowLeft";let a;switch(t){case"ArrowUp":i.currentNode=e||(e=r.bottomFocusTrap),i.previousNode(),a=i.currentNode;break;case"ArrowDown":i.currentNode=e||(e=r.topFocusTrap),i.nextNode(),a=i.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(null!=o&&o.menu?r.openSubMenu(e,o):r.triggerElement(e,n));break;case s:if(e&&null!=o&&o.menu&&!e.classList.contains("b-disabled")){const t=r.openSubMenu(e,o);null==t||t.focus()}else i.currentNode=e||(e=r.topFocusTrap),i.nextNode(),a=i.currentNode;break;case l:r.isSubMenu?r.hide():e||(i.currentNode=e||(e=r.topFocusTrap),i.nextNode(),a=i.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&r.triggerElement(e,n)}a&&(a===r.element?r.navigateFrom(r.bottomFocusTrap,"ArrowUp",n):a===e?r.navigateFrom(r.topFocusTrap,"ArrowDown",n):a.focus())}getItem(e){if(null!=e)return"number"==typeof e?this.items[e]:e.nodeType===Element.ELEMENT_NODE?ul.fromElement(e,"menuitem",this.contentElement):this.items.find((t=>t.id==e))}triggerElement(e,t){const n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}get isSubMenu(){var e;return this===(null===(e=this.owner)||void 0===e?void 0:e.menu)}openSubMenu(e,t){const n=this,r=t.menu;if(r){if(!r.isVisible){var i;const o={item:t,element:e};if(!1===n.trigger("beforeSubMenu",o))return;if(!1===(null===(i=t.onBeforeSubMenu)||void 0===i?void 0:i.call(t,o)))return;r.show()}return n.currentSubMenu=r}}set selectedElement(e){const t=this,n=t._selectedElement;if(n){const e=t.getItem(n),r=null==e?void 0:e.menu;null==r||r.hide(),n.classList.remove("b-active")}if(t._selectedElement=e,e){const n=Lr.isFocusable(e);e.classList.add("b-active"),t.scrollable.scrollIntoView(e,{animate:!n,focus:n})}}get selectedElement(){return this._selectedElement}selectFirst(){const e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((()=>e.currentNode.focus()))}get parentMenu(){var e;const t=this.owner;return t&&(t.isMenu?t:null===(e=t.up)||void 0===e?void 0:e.call(t,"menu"))}get rootMenu(){let e=this;for(;e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}let lh;sh.initClass(),sh._$name="Menu";class ah extends di{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:r}},items:{},triggerEvent:!1,clickTriggerSelector:null,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...e){var t;if(super.construct(...e),null===(t=this.type)||void 0===t||!t.length)throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(e){this.onElementEvent(e)}onElementClick(e){this.onElementEvent(e)}onElementDblClick(e){this.onElementEvent(e)}onElementEvent(e){if(e.handled||this.triggerEvent!==e.type)"click"===e.type&&this.clickTriggerSelector&&e.target.matches(this.clickTriggerSelector)&&this.internalShowContextMenu(e);else{if(!0===e.ctrlKey&&!s.isMac)return void e.preventDefault();const t=e;if(lh){const{target:n}=lh;e=Gn.fixEvent(new MouseEvent(e.type,e)),Object.defineProperty(e,"target",{get:()=>n,configurable:!0}),e.preventDefault=function(){t.preventDefault(),t.handled=!0}}this.internalShowContextMenu(e)}}showContextMenuByKey(e){if(!Lr.isEditable(e.target)){const t=this.getKeyboardContextMenuTarget(e.target);if(t)return lh=e,Lr.triggerMouseEvent(t,this.triggerEvent),e.handled=!0,e.preventDefault(),e.stopImmediatePropagation(),lh=null,!0}return!1}getKeyboardContextMenuTarget(e){const t=Lr.isInView(e);return e.children.length?Lr.childFromPoint(e,t.width/2,t.height/2):e}internalShowContextMenu(e){const t=this;if(t.disabled)return;const n=t.getDataFromEvent(e);!e.handled&&!e.defaultPrevented&&n&&t.shouldShowMenu(n)&&("contextmenu"===e.type&&s.isSafari&&e.ctrlKey&&!e.metaKey&&Gn.on({element:e.target,capture:!0,once:!0,thisObj:this,click(e){e.preventDefault(),e.stopImmediatePropagation()}}),n.domEvent=e,t.showContextMenu(n))}getDataFromEvent(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}getTargetElementFromEvent(e){return e.target}async showContextMenu(e,t){var n;const r=this,i=Lr.isDOMEvent(e),o=i?r.getDataFromEvent(e):e,s=i?e:o.domEvent;if(null===(n=r._menu)||void 0===n||n.hide(),r.disabled)return;r.menuContext=o;const{type:l,client:a,processItems:c}=r,d=Lr.isInView(o.targetElement).center;if(m.assign(o,{feature:r,point:null!=s&&s.clientX?[s.clientX+1,s.clientY+1]:[d.x,d.y],menu:r,items:{},selection:a.selectedRecords}),r.callChainablePopulateMenuMethod(o),m.merge(o.items,r.baseItems),r.preventDefaultEvent(o),(!c||!1!==r.callback(c,a,[o]))&&r.hasActiveMenuItems(o)&&(r.populateItemsWithData(o),!1!==r.beforeContextMenuShow(o))){const{menu:e}=r;let n=a.trigger(`${l}MenuBeforeShow`,o);var u;if(Yt.isPromise(n)&&(s.handled=!0,n=await n),!1!==n)e.items=o.items,e.showBy(t||{target:o.domEvent}),null===(u=r.touchMoveDetacher)||void 0===u||u.call(r),r.touchMoveDetacher=Gn.on({element:a.element,touchmove:()=>e.hide(),thisObj:e,once:!0}),s&&(s.preventDefault(),s.handled=!0)}}get baseItems(){if(!this._baseItems){const e=this,{namedItems:t}=e,n=e._baseItems=m.assign({},e.items);for(const e in n){const r=n[e];r&&(t&&e in t?n[e]="object"==typeof r?m.merge(m.clone(t[e]),r):t[e]:!0===r&&delete n[e])}}return this._baseItems}hideContextMenu(e){var t;null===(t=this.menu)||void 0===t||t.hide(e)}callChainablePopulateMenuMethod(e){var t,n;null===(t=(n=this.client)[`populate${A.capitalize(this.type)}Menu`])||void 0===t||t.call(n,e)}hasActiveMenuItems(e){return Object.values(e.items).some((e=>e&&!e.hidden))}shouldShowMenu(){return!0}beforeContextMenuShow(e){}populateItemsWithData(e){}preventDefaultEvent(e){var t;null===(t=e.event)||void 0===t||t.preventDefault()}changeTriggerEvent(e){return e||this.client.contextMenuTriggerEvent}changeMenu(e,t){const n=this,{client:r,type:i}=n;if(e)return sh.reconfigure(t,e?sh.mergeConfigs({owner:r,rootElement:r.rootElement,onItem(e){r.trigger(`${i}MenuItem`,e)},onToggle(e){r.trigger(`${i}MenuToggleItem`,e)},onDestroy(){n.menu=null},onBeforeItem(e){Object.assign(e,n.menuContext)},onShow({source:e}){n.menuContext.menu=e,r.trigger(`${i}MenuShow`,n.menuContext)}},e):null,n);null!=t&&t.isWidget&&t.destroy()}}ah._$name="ContextMenuBase";const ch={down:"onMouseDown",move:"onMouseMove",up:"onMouseUp",docclick:"onDocumentClick",touchstart:{handler:"onTouchStart",passive:!1},touchmove:"onTouchMove",touchend:"onTouchEnd",keydown:"onKeyDown"};class dh extends(je(fe)){static get defaultConfig(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal",clickSwallowDuration:50,rtlSource:null}}static configurable={skipUpdatingElement:null};construct(e){const t=this;super.construct(e),t.handleSelector||s.isHoverableDevice||(t.handleSize=t.touchHandleSize),t.handleVisibilityThreshold=t.handleVisibilityThreshold||2*t.handleSize,t.initListeners(),t.initResize()}doDestroy(){this.abort(!0),super.doDestroy()}updateSkipUpdatingElement(e){e&&(this.skipTranslate=!0)}initResize(){const e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=t=>t.closest(e.targetSelector)),e.grab){const{edge:t,element:n,event:r}=e.grab;e.startEvent=r;const i=e.getCursorOffsetToElementEdge(r,n,t);e.context={element:n,edge:t,valid:!0,async:!1,elementStartX:Lr.getTranslateX(n)||n.offsetLeft,elementStartY:Lr.getTranslateY(n)||n.offsetTop,newX:Lr.getTranslateX(n)||n.offsetLeft,newY:Lr.getTranslateY(n)||n.offsetTop,elementWidth:n.offsetWidth,elementHeight:n.offsetHeight,cursorOffset:i,startX:r.clientX+i.x+e.scrollLeft,startY:r.clientY+i.y+e.scrollTop,finalize:()=>{var t;return null===(t=e.reset)||void 0===t?void 0:t.call(e)}},n.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}initListeners(){const e=this,t={element:e.outerElement,mousedown:ch.down,touchstart:ch.touchstart,thisObj:e};!e.handleSelector&&s.isHoverableDevice&&(t.mousemove={handler:ch.move,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),Gn.on(t)}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}get scrollLeft(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}get scrollTop(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}internalStartResize(e){const t={element:document,keydown:ch.keydown,thisObj:this};e?(t.touchmove=ch.touchmove,t.touchend=t.pointerup=ch.touchend):(t.mousemove=ch.move,t.mouseup=ch.up),this.removeDragListeners=Gn.on(t)}removeDragListeners(){}reset(){var e;null===(e=this.removeDragListeners)||void 0===e||e.call(this),this.context=null,this.trigger("reset")}canResize(e,t){return!this.isElementResizable||this.isElementResizable(e,t)}onPointerDown(e,t){const n=this;n.startEvent=t,n.canResize(t.target,t)&&n.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),"touchstart"===t.type&&t.preventDefault(),n.internalStartResize(e))}onTouchStart(e){e.touches.length>1||this.onPointerDown(!0,e)}onMouseDown(e){0===e.button&&this.onPointerDown(!1,e)}internalMove(e,t){const n=this,{context:r,direction:i}=n;if(null!=r&&r.element&&(r.started||Gn.getDistanceBetween(n.startEvent,t)>=n.dragThreshold)){var o;if(!r.started)null===(o=n.scrollManager)||void 0===o||o.startMonitoring(Yt.merge({scrollables:[{element:n.dragWithin||n.outerElement,direction:i}],callback:e=>{var t;return(null===(t=n.context)||void 0===t?void 0:t.element)&&n.lastMouseMoveEvent&&n.update(n.lastMouseMoveEvent,e)}},n.monitoringConfig)),n.trigger("resizeStart",{context:r,event:t}),r.started=!0;n.update(t)}else e||n.handleSelector||n.checkResizeHandles(t)}onTouchMove(e){this.internalMove(!0,e)}onMouseMove(e){this.internalMove(!1,e)}onPointerUp(e,t){var n;const r=this,i=r.context;var o,s;(null===(n=r.removeDragListeners)||void 0===n||n.call(r),i)?(null===(o=r.scrollManager)||void 0===o||o.stopMonitoring(),i.started&&Gn.on({element:document,thisObj:r,click:ch.docclick,expires:r.clickSwallowDuration,capture:!0,once:!0}),r.finishResize(t)):null===(s=r.reset)||void 0===s||s.call(r)}onTouchEnd(e){this.onPointerUp(!0,e)}onMouseUp(e){this.onPointerUp(!1,e)}onDocumentClick(e){e.stopPropagation()}onKeyDown(e){"Escape"===e.key&&this.abort()}update(e){const t=this,n=t.context,r=bn.from(t.outerElement);n.currentX=Math.max(Math.min(e.clientX+n.cursorOffset.x,r.right),r.x)+t.scrollLeft,n.currentY=Math.max(Math.min(e.clientY+n.cursorOffset.y,r.bottom),r.y)+t.scrollTop,e&&(t.updateResize(e)&&(t.trigger("resizing",{context:n,event:e}),n.element.classList.toggle(t.invalidCls,!1===n.valid)),t.lastMouseMoveEvent=e)}abort(e=!1){var t,n;const r=this;null===(t=r.scrollManager)||void 0===t||null===(n=t.stopMonitoring)||void 0===n||n.call(t),r.context?r.abortResize(null,e):r.isDestroyed||r.reset()}grabResizeHandle(e,t){const n=this;if(n.allowResize&&!n.allowResize(t.target,t))return!1;const r=n.handleSelector,i="touchstart"===t.type?t.changedTouches[0]:t,o=i.clientX,s=i.clientY,l=n.targetSelector?t.target.closest(n.targetSelector):t.target;if(l){let a;if(r){if(!t.target.matches(r))return!1;a="horizontal"===n.direction?t.pageX<Lr.getPageX(l)+l.offsetWidth/2?n.isRTL?"right":"left":n.isRTL?"left":"right":t.pageY<Lr.getPageY(l)+l.offsetHeight/2?"top":"bottom"}else if("horizontal"===n.direction?n.overLeftHandle(t,l)?a=n.isRTL?"right":"left":n.overRightHandle(t,l)&&(a=n.isRTL?"left":"right"):n.overTopHandle(t,l)?a="top":n.overBottomHandle(t,l)&&(a="bottom"),!a)return n.context=null,!1;"touchstart"===t.type&&t.preventDefault();const c=n.getCursorOffsetToElementEdge(i,l,a);if(!1!==n.trigger("beforeResizeStart",{element:l,event:t}))return n.context={element:l,edge:a,isTouch:e,valid:!0,async:!1,direction:n.direction,elementStartX:Lr.getTranslateX(l)||l.offsetLeft,elementStartY:Lr.getTranslateY(l)||l.offsetTop,newX:Lr.getTranslateX(l)||l.offsetLeft,newY:Lr.getTranslateY(l)||l.offsetTop,elementWidth:l.offsetWidth,elementHeight:l.offsetHeight,cursorOffset:c,startX:o+c.x+n.scrollLeft,startY:s+c.y+n.scrollTop,finalize:()=>{var e;return null===(e=n.reset)||void 0===e?void 0:e.call(n)}},l.classList.add(n.resizingCls),!0}return!1}getCursorOffsetToElementEdge(e,t,n){const r=bn.from(t);let i=0,o=0;switch(n){case"left":i=r.x-(this.isRTL?r.width:0)-e.clientX;break;case"right":i=r.x+(this.isRTL?0:r.width)-e.clientX;break;case"top":o=r.y-e.clientY;break;case"bottom":o=r.y+r.height-e.clientY}return{x:i,y:o}}checkResizeHandles(e){const t=this,n=t.targetSelector?e.target.closest(t.targetSelector):e.target;if(!n||t.allowResize&&!t.allowResize(e.target,e))t.currentElement&&t.unHighlightHandle();else if(t.currentElement=t.handleContainerSelector?e.target.closest(t.handleContainerSelector):e.target,t.currentElement){let r;r="horizontal"===t.direction?t.overLeftHandle(e,n)||t.overRightHandle(e,n):t.overTopHandle(e,n)||t.overBottomHandle(e,n),r?t.highlightHandle():t.unHighlightHandle()}}onMouseLeaveTarget(e){const t=this;t.currentElement=t.handleContainerSelector?e.target.closest(t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}updateResize(e){const t=this,{context:n,allowEdgeSwitch:r,skipTranslate:i,skipUpdatingElement:o}=t;let s;r&&("horizontal"===t.direction?n.edge=n.currentX>n.startX?"right":"left":n.edge=n.currentY>n.startY?"bottom":"top");const{element:l,elementStartX:a,elementStartY:c,elementWidth:d,elementHeight:u,edge:h}=n,{style:g}=l,p=n.currentX-n.startX,m=n.currentY-n.startY,f=Lr.getExtremalSizePX(l,"minWidth")||t.minWidth,v=Lr.getExtremalSizePX(l,"maxWidth")||t.maxWidth,b=Lr.getExtremalSizePX(l,"minHeight")||t.minHeight,y=Lr.getExtremalSizePX(l,"maxHeight")||t.maxHeight,C="right"===h&&!t.isRTL||"bottom"===h?1:-1,w=d+p*C,x=u+m*C;let S=Math.max(f,w),E=Math.max(b,x);if(v>0&&(S=Math.min(S,v)),y>0&&(E=Math.min(E,y)),g.flex&&(g.flex=""),"horizontal"===t.direction&&d!==S){if(o||(g.width=Math.abs(S)+"px"),n.newWidth=S,"left"===h||S<0){const e=Math.max(Math.min(a+d-t.minWidth,a+p),0);i||Lr.setTranslateX(l,Math.round(e)),n.newX=e}else"right"===h&&r&&!i&&Lr.setTranslateX(l,a);s=!0}else"vertical"===t.direction&&u!==x&&(o||(g.height=Math.abs(E)+"px"),n.newHeight=E,"top"===h||E<0?(n.newY=Math.max(Math.min(c+u-t.minHeight,c+m),0),i||Lr.setTranslateY(l,n.newY)):"bottom"===h&&r&&!i&&Lr.setTranslateY(l,c),s=!0);return s}finishResize(e){const t=this,n=t.context,r={context:n,event:e};if(n.element.classList.remove(t.resizingCls),n.started){let e=!1;e="horizontal"===t.direction?n.newWidth&&n.newWidth!==n.elementWidth:n.newHeight&&n.newHeight!==n.elementHeight,t.trigger(e?"resize":"cancel",r),n.async||n.finalize()}else{var i;null===(i=t.reset)||void 0===i||i.call(t)}}abortResize(e=null,t=!1){const n=this,r=n.context;r.element.classList.remove(n.resizingCls),"horizontal"===n.direction?(("left"===r.edge||r.allowEdgeSwitch&&!r.skipTranslate)&&Lr.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(Lr.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&n.trigger("cancel",{context:r,event:e}),n.isDestroyed||n.reset()}highlightHandle(){const e=this,t=e.targetSelector?e.currentElement.closest(e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}unHighlightHandle(){const e=this,t=e.targetSelector?e.currentElement.closest(e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}overAnyHandle(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}overStartHandle(e,t){return"horizontal"===this.direction?this.overLeftHandle(e,t):this.overTopHandle(e,t)}overEndHandle(e,t){return"horizontal"===this.direction?this.overRightHandle(e,t):this.overBottomHandle(e,t)}getDynamicHandleSize(e,t){const n=e?2:1,{handleSize:r}=this;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max(Math.floor((t-this.reservedSpace)/n),0):r}overLeftHandle(e,t){const n=this,{offsetWidth:r}=t;if(n.leftHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const i=bn.from(t);return i.width=n.getDynamicHandleSize(n.rightHandle,r),i.width>0&&i.contains(Gn.getPagePoint(e))}return!1}overRightHandle(e,t){const n=this,{offsetWidth:r}=t;if(n.rightHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const i=bn.from(t);return i.x=i.right-n.getDynamicHandleSize(n.leftHandle,r),i.width>0&&i.contains(Gn.getPagePoint(e))}return!1}overTopHandle(e,t){const n=this,{offsetHeight:r}=t;if(n.topHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const i=bn.from(t);return i.height=n.getDynamicHandleSize(n.bottomHandle,r),i.height>0&&i.contains(Gn.getPagePoint(e))}return!1}overBottomHandle(e,t){const n=this,{offsetHeight:r}=t;if(n.bottomHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const i=bn.from(t);return i.y=i.bottom-n.getDynamicHandleSize(n.bottomHandle,r),i.height>0&&i.contains(Gn.getPagePoint(e))}return!1}}dh._$name="ResizeHelper";class uh extends Array{constructor(e,t){super(),this.timeZone=e,this.year=t}}class hh{constructor(e,t){this.asString=e,this.timeZone=t,this.asArray=mh(e)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}}const gh=(e,t)=>{const n=e.toLocaleString("sv-SE",{timeZone:t});return new hh(n,t)},ph=(e,t)=>{const{asTicksUtc:n,asString:r}=gh(new Date(e),t);return{offset:(e-n)/6e4,tzTicksUtc:n,tzString:r}},mh=e=>{const t=e.split(/[\s-:]/).map((e=>1*e));return t[1]-=1,t},fh=-864e5,vh=2592e6,bh=(e,t)=>{const n=yh.get(e,t);if(n)return n;const r=new uh(e,t),i=new Date(Date.UTC(t,0,1)).getTime();let o,s,l,a,c=i,d=vh,u=0,h=[],g=null;for(;!a;)({offset:l,tzTicksUtc:o,tzString:s}=ph(c,e)),null==g?(g=l,r.push({offset:l})):d>0&&l!==g?d=d===vh?fh:-6e4:d<0&&l===g&&(d===fh?d=36e5:(1===r.length?(r.push(h),g=h.offset):(r[0].startTicks=h.startTicks,r[0].startDateString=h.startDateString,a=!0),d=vh)),h={offset:l,startDateString:s,startTicks:o},d===vh&&(c=i,c+=u*vh,u+=1),c+=d,u>11&&(a=!0);return yh.set(r),r},yh={_cache:{},get(e,t){var n;return null===(n=this._cache[e])||void 0===n?void 0:n[t]},set(e){const{timeZone:t}=e,{_cache:n}=this;n[t]||(n[t]={}),n[t][e.year]=e}};class Ch{static get $name(){return"TimeZoneHelper"}static toTimeZone(e,t){if("number"==typeof t)return this.toUtcOffset(e,t);const n=gh(e,t);return n.asArray[3]!==n.asLocalDate.getHours()&&console.warn("Incorrect time zone conversion due to local DST-switch detected"),n.asLocalDate}static fromTimeZone(e,t){if("number"==typeof t)return this.fromUtcOffset(e,t);const n=this.dateAsArray(e),r=bh(t,e.getUTCFullYear());let i=r[0].offset;if(2===r.length){const e=Date.UTC(...n);e>=r[1].startTicks&&e<r[0].startTicks&&(i=r[1].offset)}return n[4]+=i,new Date(Date.UTC(...n))}static toUtcOffset(e,t){const n=e.getTimezoneOffset()+t;return new Date(e.getTime()+60*n*1e3)}static fromUtcOffset(e,t){const n=-e.getTimezoneOffset()-t;return new Date(e.getTime()+60*n*1e3)}static dateAsArray(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}}Ch.findOffsetDates=bh,Ch._$name="TimeZoneHelper";class wh{static convertFromObject(e,t={}){m.assignIf(t,{rootName:"root",elementName:"element",includeHeader:!0,rootElementForArray:!0});const{rootName:n,elementName:r,includeHeader:i,rootElementForArray:o}=t;let{xmlns:s}=t;s=s?` xmlns="${s}"`:"";const l=e=>{const t=[];for(const n in e){const i=e[n];if(Array.isArray(i)){o&&t.push(`<${n}>`);for(const e of i)r.length?t.push(`<${r}>`):t.push(`<${n}>`),t.push(l(e)),r.length?t.push(`</${r}>`):t.push(`</${n}>`);o&&t.push(`</${n}>`)}else m.isObject(i)?t.push(`<${n}>${l(i)}</${n}>`):null==i?t.push(`<${n}/>`):t.push(`<${n}>${A.encodeHtml(i)}</${n}>`)}return t.join("")};return`${i?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>':""}<${n}${s}>${l(e)}</${n}>`}}wh._$name="XMLHelper";class xh{constructor(){this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}nextRandom(e){const{randomCache:t}=this;let n;return t[e]?n=t[e]:(n=this.random100.filter((t=>t<e)),t[e]=n),n[this.rndIndex++%n.length]}reset(){this.rndIndex=0}fromArray(e){return e[this.nextRandom(e.length)]}randomArray(e,t){const n=[],r=this.nextRandom(t+1),i={};for(let t=0,o=this.nextRandom(e.length);t<r;t++){for(;i[o];)o=this.nextRandom(e.length);i[o]=!0,n.push(e[o])}return n}}xh._$name="RandomGenerator";const Sh=["Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.","Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.","Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.","Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.","Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui atione voluptatem sequi nesciunt.","Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.","Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?","Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"];class Eh{static reset(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}static*generate(e,t=!1,n=1){let r,o;"object"==typeof e&&(t=e.randomHeight,n=e.initialId??1,r=e.addSkills,o=e.rowCallback,e=e.count);const{rnd:s,rndTime:l,rndRating:a,rndText:c,firstNames:d,surNames:u,teams:h,foods:g,colors:p,cities:m,skills:f}=this;for(let b=0;b<e;b++){var v;const y=s.fromArray(d),C=s.fromArray(u),w=`${y} ${String.fromCharCode(65+b%25)} ${C}`,x=s.nextRandom(60)+1,S=new Date(2019,0,x),E=new Date(2019,0,x+s.nextRandom(30)+2),R={id:n>-1?b+n:i,title:"Row "+b,name:w,firstName:y,surName:C,city:s.fromArray(m),team:s.fromArray(m)+" "+s.fromArray(h),age:10+s.nextRandom(80),food:s.fromArray(g),color:s.fromArray(p),score:10*s.nextRandom(100),rank:s.nextRandom(100)+1,start:S,finish:E,time:Wt.getTime(l.nextRandom(24),5*l.nextRandom(12)),percent:s.nextRandom(100),done:s.nextRandom(100)<50,rating:a.nextRandom(5),active:x>30,relatedTo:Math.min(e-1,b+n+s.nextRandom(10)),notes:Sh[c.nextRandom(7)+1]};r&&(R.skills=s.randomArray(f,"number"==typeof r?r:7));const T=null===(v=o)||void 0===v?void 0:v(R);T&&Object.assign(R,T),t&&(R.rowHeight=5*s.nextRandom(!0===t?20:t)+20),yield R}}static generateData(e,t=!1,n=1,r=!0){let i=e;"object"!=typeof e&&(i={count:e,randomHeight:t,initialId:n,reset:r}),!1!==i.reset&&this.reset(),Eh.overrideRowCount&&(i.count=Eh.overrideRowCount);const o=[],s=this.generate(i);for(let e=0;e<i.count;e++)o.push(s.next().value);return o}static generateEvents({viewStartDate:e,viewEndDate:t,nbrResources:n=50,nbrEvents:r=5,dependencies:i,tickUnit:o="days",minDuration:s=2,maxDuration:l=10,gap:a=1,eventCallback:c}){const d=this.generateData(n),u=[];let h,g;i=[];for(let t=0;t<=n;t++)for(let n=0;n<=r;n++){const r=Math.round(Math.random()*(l-1-s))+s,d=u.length+1;h=0===n?Wt.add(e,Math.round(3*Math.random())*a,o):Wt.add(g,a,o),g=Wt.add(h,r,o),u.push({id:d,name:this.tasks[(t+n)%(this.tasks.length-1)],startDate:h,duration:r,endDate:g,resourceId:t}),null==c||c(u[u.length-1]),i&&t>0&&i.push({id:i.length+1,from:d-1,to:d})}return{resources:d,events:u,dependencies:i}}static generateOneEventPerTickAndResource({startDate:e,endDate:t,nbrResources:n=50,tickUnit:r="days"}){const i=this.generateData(n),o=[],s=Wt.getDurationInUnit(e,t,r);for(let t=0;t<=n;t++)for(let n=0;n<s;n++)o.push({id:o.length+1,resourceId:t,name:this.tasks[(t+n)%(this.tasks.length-1)],startDate:Wt.add(e,n,r),duration:1,durationUnit:r});return{resources:i,events:o}}static generateRow(){return Eh.generateData(1,!1,-1,!1)[0]}}Object.assign(Eh,{rnd:new xh,rndTime:new xh,rndRating:new xh,rndText:new xh,cities:["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"],firstNames:["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"],surNames:["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"],teams:["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"],foods:["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"],colors:["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"],skills:["JavaScript","CSS","TypeScript","React","Vue","Angular","Java","PHP","Python","C#","C++","BASIC","COBOL","FORTRAN","PASCAL","SQL"],tasks:["Meetings","Documentation","Email communication","Project management","Budgeting","Marketing and advertising","Customer service","Research and analysis","Data entry","IT support","Employee management","Sales and business development","Event planning","Graphic design","Writing and editing","Presentation","Travel arrangements and expense management","Training and development","Quality assurance","Customer support","Technical writing","Social media management","Translation","Legal research","Data analysis and visualization","Video editing and production","Network admin","Content creation","Market research","Public relations","Teaching and training","Recruiting","Product development"]}),Eh._$name="DataGenerator";const Rh=["action","target","to","deltaX","deltaY","x","y","text"];class Th extends(je(ai())){static get defaultConfig(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}construct(e){super.construct(e);const t=this;t.widget&&(t.outerElement=t.widget.element,t.widget.playingDemo=!0),Gn.playingDemo=!0,Object.assign(t,{prevTarget:null,currentStep:0,mouse:Lr.createElement({parent:t.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),t.intervalId=t.setInterval(t.nextStep.bind(t),1e3),t.outerElement.classList.add("b-playing-demo"),t.outerElement.addEventListener("click",(e=>{e.isTrusted&&t.abort()}))}doDestroy(){this.abort()}abort(e=!1){const t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),Gn.playingDemo=!1,t.trigger(e?"done":"abort")}triggerEvent(e,t,n){if(!e)return null;let i;if(t.startsWith("mouse")){const e=this.mouse.getBoundingClientRect();i=new MouseEvent(t,Object.assign({view:r,bubbles:!0,cancelable:!0,clientX:e.left,clientY:e.top},n||{}))}else i=document.createEvent("Event"),i.initEvent(t,!0,!1);return e.dispatchEvent(i),i}handleMouseMove(e,t){const n=this,r=n.mouse;r.classList.add("quick"),n.mouseDown&&r.classList.add("drag");const i=bn.from(r,n.outerElement),o=i.x,s=i.y;let l=0,a=0;if(e.to)if("string"==typeof e.to){const t=n.outerElement.querySelector(e.to);if(t){const e=bn.from(t,n.outerElement),r=e.x+e.width/2,i=e.y+e.height/2;l=(r-o)/10,a=(i-s)/10}}else e.to.x?l=(e.to.x-o)/10:(l=e.to[0]/10,a=e.to[1]/10);else e.deltaX?l=e.deltaX/10:e.x&&(l=(e.x-o)/10);e.deltaY&&(a=e.deltaY/10);let c=0;n.innerIntervalId=n.setInterval((()=>{if(n.shouldPause)return;9==c++&&(clearInterval(n.innerIntervalId),e.then&&e.then());const t=o+l*c,i=s+a*c;r.style.left=t+"px",r.style.top=i+"px";const d=r.getBoundingClientRect(),u=d.left,h=d.top,g=Lr.elementFromPoint(u,h);g!==n.prevTarget&&(n.prevTarget&&(n.mouseOutElements.push(n.prevTarget),Lr.isDescendant(n.mouseOutElements[0],g)||(n.mouseOutElements.forEach((e=>n.triggerEvent(e,"mouseout"))),n.mouseOutElements.length=0)),n.prevTarget=g,n.triggerEvent(g,"mouseover")),n.triggerEvent(g,e.action,{clientX:u,clientY:h})}),50)}getTarget(e){const t=this,n=e.target;return n?"function"==typeof n?n(e):document.querySelector(n):t.prevTarget||t.outerElement}normalizeStep(e){if(e.action)return"function"==typeof e.action?e.action(e):e;if("function"==typeof e)return e(),e;for(const t in e)Object.hasOwnProperty.call(e,t)&&!Rh.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return e.target||"string"!=typeof e.to&&"function"!=typeof e.to||(e.target=e.to),e}get isScrolling(){const e=this,t=e.outerElement.getBoundingClientRect(),n=e.lastTop&&t.top!==e.lastTop;return e.lastTop=t.top,n}get isInView(){const e=this.outerElement.getBoundingClientRect();return e.top<r.innerHeight&&e.bottom>0}get shouldPause(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}nextStep(){const e=this;if(e.shouldPause)return;if(e.currentStep===e.steps.length){if(!e.repeat)return e.abort(!0);e.currentStep=0}0===e.currentStep&&e.trigger("initialize");const t=e.mouse,n=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(n),i=n.action;if(r&&i)if(t.className="simulated-mouse","mousemove"===i)e.handleMouseMove(n,r);else{if(r!==e.prevTarget){const n=bn.from(r,e.outerElement);t.style.left=n.x+n.width/2+"px",t.style.top=n.y+n.height/2+"px"}"mousedown"===i&&(e.mouseDown=!0),"mouseup"===i&&(e.mouseDown=!1),e.timeoutId=e.setTimeout((()=>{if(e.prevTarget=r,t.classList.add(i),"type"===i){const e=ul.fromElement(r),t=n.text.split("|");e.value=t[1===t.length||e.value!=t[0]?0:1]}else e.triggerEvent(r,i)}),"type"===i?100:550)}}}Th._$name="DemoBot";const Dh=Object.prototype.hasOwnProperty;let Mh=null;class Fh{constructor(e){this.formatter=e}format(e){return this.formatter.defaultFormat(e)}parse(e,t){return this.formatter.defaultParse(e,t)}resolvedOptions(){return null}}class Ih{static get(e){if(null==e)return this.NULL;if(e instanceof this)return e;const t="string"==typeof e?e:JSON.stringify(e),n=this.cache;let r=n.get(t);return r||(Mh=t,r=new this(e),n.set(t,r)),r}static get cache(){return Dh.call(this,"_cache")&&this._cache||(this._cache=new Map)}static get NULL(){return Dh.call(this,"_null")?this._null:this._null=new this(null)}constructor(e){const t=this;if(t.cacheKey=Mh,Mh=null,t.initialize(),null===e)t.formatter=new Fh(t);else{t.configure(e);for(const[e,n]of Object.entries(t.resolvedOptions()))null!=n&&e in t.defaults&&(t[e]=n)}}get parser(){return e=this,t=new this.constructor.Parser(this),Object.defineProperty(e,"parser",{value:t}),t;var e,t}defaultFormat(e){return null==e?e:String(e)}defaultParse(e){return e}format(e){return null==e?e:this.formatter.format(e)}parse(e,t){return null==e?e:this.parser.parse(e,t)}parseStrict(e){return this.parse(e,!0)}resolvedOptions(){return this.formatter.resolvedOptions()}}Ih._$name="Formatter";const kh=A.escapeRegExp,Oh=/[\d+-]/g,Lh=(e,t)=>new Intl.NumberFormat(e||i,t),Ah=/^(?:([$])\s*)?(?:(\d+)>)?\d+(,\d+)?(?:\.((\d*)(?:#*)|[*]))?(?:\s*([%])?)?$/;class Ph extends Ih{static get $name(){return"NumberFormat"}initialize(){this._as={},this.is={decimal:!1,currency:!1,percent:!1,null:!0,from:null}}get truncator(){const e=this.maximumFractionDigits;return null==e?null:this.as({style:"decimal",maximumFractionDigits:Math.min(20,e+1)},"truncator")}configure(e){const t=this;"string"!=typeof e?Object.assign(t,e):t.template=e;const n={},r=t.locale?Ye.locales[t.locale]:Ye.locale,i=r&&r.NumberFormat,o=t.template;if(i)for(const e in i)null==t[e]&&"function"!=typeof i[e]&&(t[e]=i[e]);if(o){const e=Ah.exec(o),n=e[2],r=e[4];t.useGrouping=!!e[3],t.style=e[1]?"currency":e[6]?"percent":"decimal",n&&(t.integer=+n),"*"===r?t.fraction=[0,20]:null!=r&&(t.fraction=[e[5].length,r.length])}t._minMax("fraction",!0,!0),t._minMax("integer",!0,!1),t._minMax("significant",!1,!0);for(const e in t.defaults)null!=t[e]&&(n[e]=t[e]);t.is.from=t.from&&t.from.is,t.is[t.style]=!(t.is.null=!1),t.formatter=Lh(t.locale,n)}as(e,t=null){const n=this.resolvedOptions()||{template:"9.*"},r=this._as;let i=t&&r[t];return i||("string"==typeof e?n.style=e:Object.assign(n,e),n.from=this,i=new Ph(n)),t&&(r[t]=i),i}defaultParse(e,t){return null==e?e:t?Number(e):parseFloat(e)}format(e){if("string"==typeof e){const t=Number(e);e=isNaN(t)?this.parse(e):t}return super.format(e)}round(e){return this.parse(this.format(e))}truncate(e){const t=this,n=t.maximumFractionDigits,{truncator:r}=t;let i,o=t.parse(e);return r&&(o=r.format(o),i=o.indexOf(r.parser.decimal),i>-1&&o.length-i-1>n&&(o=o.substr(0,i+n+1)),o=r.parse(o)),o}resolvedOptions(){const e=super.resolvedOptions();for(const t in e)e[t]===i&&(e[t]=this[t]);return e}_minMax(e,t,n){const r=this,i=r[e];if(null!=i){const o=A.capitalize(e),s=`maximum${o}Digits`,l=`minimum${o}Digits`;"number"==typeof i?(t&&(r[l]=i),n&&(r[s]=i)):(r[l]=i[0],r[s]=i[1])}}}Ph.Parser=class{constructor(e){const t=this,n=e.locale,r=Lh(n,{maximumFractionDigits:3}),i=e.is.currency?t._decodeStyle(n,{style:"currency",currency:e.currency,currencyDisplay:e.currencyDisplay}):null,o=e.is.percent?t._decodeStyle(n,{style:"percent"}):null,s=r.format(1.2).replace(Oh,"")[0],l=r.format(1e9).replace(Oh,"")[0]||"";Object.assign(t,{currency:i,decimal:s,formatter:e,grouper:l,percent:o}),t.decimal=s,t.decimalRe=kh(s,"g"),t.grouper=l,t.stripRe=new RegExp(`(?:\\s+|${kh(l)})`+(i?`|(?:${kh(i.text)})`:"")+(o?`|(?:${kh(o.text)})`:""),"g")}decimalPlaces(e){const t=(e=e.replace(this.stripRe,"")).indexOf(this.decimal)+1;return t&&e.length-t}parse(e,t){return"string"==typeof e&&(e=e.replace(this.stripRe,"").replace(this.decimalRe,".").replace("−","-"),e=t?Number(e):parseFloat(e),this.formatter.is.percent&&(e/=100)),e}_decodeStyle(e,t){const n=Lh(e,t),r=Lh(e,Object.assign(n.resolvedOptions(),{style:"decimal"})),i=n.format(0),o=r.format(0);return{suffix:i.startsWith(o),text:i.replace(o,"").trim()}}},Object.assign(Ph.prototype,{defaults:{style:"decimal",currency:null,currencyDisplay:"symbol",locale:null,maximumFractionDigits:null,minimumFractionDigits:null,minimumIntegerDigits:null,maximumSignificantDigits:null,minimumSignificantDigits:null,useGrouping:!0},fraction:null,from:null,integer:null,significant:null,template:null}),Object.assign(Ph.prototype,Ph.prototype.defaults),Ih.number=(e,t)=>Ph.format(e,t),Ph._$name="NumberFormat";class _h extends(je(fe)){static webSocketImplementation="undefined"==typeof WebSocket?null:WebSocket;static configurable={address:"",userName:"User",autoConnect:!0};construct(e={}){const t=this;super.construct(e),t.onWsOpen=t.onWsOpen.bind(t),t.onWsClose=t.onWsClose.bind(t),t.onWsMessage=t.onWsMessage.bind(t),t.onWsError=t.onWsError.bind(t),t.autoConnect&&t.address&&t.open()}doDestroy(){const e=this;e.connector&&(e.detachSocketListeners(e.connector),e.connector.close(),e.connector=null),super.doDestroy()}get isConnecting(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.CONNECTING}get isOpened(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.OPEN}get isClosing(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.CLOSING}get isClosed(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.CLOSED}createWebSocketConnector(){const e=this.connector=new this.constructor.webSocketImplementation(this.address);this.attachSocketListeners(e)}destroyWebSocketConnector(){this.detachSocketListeners(this.connector),this.connector.close(),this.connector=null}attachSocketListeners(e){const t=this;e.addEventListener("open",t.onWsOpen),e.addEventListener("close",t.onWsClose),e.addEventListener("message",t.onWsMessage),e.addEventListener("error",t.onWsError)}detachSocketListeners(e){const t=this;e.removeEventListener("open",t.onWsOpen),e.removeEventListener("close",t.onWsClose),e.removeEventListener("message",t.onWsMessage),e.removeEventListener("error",t.onWsError)}async open(){const e=this;if(e._openPromise)return e._openPromise;if(!e.address)return void console.warn("Server me.address cannot be empty");if(e.isOpened)return!0;let t;return e.createWebSocketConnector(),e._openPromise=new Promise((n=>{t=e.ion({open(){n(!0)},error(){n(!1)}})})).then((n=>(t(),e._openPromise=null,n||e.destroyWebSocketConnector(),n))).catch((()=>{e._openPromise=null,e.destroyWebSocketConnector()})),e._openPromise}close(){this.connector&&(this.destroyWebSocketConnector(),this.trigger("close"))}send(e,t={}){var n;null===(n=this.connector)||void 0===n||n.send(JSON.stringify({command:e,...t}))}onWsOpen(e){this.trigger("open",{event:e})}onWsClose(e){this.trigger("close",{event:e})}onWsMessage(e){try{const t=JSON.parse(e.data);this.trigger("message",{data:t})}catch(e){this.trigger("error",{error:e})}}onWsError(e){this.trigger("error",{error:e})}}_h._$name="WebSocketManager";class $h extends(fe.mixin(je)){hasNativeAccess=!0;_content=null;async writeText(e,t){const n=this,{_content:r}=n;if(t&&n.hasNativeAccess)try{await navigator.clipboard.writeText(e)}catch(e){n.hasNativeAccess=!1}r!==e&&(n._content=e,n.triggerContentChange(r,!1,!0))}async readText(e){const t=this,{_content:n}=t;if(e&&t.hasNativeAccess)try{const e=await navigator.clipboard.readText();return n!==e&&(t._content=e,t.triggerContentChange(n,!0)),e}catch(e){t.hasNativeAccess=!1}return n}triggerPaste(e){this.trigger("paste",{source:e,text:this._content})}triggerContentChange(e,t=!1,n=!1){this.trigger("contentChange",{fromRead:t,fromWrite:n,oldText:e,newText:this._content})}async clear(e){await this.writeText("",e)}}var Nh=e=>class extends(e||fe){static $name="Clipboardable";static configurable={useNativeClipboard:!1};construct(...e){super.construct(...e),r.bryntum.clipboard||(r.bryntum.clipboard=new $h),r.bryntum.clipboard.ion({paste:"onClipboardPaste",contentChange:"onClipboardContentChange",thisObj:this})}get clipboard(){return r.bryntum.clipboard}onClipboardPaste({text:e,source:t}){const n=this,{clipboardText:r,isCut:i}=n,o=n.compareClipboardText(r,e);var s;o&&i?(null===(s=n.handleCutData)||void 0===s||s.call(n,{text:e,source:t}),n.isCut=!1,n.cutData=null):o||n.clearClipboard(!1)}onClipboardContentChange({newText:e}){this.compareClipboardText(this.clipboardText,e)||this.clearClipboard(!1)}set cutData(e){var t,n;const r=this;null===(t=r._cutData)||void 0===t||t.forEach((e=>r.setIsCut(e,!1))),r._cutData=H.asArray(e),null===(n=r._cutData)||void 0===n||n.forEach((e=>r.setIsCut(e,!0)))}get cutData(){return this._cutData}setIsCut(){}async writeToClipboard(e,t,n={}){if(!1===await this.beforeCopy({data:e,isCut:t,...n}))return;const r=this,i="string"==typeof e,o=i?e:r.stringConverter?r.stringConverter(e):A.safeJsonStringify(e);return r.clipboardText=o,await r.clipboard.writeText(o,r.useNativeClipboard),r.clipboardData=e,r.isCut=t,r.cutData=t&&!i?e:null,o}async readFromClipboard(e={},t=!1){var n;const r=this,{clipboard:i}=r,o=await i.readText(r.useNativeClipboard),{isOwn:s,data:l}=r.transformClipboardText(o),a=o&&s&&r.isCut;if(!(null==l||Array.isArray(l)&&0==l.length||!1===await(null===(n=r.beforePaste)||void 0===n?void 0:n.call(r,{data:l,text:o,...e,isCut:a}))))return s||r.clearClipboard(!1),t||i.triggerPaste(r),l}async clearClipboard(e=!0){const t=this;t.clipboardData=t.clipboardText=t.cutData=null,t.isCut=!1,e&&await t.clipboard.clear(t.useNativeClipboard)}compareClipboardText(e,t){const n=/\r\n|(?!\r\n)[\n-\r\x85\u2028\u2029]/g;return(null==e?void 0:e.replace(n,"\n"))===(null==t?void 0:t.replace(n,"\n"))}transformClipboardText(e){const t=this,n=t.compareClipboardText(t.clipboardText,e);return{isOwn:n,data:n?t.clipboardData:t.stringParser&&e?t.stringParser(e):e}}hasClipboardData(){const{clipboard:e}=this,{_content:t}=e;if(!this.useNativeClipboard||!e.hasNativeAccess)return Boolean(t&&this.transformClipboardText(t).data)}},Hh=e=>class extends(e||fe){static get $name(){return"Finalizable"}construct(...e){super.construct(...e),this.finalizer=null,this.finalizing=null,this.isFinalized=!1,this.isFinalizing=!1}doFinalize(){this.destroy()}finalize(){const e=this;let t=e.finalizing;return t||e.isFinalized||(e.isFinalizing=!0,e.finalizing=t=e._awaitFinalizer()),t}async _awaitFinalizer(){const e=this;try{await e.finalizer}finally{e.finalizing=null,e.isFinalized=!0,e.doFinalize()}}};const Vh=Symbol("dragAbort"),Bh=Symbol("dragInit"),zh=Symbol("dragDrag"),Wh=Symbol("dragDrop"),jh={x:"horizontal",y:"vertical"};class Gh extends(fe.mixin(Hh,ai,Si)){static $name="DragContext";static get configurable(){return{itemElement:null,scrollManager:null,monitoringConfig:null,source:null,target:null,targetElement:null,threshold:5,touchStartDelay:300}}static get identifiable(){return{}}construct(...e){super.construct(...e);const t=this,{event:n}=t;Object.assign(t,{altKey:null,cleaners:[],ctrlKey:null,data:new Map,element:n.target,endEvent:null,lastMoveEvent:null,metaKey:null,previousTarget:null,scrollerAction:null,shiftKey:null,state:Bh,startEvent:n,touchStartTimer:null,_valid:!0}),"touches"in n&&t.touchStartDelay&&(t.touchStartTimer=t.setTimeout((()=>t.touchStartTimer=null),t.touchStartDelay,"touchStartDelay")),Gn.on({element:r,blur:"onWindowBlur",thisObj:t})}doDestroy(){const e=this,{source:t,target:n}=e;e.cleanup(),(null==n?void 0:n.dropping)===e&&(n.dropping=null),(null==t?void 0:t.dragging)===e&&(t.dragging=null),super.doDestroy()}onWindowBlur(){this.started&&this.abort()}get aborted(){return this.state===Vh}get completed(){return this.isDestroying||this.aborted||null!==this.endEvent}get pending(){return this.state===Bh}get started(){return this.state!==Bh&&!this.aborted}get valid(){return this.started&&null!=this.targetElement&&this._valid}set valid(e){this._valid=e}async get(e){if(this.aborted)throw new Error("Data is not available on aborted drag");if(!this.completed)throw new Error("Data is not available until drag completion");if(Array.isArray(e))return Promise.all(e.map((e=>this.get(e))));let t=this.data.get(e);return"function"==typeof t&&(t=await t(),this.data.set(e,t)),t}has(e){return this.data.has(e)}peek(e){if(this.aborted)throw new Error("Data is not available on aborted drag");if(Array.isArray(e))return e.map((e=>this.peek(e)));let t=this.data.get(e);return"function"==typeof t&&(t=!0),t}set(e,t){this.data.set(e,t)}changeTarget(e,t){if(e!==t){const n=this;n._target=e,n.previousTarget=t,t&&(t.dropping=null),e&&(e.dropping=n,e.dropping!==n&&(e=null,n.valid=!1)),n._target=t}return e}updateTarget(e,t){const n=this;t&&n.source.dragLeaveTarget(n,t),e&&(n.valid=!0,e.dragMove(n),n.source.dragEnterTarget(n))}updateTargetElement(e){let t,n,r,i,o;for(o=e;o;o=o.parentElement)if(n=Nc.get(o,"droppables"),n)for(i=0;i<n.length;++i)if(t=n[i],t.dropRootElement.contains(e)&&(r=t.droppableSelector,(!r||e.closest(`#${Lr.getId(t.dropRootElement)} ${r}`))&&(this.target=t,this.target===t)))return}abort(){const e=this,{element:t,source:n}=e;null==t||t.getBoundingClientRect(),e.state!==Wh&&(e.state=Vh,e.cleanup()),null==n||n.endDrag(e)}begin(){const e=this,{source:t}=e,n=t.beforeDrag(e);return!1!==n&&(t.dragging=e),n}cleanup(){let e;for(;e=this.cleaners.pop();)e()}end(e){const t=this,{lastMoveEvent:n,target:r}=t,{dragSwallowClickTime:i}=t.source;t.event=t.domEvent=t.endEvent=e,t.syncFlags(),t.started&&((null==n?void 0:n.clientX)===e.clientX&&(null==n?void 0:n.clientY)===e.clientY&&(null==n?void 0:n.target)===e.target||t.track(),i&&Gn.on({element:document,capture:!0,expires:i,once:!0,click(e){e.stopPropagation()}}),t.state=Wh,r!==t.source&&(null==r||r.dragDrop(t)))}fakeKey(e,t){const n=this,{lastMoveEvent:r}=n;if(r&&n.element){let i;r.isKey=!0,"Alt"===e.key?n.altKey!==t&&(n.altKey=t,i=!0):"Control"===e.key&&n.ctrlKey!==t&&(n.ctrlKey=t,i=!0),i&&(n.event=n.domEvent=r,n.track())}}keyDown(e){this.completed||("Escape"===e.key?this.abort():this.isDragToggleKey(e.key)&&this.fakeKey(e,!0))}keyUp(e){!this.completed&&this.isDragToggleKey(e.key)&&this.fakeKey(e,!1)}getDistance(e){return Gn.getDistanceBetween(this.startEvent,e)}isDragToggleKey(e){return"Control"===e||"Alt"===e}move(e){const t=this,{target:n}=e,r=t.getDistance(e)>=t.threshold;if(t.syncFlags(),t.touchStartTimer)r&&t.abort();else if(n&&n.nodeType===Node.ELEMENT_NODE){if(r&&!t.started&&(t.event=t.domEvent=e,!1===t.start()))return void t.abort();t.started&&!t.completed&&(t.lastMoveEvent=t.event=t.domEvent=e,"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.track())}}start(){const e=this,{scrollManager:t,monitoringConfig:n,source:r}=e,{draggingBodyCls:i,dragLock:o}=r,l=r.dragRootElement;if(e.state=zh,"touchstart"===e.startEvent.type&&s.isMobileSafari){for(let t=e.startEvent.target.parentElement;t;t=t.parentElement){const{style:n}=t,r=Lr.getStyleValue(t,"overflow");"auto"!==r&&"scroll"!=r||(e.scrollingAncestors||(e.scrollingAncestors=[]),e.scrollingAncestors.push([t,n.overflow,n.overflowX,n.overflowY]),n.overflow="hidden")}e.requestAnimationFrame((()=>{e.scrollingAncestors.forEach((([{style:e},t,n,r])=>{e.overflow=t,e.overflowX=n,e.overflowY=r})),e.scrollingAncestors=null}))}if(t){const r=t.startMonitoring(m.merge({scrollables:[{element:l}],direction:jh[o]||o||"both",callback(t){const{lastMoveEvent:n}=e;n&&e.element&&(n.isScroll=!0,e.event=e.domEvent=n,e.scrollerAction=t,e.track(),e.scrollerAction=null)}},n));e.cleaners.push(r)}const a=r.dragRootElement.closest(".b-outer")||document.body;if(a.classList.add(i),e.cleaners.push((()=>a.classList.remove(i))),!1===r.startDrag(e))return e.cleanup(),!1}syncFlags(){const e=this,{event:t}=e;e.altKey=t.altKey,e.ctrlKey=t.ctrlKey||t.metaKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey}track(){const e=this,{event:t,source:n,target:r}=e;let i,o=t.target;"touchmove"===t.type&&(i=t.changedTouches[0],o=Lr.elementFromPoint(i.clientX,i.clientY)),e.targetElement=o,r===e.target&&(null==r||r.dragMove(e)),n.trackDrag(e)}}Gh.prototype.STATE=Gh.STATE=Object.freeze({ABORTED:Vh,INIT:Bh,DRAGGING:zh,DROPPED:Wh}),Gh._$name="DragContext";class Uh extends(fe.mixin(_i)){static get type(){return"default"}static get configurable(){return{dragging:null}}static get factoryable(){return{defaultType:Uh}}updateDragging(e,t){t&&this.close(t),e&&this.open(e)}close(e){}open(e){}dragStart(e){this.dragging=e}dragMove(e){}dragEnd(e){this.dragging=null}}Uh.initClass(),Uh._$name="DragProxy";const Yh="b-hover-edge",qh="b-hover-top",Kh="b-hover-right",Xh="b-hover-bottom",Jh="b-hover-left",Qh={[Yh]:1,[qh]:1,[Kh]:1,[Xh]:1,[Jh]:1},Zh={t:[Yh,qh],r:[Yh,Kh],b:[Yh,Xh],l:[Yh,Jh],tr:[Yh,qh,Kh],bl:[Yh,Xh,Jh],tl:[Yh,qh,Jh],br:[Yh,Xh,Kh]};const{defineProperty:eg}=Object,{hasOwn:tg}=Yt,ng=Symbol("fencible"),rg=[],ig=e=>Array.from(new Set(e)),og=e=>e?ig(A.split(e)):rg,sg=(e,t,n)=>{!0===n&&(n=t),Yt.isObject(n)||(n={all:n});let r=og(n.any);const i=og(n.all),o=n.lock?og(n.lock):ig(i.concat(r)),s=t+"Impl";r=r.length?r:null,!e[s]&&eg(e,s,{configurable:!0,value:e[t]}),eg(e,t,{configurable:!0,value:function(...e){const t=this,n=tg(t,ng)?t[ng]:t[ng]={},l=e=>!n[e];if(i.every(l)&&(!r||r.some(l)))try{return o.forEach((e=>n[e]=(n[e]||0)+1)),t[s](...e)}finally{o.forEach((e=>--n[e]))}}})};var lg=e=>class extends(e||fe){static $name="Fencible";static declarable=["fenced"];static setupFenced(e){let{fenced:t}=e;const n=t.static,r=[];n&&(t={...t},delete t.static,r.push([n,e])),r.push([t,e.prototype]);for(const[e,t]of r)for(const n in e)sg(t,n,e[n])}get widgetClass(){}};const ag=6e4,cg=36e5,dg=864e5,ug=/(\d+)?:?(\d*)/;class hg{static format(e){const t=Math.floor(e/cg),n=Math.floor(e/ag)%60;return`${t}:${n<10?"0":""}${n}`}static parse(e){const t=typeof e;if("string"===t){const t=ug.exec(e);e=Number(t[1]||0)*cg+Number(t[2]||0)*ag}else"number"!==t?e=Wt.getTimeOfDay(e):e<=24&&(e*=cg);return Math.min(Math.max(Math.floor(e),0),dg)}constructor(e){let t,n,r=0;null!=e&&e.isDayView?(r=e.dayStartShift,t=e.dayStartTime,n=e.dayEndTime):"number"==typeof e?r=t=n=e:e&&(r=e.startShift,t=e.timeStart,n=e.timeEnd),this.startShift=r=hg.parse(r||0),this.timeEnd=(null==n?(r+dg)%dg:hg.parse(n))||dg,this.timeStart=null==t?r:hg.parse(t)}get startHour(){return Math.floor(this.timeStart/cg)}get endHour(){return Math.floor(this.timeEnd/cg)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?dg-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),Wt.makeKey(e)}dayOfDate(e){return this.shiftDate(Wt.clearTime(e))}dayOfWeek(e){return(e=this.shiftDate(e,-1)).getDay()}delta(e,t="ms"){const{timeStart:n}=this,r=hg.parse(e),i=(this.startShift&&r<n?r+dg:r)-n;return"ms"===t?i:Wt.as(t,i,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:n}=this,r=t<n?n-t:dg-t+n;return"ms"===e?r:Wt.as(e,r,"ms")}equals(e){return this.startShift===(null==e?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const n=this,{timeStart:r,timeEnd:i}=n,[o,s]=n._dateRangeArgs(e,t),[l,a]=n.timeRange(o,s);return r<i?l<a?l<i&&r<=a:l<i||r<=a:!(l<a)||l<i||r<=a}isIntraDay(e,t){const[n,r]=this._dateRangeArgs(e,t),i=this.startOfDay(n),o=dg-Wt.diff(i,r,"ms");return!(o<0)&&(o>0||i<n)}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:n,timeEnd:r}=this,i=hg.parse(e);return n<r?i<n?i<t?1:-1:i<r?0:i<t?-1:1:i<r||i>=n?0:i<t?1:-1}parseKey(e){return this.dayOfDate(Wt.parseKey(e))}shiftDate(e,t=1){const{startShift:n}=this,r=typeof e;return e="number"===r?new Date(e):"string"===r?Wt.parse(e):new Date(e.getTime()),t&&n&&e.setMilliseconds(t>0?n:-n),e}sortEvents(e,t){const n=this.startOfDay(e);return null==t?void 0:t.sort(((e,t)=>{e=e.eventRecord||e,t=t.eventRecord||t;let{startDate:r}=e,{startDate:i}=t;return r?i?(r=r<n?n:r,i=i<n?n:i,r-i||t.endDate-i-(e.endDate-r)):1:-1}))}startOfDay(e){return e=this.shiftDate(e,-1),e=Wt.clearTime(e),e=this.shiftDate(e)}timeRange(e,t){const[n,r]=this._dateRangeArgs(e,t);return[Wt.getTimeOfDay(n),Wt.getTimeOfDay(r)]}toString(){const{startShift:e,timeEnd:t,timeStart:n}=this,r=e?`@${hg.format(e)}`:"",i=hg.format(n);return n===t?e?r:i:`${i}-${hg.format(t)}${r}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}}hg.MIDNIGHT=new hg({startShift:0,timeStart:0,timeEnd:24}),hg.MILLIS_PER_MINUTE=ag,hg.MILLIS_PER_HOUR=cg,hg.MILLIS_PER_DAY=dg,hg._$name="DayTime";class gg extends(je(fe)){static $name="Month";static get configurable(){return{date:{$config:{equal:"date"},value:Wt.clearTime(new Date)},month:null,year:null,weekStartDay:null,hideNonWorkingDays:null,nonWorkingDays:null,sixWeeks:null}}configure(e){super.configure(e),this.updateDayNumbers(),e.date&&(this.date=e.date),this.generation=0}changeDate(e){if(!this.isConfiguring){if(e="string"==typeof e?Wt.parse(e,"YYYY-MM-DD"):new Date(e),isNaN(e))throw new Error("Month date ingestion must be passed a Date, or a valid YYYY-MM-DD date string");return e}}updateDate(e,t){const n=this,{dayColumnIndex:r,weekCount:i}=n,o=Wt.getFirstDateOfMonth(e),s=Wt.getLastDateOfMonth(o),l=r[o.getDay()],a=r[s.getDay()],c=!t||e.getFullYear()!==t.getFullYear(),d=!t||e.getMonth()!==t.getMonth(),u=n.eventListeners&&(t?e.getDate()!==t.getDate()|(n.getWeekId(e)!==n.getWeekId(t))<<1|d<<2|c<<3:15);if(n._year=e.getFullYear(),n._month=e.getMonth(),n.startDayOfMonth=1-l,n.endDayOfMonth=s.getDate()+(6-a),n.sixWeeks&&(n.endDayOfMonth+=7*(6-n.weekCount)),n.weekBase&&!c||n.calculateWeekBase(),(d||c)&&n.generation++,u){const r={newDate:e,oldDate:t,changes:{d:!0,w:Boolean(2&u),m:Boolean(12&u),y:Boolean(8&u),r:n.weekCount!==i}};n.trigger("dateChange",r),2&u&&n.trigger("weekChange",r),12&u&&n.trigger("monthChange",r),8&u&&n.trigger("yearChange",r)}}calculateWeekBase(){const e=this,{dayColumnIndex:t}=e,n=new Date(e.year,0,1),r=new Date(e.year,11,31),i=e.month?e.getOtherMonth(n):e;e.dayColumnIndex[n.getDay()]>3?e.weekBase=i.startDate:e.weekBase=new Date(e.year,0,i.startDayOfMonth-7);const o=Math.floor(Wt.diff(e.weekBase,r,"day")/7);e.has53weeks=53===o&&t[r.getDay()]>2}getWeekStart(e){if("number"==typeof e)return Wt.add(this.weekBase,7*Math.max(e,1),"day");const t=this,[n,r]=e;return n===t.year?t.getWeekStart(r):t.getOtherMonth(new Date(n,0,1)).getWeekStart(r)}getOtherMonth(e){const t=this,n=t===pg?new gg(null):pg;return n.configure({weekBase:null,weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks,date:new Date(e.getFullYear(),0,1)}),n.date=e,n.updateDate(n.date,n.date),n}changeYear(e){const t=new Date(this.date);t.setFullYear(e),this.date=t}changeMonth(e){const t=new Date(this.date);t.setMonth(e),this.date=t}get weekStartDay(){return"number"==typeof this._weekStartDay?this._weekStartDay:Wt.weekStartDay}updateWeekStartDay(){const e=this;e.updateDayNumbers(),!e.isConfiguring&&e.date&&(e.weekBase=null,e.updateDate(e.date,e.date))}get nonWorkingDays(){return this._nonWorkingDays||Wt.nonWorkingDays}changeNonWorkingDays(e){return Yt.assign({},e)}updateNonWorkingDays(){this.updateDayNumbers()}updateHideNonWorkingDays(){this.updateDayNumbers()}updateSixWeeks(){this.isConfiguring||this.updateDate(this.date,this.date)}get dayCount(){return this.endDayOfMonth+1-this.startDayOfMonth}get weekCount(){return this.dayCount/7}get startDate(){const e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.startDayOfMonth)}get endDate(){const e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.endDayOfMonth)}eachDay(e){for(let t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}eachWeek(e){const t=this,{weekCount:n}=t;for(let r=t.startDayOfMonth,i=0;i<n;i++){const n=[],i=t.getWeekNumber(new Date(t.year,t.month,r));for(let e=0;e<7;e++,r++)n.push(new Date(t.year,t.month,r));e(i,n)}}getWeekNumber(e){const t=this;if((e=Wt.clearTime(e)).getFullYear()!==t.year)return t.getOtherMonth(new Date(e.getFullYear(),0,1)).getWeekNumber(e);let n=Math.floor(Wt.diff(t.weekBase,e,"day")/7),r=e.getFullYear();return n?(53!==n||t.has53weeks?n>53&&(n%=52):(n=1,r++),[r,n]):t.getOtherMonth(new Date(t.year-1,0,1)).getWeekNumber(new Date(t.year,0,0))}getWeekId(e){const t=this.getWeekNumber(e);return 100*t[0]+t[1]}getCellData(e,t,n=hg.MIDNIGHT){const r=this,i=e.getDay(),o=r.visibleDayColumnIndex[i],s=r.nonWorkingDays[i],l=r.hideNonWorkingDays&&s;return(e<r.startDate||e>r.endDate)&&(r.month=e.getMonth()),{day:i,dayTime:n,visibleColumnIndex:o,isNonWorking:s,week:r.getOtherMonth(e).getWeekNumber(e),key:Wt.format(e,"YYYY-MM-DD"),columnIndex:r.dayColumnIndex[i],date:new Date(e),dayEnd:n.duration("s"),tomorrow:n.dayOfDate(Wt.add(e,1,"day")),isOtherMonth:Math.sign(e.getMonth()+12*e.getFullYear()-(t.month+12*t.year)),visible:!l&&e>=t.startDate&&e<Wt.add(t.endDate,1,"day"),isRowStart:0===o,isRowEnd:o===r.visibleColumnCount-1}}updateDayNumbers(){const e=this,{weekStartDay:t,nonWorkingDays:n,hideNonWorkingDays:r}=e,i=e.dayColumnIndex=[],o=e.canonicalDayNumbers=[],s=e.visibleDayColumnIndex=[];let l=0;for(let e=0;e<7;e++){const a=(t+e)%7;o[e]=a,i[a]=e,r&&n[a]||(s[a]=l++)}e.visibleColumnCount=l,e.weekLength=r?7-Yt.keys(n).length:7}}const pg=new gg(null);gg._$name="Month";let mg=0;const fg=new WeakMap,vg=e=>{const t=new Map;return(...n)=>{const r=((...e)=>e.map((e=>{let t;return e&&"object"==typeof e||"function"==typeof e?(t=fg.get(e),t===i&&(t=++mg,fg.set(e,t))):t=String(e),t})).join("-"))(n);let o=t.get(r);return o===i&&(o=e(...n),t.set(r,o)),o}},bg=e=>{const t=new Map,n=e=>e[0],r=e=>e[1],o=(e,t)=>n(e).push(t);return(s,l)=>{const a=(e=>{let n=t.get(e);return n===i&&(n=[[],[]],t.set(e,n)),n})(s);(e=>!r(e).length&&!n(e).length)(a)?(o(a,l),e(s,(e=>{((e,t)=>r(e).some((e=>Yt.isEqual(e,t))))(a,e)||(((e,t)=>{r(e).push(t)})(a,e),n(a).forEach((t=>t(e))))}))):(o(a,l),r(a).forEach((e=>l(e))))}},yg=Symbol("success"),Cg=Symbol("failure"),wg=(e,t)=>[yg,e,t],xg=e=>[Cg,e],Sg=e=>e.length&&e[0]===yg,Eg=e=>"function"!=typeof e||e.length?e:e(),Rg=vg((e=>bg(((t,n)=>n(wg(e,t)))))),Tg=vg((e=>bg(((t,n)=>{const r=Math.min(e.length,t.length),i=t.substr(0,r),o=t.substr(r);n(i===e?wg(i,o):xg(o))})))),Dg=(e,t)=>(n,r)=>Eg(e)(n,(e=>{if(Sg(e)){const[,n,i]=e;t(n)(i,r)}else r(e)})),Mg=vg(((...e)=>{const t=vg(((e,t)=>bg(Dg(e,(e=>Dg(t,(t=>Rg([].concat(e,t)))))))));return e.reduce(t,Rg([]))})),Fg=vg(((...e)=>bg(((t,n)=>e.forEach((e=>Eg(e)(t,n))))))),Ig=vg((e=>(t,n)=>{const r=new RegExp(`^${e}`).exec(t);if(r){const e=r[0],i=t.substr(e.length);n(wg(e,i))}else n(xg(t))})),kg=vg(((e,t)=>Dg(e,((...e)=>Rg(t(...[].concat.apply([],e))))))),Og=(e,t)=>{const n=[];return e(t,(e=>{if(Sg(e)){const[,,t]=e;""===t&&n.push(e)}})),n};var Lg={memo:vg,memoCps:bg,success:wg,failure:xg,isSuccess:Sg,resolveParser:Eg,succeed:Rg,string:Tg,bind:Dg,seq:Mg,alt:Fg,regexp:Ig,red:kg,runParser:Og,defineParser:e=>(t,n)=>n?Eg(e)(t,n):Og(Eg(e),t)};class Ag extends Uh{static get type(){return"tip"}static get configurable(){return{align:"t10-b50",offset:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip"}}}}open(){this.getConfig("tooltip")}close(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}dragMove(e){const{offset:t,tooltip:n}=this,{event:r}=e;n&&(n.isVisible||n.show(),n.alignTo({align:this.align,target:new bn(r.clientX-t,r.clientY-t,2*t,2*t)}))}changeTooltip(e,t){return ul.reconfigure(t,e,this)}}Ag.initClass(),Ag._$name="DragTipProxy";class Pg extends El{static $name="UndoRedoBase";static type="undoredobase";static get configurable(){return{project:null,stm:null,text:null,color:null,showZeroActionBadge:null,cls:"b-undo-controls b-toolbar",layoutStyle:{alignItems:"stretch",flexFlow:"row nowrap",overflow:"visible"},items:{undoBtn:{type:"button",icon:"b-icon-undo",tooltip:"L{UndoRedo.UndoLastAction}",onAction:"up.onUndo"},transactionsCombo:{type:"combo",valueField:"idx",editable:!1,store:{},emptyText:"L{UndoRedo.NoActions}",onAction:"up.onTransactionSelected",displayValueRenderer:"up.transactionsDisplayValueRenderer"},redoBtn:{type:"button",icon:"b-icon-redo",tooltip:"L{UndoRedo.RedoLastAction}",onAction:"up.onRedo"}},overflowable:!0}}afterConstruct(){this.updateUndoRedoControls()}updateStm(e){this.detachListeners("undoredo"),null==e||e.ion({name:"undoredo",recordingstop:"updateUndoRedoControls",restoringstop:"updateUndoRedoControls",queueReset:"updateUndoRedoControls",disabled:"updateUndoRedoControls",thisObj:this})}changeItems(e){const{undoBtn:t,redoBtn:n}=e;return this.color&&(t&&(t.color=this.color),n&&(n.color=this.color)),this.text&&(t&&(t.text="L{UndoRedo.Undo}"),n&&(n.text="L{UndoRedo.Redo}")),super.changeItems(e)}updateProject(e){this.stm=e.stm}fillUndoRedoCombo(){const{transactionsCombo:e}=this.widgetMap;e&&(e.items=[[0,"Original data"],...this.stm.queue.map(((e,t)=>[t+1,e||`Transaction ${t+1}`]))])}updateUndoRedoControls(){const{stm:e,showZeroActionBadge:t}=this,{undoBtn:n,redoBtn:r,transactionsCombo:i}=this.widgetMap;n.badge=e.position||(t?"0":""),r.badge=e.length-e.position||(t?"0":""),n.disabled=!e.canUndo,r.disabled=!e.canRedo,this.fillUndoRedoCombo(),i&&(i.disabled=i.store.count<=1)}transactionsDisplayValueRenderer(e,t){var n;const r=(null===(n=this.stm)||void 0===n?void 0:n.position)||0;return`${r} undo actions / ${t.store.count-r-1} redo actions`}onUndo(){this.stm.canUndo&&this.stm.undo()}onRedo(){this.stm.canRedo&&this.stm.redo()}onTransactionSelected(e){const{stm:t}=this,n=t.position-e.value;n>0?t.canUndo&&t.undo(n):n<0&&t.canRedo&&t.redo(-n)}}Pg.initClass(),Pg._$name="UndoRedoBase";class _g extends yc{static $name="BooleanCombo";static type="booleancombo";static get configurable(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,store:{value:[],$config:"lazy"},value:!1}}changeStore(e,t){const n=this;return super.changeStore(new ts({data:[{id:n.positiveValue,text:n.positiveText||n.L("L{Object.Yes}")},{id:n.negativeValue,text:n.negativeText||n.L("L{Object.No}")}]}),t)}}_g.initClass(),_g._$name="BooleanCombo";class $g extends(El.mixin(Hl)){static $name="ButtonGroup";static type="buttongroup";static configurable={defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null,hideWhenEmpty:!0,defaultBindProperty:"value"};onChildAdd(e){super.onChildAdd(e),e.ion({click:"resetValueCache",toggle:"onItemToggle",thisObj:this,prio:1e4})}onChildRemove(e){e.un({toggle:"resetValueCache",click:"resetValueCache",thisObj:this}),super.onChildRemove(e)}onItemToggle(e){const t=this;t.resetValueCache(),t.isSettingValue||t.toggleGroup&&!e.pressed||t.triggerFieldChange({value:t.value,userAction:!0,event:e})}resetValueCache(){this._value=null}createWidget(e){const t=this;return t.constructor.resolveType(e.type||"button").isButton&&(t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&("boolean"==typeof t.toggleGroup&&(t.toggleGroup=$g.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup)),t.columns&&(e.width=100/t.columns+"%"),e=super.createWidget(e),t.relayEvents(e,["click","action","toggle"]),e}updateRotate(e){this.eachWidget((t=>{!1!==t.rotate&&(t.rotate=e)}))}get value(){if(!this._value){const e=[];this.items.forEach((t=>{t.pressed&&t.value!==i&&e.push(t.value)})),this._value=e.join(this.valueSeparator)}return this._value}set value(e){const t=this,n=t.value;Array.isArray(e)||(e=e===i||null===e?[]:"string"==typeof e?e.split(t.valueSeparator):[e]),t._value=e.join(t.valueSeparator),t.isSettingValue=!0,t.items.forEach((t=>{t.value!==i&&(t.pressed=e.includes(t.value))})),t.isSettingValue=!1,t.isConfiguring||n===t.value||t.triggerFieldChange({value:t.value,userAction:!1})}updateDisabled(e){this.items.forEach((t=>t.disabled=e||!t.ignoreParentReadOnly&&this.readOnly))}updateReadOnly(e){super.updateReadOnly(e),this.updateDisabled(this.disabled)}get widgetClassList(){const e=super.widgetClassList;return this.columns&&e.push("b-columned"),e}}$g.initClass(),$g._$name="ButtonGroup";class Ng extends Ka{static $name="CalendarPanel";static type="calendarpanel";static get configurable(){return{layout:"vbox",textContent:!1,date:{$config:{equal:"date"},value:null},month:{},year:null,weekStartDay:null,sixWeeks:!0,showWeekNumber:null,showWeekColumn:null,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,hideNonWorkingDays:null,hideNonWorkingDaysCls:"b-hide-nonworking-days",nonWorkingDays:null,tip:null,dayCellCls:"b-calendar-cell",dayHeaderCls:"b-calendar-day-header",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today",nonWorkingDayCls:"b-nonworking-day",dayNameFormat:"ddd",minRowHeight:{$config:["lazy"],value:null},minColumnWidth:{$config:["lazy"],value:null},disableOtherMonthCells:null,disableOtherMonthCellsCls:"b-disable-othermonth-cells",hideOtherMonthCells:null,hideOtherMonthCellsCls:"b-hide-othermonth-cells",animateTimeShift:!0}}construct(e){super.construct(e),this.refreshCount||this.refresh()}onPaint({firstPaint:e}){var t;null===(t=super.onPaint)||void 0===t||t.call(this,...arguments),e&&(this.refreshCount||this.refresh(),this.getConfig("minColumnWidth"),this.getConfig("minRowHeight"))}get overflowElement(){return this.weeksElement}doDestroy(){var e;null===(e=this.tip)||void 0===e||e.destroy(),super.doDestroy()}changeMinRowHeight(e){const t=parseInt(Lr.getStyleValue(this.element,"--min-row-height"),10)||75;return isNaN(e)?e:Math.max(parseInt(e)||0,t)}updateMinRowHeight(e){this.weekElements.forEach((t=>Lr.setLength(t,"minHeight",e))),this.scrollable={overflowY:!!e&&"auto"}}changeMinColumnWidth(e){const t=parseInt(Lr.getStyleValue(this.element,"--min-column-width"),10)||75;return null==e?e:Math.max(parseInt(e)||0,t)}updateMinColumnWidth(e){const t=this;t.weekdayCells.forEach((t=>Lr.setLength(t,"minWidth",e))),t.cellElements.forEach((n=>n.matches(`.${t.dayCellCls}`)&&Lr.setLength(n,"minWidth",e))),t.scrollable={overflowX:!!e&&"auto"},t.overflowElement.classList[e?"add":"remove"]("b-min-columnwidth")}getDateFromDomEvent(e){const t=(e.nodeType===Element.ELEMENT_NODE?e:e.target).closest(`#${this.id} [data-date]`);if(t)return Wt.parseKey(t.dataset.date)}changeTip(e,t){const n=this;return ec.reconfigure(t,e,{owner:n,defaults:{type:"tooltip",owner:n,id:`${n.id}-cell-tip`,forElement:n.bodyElement,forSelector:`.${n.dayCellCls}`}})}updateTip(e){this.detachListeners("tip"),null==e||e.ion({pointerOver:"onTipOverCell",name:"tip",thisObj:this})}updateElement(e,t){const n=this;super.updateElement(e,t),n.updateHideNonWorkingDays(n.hideNonWorkingDays),n.weekdayCells=Array.from(e.querySelectorAll(".b-calendar-day-header")),n.weekElements=Array.from(e.querySelectorAll(".b-calendar-week")),n.weekDayElements=Array.from(e.querySelectorAll(".b-calendar-days")),n.cellElements=[];for(let e=0,{length:t}=n.weekDayElements;e<t;e++)n.cellElements.push(n.weekDayElements[e].previousSibling,...n.weekDayElements[e].children)}changeDate(e){if(e="string"==typeof e?Wt.parse(e):new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a YYYY-MM-DD date string");return Wt.clearTime(e)}updateDate(e){this.month.date=e}updateDayNameFormat(){const e=new Date("2000-06-04T12:00:00");this.shortDayNames=[];for(let t=4;t<11;t++)e.setDate(t),this.shortDayNames.push(Wt.format(e,this.dayNameFormat))}get weekStartDay(){return"number"==typeof this._weekStartDay?this._weekStartDay:Wt.weekStartDay}updateWeekStartDay(e){const t=this;if(t._month){t.month.weekStartDay=e,t.dayNames=[];for(let e=0;e<7;e++)t.dayNames[e]=t.shortDayNames[t.canonicalDayNumbers[e]];t.refreshCount&&t.refresh()}}updateHideNonWorkingDays(e){var t;this.contentElement.classList.toggle(this.hideNonWorkingDaysCls,Boolean(e)),null===(t=this.scrollable)||void 0===t||t.syncOverflowState(),this._month&&(this.month.hideNonWorkingDays=e),this.isConfiguring||this.refresh()}updateHideOtherMonthCells(e){var t;this.element.classList.toggle(this.hideOtherMonthCellsCls,Boolean(e)),null===(t=this.scrollable)||void 0===t||t.syncOverflowState()}updateDisableOtherMonthCells(e){var t;this.element.classList.toggle(this.disableOtherMonthCellsCls,Boolean(e)),null===(t=this.scrollable)||void 0===t||t.syncOverflowState()}get nonWorkingDays(){return this._nonWorkingDays||this._localeNonWorkingDays||(this._localeNonWorkingDays=Wt.nonWorkingDays)}get weekends(){return this._localeWeekends||(this._localeWeekends=Wt.weekends)}changeNonWorkingDays(e){return Yt.assign({},e)}updateNonWorkingDays(e){var t;this._month&&(this.month.nonWorkingDays=e,this.refresh(),null===(t=this.scrollable)||void 0===t||t.syncOverflowState())}get visibleDayColumnIndex(){return this.month.visibleDayColumnIndex}get dayColumnIndex(){return this.month.dayColumnIndex}get canonicalDayNumbers(){return this.month.canonicalDayNumbers}get visibleColumnCount(){return this.month.visibleColumnCount}get weekLength(){return this.month.weekLength}get startDate(){return this.month.startDate}get duration(){return Wt.diff(this.month.startDate,this.month.endDate,"day")+1}get endDate(){const{endDate:e}=this.month;if(e)return Wt.add(e,1,"day")}changeMonth(e,t){const n=this;if(!(e instanceof gg)){if("number"==typeof e){if(t)return void(t.month=e);const r=n.date||Wt.clearTime(new Date);r.setMonth(e),e={date:r}}e=gg.new({weekStartDay:n.weekStartDay,nonWorkingDays:n.nonWorkingDays,hideNonWorkingDays:n.hideNonWorkingDays,sixWeeks:n.sixWeeks},e)}return e.ion({dateChange:"onMonthDateChange",thisObj:n}),e}onMonthDateChange({source:e,newDate:t,oldDate:n,changes:r}){const i=this;if(i.year=e.year,!i.isConfiguring){if(!i.getCell(t)||r.m||r.y){const{isVisible:e}=i;i.refresh(),i.animateTimeShift&&e&&Lr.slideIn(i.contentElement,t>n?1:-1)}i.trigger("dateChange",{changes:r,value:t,oldValue:n})}}updateYear(e){this.month.year=e}updateShowWeekNumber(e){this.updateShowWeekColumn(e)}updateShowWeekColumn(e){const t=this;t.element.classList[e?"add":"remove"]("b-show-week-column"),t.floating&&(t.isAligning||t.realign())}updateSixWeeks(e){this.month&&(this.month.sixWeeks=e,this.refresh())}refresh(){this.doRefresh()}doRefresh(){var e;this.getConfig("element");const t=this,n=null!=t.timeZone?t.timeZone:null===(e=t.project)||void 0===e?void 0:e.timeZone,r=null!=n?Ch.toTimeZone(new Date,n):new Date,{weekElements:i,weekDayElements:o,date:s,month:l,dayCellCls:a,dayHeaderCls:c,disabledCls:d,otherMonthCls:u,weekendCls:h,todayCls:g,nonWorkingDayCls:p,nonWorkingDays:m,canonicalDayNumbers:f,sixWeeks:v}=t;if(r.setHours(0,0,0,0),!s)return void(t.date=r);t.trigger("beforeRefresh"),t.getConfig("dayNameFormat");for(let e=0;e<7;e++){const n=t.weekdayCells[e],r=t.canonicalDayNumbers[e],i={[c]:1,[h]:Wt.weekends[r],[p]:m[r]};t.headerRenderer?(n.innerHTML="",t.callback(t.headerRenderer,t,[n,e,r])):Lr.setInnerText(n,t.shortDayNames[r]),Lr.syncClassList(n,i),n.dataset.columnIndex=e,n.dataset.cellDay=r}let b=0,y=0,C=6;for(let e=6;e>=0;e--)if(!m[f[e]]){C=e;break}i[4].classList.toggle("b-hide-display",l.weekCount<5&&!v),i[5].classList.toggle("b-hide-display",l.weekCount<6&&!v),l.eachWeek(((e,n)=>{const s=o[b],c=[s.previousSibling,...s.children];i[b].dataset.week=`${e[0]},${e[1]}`,t.weekRenderer?t.callback(t.weekRenderer,t,[c[0],e]):c[0].innerText=e[1];for(let o=0;o<7;o++){const s=n[o],f=s.getDay(),v=Wt.makeKey(s),w=m[f],x=c[o+1],S={[a]:1,[d]:t.isDisabledDate(s),[u]:s.getMonth()!==l.month,[h]:Wt.weekends[f],[g]:s.getTime()===r.getTime(),[p]:w,"b-last-working-day":o===C,"b-first-visible-cell":!(s-(t.firstVisibleDate||-1)),"b-last-visible-cell":!(s-(t.lastVisibleDate||-1)),[`b-day-of-week-${f}`]:1};Lr.syncClassList(x,S),x.dataset.date=v,x.dataset.cellIndex=y,x.dataset.columnIndex=o,x.lastDomConfig&&(delete x.lastDomConfig.class,delete x.lastDomConfig.className),t.cellRenderer?t.callback(t.cellRenderer,t,[{cell:x,date:s,day:f,row:i[b],rowIndex:b,cellIndex:y,columnIndex:o,visibleColumnIndex:t.visibleDayColumnIndex[f],week:e,key:v}]):x.innerHTML=s.getDate(),y++}b++})),t.visibleWeekCount=b,t.floating&&(t.isAligning||t.realign()),t.refreshCount=(t.refreshCount||0)+1,t.trigger("refresh")}isDisabledDate(e){const t=e.getDay(),{disabledDates:n,nonWorkingDays:r}=this;return!(!this.disableWeekends||!r[t])||(n?Array.isArray(n)?(e=Wt.clearTime(e,!0),n.some((t=>!(Wt.clearTime(t,!0)-e)))):this.callback(this.disabledDates,this,[e]):void 0)}get bodyConfig(){const e=super.bodyConfig,t=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",reference:"weekdaysHeader",children:[{class:"b-week-number-cell"},...H.fill(7,{class:this.dayHeaderCls}),Lr.scrollBarPadElement]},{className:"b-weeks-container notranslate",reference:"weeksElement",children:t}];for(let e=0;e<6;e++){const n={className:"b-calendar-row b-calendar-week",dataset:{rowIndex:e},children:[{className:"b-week-number-cell"},{className:"b-calendar-days",children:[{},{},{},{},{},{},{}],syncOptions:{ignoreRefs:!0,strict:!1}}]};t.push(n)}return e}get firstVisibleDate(){if(this.hideOtherMonthCells){const{year:e,month:t}=this.month;return new Date(e,t,1)}for(const e=this,t=e.month.startDate;;t.setDate(t.getDate()+1))if(!e.hideNonWorkingDays||!e.nonWorkingDays[t.getDay()])return t}get lastVisibleDate(){const e=Wt.add(this.endDate,-1,"d");if(this.hideOtherMonthCells)return e;for(const t=this,n=e;;n.setDate(n.getDate()-1))if(!t.hideNonWorkingDays||!t.nonWorkingDays[n.getDay()])return n}getCell(e,t){"string"!=typeof e&&(e=Wt.makeKey(e));const n=this.weeksElement.querySelector(`[data-date="${e}"]`);if(n&&(!t||!n.classList.contains(this.otherMonthCls)))return n}onTipOverCell({source:e,target:t}){e.date=Wt.parseKey(t.dataset.date)}updateLocalization(){this._localeNonWorkingDays=this._localeWeekends=null,this.updateDayNameFormat(),this.updateWeekStartDay(this.weekStartDay),super.updateLocalization()}}Ng.initClass(),Ng._$name="CalendarPanel";const Hg=e=>!e.value;class Vg extends lc{static $name="Checkbox";static type="checkbox";static alias="check";static get configurable(){return{inputType:"checkbox",autoCollapse:null,containerDefaults:{syncableConfigs:{disabled:e=>e.disabled||!e.value},syncConfigTriggers:{autoCollapse:1,value:1}},text:"",checkedValue:!0,uncheckedValue:!1,color:null,value:"",toggleGroup:null,localizableProperties:["label","text"]}}construct(e){"checked"in e&&((e=Yt.assign({},e)).value=e.checked,delete e.checked),super.construct(e),this.syncHasText()}get textLabelCls(){return"b-checkbox-label"}get innerElements(){return[this.inputElement,{tag:"label",class:this.textLabelCls,for:`${this.id}-input`,reference:"textLabel",html:this.text||""}]}get inputElement(){const e=super.inputElement;return this.toggleGroup&&(e.dataset={group:this.toggleGroup}),e.listeners={click:"internalOnClick",change:"internalOnChange",input:"internalOnInput"},e}get checked(){return this.value}set checked(e){this.value=e}syncHasText(){this.element.classList[this.text?"add":"remove"]("b-text")}updateText(e){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=e)}afterSyncChildConfigs(e){super.afterSyncChildConfigs(e);let{autoCollapse:t}=this;t&&(t=!0===t?Hg:t,e.collapsed=t(this))}assignFieldValue(e,t,n){this.value=n===this.checkedValue||n!==this.uncheckedValue&&null}fetchInputValue(){this.readOnly||(this.value=this.input.checked)}gatherValue(e){var t;const n=this,r=n.value?n.checkedValue:n.uncheckedValue,o=r!==i,{valueName:s}=n;o&&(e[s]=r),n.gatherValues(e,o),!0===r&&(null===(t=e[s])||void 0===t?void 0:t.value)===r&&delete e[s].value}changeValue(e){return"false"!==e&&Boolean(e)}updateValue(e){var t;const n=this,r=n.input.checked!==e;n.input.checked=e,null===(t=n.container)||void 0===t||t.syncChildConfigs(),!r||n.inputting||n.isConfiguring||(n.uncheckToggleGroupMembers(),n.triggerChange(!1))}get inputValueAttr(){return"checked"}updateColor(e,t){const n=this.element.classList;t&&n.remove(t),e&&n.add(e)}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:n,input:r,type:i}=e,o=[];return t&&n&&Lr.forEachSelector(e.rootElement,`input[type=${i}][data-group=${n}]`,(e=>{if(e!==r){const t=ul.fromElement(e);t&&o.push(t)}})),o}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((e=>e.checked=!1))}check(){this.checked=!0}uncheck(){this.checked=!1}toggle(){this.checked=!this.checked}internalOnClick(e){return this.readOnly?(e.preventDefault(),!1):this.trigger("click",{event:e})}internalOnChange(e){const t=this;t.readOnly&&t.value!==t.input.checked?t.input.checked=t.value:(t.value=t.input.checked,t.inputting||(t.inputting=!0,t.triggerChange(!0),t.inputting=!1))}updateInputReadOnly(e){}triggerChange(e){const t=this,{checked:n}=t.input,r={checked:n,value:n,userAction:e,valid:!0};if(!(!n&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter((e=>e.isVisible&&!e.disabled)).length||!1===t.trigger("beforeChange",r)))return t.triggerFieldChange(r,!1),e&&t.uncheckToggleGroupMembers(),t.trigger("action",r),t.trigger("change",r),!0;t.input.checked=t._value=!n}}Vg.initClass(),Vg._$name="Checkbox";class Bg extends mc{static $name="ColorPicker";static type="colorpicker";static configurable={itemsFocusable:!1,navigator:{focusCls:"b-color-active"},itemWrapperTpl(e,t){const{selected:n}=this,{color:r,text:i}=e,o=this.getColorClassName(r);return hc.tpl`
                    <li
                        class="${this.getItemClasses(e,t)} ${o}"
                        role="option"
                        aria-selected="${n.includes(e)}"
                        data-index="${t}"
                        data-id="${A.encodeHtml(r)}"
                        data-btip="${i}"
                        ${this.itemsFocusable?'tabindex="-1"':""}
                        style="${o?"":"background-color: "+r}"
                    ></li>`},colorClasses:null,colorClassPrefix:null,colors:["#45171D","#F03861","#FF847C","#FECEA8","#A5F2E7","#AA83F3","#8983F3","#A10054","#073059","#2866AB","#5FBDC5","#D8D95C","#FFDEDE","#F7F3CE","#C5ECBE","#3E3E3E","#405559","#68868C","#EDEDED","#D3D6DB","#3A4750","#303841","#BE3144"],addNoColorItem:!0,columns:6,colorSelected:null};configure(e){super.configure(e),this.setItems(),this.ion({item:"onColorSelect"})}setItems(){const e=this,{colors:t,colorClasses:n}=e;let r=n||t;e.addNoColorItem&&(r=[...r],r.push(null)),e.items=r.map((t=>t&&"string"!=typeof t?t:{color:t,text:(n?A.capitalize(t):t)||e.L("L{noColor}")}))}afterConfigure(){super.afterConfigure(...arguments),(this.addNoColorItem||this.value)&&this.select(this.value??null)}updateColors(){this.isConfiguring||this.setItems()}updateAddNoColorItem(){this.isConfiguring||this.setItems()}onColorSelect({record:e}){var t;this.refresh();const n={color:e.color,record:e,bubbles:!0};null===(t=this.colorSelected)||void 0===t||t.call(this,n),this.trigger("colorSelected",n)}select(e){e&&"string"!=typeof e||(e=this.store.findRecord("color",e??null)),e&&super.select(e)}updateColumns(e){this.style=`grid-template-columns:repeat(${e}, 1fr);`}getColorClassName(e){var t,n;return null!==(t=this.colorClasses)&&void 0!==t&&t.includes(e)||null!==(n=this.colorClasses)&&void 0!==n&&n.find((t=>t&&t.color===e))?this.colorClassPrefix+e:e?"":"b-no-color"}}Bg.initClass(),Bg._$name="ColorPicker";class zg extends yc{static $name="ColorField";static type="colorfield";static configurable={displayField:"text",valueField:"color",editable:!1,picker:{type:"colorpicker",align:{align:"t100-b100",matchSize:!1}},showBoxForNoColor:!0,colors:null,addNoColorItem:!0};configure(e){const t=e.picker??{};e.colors&&(t.colors=e.colors),"addNoColorItem"in e&&(t.addNoColorItem=e.addNoColorItem),e.picker=t,super.configure(e)}updatePicker(e){e&&(this.items=e.store.records)}updateColors(e){this.isConfiguring||(this.picker.colors=e)}updateAddNoColorItem(e){this.isConfiguring||(this.picker.addNoColorItem=e)}set value(e){this.store||(this.items=[],this.store=this.picker.store),e||(e=this.store.findRecord("color",null)),super.value=e}showPicker(){this.picker.refresh(),super.showPicker(...arguments)}get value(){return super.value}syncInputFieldValue(...e){var t;const n=this,{value:r}=n;let i=null===(t=n.picker)||void 0===t?void 0:t.getColorClassName(r);i||(n.colorBox.style.color=r),i="b-colorbox "+i,n.colorBox.className=i,n.showBoxForNoColor||n.element.classList.toggle("b-colorless",!r),super.syncInputFieldValue(...e)}get innerElements(){return[{reference:"colorBox",className:"b-colorbox"},...super.innerElements]}}zg.initClass(),zg._$name="ColorField";class Wg extends Ka{static $name="YearPicker";static type="yearpicker";static configurable={textContent:!1,tbar:{overflow:null,items:{previous:{type:"tool",cls:"b-icon b-icon-previous",onAction:"up.previous",weight:100},title:{type:"button",cls:"b-yearpicker-title",weight:200,onAction:"up.handleTitleClick"},next:{type:"tool",cls:"b-icon b-icon-next",onAction:"up.next",weight:300}}},itemCls:"b-year-container",yearButtonCount:12,year:null,minYear:null,maxYear:null,startYear:null};construct(e){super.construct({year:(new Date).getFullYear(),...e}),Gn.on({element:this.contentElement,click:"onYearClick",delegate:".b-yearpicker-year",thisObj:this})}get focusElement(){return this.getYearButton(this.year)||this.getYearButton(this.startYear)}getYearButton(e){return this.contentElement.querySelector(`.b-yearpicker-year[data-year="${e}"]`)}get value(){return this.year}set value(e){this.year=e}onYearClick({target:e}){const t=Math.min(Math.max(parseInt(e.innerText),this.minYear||1),this.maxYear||9999);this.year===t?this.trigger("select",{oldValue:t,value:t}):this.year=t}handleTitleClick(e){this.trigger("titleClick",e)}previous(){this.startYear=this.startYear-this.yearButtonCount}next(){this.startYear=this.endYear+1}ingestYear(e){if(!isNaN(e))return Yt.isDate(e)?e.getFullYear():e}changeYear(e){if(e=this.ingestYear(e))return Math.min(Math.max(e,this.minYear||1),this.maxYear||9999)}updateYear(e,t){const n=this;!n.startYear||e>n.endYear?n.startYear=e:e<n.startYear&&(n.startYear=e-(n.yearButtonCount-1)),n.isConfiguring||n.trigger("select",{oldValue:t,value:e})}get endYear(){return this.startYear+this.yearButtonCount-1}changeStartYear(e){if(e=this.ingestYear(e))return e=this.minYear?Math.max(e,this.minYear):e,this.maxYear?Math.min(e,this.maxYear-(this.yearButtonCount-1)):e}async updateStartYear(e,t){this.isVisible&&Lr.slideIn(this.contentElement,Math.sign(e-t))}composeBody(){this.getConfig("year");const{startYear:e}=this,t=super.composeBody(),n=t.children[this.tbar?1:0].children=[];this.widgetMap.title.text=`${`000${e}`.slice(-4)} - ${`000${this.endYear}`.slice(-4)}`;for(let t=0,r=e;t<this.yearButtonCount;t++,r++)n.push({tag:"button",dataset:{year:r},class:{"b-yearpicker-year":1,"b-selected":r===this.year},text:`000${r}`.slice(-4)});return t}}Wg.initClass(),Wg._$name="YearPicker";class jg extends ac{static $name="DisplayField";static type="displayfield";static alias="display";static get configurable(){return{readOnly:!0,editable:!1,cls:"b-display-field",template:null,ariaElement:"displayElement"}}get focusElement(){}changeReadOnly(){return!0}changeEditable(){return!1}get inputElement(){return{tag:"span",id:`${this.id}-input`,reference:"displayElement",html:this.template?this.template(this.value):A.encodeHtml(this.value)}}}jg.initClass(),jg._$name="DisplayField";const Gg=()=>Wt.getMonthNames().map(((e,t)=>[t,e])),Ug=(e,t)=>e.valueOf()-t.valueOf(),Yg=Object.freeze([]);(class extends yc{static get $name(){return"ReadOnlyCombo"}static get type(){return"readonlycombo"}static get configurable(){return{editable:!1,inputAttributes:{tag:"div",tabIndex:-1},inputValueAttr:"innerHTML",highlightExternalChange:!1,monitorResize:!1,triggers:{expand:!1},picker:{align:{align:"t-b",axisLock:!0,matchSize:!1},cls:"b-readonly-combo-list",scrollable:{overflowX:!1}}}}}).initClass();class qg extends Ng{static $name="DatePicker";static type="datepicker";static get delayable(){return{refresh:"raf"}}static get configurable(){return{activeDate:{value:new Date,$config:{equal:"date"}},focusable:!0,textContent:!1,tbar:{overflow:null,items:{prevYear:{cls:"b-icon b-icon-first",onAction:"up.gotoPrevYear",tooltip:"L{DatePicker.gotoPrevYear}"},prevMonth:{cls:"b-icon b-icon-previous",onAction:"up.gotoPrevMonth",tooltip:"L{DatePicker.gotoPrevMonth}"},fields:{type:"container",cls:"b-datepicker-title",items:{monthField:{type:"readonlycombo",cls:"b-datepicker-monthfield",items:Gg(),internalListeners:{select:"up.onMonthPicked"}},yearButton:{type:"button",cls:"b-datepicker-yearbutton",internalListeners:{click:"up.onYearPickerRequested"}}}},nextMonth:{cls:"b-icon b-icon-next",onAction:"up.gotoNextMonth",tooltip:"L{DatePicker.gotoNextMonth}"},nextYear:{cls:"b-icon b-icon-last",onAction:"up.gotoNextYear",tooltip:"L{DatePicker.gotoNextYear}"}}},yearPicker:{value:{type:"YearPicker",yearButtonCount:16,trapFocus:!0,positioned:!0,hidden:!0,internalListeners:{titleClick:"up.onYearPickerTitleClick",select:"up.onYearPicked"}},$config:"lazy"},date:null,minDate:{value:null,$config:{equal:"date"}},maxDate:{value:null,$config:{equal:"date"}},focusDisabledDates:null,multiSelect:!1,selection:{$config:{equal:(e,t)=>e&&e.equals(t)},value:null},editMonth:!0,dayNameFormat:"dd",trapFocus:!0,role:"grid",focusDescendant:!0,alwaysRefreshOnMonthChange:null}}static get prototypeProperties(){return{outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date"}}construct(e){const t=this;super.construct(e),t.externalCellRenderer=t.cellRenderer,t.cellRenderer=t.internalCellRenderer,t.element.setAttribute("aria-activedescendant",`${t.id}-active-day`),t.weeksElement.setAttribute("role","grid"),t.weekElements.forEach((e=>e.setAttribute("role","row"))),t.element.setAttribute("ariaLabelledBy",t.widgetMap.fields.id),Gn.on({element:t.weeksElement,click:{handler:"onCellClick",delegate:`.${t.dayCellCls}:not(.${t.disabledCls}):not(.${t.outOfRangeCls})`},mousedown:{handler:"onCellMousedown",delegate:`.${t.dayCellCls}`},thisObj:t}),t.widgetMap.monthField.readOnly=t.widgetMap.yearButton.disabled=!t.editMonth,t.refresh.flush()}afterHide(){var e;null===(e=this._yearPicker)||void 0===e||e.hide(),super.afterHide(...arguments)}doDestroy(){var e,t;null===(e=this.yearButton)||void 0===e||e.destroy(),null===(t=this.monthField)||void 0===t||t.destroy(),super.doDestroy()}get focusElement(){return this.weeksElement.querySelector(`.${this.dayCellCls}[tabIndex="0"]`)}doRefresh(){const e=this,{date:t}=e,n=e.focusElement,r=Wt.betweenLesser(e.activeDate,e.month.startDate,e.month.endDate)?e.activeDate:e._activeDate=t;e.getConfig("tbar"),super.doRefresh(...arguments),e.widgetMap.monthField.value=t.getMonth(),e.widgetMap.yearButton.text=t.getFullYear();const i=Wt.parseKey(null==n?void 0:n.dataset.date);r-i&&e.syncActiveDate(r,i)}internalCellRenderer({cell:e,date:t}){const n=this,{activeCls:r,selectedCls:i,externalCellRenderer:o}=n,s=n.isSelectedDate(t),l={[r]:r&&n.isActiveDate(t),[i]:s,[n.outOfRangeCls]:n.minDate&&t<n.minDate||n.maxDate&&t>n.maxDate};if(s&&n.multiSelect){const e=!n.isSelectedDate(Wt.add(t,-1,"d")),r=!n.isSelectedDate(Wt.add(t,1,"d"));l["b-range-start"]=e,l["b-range-end"]=r,l["b-in-range"]=!e&&!r}Lr.updateClassList(e,l),e.innerHTML=`<div class="b-datepicker-cell-inner">${t.getDate()}</div>`,e.setAttribute("role","gridcell"),e.setAttribute("aria-label",Wt.format(t,"MMMM D, YYYY")),n.isActiveDate(t)?e.id=`${n.id}-active-day`:e.removeAttribute("id"),o&&(arguments[0].cell=e.firstChild,n.callback(o,this,arguments))}onCellMousedown(e){const t=e.target.closest("[data-date]");e.preventDefault(),t.focus(),this.activeDate=Wt.parseKey(t.dataset.date)}onCellClick(e){const t=e.target.closest("[data-date]");this.onUIDateSelect(Wt.parseKey(t.dataset.date),e)}onUIDateSelect(e,t){const n=this,{lastClickedDate:r,multiSelect:i}=n;n.lastClickedDate=e,n.isDisabledDate(e)||(n.activatingEvent=t,i?n.handleMultiSelect(r,e,t):(n.selection=e,n.floating&&n.hide()),n.activatingEvent=null)}handleMultiSelect(e,t,n){const r=this,{multiSelect:i}=r,o=r._selection||(r._selection=new Kg),s=o.dates,l="range"===i,{size:a,generation:c}=o,d=a&&{[Wt.makeKey(Wt.add(s[0],-1,"d"))]:1,[Wt.makeKey(s[0])]:1,[Wt.makeKey(s[s.length-1])]:1,[Wt.makeKey(Wt.add(s[s.length-1],1,"d"))]:1},u=o.has(t)?"delete":"add",h=l&&(null==d?void 0:d[Wt.makeKey(t)]);if(n.ctrlKey)!0!==i&&a&&!h||(o[u](t),l&&!o.has(r.rangeStartDate)&&r.rangeStartDate.setDate(r.rangeStartDate.getDate()+(t<s[1]?1:-1)));else if(n.shiftKey&&a){const[n,i]=[new Date(l?r.rangeStartDate||(r.rangeStartDate=s[0]):e),t].sort(Ug);l&&o.clear();for(const e=n;e<=i;e.setDate(e.getDate()+1))o.add(e)}else o.has(t)&&1===o.size||(o.clear(),o.add(t));const g=o.size;1===g?r.rangeStartDate=t:g||(r.rangeStartDate=null),o.generation!==c&&r.updateSelection(o)}changeSelection(e){const t=this;let n,r;if(e)if(e.forEach||(e=[e]),e.forEach(((n,r)=>e[r]=t.changeDate(n))),r=e[0],e.sort(Ug),"range"===t.multiSelect&&2===e.length){n=new Kg;for(const t=new Date(e[0]);t<=e[1];t.setDate(t.getDate()+1))n.add(t)}else r=e[0],n=new Kg(e);else n=new Kg;return r&&(t.activeDate=t.rangeStartDate=Wt.clearTime(r)),n}updateMultiSelect(e){this.element.classList.toggle("b-multiselect",Boolean(e)),e||(this.selection=[...this.selection][0])}updateSelection(e){const t=this,{dates:n}=e,r="range"===t.multiSelect?[n[0],n[n.length-1]]:n;n.length&&(t.date=n[0]),t.isConfiguring||(t.refresh.now(),t.trigger("selectionChange",{selection:r,userAction:Boolean(t.activatingEvent)}))}get selection(){const{_selection:e}=this,t=e?e.dates:Yg;return"range"===this.multiSelect&&t.length?[t[0],t[t.length-1]]:t}onInternalKeyDown(e){const t=this,n=e.key.trim()||e.code,r=t.activeDate;let i=new Date(r);if("Escape"===n&&t.floating)return t.hide();if(r&&t.weeksElement.contains(e.target)){do{switch(n){case"ArrowLeft":e.preventDefault(),e.ctrlKey?i=t.gotoPrevMonth():i.setDate(i.getDate()-1);break;case"ArrowUp":e.preventDefault(),i.setDate(i.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?i=t.gotoNextMonth():i.setDate(i.getDate()+1);break;case"ArrowDown":e.preventDefault(),i.setDate(i.getDate()+7);break;case"Enter":return t.onUIDateSelect(r,e)}}while(t.isDisabledDate(i)&&!t.focusDisabledDates);if(t.minDate&&i<t.minDate)return;if(t.maxDate&&i>t.maxDate)return;t.activeDate=i}}changeMinDate(e){return e&&Ng.prototype.changeDate.apply(this,arguments)}updateMinDate(e){this._yearpicker&&(this._yearpicker.minYear=null==e?void 0:e.getFullYear()),this.refresh()}changeMaxDate(e){return e&&Ng.prototype.changeDate.apply(this,arguments)}updateMaxDate(e){this._yearpicker&&(this._yearpicker.maxYear=null==e?void 0:e.getFullYear()),this.refresh()}changeDate(e){return Wt.clamp(super.changeDate(e),this.minDate,this.maxDate)}updateDate(e,t){const n=this,{month:r}=n;if(n.isConfiguring&&!n.initializingActiveDate&&(n.selection=e),!r.date||e.getMonth()===r.month||!n.getCell(e)||n.alwaysRefreshOnMonthChange||n.isNavigating)super.updateDate(e);else{const i=r.getOtherMonth(e),o=n.eventListeners&&(t?e.getDate()!==t.getDate()|(i.getWeekId(e)!==r.getWeekId(t))<<1|(e.getMonth()!==(null==t?void 0:t.getMonth()))<<2|(e.getFullYear()!==(null==t?void 0:t.getFullYear()))<<3:15);n.trigger("dateChange",{changes:{d:!0,w:Boolean(2&o),m:Boolean(12&o),y:Boolean(8&o),r:i.weekCount!==r.weekCount},value:e,oldValue:t})}}changeActiveDate(e,t){if(!1!==this.trigger("beforeActiveDateChange",{activeDate:e,oldActiveDate:t})){if(e=e?this.changeDate(e):this.date||(this.date=Wt.clearTime(new Date)),isNaN(e))throw new Error("DatePicker date ingestion must be passed a Date, or a YYYY-MM-DD date string");return Wt.clamp(e,this.minDate,this.maxDate)}}updateActiveDate(e,t){const n=this,{isConfiguring:r}=n;!r&&n.getCell(e)||(n.initializingActiveDate=r,n.date=e,n.initializingActiveDate=!1),r||n.refresh.isPending||n.syncActiveDate(e,t)}syncActiveDate(e,t){const n=this,{activeCls:r}=n,i=n.getCell(e),o=t&&n.getCell(t),s=Lr.getActiveElement(n.element);i.setAttribute("tabIndex",0),r&&i.classList.add(r),i.id=`${n.id}-active-day`,n.weeksElement.contains(s)&&i.focus(),o&&o!==i&&(o.removeAttribute("tabIndex"),r&&o.classList.remove(r),o.removeAttribute("id"))}set value(e){const t=this,{selection:n,duration:r}=t;if(e){if(e=t.changeDate(e,t.value),"range"===t.multiSelect&&2===(null==n?void 0:n.length))return Wt.betweenLesserEqual(e,...n)||(e<n[0]?t.selection=[e,Wt.add(e,r-1,"d")]:t.selection=[Wt.add(e,-(r-1),"d"),e]),void(t.date=t.activeDate=e);e!==i&&(t.selection=e)}else t.date=new Date,t.selection=null}get value(){return this.selection[this.selection.length-1]}get duration(){return"range"===this.multiSelect?Wt.diff(...this.selection,"d")+1:1}gotoPrevYear(){return this.goto(-1,"year")}gotoPrevMonth(){return this.goto(-1,"month")}gotoNextMonth(){return this.goto(1,"month")}gotoNextYear(){return this.goto(1,"year")}goto(e,t){const n=this,{activeDate:r}=n,i=r&&n.getCell(r);let o;o="month"===t&&i&&(null==r?void 0:r.getMonth())===n.month.month+e?r:Wt.add(i?r:n.date,e,t);const s=new Date(o);s.setDate(1);const l=Wt.add(Wt.add(s,1,"month"),-1,"day");if(n.minDate&&e<0&&l<n.minDate||n.maxDate&&e>0&&s>n.maxDate)return;n.isNavigating=!0;const a=n.date=o;return i&&(n.activeDate=o),n.isNavigating=!1,a}isActiveDate(e){return!(e-this.activeDate)}isSelectedDate(e){var t;return null===(t=this._selection)||void 0===t?void 0:t.has(e)}onMonthPicked({record:e,userAction:t}){var n;t&&(this.activeDate=Wt.add(this.activeDate,e.value-this.activeDate.getMonth(),"month"),null===(n=this.focusElement)||void 0===n||n.focus())}onYearPickerRequested(){const{yearPicker:e}=this;e.isVisible?e.hide():(e.year=e.startYear=this.activeDate.getFullYear(),e.show(),e.focus())}onYearPickerTitleClick(){this.yearPicker.hide()}onYearPicked({value:e,source:t}){const n=new Date(this.activeDate);n.setFullYear(e),this.activeDate=n,this.focusElement&&Lr.focusWithoutScrolling(this.focusElement),t.hide()}changeYearPicker(e,t){var n,r;return Wg.reconfigure(t,e?Wg.mergeConfigs({owner:this,appendTo:this.element,minYear:null===(n=this.minDate)||void 0===n?void 0:n.getFullYear(),maxYear:null===(r=this.maxDate)||void 0===r?void 0:r.getFullYear()},e):null,this)}get childItems(){const{_yearPicker:e}=this,t=super.childItems;return e&&t.push(e),t}updateLocalization(){const{monthField:e}=this.widgetMap,t=Gg();this.isConfiguring||t.every(((t,n)=>t[1]===e.store.getAt(n).text))||(t[e.value??this.date.getMonth()].selected=!0,e.items=t),super.updateLocalization()}}class Kg extends Set{add(e){return e=Wt.makeKey(e),this.has(e)||(this.generation=(this.generation||0)+1),super.add(e)}delete(e){return e=Wt.makeKey(e),this.has(e)&&this.generation++,super.delete(e)}has(e){return super.has(Wt.makeKey(e))}clear(){return this.size&&this.generation++,super.clear()}equals(e){return Array.isArray(e)&&(e=new Kg(e)),e.size===this.size&&[...this].every((t=>e.has(t)))}get dates(){return[...this].sort().map((e=>Wt.parseKey(e)))}}qg.initClass(),qg._$name="DatePicker";class Xg extends cc{static $name="DateField";static type="datefield";static alias="date";static get configurable(){return{format:"L",strictParsing:!1,fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,validateDateOnly:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200},back:{cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:!1,stepTriggers:null,weekStartDay:null,picker:{type:"datepicker",role:"dialog",floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0}},value:null}}changePicker(e,t){const n=this,r={owner:n,forElement:n[n.pickerAlignElement],minDate:n.min,maxDate:n.max,weekStartDay:n._weekStartDay,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onSelectionChange:({selection:e,source:t})=>{t.isVisible&&(n._isUserAction=n._isPickerInput=!0,n.value=e[0],n._isPickerInput=n._isUserAction=!1,t.hide())}};n.calendarContainerCls&&(r.cls=n.calendarContainerCls),n.value?r.value=n.value:r.activeDate=new Date;const i=qg.reconfigure(t,e,{owner:n,defaults:r});return null==i||i.refresh.flush(),i}get backShiftDate(){return Wt.add(this.value,-1*this._step.magnitude,this._step.unit)}onBackClick(){const e=this,{min:t}=e;if(!e.readOnly&&e.value){const n=e.backShiftDate;(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}get forwardShiftDate(){return Wt.add(this.value,this._step.magnitude,this._step.unit)}onForwardClick(){const e=this,{max:t}=e;if(!e.readOnly&&e.value){const n=e.forwardShiftDate;(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}showPicker(e){if(this.readOnly)return;const t=this,{_picker:n}=t;if(n){const e={minDate:t.min,maxDate:t.max};t.value?e.value=t.value:n.activeDate||(e.activeDate=new Date),n.setConfig(e)}super.showPicker(e)}focusPicker(){this.picker.focus()}get isValid(){const e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);let t=e.value;if(t){const{min:n,max:r,validateDateOnly:i}=e;if(i&&(t=Wt.clearTime(t,!1)),n&&t<n)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(r&&t>r)return e.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}transformDateValue(e){const t=this;return null!=e&&(Wt.isDate(e)||(e="string"==typeof e?Wt.parse(e,t.format,t.strictParsing)||Wt.parse(e,t.fallbackFormat,t.strictParsing):new Date(e)),Wt.isValidDate(e))?(!t.min||e-t.min>-Wt.MS_PER_DAY)&&(!t.max||e<=t.max)?t.transformTimeValue(e):e:null}transformTimeValue(e){const t=this,{keepTime:n}=t;if(e=Wt.clone(e),n)if("entered"!==n){const r=Wt.parse(n,t.timeFormat);Wt.isValidDate(r)?Wt.copyTimeValues(e,r):Wt.isValidDate(t.value)&&Wt.copyTimeValues(e,t.value)}else t._isPickerInput&&Wt.isValidDate(t.value)&&Wt.copyTimeValues(e,t.value);else Wt.clearTime(e,!1);return e}changeMin(e){return this.transformDateValue(e)}updateMin(e){const{input:t,_picker:n}=this;t&&(null==e?t.removeAttribute("min"):t.min=e),n&&(n.minDate=e),this.syncInvalid()}changeMax(e){return this.transformDateValue(e)}updateMax(e){const{input:t,_picker:n}=this;t&&(null==e?t.removeAttribute("max"):t.max=e),n&&(n.maxDate=e),this.syncInvalid()}get weekStartDay(){return"number"==typeof this._weekStartDay?this._weekStartDay:Wt.weekStartDay}updateWeekStartDay(e){this._picker&&(this._picker.weekStartDay=e)}changeValue(e,t){const n=this,r=n.transformDateValue(e);if(!e||r){if(n.clearError("L{invalidDate}"),n.hasChanged(t,r))return super.changeValue(r,t);n.inputting||n.syncInputFieldValue()}else n.setError("L{invalidDate}")}updateValue(e,t){const n=this._picker;n&&!this.inputting&&(n.value=n.activeDate=e),super.updateValue(e,t)}changeStep(e,t){const n=typeof e;return e?("number"===n?e={magnitude:Math.abs(e),unit:t?t.unit:"day"}:"string"===n&&(e=Wt.parseDuration(e)),e&&e.unit&&e.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}updateStep(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}hasChanged(e,t){return null!=e&&e.getTime&&null!=t&&t.getTime&&"entered"!==this.keepTime?!Wt.isEqual(Wt.clearTime(e),Wt.clearTime(t)):super.hasChanged(e&&e.getTime(),t&&t.getTime())}get inputValue(){const e=this.value;return e?Wt.format(e,this.format):""}updateFormat(){this.isConfiguring||this.syncInputFieldValue(!0)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}internalOnKeyEvent(e){super.internalOnKeyEvent(e),"Enter"===e.key&&this.isValid&&this.picker.hide()}}Xg.initClass(),Xg._$name="DateField";const Jg=e=>e.ctrlKey&&e.preventDefault();class Qg extends lc{static $name="NumberField";static type="numberfield";static alias="number";static get configurable(){return{min:null,max:null,step:1,largeStep:0,value:null,format:"",decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},changeOnSpin:!0,inputType:null}}construct(e){super.construct(e);const t=this;t.input.addEventListener("dblclick",(()=>{t.select()})),"number"==typeof t.changeOnSpin&&(t.bufferedSpinChange=t.buffer(t.triggerChange,t.changeOnSpin))}acceptValue(e,t){let n=!isNaN(e);if(n&&!this.hasTextSelection){n=!1;const e=this.input.value,r=parseFloat(e);e!==t&&(n=!this.acceptValue(r,e))}return n}okMax(e){return isNaN(this.max)||e<=this.max}okMin(e){return isNaN(this.min)||e>=this.min}internalOnKeyEvent(e){if("keydown"===e.type){const t=this,n=e.key;let r;if("ArrowUp"===n)t.doSpinUp(e.shiftKey),r=!0;else if("ArrowDown"===n)t.doSpinDown(e.shiftKey),r=!0;else if(!e.altKey&&!e.ctrlKey&&n&&1===n.length){const e=t.getAfterValue(n),i=t.formatter.parseStrict(e);r=!(i===t.value||"-"===e&&(isNaN(t.min)||t.min<0))&&!t.acceptValue(i,e)}"Enter"===n&&t._changedBySilentSpin&&(t.triggerChange(e,!0),t._changedBySilentSpin=!1),r&&e.preventDefault()}super.internalOnKeyEvent(e)}doSpinUp(e=!1){const t=this;if(t.readOnly)return;let n=(t.value||0)+(e?t.largeStep:t.step);t.okMin(n)||(n=t.min),t.okMax(n)&&t.applySpinChange(n)}doSpinDown(e=!1){const t=this;if(t.readOnly)return;let n=(t.value||0)-(e?t.largeStep:t.step);t.okMax(n)||(n=t.max),t.okMin(n)&&t.applySpinChange(n)}applySpinChange(e){const t=this;t._isUserAction=!0,!0!==t.changeOnSpin&&(t._changedBySilentSpin=!0,t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}triggerChange(){this.silenceChange||super.triggerChange(...arguments)}onFocusOut(e){var t,n,r;super.onFocusOut(...arguments);const i=this,{input:o}=i,s=o.value,l=i.formatter.truncate(s),a=isNaN(l)?s:i.formatValue(l);null===(t=i.triggers)||void 0===t||null===(n=t.spin)||void 0===n||null===(r=n.clickRepeater)||void 0===r||r.cancel(),i.lastTouchmove=null,s!==a&&(o.value=a),i._changedBySilentSpin&&(i.triggerChange(e,!0),i._changedBySilentSpin=!1)}internalOnInput(e){const t=this,{formatter:n,input:r}=t,{parser:i}=n,o=r.value,s=i.decimalPlaces(o);if(n.truncator&&s){let e=o;const l=n.truncate(o);if(!isNaN(l)&&(e=t.formatValue(l),i.decimalPlaces(e)<s)){const n=o.length-t.caretPos;r.value=e,t.caretPos=e.length-n}}super.internalOnInput(e)}formatValue(e){return this.formatter.format(e)}changeFormat(e){const t=this;if(""===e){const{leadingZeroes:n,decimalPrecision:r}=t;e=n?`${n}>9`:null,null!=r?e=`${e||""}9.${"#".repeat(r)}`:e&&(e+=".*")}return e}get formatter(){const e=this,t=e.format;let n=e._formatter;return n&&e._lastFormat===t||(n=Ph.get(e._lastFormat=t),e._formatter=n),n}updateStep(e){const t=this;var n;(t.element.classList.toggle("b-hide-spinner",!e),t._step=e,e&&s.isMobile)?t.touchMoveListener||(t.touchMoveListener=Gn.on({element:t.input,touchmove:"onInputSwipe",thisObj:t,throttled:{buffer:150,alt:Jg}})):null===(n=t.touchMoveListener)||void 0===n||n.call(t)}onInputSwipe(e){const{lastTouchmove:t}=this;if(t){const n=e.screenX-t.screenX,r=t.screenY-e.screenY;this["doSpin"+((Math.abs(n)>Math.abs(r)?n:r)>0?"Up":"Down")]()}e.preventDefault(),this.lastTouchmove=e}changeLargeStep(e){return e||10*this.step}get validity(){const e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}changeValue(e,t){const n=this;if(e||0===e){let t;"number"!=typeof e&&(e="string"==typeof e?n.formatter.parse(e):Number(e),t=isNaN(e),t&&(e="")),!t&&n.format&&(e=n.formatter.round(e))}else e=i;return super.changeValue(e,t)}get inputValue(){let e=this.value;return null!=e&&this.format&&(e=this.formatValue(e)),e}}Qg.initClass(),Qg._$name="NumberField";class Zg extends Ka{static $name="TimePicker";static type="timepicker";static configurable={floating:!0,layout:"hbox",items:{hour:{label:"L{TimePicker.hour}",type:"number",min:0,max:23,highlightExternalChange:!1,format:"2>9"},minute:{label:"L{TimePicker.minute}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9"},second:{hidden:!0,label:"L{TimePicker.second}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9"},amPm:{type:"buttongroup",items:{amButton:{type:"button",text:"AM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"},pmButton:{type:"button",text:"PM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"}}}},autoShow:!1,trapFocus:!0,seconds:null,value:{$config:{equal:"date"},value:null},format:null,max:null,min:null,initialValue:null};construct(e){super.construct(e),this.refresh()}updateSeconds(e){this.widgetMap.second[e?"show":"hide"]()}onFieldChange(){this.isConfiguring||this.isRefreshing||(this.value=this.pickerToTime())}onAmPmButtonClick({source:e}){this._pm="pmButton"===e.ref,this._value&&(this.value=this.pickerToTime())}onInternalKeyDown(e){var t;const n=this;switch(e.key){case"Escape":return n.triggerTimeChange(n._initialValue),n.hide(),void e.preventDefault();case"Enter":return n.value=n.pickerToTime(),n.hide(),void e.preventDefault()}null===(t=super.onInternalKeyDown)||void 0===t||t.call(this,e)}pickerToTime(){const e=this,t=e._pm,{hour:n,minute:r,second:i}=e.widgetMap;n.format=e._is24Hour?"2>9":null;let o=n.value,s=new Date(e.value);return e._is24Hour||(t&&o<12&&(o+=12),t||12!==o||(o=0)),s.setHours(o),s.setMinutes(r.value),e.seconds&&s.setSeconds(i.value),e._min&&(s=Wt.max(e._min,s)),e._max&&(s=Wt.min(e._max,s)),s}triggerTimeChange(e){this.trigger("timeChange",{time:e})}updateInitialValue(e){this.value=e}changeValue(e){return e&&(e="string"==typeof e?Wt.parse(e,this.format):e),this.isVisible||(this._initialValue=e),e??Wt.getTime(0)}updateValue(e){this.isVisible&&this.triggerTimeChange(e),this.refresh()}updateFormat(e){this._is24Hour=Wt.is24HourFormat(e),this.refresh()}changeMin(e){return"string"==typeof e?Wt.parse(e,this.format):e}changeMax(e){return"string"==typeof e?Wt.parse(e,this.format):e}refresh(){const e=this;if(!e.isConfiguring&&e.value){e.isRefreshing=!0;const{hour:t,minute:n,second:r,amButton:i,pmButton:o}=e.widgetMap,s=e.value,l=e._is24Hour,a=s.getHours(),c=e._pm=a>=12;e.element.classList[l?"add":"remove"]("b-24h"),t.min=l?0:1,t.max=l?23:12,t.value=l?a:a%12||12,n.value=s.getMinutes(),r.value=s.getSeconds(),i.pressed=!c,o.pressed=c,i.hidden=o.hidden=l,e.isRefreshing=!1}}}Zg.initClass(),Zg._$name="TimePicker";class ep extends cc{static $name="TimeField";static type="timefield";static alias="time";static get configurable(){return{picker:{type:"timepicker",align:{align:"t0-b0",axisLock:!0}},format:"LT",triggers:{expand:{align:"end",handler:"onTriggerClick",compose:()=>({children:[{class:{"b-icon-clock-live":1}}]})},back:{align:"start",cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick"},forward:{align:"end",cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick"}},min:null,max:null,step:"5m",stepTriggers:null,value:null,keepDate:!1}}changePicker(e,t){const n=this;return Zg.reconfigure(t,e,{owner:n,defaults:{value:n.value,forElement:n[n.pickerAlignElement],owner:n,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onTimeChange({time:e}){n._isUserAction=!0,n.value=e,n._isUserAction=!1}}})}onBackClick(){const e=this,{min:t}=e;if(!e.readOnly&&e.value){const n=Wt.add(e.value,-1*e.step.magnitude,e.step.unit);(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}onForwardClick(){const e=this,{max:t}=e;if(!e.readOnly&&e.value){const n=Wt.add(e.value,e.step.magnitude,e.step.unit);(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}get isValid(){const e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);let t=e.value;if(t){if(t=t.getTime(),e._min&&e._min.getTime()>t)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(e._max&&e._max.getTime()<t)return e.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}hasChanged(e,t){return null!=e&&e.getTime&&null!=t&&t.getTime?e.getHours()!==t.getHours()||e.getMinutes()!==t.getMinutes()||e.getSeconds()!==t.getSeconds()||e.getMilliseconds()!==t.getMilliseconds():super.hasChanged(e,t)}showPicker(){const e=this,{picker:t,value:n}=e;e.readOnly||(t.value=n,t.format=e.format,t.maxTime=e.max,t.minTime=e.min,n||(e.value=t.value),super.showPicker(!0))}onPickerShow(){var e;super.onPickerShow(),this.pickerKeyDownRemover=null===(e=this.pickerKeyDownRemover)||void 0===e?void 0:e.call(this)}focusPicker(){this.picker.focus()}transformTimeValue(e){return null!=e&&("string"==typeof e?(e=Wt.parse(e,this.format),this.keepDate&&(e=Wt.copyTimeValues(new Date(this.value),e))):e=new Date(e),Wt.isValidDate(e))?this.keepDate?e:Wt.getTime(e):null}changeMin(e){return this.transformTimeValue(e)}updateMin(e){const{input:t}=this;t&&(null==e?t.removeAttribute("min"):t.min=e),this.syncInvalid()}changeMax(e){return this.transformTimeValue(e)}updateMax(e){const{input:t}=this;t&&(null==e?t.removeAttribute("max"):t.max=e),this.syncInvalid()}changeValue(e,t){const n=this,r=n.transformTimeValue(e);if(e&&!r||n.isRequired&&""===e)n.setError("L{invalidTime}");else{if(n.clearError("L{invalidTime}"),n.hasChanged(t,r))return super.changeValue(r,t);n.inputting||n.syncInputFieldValue(!0)}}updateValue(e,t){const{expand:n}=this.triggers;n&&e&&(n.element.firstElementChild.style.animationDelay=-(60*e.getHours()+e.getMinutes())/10+"s"),super.updateValue(e,t)}changeStep(e,t){var n,r;const i=typeof e;return e?("number"===i?e={magnitude:Math.abs(e),unit:t?t.unit:"hour"}:"string"===i&&(e=Wt.parseDuration(e)),null!==(n=e)&&void 0!==n&&n.unit&&null!==(r=e)&&void 0!==r&&r.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}updateStep(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}updateFormat(){this.syncInputFieldValue(!0)}get inputValue(){return Wt.format(this.value,this.format)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}}ep.initClass(),ep._$name="TimeField";const tp=new Date(2e3,0,1);class np extends lc{static $name="DateTimeField";static type="datetimefield";static alias="datetime";static configurable={timeField:{},dateField:{keepTime:!0,step:"1 d"},weekStartDay:null,inputTemplate:()=>"",ariaElement:"element"};doDestroy(){this.dateField.destroy(),this.timeField.destroy(),super.doDestroy()}get focusElement(){return this.dateField.input}get innerElements(){return[this.dateField.element,this.timeField.element]}internalOnKeyEvent(){}updateRevertOnEscape(e){this.timeField.revertOnEscape=e,this.dateField.revertOnEscape=e}changeTimeField(e){const t=this,n=ep.new({revertOnEscape:t.revertOnEscape,syncInvalid(...e){const n=t.updatingInvalid;ep.prototype.syncInvalid.apply(this,e),t.timeField&&!n&&t.syncInvalid()}},e);return Gn.on({element:n.element,keydown:"onTimeFieldKeyDown",thisObj:t}),t.readOnly&&(n.readOnly=!0),n}updateTimeField(e){const t=this;e.ion({change({userAction:e,value:n}){if(e&&!t.$settingValue){const e=t.dateField.value;t._isUserAction=!0,t.value=e?Wt.copyTimeValues(e,n||tp):null,t._isUserAction=!1}},thisObj:t})}changeDateField(e){const t=this,n=(null==e?void 0:e.type)||"datefield",r=ul.resolveType(e.type||"datefield"),i=ul.create(Yt.assign({type:n,revertOnEscape:t.revertOnEscape,syncInvalid(...e){const n=t.updatingInvalid;r.prototype.syncInvalid.apply(this,e),t.dateField&&!n&&t.syncInvalid()}},e));return Gn.on({element:i.element,keydown:"onDateFieldKeyDown",thisObj:t}),t.readOnly&&(i.readOnly=!0),i.ion({keydown:({event:e})=>{var t;"Tab"===e.key&&!e.shiftKey&&null!==(t=this.timeField)&&void 0!==t&&t.isVisible&&(e.stopPropagation(),e.cancelBubble=!0)}}),i}get childItems(){return[this.dateField,this.timeField]}updateDateField(e){const t=this;e.ion({change({userAction:e,value:n}){e&&!t.$isInternalChange&&(t._isUserAction=!0,t.timeField.value?n&&Wt.copyTimeValues(n,t.timeField.value||tp):t.timeField.value=n,t.value=n,t._isUserAction=!1)},thisObj:t})}updateWeekStartDay(e){this.dateField&&(this.dateField.weekStartDay=e)}changeWeekStartDay(e){var t;return"number"==typeof e?e:(null===(t=this.dateField)||void 0===t?void 0:t.weekStartDay)??Wt.weekStartDay}syncInputFieldValue(e=this.isConfiguring){super.syncInputFieldValue(!0);const t=this,{dateField:n,timeField:r}=t,i=n.highlightExternalChange,o=r.highlightExternalChange;e||t.highlightExternalChange||(e=!0),t.$isInternalChange=!0,n.highlightExternalChange=!1,n.value=null,n.highlightExternalChange=i,e&&(r.highlightExternalChange=n.highlightExternalChange=!1),r.value=n.value=t.inputValue,n.highlightExternalChange=i,r.highlightExternalChange=o,t.$isInternalChange=!1,t.syncInvalid()}onTimeFieldKeyDown(e){const t=this;if("Enter"===e.key||"Tab"===e.key){const e=t.dateField.value;t._isUserAction=!0,t.value=e?Wt.copyTimeValues(e,t.timeField.value||tp):null,t._isUserAction=!1}}onDateFieldKeyDown(e){const t=this;"Tab"!==e.key||e.shiftKey?"Enter"===e.key&&(t.value=t.dateField.value):(e.stopPropagation(),e.preventDefault(),t.timeField.focus())}updateRequired(e,t){this.timeField.required=this.dateField.required=e}updateReadOnly(e,t){super.updateReadOnly(e,t),this.isConfiguring||(this.timeField.readOnly=this.dateField.readOnly=e)}onDisabled(e){this.timeField.disabled=this.dateField.disabled=e}focus(){this.dateField.focus()}hasChanged(e,t){return!Wt.isEqual(e,t)}get isValid(){return this.timeField.isValid&&this.dateField.isValid}setError(e,t){[this.dateField,this.timeField].forEach((n=>n.setError(e,t)))}getErrors(){const e=[...this.dateField.getErrors()||[],...this.timeField.getErrors()||[]];return e.length?e:null}clearError(e,t){[this.dateField,this.timeField].forEach((n=>n.clearError(e,t)))}updateInvalid(){this.updatingInvalid=!0,[this.dateField,this.timeField].forEach((e=>e.updateInvalid())),this.updatingInvalid=!1}}np.initClass(),np._$name="DateTimeField";class rp extends ac{static $name="DurationField";static type="durationfield";static alias="duration";static get defaultConfig(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}},nullValue:null}}static get configurable(){return{min:null,max:null,allowedUnits:null}}changeMin(e){return"string"==typeof e?new oo(e):e}changeMax(e){return"string"==typeof e?new oo(e):e}changeAllowedUnits(e){return"string"==typeof e&&(e=e.split(",")),e.length>0&&!e.includes(this.defaultUnit)&&(this.defaultUnit=e[0]),e}updateAllowedUnits(e){this.allowedUnitsRe=new RegExp(`(${e.join("|")})`,"i")}get inputValue(){return null==this.value?"":this.calcValue(!0).toString(this.useAbbreviation)}set unit(e){this._unit=e,this.value=this.calcValue()}get unit(){return this._unit}get unitWithDefault(){return this._unit||this.defaultUnit}set magnitude(e){this.clearError("L{invalidUnit}"),this._magnitude=e,super.value=this.calcValue()}get magnitude(){return this._magnitude}roundMagnitude(e){return e&&null!=this.decimalPrecision?Yt.round(e,this.decimalPrecision):e}get allowDecimals(){return 0!==this.decimalPrecision}get isValid(){const e=this,t=null==e.value||e.value&&null==e.value.magnitude;return super.isValid&&(t&&!e.required||!t&&(e.allowNegative||e.value.magnitude>=0))}internalOnChange(e){const t=this,n=t.value,r=t._lastValue;t.hasChanged(r,n)&&(t._lastValue=n,t.triggerFieldChange({value:n,event:e,userAction:!0,valid:t.isValid}))}onFocusOut(e){var t,n,r;return this.syncInputFieldValue(!0),null===(t=this.triggers)||void 0===t||null===(n=t.spin)||void 0===n||null===(r=n.clickRepeater)||void 0===r||r.cancel(),super.onFocusOut(e)}set value(e){const t=this;let n,r;if(t.getConfig("allowedUnits"),t.clearError("L{invalidUnit}"),"number"==typeof e||"string"==typeof e&&e.length>0&&!isNaN(e))n=Number(e),r=t.unitWithDefault;else if("string"==typeof e)if(/^\s*$/.test(e))n=null;else{const i=Wt.parseDuration(e,t.allowDecimals,t.unitWithDefault);i&&(!t.allowedUnitsRe||t.allowedUnitsRe.test(i.unit)?(r=i.unit,n=i.magnitude):t.setError("L{invalidUnit}"))}else e&&"unit"in e&&"magnitude"in e?(r=e.unit,n=e.magnitude):(r=null,n=null);t._magnitude===n&&t._unit==r||(t._magnitude=n,r&&(t._unit=r),super.value=t.calcValue())}okMax(e){return"number"==typeof e&&(e=new oo({unit:this.unitWithDefault,magnitude:e})),null==this.max||e<=this.max}okMin(e){return"number"==typeof e&&(e=new oo({unit:this.unitWithDefault,magnitude:e})),null==this.min||e>=this.min}get validity(){const e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}get value(){return super.value}calcValue(e=!1){const t=this;return t._unit&&null!=t._magnitude||!t.clearable?new oo(e?this.roundMagnitude(t._magnitude):this._magnitude,t.unitWithDefault):null}hasChanged(e,t){return t&&!e||!t&&e||t&&e&&!e.isEqual(t)}get milliseconds(){return this.value?this.value.milliseconds:0}onInternalKeyDown(e){"ArrowUp"===e.key?this.doSpinUp():"ArrowDown"===e.key&&this.doSpinDown()}doSpinUp(){const e=this;if(e.readOnly)return;let t=(e.magnitude||0)+e.step;e._isUserAction=!0,e.okMin(t)||(t=e.min),e.okMax(t)&&(e.value=t),e._isUserAction=!1}doSpinDown(){const e=this;if(e.readOnly)return;let t=(e.magnitude||0)-e.step;e.okMax(t)||(t=e.max),e.okMin(t)&&(e.allowNegative||(e.magnitude||0)>0)&&(e._isUserAction=!0,e.value=t,e._isUserAction=!1)}}rp.initClass(),rp._$name="DurationField";class ip extends gl{static $name="Fit";static type="fit";static configurable={containerCls:"b-fit-container",itemCls:"b-fit-item"}}ip.initClass(),ip._$name="Fit";class op extends El{static $name="Editor";static type="editor";static configurable={positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0};afterConfigure(){const e=this;super.afterConfigure(),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),Gn.on({element:e.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:e}),e.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:e}),Ye.ion({locale:"onLocaleChange",thisObj:e})}onLocaleChange(){const{inputField:e}=this;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}render(e){const t=this.element.parentNode,[n]=this.getRenderContext(this,e);n.classList.add("b-editing"),super.render(...arguments),null!=t&&t.classList&&n!==t&&t.classList.remove("b-editing")}async startEdit(e){const t=this;if(e=Yt.assignIf(e,{align:t.align,hideTarget:t.hideTarget,matchSize:t.matchSize,matchFont:t.matchFont,fitTargetContent:t.fitTargetContent,focus:!0}),!1!==t.trigger("beforeStart",e)){var n,r,o;const{target:s,hideTarget:l,matchSize:a,matchFont:c,fitTargetContent:d,record:u,field:h=t.inputField.name,focus:g}=e,{inputField:p}=t,{input:m}=p,f=Lr.getStyleValue(s,"font-size"),v=Lr.getStyleValue(s,"font-family");let{value:b,align:y}=e;if(u&&h&&(t.record=u,t.dataField=h,b===i&&(b=u.getValue(h))),a&&(s instanceof HTMLElement&&t.updateSize(s,a),s instanceof HTMLElement&&Rs.addResizeListener(s,t.onTargetSizeChange)),m&&(c?(m.style.fontSize=f,m.style.fontFamily=v):m.style.fontSize=m.style.fontFamily=""),t.assigningValues=!0,null===(n=p.clearError)||void 0===n||n.call(p),"setValue"in p?await p.setValue(b):p.value=b,t.assigningValues=!1,"string"==typeof y&&(y={align:y}),await t.showBy({target:s,allowTargetOut:!0,...y}),d){const e=m.scrollWidth-m.clientWidth;e>0&&(t.width+=e+Lr.scrollBarWidth)}g&&(null===(r=p.focus)||void 0===r||r.call(p)),s.nodeType===Element.ELEMENT_NODE&&l&&s.classList.add("b-hide-visibility"),t.editing=!0;const C=p.value;return t.trigger("start",{value:C}),Array.isArray(C)&&p.editingRecords&&null!==(o=C[0])&&void 0!==o&&o.isModel?t.oldValue=C.map((e=>e.copy(e.id))):(t.oldValue=C,Array.isArray(t.oldValue)&&(t.oldValue=t.oldValue.slice())),p.initialValue=t.oldValue,!0}return!1}async refreshEdit(){if(this.isVisible){const{record:e,dataField:t,inputField:n}=this;if(e&&t){const r=e.getValue(t);Yt.isEqual(n.value,r)||await n.setValue(r)}}}finishEdit(){const{target:e,aligningToElement:t}=this.lastAlignSpec;t&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(e){var t;const n=this;switch(e.key){case n.completeKey:n.completeEdit(null,e),e.stopImmediatePropagation();break;case n.cancelKey:n.cancelEdit(e),e.stopImmediatePropagation()}null===(t=n.trigger)||void 0===t||t.call(n,"keydown",{event:e})}stopMouseEvents(e){this.allowMouseEvents||e.stopPropagation()}onFocusOut(e){super.onFocusOut(e);const t=this;if(!t.isFinishing&&t.editing)switch(t.blurAction){case"cancel":t.cancelEdit(e);break;case"complete":t.completeEdit(null,e)}}async completeEdit(e,t){const n=this,{inputField:r,oldValue:i,record:o}=n,s=r.invalidAction||(!1===r.allowInvalid?"block":n.invalidAction),{value:l}=r;if(n.isVisible){if(r.isValid||"allow"===s){if(Yt.isEqual(l,i))return!1!==n.cancelEdit(t);{const t={inputField:r,record:o,value:l,oldValue:i};if(!1!==n.trigger("beforeComplete",t)){var a;if(!e)e=t.finalize||(null===(a=t.editorContext)||void 0===a?void 0:a.finalize);if(e){let o=await e(t);if(!0===o)n.onEditComplete();else{if(r.setError){const e=o||r.invalidValueError,t=()=>{n(),r.clearError(e)},n=r.ion({change:t,input:t});r.setError(e)}var c;if("block"===s)null===(c=r.focus)||void 0===c||c.call(r);else"revert"===s&&(await r.setValue(i),o=!0);o=!1}return o}return n.onEditComplete(),!0}var d;null===(d=r.focus)||void 0===d||d.call(r)}}else{var u;if("block"===s)return null===(u=r.focus)||void 0===u||u.call(r),!1;if("revert"===s)return!1!==n.cancelEdit(t)}return!1}}cancelEdit(e){const t=this,{inputField:n,oldValue:r}=t,{value:i}=n;if(!t.editing||t.isFinishing||!1===t.trigger("beforeCancel",{value:i,oldValue:r,event:e}))return!1;var o;null===(o=n.clearError)||void 0===o||o.call(n),t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:i,oldValue:r,event:e}),t.finishEdit(),t.isFinishing=!1}onEditComplete(){const e=this,{record:t,dataField:n,inputField:r,oldValue:i}=e,{value:o}=r;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){const e=`set${A.capitalize(n)}`;t[e]?t[e](o):t.setValue(n,o)}e.trigger("complete",{value:o,oldValue:i}),e.finishEdit(),e.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(e){this._owner=e}get owner(){return this._owner||ul.fromElement(this.element.parentNode)}changeInputField(e,t){const n=this;return t&&t.destroy(),"string"==typeof e&&(e={type:e}),e instanceof ul||(e=ul.create(e),n.createdInputField=!0),n.completeOnChange&&e.ion({change:"onInputFieldChange",thisObj:n}),e.parent=n,e}updateInputField(e){this.removeAll(),this.add(e)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(e,t,n){t&&n&&this.updateSize(e)}updateSize(e,t=this.lastMatchSize){const n=this,r=bn.inner(e);n.width=!1===t.width?"auto":r.width-n.align.offset[0],n.height=!1===t.height?"auto":r.height,n.lastMatchSize=t}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),Rs.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}}op.initClass(),op._$name="Editor";const sp=["number","boolean","string","date","duration"],lp=e=>{var t;return"duration"===(null===(t=e.column)||void 0===t?void 0:t.type)},ap="b-fieldfilterpicker",cp={between:!0,notBetween:!0,isIncludedIn:!0,isNotIncludedIn:!0},dp={textfield:!0,datefield:!0,numberfield:!0,durationfield:!0,combo:!0};class up extends El{static $name="FieldFilterPicker";static type="fieldfilterpicker";static operators={empty:{value:"empty",text:"L{isEmpty}",argCount:0},notEmpty:{value:"notEmpty",text:"L{isNotEmpty}",argCount:0},"=":{value:"=",text:"L{equals}"},"!=":{value:"!=",text:"L{doesNotEqual}"},">":{value:">",text:"L{isGreaterThan}"},"<":{value:"<",text:"L{isLessThan}"},">=":{value:">=",text:"L{isGreaterThanOrEqualTo}"},"<=":{value:"<=",text:"L{isLessThanOrEqualTo}"},between:{value:"between",text:"L{isBetween}",argCount:2},notBetween:{value:"notBetween",text:"L{isNotBetween}",argCount:2},isIncludedIn:{value:"isIncludedIn",text:"L{isOneOf}"},isNotIncludedIn:{value:"isNotIncludedIn",text:"L{isNotOneOf}"}};static defaultOperators={string:[this.operators.empty,this.operators.notEmpty,this.operators["="],this.operators["!="],{value:"includes",text:"L{contains}"},{value:"doesNotInclude",text:"L{doesNotContain}"},{value:"startsWith",text:"L{startsWith}"},{value:"endsWith",text:"L{endsWith}"},this.operators.isIncludedIn,this.operators.isNotIncludedIn],number:[this.operators.empty,this.operators.notEmpty,this.operators["="],this.operators["!="],this.operators[">"],this.operators["<"],this.operators[">="],this.operators["<="],this.operators.between,this.operators.notBetween,this.operators.isIncludedIn,this.operators.isNotIncludedIn],date:[this.operators.empty,this.operators.notEmpty,this.operators["="],this.operators["!="],{value:"<",text:"L{isBefore}"},{value:">",text:"L{isAfter}"},this.operators.between,{value:"isToday",text:"L{isToday}",argCount:0},{value:"isTomorrow",text:"L{isTomorrow}",argCount:0},{value:"isYesterday",text:"L{isYesterday}",argCount:0},{value:"isThisWeek",text:"L{isThisWeek}",argCount:0},{value:"isNextWeek",text:"L{isNextWeek}",argCount:0},{value:"isLastWeek",text:"L{isLastWeek}",argCount:0},{value:"isThisMonth",text:"L{isThisMonth}",argCount:0},{value:"isNextMonth",text:"L{isNextMonth}",argCount:0},{value:"isLastMonth",text:"L{isLastMonth}",argCount:0},{value:"isThisYear",text:"L{isThisYear}",argCount:0},{value:"isNextYear",text:"L{isNextYear}",argCount:0},{value:"isLastYear",text:"L{isLastYear}",argCount:0},{value:"isYearToDate",text:"L{isYearToDate}",argCount:0},this.operators.isIncludedIn,this.operators.isNotIncludedIn],boolean:[{value:"isTrue",text:"L{isTrue}",argCount:0},{value:"isFalse",text:"L{isFalse}",argCount:0}],duration:[this.operators.empty,this.operators.notEmpty,this.operators["="],this.operators["!="],this.operators[">"],this.operators["<"],this.operators[">="],this.operators["<="],this.operators.between,this.operators.notBetween,this.operators.isIncludedIn,this.operators.isNotIncludedIn],relation:[this.operators.isIncludedIn,this.operators.isNotIncludedIn]};static get defaultValueFieldPlaceholders(){return{string:"L{enterAValue}",number:"L{enterANumber}",date:"L{selectADate}",list:"L{selectOneOrMoreValues}",duration:"L{enterAValue}"}}static configurable={fields:null,disabled:!1,readOnly:!1,layout:"vbox",propertyLocked:!1,operatorLocked:!1,filter:null,propertyFieldConfig:null,operatorFieldConfig:null,valueFieldCls:null,items:{inputs:{type:"container",layout:"hbox",cls:`${ap}-inputs`,items:{propertyPicker:{type:"combo",items:{},cls:`${ap}-property`,placeholder:"L{FieldFilterPicker.selectAProperty}"},operatorPicker:{type:"combo",editable:!1,items:{},cls:`${ap}-operator`,placeholder:"L{FieldFilterPicker.selectAnOperator}"},valueFields:{type:"container",cls:`${ap}-values`,items:{}}}},caseSensitive:{type:"checkbox",text:"L{FieldFilterPicker.caseSensitive}",cls:`${ap}-case-sensitive`}},operators:up.defaultOperators,dateFormat:"L{FieldFilterPicker.dateFormat}",store:null,valueFieldPlaceholders:null,getValueFieldConfig:null};static buildOperatorArgCountLookup=e=>H.keyBy(Object.entries(e),(([e])=>e),(([,e])=>H.keyBy(e,(({value:e})=>e),(({argCount:e})=>e===i?1:e))));afterConstruct(){const e=this;if(!e._fields)throw new Error(`${up.name} requires 'fields' to be configured.`);if(!e._filter)throw new Error(`${up.name} requires 'filter' to be configured.`);super.afterConstruct();const{widgetMap:{propertyPicker:t,operatorPicker:n,caseSensitive:r}}=e;t.ion({select:"onPropertySelect",thisObj:e}),n.ion({select:"onOperatorSelect",thisObj:e}),r.ion({change:"onCaseSensitiveChange",thisObj:e}),e.propertyFieldConfig&&t.setConfig(e.propertyFieldConfig),e.operatorFieldConfig&&n.setConfig(e.operatorFieldConfig),t.cls=e.allPropertyPickerClasses,n.cls=e.allOperatorPickerClasses,e.populateUIFromFilter()}changeDateFormat(e){return this.L(e)}get allChildInputs(){const{propertyPicker:e,operatorPicker:t,caseSensitive:n}=this.widgetMap;return[e,t,...this.valueFields,n]}updateDisabled(e){this.allChildInputs.forEach((t=>t.disabled=e))}updateReadOnly(e){const{propertyPicker:t,operatorPicker:n}=this.widgetMap;this.allChildInputs.forEach((t=>t.readOnly=e)),t.readOnly=t.readOnly||e,n.readOnly=n.readOnly||e}updatePropertyLocked(e){this.widgetMap.propertyPicker.readOnly=e||this.readOnly,this.widgetMap.propertyPicker.cls=this.allPropertyPickerClasses}updateOperatorLocked(e){this.widgetMap.operatorPicker.readOnly=e||this.readOnly,this.widgetMap.operatorPicker.cls=this.allOperatorPickerClasses}changeOperators(e){const t=e??up.defaultOperators;return Object.keys(t).reduce(((e,n)=>({...e,[n]:t[n].map((e=>({...e,text:this.L(e.text)})))})),{})}changeFields(e){let t=e;return Array.isArray(e)&&(P.deprecate("Core","6.0.0","FieldOption[] deprecated, use Object<String, FieldOption> keyed by field name instead"),t=H.keyBy(t,"name")),t}get isMultiSelectValueField(){var e;return["isIncludedIn","isNotIncludedIn"].includes(null===(e=this._filter)||void 0===e?void 0:e.operator)}get allPropertyPickerClasses(){var e;return new wn(`${ap}-property`,null===(e=this.propertyFieldConfig)||void 0===e?void 0:e.cls,{[`${ap}-combo-locked`]:this.propertyLocked})}get allOperatorPickerClasses(){var e;return new wn(`${ap}-operator`,null===(e=this.operatorFieldConfig)||void 0===e?void 0:e.cls,{[`${ap}-combo-locked`]:this.operatorLocked})}getValueFieldConfigs(){const e=this,{valueFieldCls:t,fieldType:n,_filter:{operator:r},onValueChange:i,filterValues:o,isMultiSelectValueField:s,operatorArgCount:l,getValueFieldConfig:a}=e,c=Yt.merge({},up.defaultValueFieldPlaceholders,e.valueFieldPlaceholders);if(!n||!r||0===l)return[];let d={type:"textfield",internalListeners:{change:i,input:i,thisObj:e},cls:t,dataset:{type:n},placeholder:e.L(c[s?"list":n])};return s?d={...d,type:"combo",multiSelect:!0,createOnUnmatched:!0,items:this.getUniqueDataValues(o),value:o??[]}:["number","date","boolean"].includes(n)?d.type=`${n}field`:"duration"===n&&(d.type="durationfield"),a&&(d=e.callback(a,e,[e.filter,d])),s?[d]:H.populate(l,(t=>[{type:"widget",tag:"div",cls:`${ap}-value-separator`,content:e.L("L{FieldFilterPicker.and}")},{...d,value:o[t]}])).flat().slice(1)}getUniqueDataValues(e=[]){var t;const n=this,{fieldType:r}=n;if(!n.store||null===(t=n._filter)||void 0===t||!t.property)return[];const{relatedDisplayField:i}=n.selectedField;let o,s;if(n.fieldIsRelation){const{foreignStore:e}=n.currentPropertyRelationConfig;i?(o=e.allRecords.reduce(((e,t)=>(null!=t.id&&e.push({text:t.getValue(i),value:t.id}),e)),[]),s=o.sort(((e,t)=>n.sortStrings(e.text,t.text)))):o=e.allRecords.map((e=>e.id))}else o=n.store.allRecords.map((e=>e.getValue(n._filter.property)));if(!s){o.push(...e);const t=H.unique(o.reduce(((e,t)=>(null!=t&&""!==String(t).trim()&&("date"===r?e.push(t.valueOf()):"duration"===r?e.push(t.toString()):e.push(t)),e)),[]));s="string"===r?t.sort(n.sortStrings):"duration"===r?t.map((e=>new oo(e))).filter((e=>e.isValid)).sort(n.sortDurations):t.sort(n.sortNumerics),"date"===r?s=s.map((e=>{const t=new Date(e);return{text:Wt.format(t,n.dateFormat),value:e}})):"duration"===r&&(s=s.map((e=>e.toString())))}return s}sortStrings(e,t){return(e??"").localeCompare(t??"")}sortNumerics(e,t){return e-t}sortDurations(e,t){return e.valueOf()-t.valueOf()}get fieldType(){var e;return null===(e=this.selectedField)||void 0===e?void 0:e.type}get selectedField(){var e,t;return null===(e=this.fields)||void 0===e?void 0:e[null===(t=this._filter)||void 0===t?void 0:t.property]}get propertyOptions(){return Object.entries(this.fields??{}).filter((([,e])=>sp.includes(e.type)||lp(e))).map((([e,{title:t}])=>({value:e,text:t??e}))).sort(((e,t)=>e.text.localeCompare(t.text)))}get operatorOptions(){return this.operators[this.fieldIsRelation?"relation":this.fieldType]}get fieldIsRelation(){return Boolean(this.currentPropertyRelationConfig)}get currentPropertyRelationConfig(){var e,t;return null===(e=this.store)||void 0===e||null===(t=e.modelRelations)||void 0===t?void 0:t.find((({foreignKey:e})=>{var t;return e===(null===(t=this._filter)||void 0===t?void 0:t.property)}))}updateOperators(){delete this._operatorArgCountLookup}get operatorArgCountLookup(){return this._operatorArgCountLookup||(this._operatorArgCountLookup=up.buildOperatorArgCountLookup(this.operators))}updateFilter(){this._filter&&this.onFilterChange()}updateStore(e){var t;null===(t=this._store)||void 0===t||t.un(this),null==e||e.ion({refresh:"onStoreRefresh",thisObj:this})}onStoreRefresh({action:e}){this.isMultiSelectValueField&&["dataset","create","update","delete"].includes(e)&&(this.valueFields[0].items=this.getUniqueDataValues(this.filterValues))}refreshValueFields(){const e=this,{valueFields:t}=e.widgetMap,{fieldType:n,operatorArgCount:r,_filter:{property:o,operator:s}}=e,l=cp[s],a="string"===n;t.element.className=new wn(t.cls,{[`${ap}-values-multiple`]:l,[`${ap}-values-string`]:a,"b-hidden":o==i||s==i||0===r}),t.removeAll(),t.add(e.getValueFieldConfigs()),delete e._valueFields,e.refreshCaseSensitive()}refreshCaseSensitive(){var e,t;const n=this,{fieldType:r,operatorArgCount:i,isMultiSelectValueField:o}=n,s=null===(e=n._filter)||void 0===e?void 0:e.operator,{caseSensitive:l}=n.widgetMap;l.hidden="string"!==r||!s||o||0===i,l.checked=!1!==(null===(t=n._filter)||void 0===t?void 0:t.caseSensitive)}onPropertySelect(e){var t;const n=this,{_filter:r}=n;r.property=(null===(t=e.record)||void 0===t?void 0:t.data.value)||null,n.fieldType!==n._fieldType&&(r.operator=null,r.value=null),n._fieldType=r.type=n.fieldType,n.refreshOperatorPicker(),n.refreshValueFields(),n.triggerChange()}onCaseSensitiveChange({checked:e}){this._filter.caseSensitive=e,this.triggerChange()}onOperatorSelect(e){var t;const n=this,r=n.isMultiSelectValueField,i=this.operatorArgCount;n._filter.operator=(null===(t=e.record)||void 0===t?void 0:t.data.value)||null,n.operatorArgCount!==i&&(n._filter.value=null),n.isMultiSelectValueField&&!r&&(n._filter.value=[]),n.refreshValueFields(),n.triggerChange()}triggerChange(){const{filter:e,isValid:t}=this;this.trigger("change",{filter:e,isValid:t})}onValueChange(){const{isMultiSelectValueField:e,fieldType:t,_filter:n}=this,r=this.valueFields.map((e=>e.value));e&&"date"===t?n.value=r[0].map((e=>new Date(e))):e&&"duration"===t?n.value=r[0].map((e=>new oo(e))):("date"===t&&"between"===n.operator&&Wt.isValidDate(r[1])&&r[1].setHours(23,59,59,999),n.value=1===r.length?r[0]:r),this.triggerChange()}refreshOperatorPicker(){const{operatorPicker:e}=this.widgetMap,{_filter:{operator:t,property:n},operatorOptions:r}=this;e.items=r,e.value=t,e.hidden=null===n}populateUIFromFilter(e=!1){const t=this,{filterValues:n,widgetMap:{propertyPicker:r,operatorPicker:i},_filter:{property:o,operator:s,disabled:l},propertyOptions:a,operatorOptions:c,isMultiSelectValueField:d}=t;r.items=a,i.items=c,i.hidden=null===o;let u=e;r.value!==o&&(r.value=o,t.refreshOperatorPicker(),u=!0),i.value!==s&&(null!==s&&i.items.find((({value:e})=>e===s))?i.value=s:i.clear(),u=!0),u&&t.refreshValueFields(),t.refreshCaseSensitive(),t.valueFields.forEach(((e,r)=>{d&&(e.value.length>0||n.length>0)?"date"===t.fieldType?e.value=n.map((e=>null==e?void 0:e.valueOf())):"duration"===t.fieldType?e.value=n.map((e=>null==e?void 0:e.toString())):e.value=n:r>=n.length?e.clear():e.value=n[r]})),t.allChildInputs.forEach((e=>e.disabled=t.disabled||l))}get valueFields(){return this._valueFields||(this._valueFields=this.widgetMap.valueFields.queryAll((e=>dp[e.type])))}get filterValues(){var e;return null==(null===(e=this._filter)||void 0===e?void 0:e.value)?[]:H.asArray(this._filter.value)}onFilterChange(){const e=this,t=e.fieldType,n=t!==e._fieldType;e._fieldType=e._filter.type=t,e.populateUIFromFilter(n)}get operatorArgCount(){const{fieldType:e,filter:{operator:t},operatorArgCountLookup:n}=this;return e&&t?n[e][t]:1}get isValid(){const{filter:e,fieldType:t,filterValues:n,isMultiSelectValueField:r,operatorArgCount:i}=this,{operator:o}=e,s=i>0&&null==(null==e?void 0:e.value);return t&&o&&!s&&(r&&n.length>0||n.length===i)&&n.every((e=>null!=e&&("duration"!==t||e.isValid)))}}up.initClass(),up._$name="FieldFilterPicker";class hp extends ul{static $name="Label";static type="label";static configurable={text:null,localizableProperties:["text"]};compose(){const{text:e,html:t}=this;return{tag:"label",text:e,html:t}}}hp.initClass(),hp._$name="Label";class gp extends El{static $name="FieldFilterPickerGroup";static type="fieldfilterpickergroup";static addFilterButtonDefaultText="L{FieldFilterPickerGroup.addFilter}";static configurable={filters:[],fields:null,disabled:!1,readOnly:!1,layout:"vbox",store:null,limitToProperty:null,valueFieldCls:null,showAddFilterButton:!0,canDeleteFilter:null,getFieldFilterPickerConfig:null,canManageFilter:null,addFilterButtonText:null,items:{pickers:{type:"container",layout:"vbox",scrollable:!0,items:{}},addFilterButton:{type:"button",text:gp.addFilterButtonDefaultText,cls:`b-${gp.type}-add-button`,hidden:!0}},operators:null,dateFormat:"L{FieldFilterPicker.dateFormat}"};static childPickerType="fieldfilterpicker";afterConstruct(){const e=this;e.validateConfig();const{addFilterButton:t}=e.widgetMap;t.ion({click:"addFilter",thisObj:e}),t.text=e.L(t.text),e.store&&e.updateStore(e.store),super.afterConstruct()}changeDateFormat(e){return this.L(e)}validateConfig(){if(!this.fields&&!this.store)throw new Error("FieldFilterPickerGroup requires either a 'fields' or 'store' config property.")}updateFields(e){this.widgetMap.pickers.childItems.forEach((t=>t.fields=e))}updateFilters(e,t){const n=this;t&&t.filter((t=>!e.find((e=>e.id===t.id)))).forEach((e=>{var t;return null===(t=n.store)||void 0===t?void 0:t.removeFilter(e.id)})),e.forEach((e=>e.id=e.id||n.nextFilterId)),n.widgetMap.pickers.items=(null==e?void 0:e.map((e=>n.getPickerRowConfig(e))))||[]}changeFilters(e){const{canManageFilter:t}=this;return e&&t?e.filter((e=>this.callback(t,this,[e]))):e}updateStore(e){const t=this;t.detachListeners("store"),e&&(t.widgetMap.pickers.childItems.forEach((({widgetMap:{filterPicker:{filter:t,isValid:n}}})=>{e.removeFilter(t.id,!0),n&&e.addFilter(t,!0)})),e.filter(),t.appendFiltersFromStore(),e.ion({name:"store",filter:"onStoreFilter",thisObj:t})),t.widgetMap.pickers.childItems.forEach((t=>t.store=e))}updateShowAddFilterButton(e){this.widgetMap.addFilterButton.hidden=!e}updateAddFilterButtonText(e){this.widgetMap.addFilterButton.text=e??gp.addFilterButtonDefaultText}appendFiltersFromStore(){const e=this;e.store.filters.forEach((t=>{var n;const r=e.canManage(t),{property:i,operator:o,value:s,id:l,disabled:a=!1,caseSensitive:c}=t;r&&i&&o&&(null===(n=e.filters)||void 0===n||!n.find((e=>e.id===l)))&&e.appendFilter({id:l,property:i,operator:o,value:s,disabled:a,caseSensitive:c})}))}canManage(e){const t=this;return!t.canManageFilter||!0===t.callback(t.canManageFilter,t,[e])}getFilterPickerConfig(e){const t=this,{fields:n,store:r,disabled:o,readOnly:s,valueFieldCls:l,operators:a,limitToProperty:c,dateFormat:d,getFieldFilterPickerConfig:u}=t;return{type:t.constructor.childPickerType,fields:n??t.getFieldsFromStore(r),filter:e,store:r,disabled:o,readOnly:s,propertyLocked:Boolean(c),valueFieldCls:l,operators:a,dateFormat:d,internalListeners:{change:"onFilterPickerChange",thisObj:t},flex:1,...u?t.callback(u,t,[e]):i}}getFieldsFromStore(e){var t;return Object.fromEntries((null===(t=e.modelClass)||void 0===t?void 0:t.fields.map((({name:e,type:t})=>[e,{type:t}])))??[])}getPickerRowConfig(e){const t=this,{disabled:n,readOnly:r,canDeleteFilter:i}=t,o=!(i&&!1===t.callback(i,t,[e]));return{type:"container",layout:"box",cls:{[`b-${gp.type}-row`]:!0,[`b-${gp.type}-row-removable`]:o},dataset:{separatorText:t.L("L{FieldFilterPicker.and}")},items:{activeCheckbox:{type:"checkbox",disabled:n,readOnly:r,checked:!Boolean(e.disabled),internalListeners:{change:"onFilterActiveChange",thisObj:t},cls:`b-${gp.type}-filter-active`},filterPicker:t.getFilterPickerConfig(e),removeButton:{type:"button",ref:"removeButton",disabled:n,readOnly:r,hidden:!o,cls:`b-transparent b-${gp.type}-remove`,icon:"b-fa-trash",internalListeners:{click:"removeFilter",thisObj:t}}}}}get allInputs(){const e=[this.constructor.childPickerType,"button","checkbox"];return this.queryAll((t=>e.includes(t.type)))}updateDisabled(e){this.allInputs.forEach((t=>t.disabled=e))}updateReadOnly(e){this.allInputs.forEach((t=>t.readOnly=e))}onFilterActiveChange({source:e,checked:t}){const n=this,r=n.getFilterIndex(e),i=n.filters[r],o=n.getFilterPicker(r);i.disabled=!t,o.onFilterChange(),n.store&&o.isValid&&n.store.addFilter(i,!0),n.updateStoreFilter(),n.triggerChange()}onFilterPickerChange({source:e,filter:t,isValid:n}){const r=this,{store:i}=r,o=r.getFilterIndex(e);i&&(i.removeFilter(t.id,!0),n&&i.addFilter(t,!0),r.updateStoreFilter()),Object.assign(r.filters[o],t),r.triggerChange()}getFilterIndex(e){return this.widgetMap.pickers.childItems.indexOf(e.containingWidget)}getPickerRow(e){return this.widgetMap.pickers.childItems[e]}getFilterPicker(e){return this.getPickerRow(e).widgetMap.filterPicker}get nextFilterId(){return this._nextId=(this._nextId||0)+1,`${this.id}-filter-${this._nextId}`}removeFilter({source:e}){const t=this,n=t.getFilterIndex(e),r=t.filters[n],i=t.getPickerRow(n),o=t.query((e=>e.isFocusable&&"container"!==e.type&&!i.contains(e)));o&&o.focus(),t.removeFilterAt(n),t.store&&(t.store.removeFilter(r.id,!0),t.updateStoreFilter()),t.trigger("remove",{filter:r}),t.triggerChange()}addFilter({property:e=null,operator:t=null,value:n=null}={}){const r=this,{filters:i}=r,o={property:r.limitToProperty||e,operator:t,value:n,disabled:!1,id:r.nextFilterId,caseSensitive:!1};var s;(r.appendFilter(o),r.getFilterPicker(i.length-1).isValid)&&(null===(s=r.store)||void 0===s||s.addFilter(o,!0),r.store&&r.updateStoreFilter());r.trigger("add",{filter:o}),r.triggerChange()}appendFilter(e){const t=this;t.limitToProperty&&e.property!==t.limitToProperty||(t.filters.push(e),t.widgetMap.pickers.add(t.getPickerRowConfig(e,t.filters.length-1)))}onStoreFilter(e){const t=this;if(t._isUpdatingStore)return;const{filters:n}=e,r=n.values.reduce(((e,t)=>({...e,[t.id]:t})),{});for(let e=t.filters.length-1;e>=0;e--){const n=t.filters[e],o=r[n.id],s=t.getPickerRow(e);if(s){const{filterPicker:r,activeCheckbox:l}=s.widgetMap;if(!o&&r.isValid)t.removeFilterAt(e);else if(o!==i){const{operator:e,value:t,property:i,disabled:s,caseSensitive:a}=o;n!==o&&Object.assign(n,{operator:e,value:t,property:i,disabled:s,caseSensitive:a}),r.filter=n,r.onFilterChange(),l.checked=!s}}}t.appendFiltersFromStore(),t.triggerChange()}removeFilterAt(e){const{widgetMap:{pickers:t},filters:n}=this;t.remove(t.childItems[e]),n.splice(e,1),this.triggerChange()}updateStoreFilter(){var e;this._isUpdatingStore=!0,null===(e=this.store)||void 0===e||e.filter(),this._isUpdatingStore=!1}get value(){return this.filters}triggerChange(){const{filters:e}=this,t=e.filter(((e,t)=>this.getPickerRow(t).widgetMap.filterPicker.isValid));this.trigger("change",{filters:e,validFilters:t})}activateAll(){this.setAllActiveStatus(!0)}deactivateAll(){this.setAllActiveStatus(!1)}setAllActiveStatus(e){const t=this,{_filters:n,store:r}=t;n.forEach(((n,i)=>{if(e===n.disabled){const{filterPicker:o,activeCheckbox:s}=t.getPickerRow(i).widgetMap;n.disabled=!e,o.onFilterChange(),s.checked=e,e&&r&&o.isValid&&r.addFilter(n,!0)}})),t.updateStoreFilter()}}gp.initClass(),gp._$name="FieldFilterPickerGroup";class pp extends(Ka.mixin(tc)){static $name="FieldSet";static type="fieldset";static get configurable(){return{bodyTag:"fieldset",focusable:!1,inline:null,inlineInternal:null,layout:{type:"box",horizontal:!1}}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}get bodyConfig(){const e=super.bodyConfig,{className:t}=e,{inlineInternal:n,hasLabel:r,title:i}=this;return delete e.html,t["b-inline"]=n,t["b-fieldset-has-label"]=r,i&&(e.children={legendElement:{tag:"legend",text:i,class:{"b-fieldset-legend":1}}}),e}compose(){const{inlineInternal:e,label:t,labelCls:n,labelWidth:r}=this;return{class:{"b-field":t,"b-vbox":!e},children:{"labelElement > headerElement":t?{tag:"label",html:t,class:{"b-label":1,"b-align-start":1,[n]:n},style:{width:Lr.unitize("width",r)[1]}}:null}}}syncInlineInternal(){this.inlineInternal=this.inline??(null!=this.label&&"before"===this.labelPosition)}updateDisabled(e,t){super.updateDisabled(e,t),this.eachWidget((t=>{t.disabled=e}),!1)}updateInline(){this.syncInlineInternal()}updateInlineInternal(e){this.layout.horizontal=e}updateLabel(){this.syncInlineInternal()}updateLabelPosition(){this.syncInlineInternal()}}pp.initClass(),pp._$name="FieldSet";class mp extends lc{static $name="FileField";static type="filefield";static get configurable(){return{multiple:null,accept:null,inputType:"file",attributes:["multiple","accept"]}}get files(){return this.input.files}pickFile(){this.input.click()}get multiple(){return this._multiple?"":null}clear(){this.input.value=null}triggerChange(e){this.triggerFieldChange({event:e,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}}mp.initClass(),mp._$name="FileField";class fp extends El{static $name="FilePicker";static type="filepicker";static get defaultConfig(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}construct(e={}){const t=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"L{FilePicker.file}",localeClass:this},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),super.construct(e),t.button.ion({click:t.onButtonClick,thisObj:t}),t.fileField.ion({change:t.onFileFieldChange,thisObj:t}),t._thisIsAUsedExpression(t.fileTip)}get button(){return this.widgetMap.fileButton}get fileField(){return this.widgetMap.fileField}get files(){return this.fileField.files}get fileTip(){const e=this;return e._fileTip||(e._fileTip=new ec({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",internalListeners:{beforeshow(){const t=this,n=e.files;return!(!n||!n.length)&&(t.html=`${Array.from(n).map((e=>e.name)).join("<br>")}`,!0)}}}))}clear(){const e=this;e.fileField.clear(),e.button.badge="",e.trigger("clear")}onButtonClick({event:e}){this.fileField.pickFile(),e.preventDefault()}onFileFieldChange({valid:e}){const t=this;t.button.badge=t.files.length||"",t.triggerFieldChange({files:t.files,valid:e})}}fp.initClass(),fp._$name="FilePicker";class vp extends ac{static $name="FilterField";static type="filterfield";static get configurable(){return{field:null,store:null,filterFunction:null,clearable:!0,revertOnEscape:!0,ignoreParentReadOnly:!0,keyStrokeChangeDelay:100,onChange({value:e}){const{store:t,field:n,filterFunction:r}=this;if(t){const i=`${n||this.id}-Filter`;if(0===e.length)t.removeFilter(i);else{let o;r?o=t=>r(t,e):(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=t=>{var r;return null===(r=t.getValue(n))||void 0===r?void 0:r.match(new RegExp(e,"i"))}),t.filter({id:i,filterBy:o})}}}}}updateValue(e,t){super.updateValue(e,t),e&&this.isConfiguring&&this.onChange({value:e})}}vp.initClass(),vp._$name="FilterField";const bp=[{ref:"cancelButton",cls:"b-messagedialog-cancelbutton b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick"},{ref:"okButton",cls:"b-messagedialog-okbutton b-raised b-blue",text:"L{Object.Ok}",onClick:"up.onOkClick"}];s.isWindows&&bp.reverse();class yp extends Xa{static $name="MessageDialog";static type="messagedialog";static get configurable(){return{centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:" ",lazyItems:{$config:["lazy"],value:[{cls:"b-messagedialog-message",ref:"message"},{type:"textfield",cls:"b-messagedialog-input",ref:"input"}]},showClass:null,bbar:{overflow:null,items:bp}}}construct(){this.okButton=this.yesButton=1,this.cancelButton=3,super.construct(...arguments)}destroy(){}async confirm(){return this.showDialog("confirm",...arguments)}async alert(){return this.showDialog("alert",...arguments)}async prompt({textField:e}){const t=this.widgetMap.input;return ul.reconfigure(t,e),t.value="",this.showDialog("prompt",...arguments)}showDialog(e,{message:t="",title:n=" ",cancelButton:r,okButton:i,rootElement:o=document.body}){const s=this;return s.rootElement=o,s.getConfig("lazyItems"),s.title=s.optionalL(n),s.widgetMap.message.html=s.optionalL(t),s.showClass=`b-messagedialog-${e}`,i&&(i="string"==typeof i?{text:i}:i),r&&(r="string"==typeof r?{text:r}:r),i=Object.assign({},s.widgetMap.okButton.initialConfig,i),r=Object.assign({},s.widgetMap.cancelButton.initialConfig,r),i.text=s.optionalL(i.text),r.text=s.optionalL(r.text),ul.reconfigure(s.widgetMap.okButton,i),ul.reconfigure(s.widgetMap.cancelButton,r),s.show(),s.promise=new Promise((e=>{s.resolve=e}))}show(){const e=Lr.getActiveElement(this.element);return this.owner=this.element.contains(e)?null:yp.fromElement(document.activeElement),super.show(...arguments)}updateShowClass(e,t){const{classList:n}=this.element;t&&n.remove(t),e&&n.add(e)}doResolve(e){const t=this,{resolve:n}=t;if(n){const r="b-messagedialog-prompt"===t.showClass;if(r&&e===t.okButton&&!t.widgetMap.input.isValid)return;t.resolve=t.reject=t.promise=null,n(r?{button:e,text:t.widgetMap.input.value}:e),t.hide()}}onInternalKeyDown(e){"Escape"===e.key?(e.stopImmediatePropagation(),this.onCancelClick()):"Enter"!==e.key||e.target.closest(".b-button")||(e.stopImmediatePropagation(),e.preventDefault(),this.onOkClick()),super.onInternalKeyDown(e)}onOkClick(){this.doResolve(Cp.okButton)}onCancelClick(){this.doResolve(Cp.cancelButton)}}yp.initClass();const Cp=new Proxy({},{get(e,t){const n=e.instance||(e.instance=new yp({rootElement:document.body})),r=n[t];return"function"==typeof r?r.bind(n):r}});class wp extends Na{static $name="PagingToolbar";static type="pagingtoolbar";static get defaultConfig(){return{store:null,defaults:{localeClass:this},items:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-icon-first",weight:100,tooltip:"L{PagingToolbar.firstPage}"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-icon-previous",weight:110,tooltip:"L{PagingToolbar.prevPage}"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange",highlightExternalChange:!1,weight:120},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text",weight:130},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-icon-next",weight:140,tooltip:"L{PagingToolbar.nextPage}"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-icon-last",weight:150,tooltip:"L{PagingToolbar.lastPage}"},separator:{type:"widget",cls:"b-toolbar-separator",weight:151},reloadButton:{onClick:"up.onReloadClick",icon:"b-icon-reload",weight:160,tooltip:"L{PagingToolbar.reload}"},spacer:{type:"widget",cls:"b-toolbar-fill",weight:161},dataSummary:{type:"widget",cls:"b-toolbar-text",weight:170}}}}set parent(e){super.parent=e,this.store||(this.store=e.store)}get parent(){return super.parent}set store(e){const t=this;t.detachListeners("store"),t._store=e,e&&(e.ion({name:"store",beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t}),e.isLoading&&t.onStoreBeforeRequest())}get store(){return this._store}onStoreBeforeRequest(){this.eachWidget((e=>e.disable()))}updateLocalization(){this.updateSummary(),super.updateLocalization()}updateSummary(){const e=this,{pageCount:t,dataSummary:n}=e.widgetMap;let r=0,i=0,o=0,s=0,l=0;if(e.store){const{store:t}=e,{pageSize:n,currentPage:a}=t;r=t.count,i=t.lastPage,l=t.allCount,o=Math.max(0,(a-1)*n+1),s=Math.min(l,o+n-1)}t.html=e.L("L{pageCountTemplate}")({lastPage:i}),n.html=r?e.L("L{summaryTemplate}")({start:o,end:s,allCount:l}):e.L("L{noRecords}")}onStoreChange(){const e=this,{widgetMap:t,store:n}=e,{count:r,lastPage:i,currentPage:o}=n,{pageNumber:s,pageCount:l,firstPageButton:a,previousPageButton:c,nextPageButton:d,lastPageButton:u,dataSummary:h}=t;e.eachWidget((e=>e.enable())),s.value=o,s.max=i,h.disabled=s.disabled=l.disabled=!r,a.disabled=c.disabled=o<=1||!r,d.disabled=u.disabled=o>=i||!r,e.updateSummary()}onPageNumberChange({value:e}){this.store.currentPage!==e&&this.store.loadPage(e)}onFirstPageClick(){this.store.loadPage(1)}onPreviousPageClick(){this.store.previousPage()}onNextPageClick(){this.store.nextPage()}onLastPageClick(){this.store.loadPage(this.store.lastPage)}onReloadClick(){this.store.loadPage(this.store.currentPage)}}wp.initClass(),wp._$name="PagingToolbar";const{dockIsHorz:xp}=la.maps,Sp={top:0,down:0,left:1,bottom:2,up:2,right:3},Ep={up:{from:"translate(0,0)",to:"translate(0,-100%)"},down:{from:"translate(0,0)",to:"translate(0,100%)"},left:{from:"translate(0,0)",to:"translate(-100%,0)"},right:{from:"translate(0,0)",to:"translate(100%,0)"}};class Rp extends(la.mixin(ai)){static $name="PanelCollapserOverlay";static type="overlay";static get configurable(){return{autoCloseDelay:1e3,autoClose:!0,revealing:{value:null,$config:null,default:!1},recollapseTool:{type:"collapsetool",cls:"b-recollapse",collapsify:"overlay",handler(){var e;null===(e=this.collapsible)||void 0===e||e.toggleReveal()}}}}static get delayable(){return{doAutoClose:0}}doAutoClose(){this.toggleReveal(!1)}updateAutoCloseDelay(e){const{doAutoClose:t}=this;(t.suspended=null==e||e<0)||(t.delay=e,t.immediate=!e)}changeRecollapseTool(e){const t=this,{panel:n}=t;if(t.isConfiguring||t.isDestroying||!n||n.isDestroying)return e;n.tools={recollapse:e}}beforeCollapse(e){if(!1===super.beforeCollapse(e))return!1;this.panel.revealed&&(e.animation=null)}applyHeaderDock(e,t=!0){var n;null===(n=this.panel)||void 0===n||n.recompose(),super.applyHeaderDock(e,t)}collapseBegin(e){const t=this,{collapseDir:n,innerElement:r}=t,{animation:i}=e,{collapseTool:o,panel:s}=t;t.configuredWidth=s._lastWidth,t.configuredHeight=s._lastHeight,t.applyHeaderDock(!0),t.lockInnerSize(),null==o||o.element.classList.add("b-collapsed"),i&&(s.element.classList.add("b-collapsing"),i.element=r,i.transform=Ep[n],e.animation=Pl.run(i))}onComplete(e){var t,n;super.onComplete(e);const r=this,{panel:i}=r,{element:o}=i;r.autoCloseLeaveDetacher=null===(t=r.autoCloseLeaveDetacher)||void 0===t?void 0:t.call(r),r.autoCloseClickDetacher=null===(n=r.autoCloseClickDetacher)||void 0===n?void 0:n.call(r),r.doAutoClose.cancel(),"reveal"===e&&r.autoClose&&(i.containsFocus&&(r.autoCloseLeaveDetacher=Gn.on({element:o,mouseenter:e=>{r.doAutoClose.cancel()},mouseleave:e=>{r.doAutoClose()}})),r.autoCloseClickDetacher=Gn.on({element:document.body,thisObj:i,mousedown:e=>{var t;i.owns(e)||null!==(t=r.revealer)&&void 0!==t&&t.contains(e.target)||null==r.autoCloseDelay||r.doAutoClose.now()}}))}expandBegin(e){const t=this,{animation:n}=e,{collapseDir:r,collapseTool:i,innerElement:o,panel:s}=t,{element:l}=s;l.classList.remove("b-collapsed","b-collapsing"),t.restoreConfiguredSize(),t.lockInnerSize(!1),t.lockInnerSize(),null==i||i.element.classList.remove("b-collapsed"),n&&(l.classList.add("b-collapsed","b-expanding"),n.element=o,n.transform={from:Ep[r].to,to:Ep[r].from},e.animation=Pl.run(n))}expandEnd(e){super.expandEnd(e);const{panel:t}=this;e.completed&&(t.revealed=!1),t.element.classList.remove("b-expanding")}expandRevert(e){super.expandRevert(e),this.panel.element.classList.add("b-expanding")}get innerElement(){return this.panel.overlayElement}get innerSizeElement(){return this.panel.element}get toolsConfig(){const{direction:e}=this,t=super.toolsConfig,n=this.recollapseTool;return n?{...t,recollapse:n&&Yt.assign({direction:e.toLowerCase()},n)}:t}lockInnerSize(e=!0){const t=this,{panel:n}=t,r=e&&n.rectangle(),i=e?[0,0,0,0]:"",o=super.lockInnerSize(e);return e&&(i[Sp[t.collapseDir]]=`-${r[t.collapseDim]+10}px`),n.element.style.clipPath=e?`inset(${i.join(" ")})`:"",o}onOverlayTransitionDone(e){const t=this,{panel:n}=t;e.srcElement===n.overlayElement&&t.revealing&&(t.revealing=!1,t.onComplete(n.revealed?"reveal":"unreveal"))}onRevealerClick(){this.toggleReveal()}toggleReveal(e){const{panel:t}=this,{element:n}=t;t.collapsed&&(this.revealer=Lr.getActiveElement(n),null==e&&(e=!t.revealed),t.revealed!==e&&!1!==t.trigger("beforeToggleReveal",{reveal:e})&&(!e&&n.contains(this.revealer)&&t.revertFocus(!0),this.revealing=!0,t.revealed=e))}updateRevealing(e){const t=this,{panel:n}=t,r=/left|right/i.test(t.collapseDir)?"height":"width";n&&(t.innerElement.style[r]="0px",t.innerElement.style[`min-${r}`]="100%",n.element.classList[e?"add":"remove"]("b-panel-overlay-revealing"))}wrapCollapser(e,t){var n;const r=this,{collapseDir:i,panel:o}=r,{expandedHeaderDock:s,header:l,uiClassList:a}=o,c=null===(n=o.tools)||void 0===n?void 0:n.recollapse,[d,u]=r.splitHeaderItems({as:"element",dock:r.collapseDock}),h=xp[s],g=o.hasHeader?o.title||(null==l?void 0:l.title)||" ":null;return c&&(c.direction=i),["overlayElement",{class:{...a,[`b-panel-overlay-header-${s}`]:1,[`b-panel-overlay-${i}`]:1,[`b-${h?"h":"v"}box`]:1,"b-panel-overlay":1,"b-box-center":1},listeners:{transitionend:e=>r.onOverlayTransitionDone(e),transitioncancel:e=>r.onOverlayTransitionDone(e)},children:{overlayHeaderElement:g&&{tag:"header",class:new wn({...a,[`b-dock-${s}`]:1,"b-panel-header":1,"b-panel-overlay-header":1},null==l?void 0:l.cls),children:[...d,{reference:"overlayTitleElement",html:g,class:{...a,[`b-align-${(null==l?void 0:l.titleAlign)||"start"}`]:1,"b-header-title":1}},...u]},[e]:t}}]}}Rp.initClass(),Rp._$name="PanelCollapserOverlay";class Tp extends lc{static $name="PasswordField";static type="passwordfield";static alias="password";construct(e={}){e.inputType="password",super.construct(...arguments),this.element.classList.add("b-textfield")}}Tp.initClass(),Tp._$name="PasswordField";class Dp extends Vg{static $name="Radio";static type="radio";static alias="radiobutton";static get configurable(){return{inputType:"radio",clearable:null,uncheckedValue:i}}get textLabelCls(){return super.textLabelCls+" b-radio-label"}internalOnClick(e){!1!==super.internalOnClick(e)&&this.checked&&this.clearable&&(this.checked=!1)}updateName(e){this.toggleGroup=e}updateClearable(){}}Dp.initClass(),Dp._$name="Radio";class Mp extends pp{static $name="RadioGroup";static type="radiogroup";static get configurable(){return{defaultType:"radio",clearable:null,name:null,options:{value:null,$config:{merge:"items"}},defaultBindProperty:"value"}}get existingOptions(){const{name:e}=this;return this.ensureItems().filter((t=>t.name===e))}get refPrefix(){return`${this.name||this.ref||this.id}_`}get selected(){return this.existingOptions.filter((e=>e.input.checked))[0]||null}get value(){const{selected:e}=this;return e?e.checkedValue:null}set value(e){this.existingOptions.forEach((t=>{t.isConfiguring=this.isConfiguring,t.checked=t.checkedValue===e,t.isConfiguring=!1}))}ensureItems(){return this.getConfig("options"),super.ensureItems()}changeOptions(e,t){if(!(e&&t&&Yt.isDeeplyEqual(t,e)))return e}convertOption(e,t,n){const r=this,{name:i}=r,o={name:i,type:"radio",value:e===r.value,ref:`${r.refPrefix}${e}`,checkedValue:e};return"string"==typeof t?o.text=t:Yt.assign(o,t),n?ul.reconfigure(n,o):o}isOurRadio(e){return e.isRadio&&e.name===this.name}isolateFieldChange(e){return this.isOurRadio(e)}onChildAdd(e){super.onChildAdd(e),this.isOurRadio(e)&&e.ion({name:e.id,beforeChange:"onRadioItemBeforeChange",change:"onRadioItemChange",click:"onRadioClick",thisObj:this})}onChildRemove(e){this.isOurRadio(e)&&this.detachListeners(e.id),super.onChildRemove(e)}onRadioClick(e){const{source:t}=e;t.checked&&this.clearable&&null==t.clearable&&(t.checked=!1)}onRadioItemBeforeChange(e){if(e.checked){const t=this,{lastValue:n}=t;if(!t.reverting&&!1===t.trigger("beforeChange",t.wrapRadioEvent(e))&&null!=n&&n!==t.value)return t.reverting=!0,e.source.uncheckToggleGroupMembers(),t.value=n,t.lastValue=n,t.reverting=!1,!1}}onRadioItemChange(e){const t=this;e.checked&&!t.reverting&&(t.triggerFieldChange(t.wrapRadioEvent(e)),t.lastValue=t.value)}wrapRadioEvent(e){return{from:e,item:e.source,userAction:e.userAction,lastValue:this.lastValue,value:this.value}}updateOptions(){const e=this,{options:t,refPrefix:n}=e,r=e.existingOptions.reduce(((e,t)=>(e[t.ref.substring(n.length)]=t,e)),{});let i,o,s=0;if(t)for(i in t)o=e.convertOption(i,t[i],r[i]),delete r[i],e.insert(o,s++);const l=Object.values(r);null!=l&&l.length&&(e.remove(l),l.forEach((e=>e.destroy())))}}Mp.initClass(),Mp._$name="RadioGroup";const Fp={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1};class Ip extends ul{static $name="Slider";static type="slider";static get configurable(){return{text:null,showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:50,unit:null,thumbSize:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip",align:"b-t",anchor:!1,axisLock:!0}},localizableProperties:["text"],triggerChangeOnInput:null,defaultBindProperty:"value"}}compose(){const{id:e,min:t,max:n,showValue:r,step:i,text:o,value:s,unit:l="",disabled:a}=this,c=`${e}-input`,d=Boolean(o||r);return{class:{"b-has-label":d,"b-text":d,"b-disabled":a},children:{input:{tag:"input",type:"range",id:c,reference:"input",[a?"disabled":""]:a,min:t,max:n,step:i,value:s,listeners:{input:"onInternalInput",change:"onInternalChange",mouseover:"onInternalMouseOver",mouseout:"onInternalMouseOut"}},label:{tag:"label",for:c,html:r?o?`${o} (${s}${l})`:s+l:o}}}}get focusElement(){return this.input}get percentProgress(){return(this.value-this.min)/(this.max-this.min)*100}onInternalKeyDown(e){!this.readOnly&&Fp[e.key]&&e.stopImmediatePropagation()}onInternalChange(){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}onInternalInput(){const e=this;e.readOnly?e.input.value=e.value:(e.value=parseInt(e.input.value,10),e.trigger("input",{value:e.value}),e.triggerChangeOnInput&&e.triggerChange(e))}onInternalMouseOver(){var e;const t=this,n=t.rtl?100-t.percentProgress:t.percentProgress;null===(e=t.tooltip)||void 0===e||e.showBy({target:bn.from(t.input).inflate(t.thumbSize/2,-t.thumbSize/2),align:`b-t${Math.round(n)}`})}onInternalMouseOut(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}triggerChange(e){this.triggerFieldChange({value:this.value,valid:!0,userAction:e})}updateMax(e){const t=this;t.input&&t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))}updateMin(e){const t=this;t.input&&t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))}changeTooltip(e,t){return e&&(e.owner=this),this.showTooltip?ec.reconfigure(t,e,{owner:this,defaults:{forElement:this.input,html:String(this.value)+(this.unit??"")}}):null}changeValue(e){const{min:t,step:n}=this;return(e=Math.min(Math.max(e,t),this.max))>t?t+Yt.roundTo(e-t,n):Yt.roundTo(e,n)}updateValue(e){const t=this,{input:n,_tooltip:r}=t;r&&(r.html=t.value+(t.unit??"")),n&&n.value!==String(e)&&(n.value=e,t.triggerChange(!1)),t.updateUI()}updateUI(){var e,t;const n=this;(null===(e=n._tooltip)||void 0===e?void 0:e.isVisible)&&(null===(t=n._tooltip)||void 0===t||t.alignTo({target:bn.from(n.input).inflate(n.thumbSize/2,-n.thumbSize/2),align:`b-t${Math.round(n.percentProgress)}`}))}}Ip.initClass(),Ip._$name="Slider";class kp extends Vg{static $name="SlideToggle";static type="slidetoggle";static get properties(){return{toggledCls:"b-slidetoggle-checked"}}construct(e){null!=e&&e.checked&&(e.cls=(e.cls||"")+" "+this.constructor.properties.toggledCls),super.construct(e)}get innerElements(){const e=super.innerElements;return e.splice(1,0,this.toggleElement),this.text?e[e.length-1].class="b-slidetoggle-label":e.pop(),e}get toggleElement(){return{class:"b-slidetoggle-toggle",reference:"slideToggle",children:[{class:"b-slidetoggle-thumb",reference:"slideThumb"}]}}internalOnChange(){super.internalOnChange(),this.element.classList[this.value?"add":"remove"](this.toggledCls)}}kp.initClass(),kp._$name="SlideToggle";const Op=["b-horizontal","b-vertical"],Lp=e=>"flex"===Lr.getStyleValue(e.parentElement,"display")&&(parseInt(Lr.getStyleValue(e,"flex-basis"),10)||parseInt(Lr.getStyleValue(e,"flex-grow"),10)),Ap={horizontal:!1,vertical:!0};class Pp extends ul{static $name="Splitter";static type="splitter";static get configurable(){return{orientation:"auto",vertical:null,containerElement:{$config:"nullify",value:null},nextNeighbor:{$config:"nullify",value:null},previousNeighbor:{$config:"nullify",value:null}}}static get delayable(){return{syncState:"raf"}}doDestroy(){var e;null===(e=this.mouseDetacher)||void 0===e||e.call(this),super.doDestroy()}compose(){return{class:{"b-splitter":1},listeners:{pointerdown:"onMouseDown",mouseenter:"syncState",...!s.supportsPointerEvents&&{mousedown:"onMouseDown",touchstart:"onMouseDown"}}}}get currentOrientation(){return this.vertical?"vertical":"horizontal"}getSibling(e=!0){let t,{element:n}=this;for(;!t&&(n=n[(e?"next":"previous")+"ElementSibling"]);)n.isConnected&&!Lr.isVisible(n)||(t=n);return t}get nextWidget(){let e,{element:t}=this;for(;!e&&(t=t.nextElementSibling);)e=ul.fromElement(t,this.element.parentElement);return e}get previousWidget(){let e,{element:t}=this;for(;!e&&(t=t.previousElementSibling);)e=ul.fromElement(t,this.element.parentElement);return e}updateContainerElement(e){var t;const n=this;n.stateDetector=null===(t=n.stateDetector)||void 0===t?void 0:t.disconnect(),e&&(n.stateDetector=new MutationObserver((()=>n.syncState())),n.stateDetector.observe(e,{attributes:!0,childList:!0}))}updateNextNeighbor(e){this.watchNeighbor(e,"next")}updatePreviousNeighbor(e){this.watchNeighbor(e,"previous")}watchNeighbor(e,t){this.detachListeners(t),null==e||e.ion({name:t,thisObj:this,collapse:"syncState",expand:"syncState",hide:"syncState",show:"syncState"})}updateOrientation(){this.syncState.now()}updateVertical(e){var t;const n=null===(t=this.element)||void 0===t?void 0:t.classList;null==n||n.add(Op[e?1:0]),null==n||n.remove(Op[e?0:1])}syncState(){const e=this,{element:t,nextWidget:n,previousWidget:r}=e;let i=Ap[e.orientation]??null;if(e.nextNeighbor=n,e.previousNeighbor=r,e.disabled=n&&(n.collapsible&&n.collapsed||n.hidden)||r&&(r.collapsible&&r.collapsed||r.hidden),null!==i&&n&&r)e.containerElement=null;else if(e.containerElement=t.parentElement,e.rendered&&t.offsetParent){const e=Lr.getStyleValue(t.parentElement,"flex-direction");if(e)i=!e.startsWith("column");else{const e=t.previousElementSibling,n=t.nextElementSibling;if(!e||!n)return;const r=e.getBoundingClientRect(),o=n.getBoundingClientRect(),s=r.top<o.top?r:o,l=s===o?r:o;i=s.top===l.top}}e.vertical=i}onMouseDown(e){var t;e.preventDefault(),e.touches&&(e=e.touches[0]);const n=this,{element:r,nextNeighbor:i,previousNeighbor:o}=n,l=o?o.element:n.getSibling(!1),a=i?i.element:n.getSibling(),c=Lp(l),d=Lp(a),u=[];null===(t=n.mouseDetacher)||void 0===t||t.call(n);for(const e of r.parentElement.children)Lp(e)&&e!==r&&u.push({element:e,width:e.offsetWidth,height:e.offsetHeight});n.context={startX:e.pageX,startY:e.pageY,prevWidth:l.offsetWidth,prevHeight:l.offsetHeight,nextWidth:a.offsetWidth,nextHeight:a.offsetHeight,prevHasFlex:c,nextHasFlex:d,flexed:u,prev:l,next:a};const h={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:n};s.supportsPointerEvents||(h.mousemove=h.touchmove="onMouseMove",h.mouseup=h.touchend="onMouseUp"),r.classList.add("b-moving"),n.mouseDetacher=Gn.on(h),n.trigger("splitterMouseDown",{event:e})}onMouseMove(e){const t=this,{context:n,nextWidget:r,previousWidget:i}=t,o=n.prev.style,s=n.next.style,l=(e.pageX-n.startX)*(t.rtl?-1:1),a=e.pageY-n.startY;if(e.preventDefault(),Object.assign(n,{deltaX:l,deltaY:a}),n.started||(n.started=!0,t.trigger("dragStart",{context:n,event:e}),n.flexed.forEach((e=>{e.element.style.flexGrow=t.vertical?e.width:e.height,e.element.style.flexBasis="0"}))),t.vertical){const e=n.prevWidth+l,t=n.nextWidth-l;n.prevHasFlex?o.flexGrow=e:i?i.width=e:o.width=`${e}px`,n.nextHasFlex?s.flexGrow=t:r?r.width=t:s.width=`${t}px`}else{const e=n.prevHeight+a,t=n.nextHeight-a;n.prevHasFlex?o.flexGrow=e:i?i.height=e:o.height=`${e}px`,n.nextHasFlex?s.flexGrow=t:r?r.height=t:s.height=`${t}px`}t.trigger("drag",{context:n,event:e})}onMouseUp(e){var t;const n=this;null===(t=n.mouseDetacher)||void 0===t||t.call(n),n.mouseDetacher=null,n.element.classList.remove("b-moving"),n.context.started&&n.trigger("drop",{context:n.context,event:e}),n.context=null}render(){super.render(...arguments),this.syncState.now(),null===this.vertical&&this.syncState()}}Pp.initClass(),Pp._$name="Splitter";class _p extends Ma{static $name="Tab";static type="tab";static get configurable(){return{active:null,index:null,isFirst:null,isLast:null,item:{value:null,$config:"nullify"},itemCls:null,tabPanel:null,titleProperty:"text",titleSource:"title",role:"tab"}}compose(){const{active:e,cls:t,index:n,isFirst:r,isLast:i}=this;return{tabindex:0,"aria-selected":e,"aria-setsize":this.owner.visibleChildCount,"aria-posinset":n+1,class:{"b-tabpanel-tab":1,"b-active":e,"b-tab-first":r,"b-tab-last":i,...t},dataset:{index:n}}}updateIndex(e){this.isFirst=!e}updateItem(e,t){var n,r;const i=this;(null==t?void 0:t.tab)===i&&(t.tab=null),e&&(e.tab=i,i[i.titleProperty]=e[i.titleSource],i.itemCls=e.cls,i.ariaElement.setAttribute("aria-controls",e.id),e.role="tabpanel"),null===(n=i.itemChangeDetacher)||void 0===n||n.call(i),i.itemChangeDetacher=e&&Te.after(e,"onConfigChange","onItemConfigChange",i,{return:!1}),null===(r=i.itemHideDetacher)||void 0===r||r.call(i),i.itemHideDetacher=null==e?void 0:e.ion({beforeChangeHidden:"onItemBeforeChangeHidden",beforeHide:"onItemBeforeHide",beforeUpdateDisabled:"onItemBeforeUpdateDisabled",thisObj:i,prio:1e3}),i.syncMinMax()}updateItemCls(e,t){const{element:n}=this,r=n&&wn.from(null==n?void 0:n.classList,!0);n&&(r.remove(t).add(e),n.className=r.value)}updateRotate(e,t){!e!=!t&&this.syncMinMax()}syncMinMax(){const e=this,{rotate:t,tabPanel:n}=e;let{_minWidth:r,_minHeight:i,_maxWidth:o,_maxHeight:s}=e;if(n){const{tabMinWidth:l,tabMaxWidth:a}=n;null!=l&&(t?(r===l&&(r=null),i=l):(i===l&&(i=null),r=l)),null!=a&&(t?(o===a&&(o=null),s=a):(s===a&&(s=null),o=a)),e.minWidth=r,e.minHeight=i,e.maxWidth=o,e.maxHeight=s}}onItemBeforeChangeHidden({source:e,hidden:t}){if(!e.$isDeactivating&&!e.$isActivating){const{tabPanel:n}=this;this.hidden=t,t&&e===n.activeItem&&n.activateAvailableTab(e)}}onItemBeforeHide(){this.item.$isDeactivating||this.hide()}onItemBeforeUpdateDisabled({source:e,disabled:t}){const{tabPanel:n}=this;this.disabled=t,e===n.activeItem&&n.activateAvailableTab(e)}onItemConfigChange({name:e,value:t}){e===this.titleSource&&(this[this.titleProperty]=t)}}_p.initClass(),_p._$name="Tab";const $p=e=>e.isTab;class Np extends Na{static $name="TabBar";static type="tabbar";static get configurable(){return{defaultType:"tab",overflow:"scroll",role:"tablist",ignoreParentReadOnly:!0}}get firstTab(){return this.tabAt(0)}get lastTab(){return this.tabAt(-1)}get tabCount(){return this._items.countOf($p)}get tabs(){return H.from(this._items,$p)}compose(){return{children:{toolbarContent:{class:{"b-tabpanel-tabs":1}}}}}indexOfTab(e){return this._items.indexOf(e,$p)}onChildAdd(e){super.onChildAdd(e),null==e.index&&this.syncTabs()}onChildRemove(e){super.onChildRemove(e),this.syncTabs()}onFocusIn(){const{activeIndex:e}=this.owner;isNaN(e)||this.tabs[e].focus()}syncTabs(){const{tabs:e}=this;for(let t=0,n=e.length;t<n;++t)e[t].index=t,e[t].isFirst=!t,e[t].isLast=t===n-1}tabAt(e){return this._items.find($p,e)||null}}Np.initClass(),Np._$name="TabBar";const Hp=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"];class Vp extends gl{static $name="Card";static type="card";static configurable={containerCls:"b-card-container",itemCls:"b-card-item",hideChildHeaderCls:"b-hide-child-headers",animateCardChange:!0,activeItem:null,activeIndex:null};onChildAdd(e){super.onChildAdd(e);const t=this,{activeItem:n,owner:r}=t,i=null!=r.activeIndex?r.activeIndex:t.activeIndex||0,o=r.items.indexOf(e),s=null!=n?e===n:o===i;e.ion({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t}),s?(t._activeIndex=o,t._activeItem=e,e.show()):(e.$isDeactivating=!0,e.hide(),e.$isDeactivating=!1)}onChildRemove(e){super.onChildRemove(e);const t=this;t._activeItem===e&&t.activateSiblingOf(e),t._activeIndex=t.owner.items.indexOf(t._activeItem),e.un({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t})}onBeforeChildShow({source:e}){if(!this.owner.isConfiguring&&!e.$isActivating)return this.activeItem=e,!1}onBeforeChildHide({source:e}){if(!this.owner.isConfiguring&&!e.$isDeactivating)return this.activateSiblingOf(e),!1}activateSiblingOf(e){const{owner:t}=this,n=t.items.slice(),r=n.indexOf(e);n.splice(r,1),this.activeIndex=Math.min(r,n.length-1)}setActiveItem(e,t=this.activeIndex,n){const r=this,{owner:i}=r,{items:o}=i,s=e instanceof ul,l=o[t],a=i.items[e=s?o.indexOf(e):parseInt(e,10)],c=!1!==(null==n?void 0:n.animation),d=!(null!=n&&n.silent),u={prevActiveIndex:t,prevActiveItem:l};if(a&&!a.$isActivating&&a!==l){var h;const o=l&&l.element,s=a&&a.element;if(r.animateDetacher){const e=r.animateDetacher.event;if(e.activeItem===a)return e.promise;r.animateDetacher(),e.prevActiveItem.element.classList.remove(...Hp),e.activeItem.element.classList.remove(...Hp),r.animateDetacher=null}if(u.activeIndex=e,u.activeItem=a,d&&!1===i.trigger("beforeActiveItemChange",u))return null;const g=r._activeIndex!==u.activeIndex;g&&(r._activeIndex=u.activeIndex),d&&(null===(h=i.onBeginActiveItemChange)||void 0===h||h.call(i,u)),g&&(r._activeIndex=u.prevActiveIndex),c&&o&&i.isVisible&&r.animateCardChange?u.promise=r.cardChangeAnimation=new Promise(((c,h)=>{const g=l.monitorResize;l.monitorResize=!1,r.contentElement.style.overflowX="hidden",l._hidden=!0,a.$isActivating=!0,a.show(),a.$isActivating=!1,o.classList.add(e>t?"b-slide-out-left":"b-slide-out-right"),s.classList.add(e<t?"b-slide-in-left":"b-slide-in-right"),i.isAnimating=!0,r.animateDetacher=Gn.onTransitionEnd({mode:"animation",element:s,thisObj:l,handler(){i.isAnimating=r.cardChangeAnimation=!1,r.animateDetacher?(r.animateDetacher=null,s.classList.remove(...Hp),o&&(o.classList.remove(...Hp),l.$isDeactivating=!0,l._hidden=!1,l.hide(),l.monitorResize=g,l.$isDeactivating=!1),r.contentElement.style.overflowX="",r.onActiveItemChange(u,c,!d)):r.setActiveItem(e,t,n)}}),r.animateDetacher.reject=h,r.animateDetacher.event=u})):(a.$isActivating=!0,a.show(),a.focus(),a.$isActivating=!1,l&&(l.$isDeactivating=!0,l.hide(),l.$isDeactivating=!1),r.onActiveItemChange(u,null,!d))}return u}onActiveItemChange(e,t,n){const r=this;r._activeItem=e.activeItem,r._activeIndex=e.activeIndex,!n&&r.owner.trigger("activeItemChange",e),r.owner.containsFocus&&e.activeItem.focus(),null==t||t(e)}renderChildren(){const{owner:e}=this;e.contentElement.classList.toggle(this.hideChildHeaderCls,e.suppressChildHeaders),super.renderChildren()}changeActiveIndex(e){const{owner:t}=this;return t.isConfiguring&&!t._items?e:Math.min(e,t.items.length-1)}updateActiveIndex(e,t){this.owner.isConfiguring||this.setActiveItem(e,t)}updateActiveItem(e){this.owner.isConfiguring||this.setActiveItem(e,this.activeIndex)}get isChangingCard(){return Boolean(this.animateDetacher)}}Vp.initClass(),Vp._$name="Card";const Bp=e=>e.maximized;class zp extends Ka{static $name="TabPanel";static type="tabpanel";static alias="tabs";static get configurable(){return{activeTab:0,animateTabChange:!0,autoHeight:!1,defaultType:"container",focusable:!1,itemCls:"b-tabpanel-item",layout:{type:"card"},suppressChildHeaders:!0,tabBar:{type:"tabbar",weight:-2e3},tabMinWidth:null,tabMaxWidth:null}}get activeIndex(){return this.layout.activeIndex}get activeItem(){return this.layout.activeItem}get activeTabItemIndex(){var e;const{activeTab:t,items:n,tabBar:r}=this;return n.indexOf(null===(e=r.tabs[t])||void 0===e?void 0:e.item)}get bodyConfig(){return Yt.merge({className:{"b-tabpanel-body":1}},super.bodyConfig)}get focusElement(){var e;const t=this.items[this.activeTab||0];return(null==t?void 0:t.focusElement)||(null==t||null===(e=t.tab)||void 0===e?void 0:e.focusElement)}get tabPanelBody(){return this.bodyElement}finalizeInit(){super.finalizeInit();const e=this,{activeTab:t,layout:n}=e,{activeIndex:r}=n,{tabs:i}=e.tabBar,o=t>=0&&t<i.length&&e.items.indexOf(i[t].item);if(i.length>0&&(!1===o||o<0))throw new Error(`Invalid activeTab ${t} (${i.length} tabs)`);o!==r&&n.setActiveItem(o,r,{animation:!1,silent:!0}),n.animateCardChange=e.animateTabChange}onChildAdd(e){if(super.onChildAdd(e),!this.initialItems){const t=this,{tabBar:n}=t,r=t.makeTabConfig(e),i=r&&(null==n?void 0:n.firstTab),o=i&&n._items,s=i&&H.from(t._items,(t=>t.tab||t===e)),l=i?s.indexOf(e)+o.indexOf(i):0;r&&n&&(i&&null==e.weight&&l<o.count-1?n.insert(r,l):n.add(r))}}onChildRemove(e){const{tab:t}=e,{items:n}=this;t&&(this.tabBar.remove(t),t.destroy()),e===this.activeItem&&(this._activeTab=null,n.length&&(this.activeTab=n[Math.min(this.activeIndex,n.length-1)])),super.onChildRemove(e)}isDisabledOrHiddenTab(e){const{tabs:t}=this.tabBar,n=null==t?void 0:t[e];return n&&(n.disabled||n.hidden)}findAvailableTab(e,t=1){const{tabs:n}=this.tabBar,r=n.length,i=Math.max(0,n.indexOf(e.tab));let o;i&&(t=-t);for(let e=1;e<=r&&(o=(i+(t<0?r:0)+e*t)%r,this.isDisabledOrHiddenTab(o));++e);return o}activateAvailableTab(e,t=1){this.activeTab=this.findAvailableTab(e,t)}changeActiveTab(e,t){const n=this,{tabBar:r,layout:i}=n,{tabCount:o}=r;if(e.isWidget||Yt.isObject(e)?(-1===n.items.indexOf(e)&&(e=n.add(e)),e=r.indexOfTab(e.tab)):e=parseInt(e,10),!n.initialItems&&o>0&&(e<-1||e>=o))throw new Error(`Invalid activeTab ${e} (${o} tabs)`);if(n.isDisabledOrHiddenTab(e)&&(e=n.findAvailableTab(e)),!i.animateCardChange||!i.cardChangeAnimation)return e;i.cardChangeAnimation.then((r=>{(null==r?void 0:r.activeIndex)!==e&&(n._activeTab=e,n.updateActiveTab(e,t))}))}async updateActiveTab(e,t){if(!this.initialItems){const{activeTabItemIndex:e,layout:r}=this;if(e>-1){const i=this.items[t],o=this.items[e];var n;if(r.activeItem!==o)r.animateCardChange&&await this.tabSelectionPromise,null!=i&&i.containsFocus&&i.tab.focus(),this.tabSelectionPromise=null===(n=r.setActiveItem(o))||void 0===n?void 0:n.promise}}}changeTabBar(e){return this.getConfig("strips"),this.strips={tabBar:e},this.strips.tabBar}makeTabConfig(e){const{tab:t}=e,n={item:e,type:"tab",tabPanel:this,disabled:Boolean(e.disabled),hidden:e.initialConfig.hidden,weight:e.weight||0,internalListeners:{click:"onTabClick",thisObj:this},localizableProperties:{text:!1}};return!1===t?null:Yt.isObject(t)?_p.mergeConfigs(n,t):n}updateItems(e,t){const n=this,{activeTab:r,initialItems:i}=n;let o,s=0;super.updateItems(e,t),i&&(o=Array.from(e,(e=>n.makeTabConfig(e))).filter((e=>{if(e)return e.index=s++,!0})),s&&(o[0].isFirst=!0,o[s-1].isLast=!0,o[r].active=!0,n.tabBar.add(o),n.activeTab=r))}updateTabMinWidth(e){var t;null===(t=this.tabBar)||void 0===t||t.items.forEach((t=>{t.isTab&&(t.minWidth=e)}))}updateTabMaxWidth(e){var t;null===(t=this.tabBar)||void 0===t||t.items.forEach((t=>{t.isTab&&(t.maxWidth=e)}))}updateAutoHeight(e){this.detachListeners("themeAutoHeight"),e&&Rn.ion({name:"themeAutoHeight",theme:"internalOnThemeChange",thisObj:this}),this.$measureHeight=e}applyAutoHeight(){const e=this,{layout:t,activeTab:n,element:r}=e,{animateCardChange:i}=t;t.animateCardChange=!1,e.height=null,e.up(Bp)||(e.height=Math.max(...e.items.map((t=>(e.activeTab=t,r.clientHeight))))+1),e.activeTab=n,t.animateCardChange=i,e.$measureHeight=!1}internalOnThemeChange(){this.isVisible?this.applyAutoHeight():this.$measureHeight=!0}onBeginActiveItemChange(e){const t=this.tabBar.tabs,{activeItem:n,prevActiveItem:r}=e;this.activeTab=t.indexOf(null==n?void 0:n.tab),null!=r&&r.tab&&(r.tab.active=!1),null!=n&&n.tab&&(n.tab.active=!0,n.tab.show())}onBeforeActiveItemChange(e){return this.trigger("beforeTabChange",e)}onActiveItemChange(e){this.trigger("tabChange",e)}onTabClick(e){this.activeTab=e.source.item}onPaint(){super.onPaint(...arguments),this.$measureHeight&&this.applyAutoHeight()}}zp.initClass(),zp._$name="TabPanel";class Wp extends lc{static $name="TextAreaField";static type="textareafield";static alias="textarea";static get configurable(){return{resize:"none",inputAttributes:{tag:"textarea"}}}updateResize(e){this.input.style.resize=e}}Wp.initClass(),Wp._$name="TextAreaField";class jp extends cc{static $name="TextAreaPickerField";static type="textareapickerfield";static get configurable(){return{picker:{type:"widget",tag:"textarea",cls:"b-textareapickerfield-picker",scrollAction:"realign",align:{align:"t-b",axisLock:!0},autoShow:!1},triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},resize:"none",inputType:null}}startConfigure(e){"boolean"==typeof e.inline&&P.deprecate("Core","6.0.0","TextAreaPickerField.inline config is no longer supported"),super.startConfigure(e)}get inputElement(){const e=super.inputElement;return e.readOnly="readonly",e.reference="displayElement",this.ariaElement="displayElement",e}get focusElement(){var e;return null!==(e=this._picker)&&void 0!==e&&e.isVisible?this.input:this.displayElement}get needsInputSync(){return this.displayElement[this.inputValueAttr]!==String(this.inputValue??"")}showPicker(){const e=this,{picker:t}=e;e.inline||(t.width=e.pickerWidth||e[e.pickerAlignElement].offsetWidth,super.showPicker(!0))}focusPicker(){this.input.focus()}onPickerKeyDown(e){const t=this,n=t.input;switch(e.key.trim()||e.code){case"Escape":return void t.picker.hide();case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide())}t.input=t.displayElement;const r=super.onPickerKeyDown(e);return t.input=n,r}syncInputFieldValue(e){this.displayElement&&(this.displayElement.value=this.inputValue),super.syncInputFieldValue(e)}changeValue(e){return null==e?"":e}changePicker(e,t){var n;const r=this,i=r.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width);if(e=jp.reconfigure(t,e?m.merge({owner:r,forElement:r[r.pickerAlignElement],align:{matchSize:null==i,anchor:r.overlayAnchor,target:r[r.pickerAlignElement]},id:r.id+"-input",style:{resize:r.resize},html:r.value??""},e):null,r)){const t=r.input=e.element;r.inputListenerRemover=Gn.on({element:t,thisObj:r,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}return e}}jp.initClass(),jp._$name="TextAreaPickerField";const Gp=[],Up=e=>"*"!==e[0],Yp=(e,t)=>{const n=e[t]||null;return delete e[t],n},qp=e=>e.responsiveRoot,Kp={number:e=>({width:t})=>t<=e&&e},Xp=e=>(delete e.once,{callback:Yp(e,"callback"),configs:e,when:Yp(e,"when")}),Jp=(e,...t)=>{const n=t.flatMap((e=>(null==e?void 0:e.once)||Gp)),r=e.mergeConfigs(...t),i=Xp(r);return i.once=n.length?Xp(e.mergeConfigs(...n)):null,i};const Qp="http://www.w3.org/2000/svg",Zp={bar:1,outline:2,text:3},em=(e,t)=>parseInt(e.order,10)-parseInt(t.order,10),tm=(e,t)=>parseInt(e.dataset.order,10)-parseInt(t.dataset.order,10),nm=e=>e.field,rm=()=>!1,im=/\s+/;class om extends ul{static type="histogram";static $name="Histogram";static get configurable(){return{data:null,values:null,series:null,topValue:null,element:{children:[{ns:Qp,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:Qp,tag:"g",reference:"scaledSvgGroup"},{ns:Qp,tag:"g",reference:"unscaledSvgGroup"}]}]},omitZeroHeightBars:!1,singleTextForAllBars:!0,monitorResize:!0,getRectClass:(e,t,n,r)=>"",getOutlineClass:(e,t)=>"",getBarTip(e,t,n,r){},getBarText:(e,t,n)=>"",getRectConfig:null,getBarTextRenderData:(e,t,n,r)=>e,getBarTextTip(e,t,n,r){}}}static properties={refreshSuspended:0};construct(e){const t=this;super.construct(e),t.scheduleRefresh=t.createOnFrame(t.refresh,[],t,!0),t.refresh()}set tip(e){var t;const n=this;null===(t=n.tip)||void 0===t||t.destroy(),n._tip=e?ec.new({owner:n,forElement:n.svgElement,forSelector:"rect",internalListeners:{beforeShow:"up.onBeforeTipShow"}},e):null}onElementResize(){super.onElementResize(...arguments);const e=this.svgElement.getBoundingClientRect();this.scaledSvgGroup.setAttribute("transform",`scale(${e.width} ${e.height})`)}onBeforeTipShow({source:e}){const t=parseInt(e.activeTarget.dataset.index);e.html=e.contentTemplate({histogram:this,index:t})}updateSeries(e){const t=this,n=t._series={};let r=0,i=0;for(const t in e)if(!1!==e[t]){const o=n[t]=m.merge({},e[t]);o.field||(o.field=t),o.type||(o.type="bar"),"order"in o||(o.order=10*Zp[o.type]+r),"index"in o||(o.index=r),"bar"===o.type&&(o.index=i++),o.id=t,r++}!t.topValue&&t._data&&(t.topValue=t.getDataTopValue(t._data)),t.refreshSuspended||t.scheduleRefresh()}getDataTopValue(e,t){const n=Object.values(t||this.series).map(nm);let r,i=0;for(let t=0,{length:o}=e;t<o;t++){r=e[t];for(let e=0,{length:t}=n;e<t;e++)i=Math.max(i,r[n[e]])}return i}updateData(e){const t=this;t._data=e,!t.topValue&&t._data&&t._series&&(t.topValue=t.getDataTopValue(e)),t.refreshSuspended||t.scheduleRefresh()}updateTopValue(e){const t=this;t._topValue=e,!e&&t._data&&(t._topValue=t.getDataTopValue(t._data)),t.refreshSuspended||t.scheduleRefresh()}scheduleRefresh(){}suspendRefresh(){this.refreshSuspended++}resumeRefresh(){this.refreshSuspended&&this.refreshSuspended--}refresh(e){const t=this,{series:n,_tip:r,topValue:i,singleTextForAllBars:o}=t,s=(null==e?void 0:e.args)||[],l=[],a=[];if(n){for(const e of Object.values(n).sort(em)){const n=t[`draw${A.capitalize(e.type)}`](e,...s);Array.isArray(n)?l.push.apply(l,n):l.push(n),o||"bar"!==e.type||a.push(...t.drawText(e,...s))}l.sort(tm),o?a.push(...t.drawText(null,...s)):a.sort(tm),Cs.sync({domConfig:{width:"100%",height:"100%",preserveAspectRatio:"none",dataset:{topValue:i},children:[{ns:Qp,tag:"g",reference:"scaledSvgGroup",children:l},{ns:Qp,tag:"g",reference:"unscaledSvgGroup",children:a}]},configEquality:rm,targetElement:t.svgElement}),r&&r.isVisible&&t.onBeforeTipShow({source:r})}}drawBar(e,...t){const n=this,{topValue:r,data:o,omitZeroHeightBars:s,barStyle:l}=n,{field:a,order:c,stretch:d}=e,{length:u}=o,h=1/u,g=[],p=A.createId(e.id),m=e.index,f=d?1:i;let v;for(let i=0,d=0,{length:u}=o;i<u;i++,d+=v){const u=o[i];let b=u.rectConfig={ns:Qp,tag:"rect",dataset:{}};const y=u[a],C=y?f||u.height||(y>r?r:y)/r:0,w=1-C,x=n.callback("getBarTip",n,[e,b,u,i,...t]);v=u.width||h,l?b.style=l:delete b.style,Object.assign(b.dataset,{index:i,order:c,series:p});const S={[`b-series-${p}`]:1,[`b-series-index-${m}`]:1},E=n.callback("getRectClass",n,[e,b,u,i,...t]);E&&E.split(im).forEach((e=>S[e]=1)),Object.assign(b,{x:d,y:w,width:v,height:C,class:S}),x?b.dataset.btip=x:delete b.dataset.btip,n.getRectConfig&&(b=n.getRectConfig(b,u,i,e,...t)),!b||!b.height&&s||g.push(b)}return g}changeGetRectConfig(e){return e?this.bindCallback(e):null}drawOutline(e,...t){const n=this,{topValue:r,data:i}=n,{field:o,order:s,id:l}=e,a=1/i.length,c=["M 0,1"],d={ns:Qp,tag:"path",dataset:{order:s,id:l}};let u,h="M",g="L";for(let e=0,t=0,{length:n}=i;e<n;e++){const n=1-i[e][o]/r;u=i[e].width||a,c.push(`${h} ${t},${n} ${g} ${t+=u},${n}`),h=g=""}return d.class=`b-series-${e.id} b-series-index-${e.index} `+n.callback("getOutlineClass",n,[e,i,...t]),d.d=c.join(" "),d}drawText(e,...t){const n=this,{data:r}=n,o=1/r.length,s=[];for(let l,a=0,c=0,{length:d}=r;a<d;a++,c+=l){l=r[a].width||o;const d=n.callback("getBarText",n,[r[a],a,e,...t]);if(d){const o=n.callback("getBarTextRenderData",n,[{ns:Qp,tag:"text",className:"b-bar-legend",html:d,left:c,width:l,x:100*(c+l/2)+"%",y:r[a].y!==i?r[a].y:"100%",dataset:{index:a,series:e}},r[a],a,e,...t]),u=n.callback("getBarTextTip",n,[o,r[a],a,e,...t]);u?o.dataset.btip=u:delete o.dataset.btip,s.push(o)}}return s}}om.initClass(),om._$name="Histogram";const sm="http://www.w3.org/2000/svg";class lm extends ul{static $name="Scale";static type="scale";static get configurable(){return{scalePoints:null,scaleMaxPadding:.1,horizontal:!1,align:{value:!1,$config:{merge:"replace"}},element:{children:[{ns:sm,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:sm,tag:"g",reference:"scaledSvgGroup",children:[{ns:sm,tag:"path",reference:"pathElement"}]},{ns:sm,tag:"g",reference:"unscaledSvgGroup"}]}]},monitorResize:!0}}construct(e){super.construct(e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}changeAlign(e){return e||(e=this.horizontal?"bottom":"right"),e}updateAlign(e,t){this.element.classList.remove(`b-align-${t}`),this.element.classList.add(`b-align-${e}`)}updateHorizontal(e,t){this.element.classList.remove("b-scale-"+(t?"horizontal":"vertical")),this.element.classList.add("b-scale-"+(e?"horizontal":"vertical"))}onElementResize(){super.onElementResize(...arguments),this.scheduleRefresh()}scheduleRefresh(){}refresh(){var e;if(!this.scalePoints)return;const t=this,{horizontal:n,width:r,height:i,align:o,scalePoints:s,scaleMaxPadding:l}=t,a=null===(e=s[s.length-1])||void 0===e?void 0:e.value,c=[],d=[],u=1/(a+l*a);t.scaledSvgGroup.setAttribute("transform",`scale(${n?r:1} ${n?1:i})`);for(const e of s){const t=Boolean(e.text),s=u*e.value;if(t){const t={ns:sm,tag:"text",className:"b-scale-tick-label",html:e.text,dataset:{tick:e.value}};n?(t.x=100*s+"%",t.y="top"===o?"1.6em":i-12):(t.x="left"===o?"12":""+(r-12),t.y=100*(1-s)+"%"),d.push(t)}n?"top"===o?c.push(`M${s},0 L${s},${t?10:5}`):c.push(`M${s},${i} L${s},${i-(t?10:5)}`):"left"===o?c.push(`M0,${1-s} L${t?10:5},${1-s}`):c.push(`M${r},${1-s} L${r-(t?10:5)},${1-s}`)}t.pathElement.setAttribute("d",c.join("")),Cs.syncChildren({domConfig:{children:d}},t.unscaledSvgGroup)}}lm.initClass(),lm._$name="Scale";class am extends fe{static $name="AvatarRendering";static get configurable(){return{element:null,colorPrefix:"b-sch-",tooltip:null,size:null}}doDestroy(){var e;null===(e=this.tooltip)||void 0===e||e.destroy(),super.doDestroy()}updateElement(e){Gn.on({element:e,delegate:".b-resource-image",error:"onImageErrorEvent",thisObj:this,capture:!0})}changeTooltip(e){return ec.new({forElement:this.element,forSelector:".b-resource-avatar",cls:"b-resource-avatar-tooltip"},e)}static get failedUrls(){return this._failedUrls||(this._failedUrls=new Set),this._failedUrls}getResourceAvatar(e){if(Array.isArray(e))return e.map((e=>this.getResourceAvatar(e)));const{initials:t,color:n,iconCls:r,imageUrl:o,defaultImageUrl:s,dataset:l={},resourceRecord:a,alt:c=A.encodeHtml(null==a?void 0:a.name)}=e,d=this.getImageConfig(t,n,o,s,l,c)||this.getIconConfig(r,l)||this.getResourceInitialsConfig(t,n,l),{size:u}=this;return Object.assign(d.style,{...u?{height:u,width:u}:i}),d}getImageConfig(e,t,n,r,i,o){if(n=am.failedUrls.has(n)?r:n||r)return{tag:"img",draggable:"false",loading:"lazy",class:{"b-resource-avatar":1,"b-resource-image":1},style:{},alt:o,elementData:{defaultImageUrl:r,imageUrl:n,initials:e,color:t,dataset:i},src:n,dataset:i}}getIconConfig(e,t){if(e)return e&&{tag:"i",style:{},class:{"b-resource-avatar":1,"b-resource-icon":1,[e]:1},dataset:t}}getResourceInitialsConfig(e,t,n){const r=Lr.isNamedColor(t)&&t,o=!r&&t,{size:s}=this;return{tag:"div",class:{"b-resource-avatar":1,"b-resource-initials":1,[`${this.colorPrefix}${r}`]:r},style:{backgroundColor:o||null,...s?{height:s,width:s}:i},children:[e],dataset:n}}onImageErrorEvent({target:e}){if(!e.matches(".b-resource-avatar"))return;const{defaultImageUrl:t,initials:n,color:r,imageUrl:i,dataset:o}=e.elementData;if(t&&!e.src.endsWith(t.replace(/^[./]*/gm,"")))e.src=t;else{const t=Lr.createElement(this.getResourceInitialsConfig(n,r,o));t.elementData=e.elementData,e.parentElement.replaceChild(t,e)}am.failedUrls.add(i)}}am._$name="AvatarRendering",n&&!n.bryntum&&(n.bryntum={});class cm extends Gc{static type="action";static fields=[{name:"actions",type:"array"},{name:"disableIfGridReadOnly",defaultValue:!1}];static defaults={filterable:!1,groupable:!1,sortable:!1,editor:!1,searchable:!1,htmlEncode:!1,resizable:!1,minWidth:30};get groupHeaderReserved(){return!0}construct(e,t){const n=this;super.construct(...arguments),e.width||e.flex||n.grid.ion({paint:"updateAutoWidth",thisObj:n}),n.disableIfGridReadOnly&&n.grid.element.classList.add("b-actioncolumn-readonly"),n.renderer!==n.internalRenderer&&(n.externalRenderer=n.renderer,n.renderer=n.internalRenderer)}internalRenderer({grid:e,column:t,record:n,callExternalRenderer:r=!0}){var i;const o=n&&"groupRowFor"in n.meta,{subGrid:s}=t;var l;r&&(null===(l=this.externalRenderer)||void 0===l||l.call(this,...arguments));return{className:{"b-action-ct":1},children:null===(i=t.actions)||void 0===i?void 0:i.map(((e,r)=>{var i;if("visible"in e){if("function"==typeof e.visible&&!1===e.visible({record:n}))return"";if(!1===e.visible)return""}if(o&&!e.showForGroup||!o&&e.showForGroup)return"";const{tooltip:l,renderer:a}=e,c="function"==typeof l||null!=l&&null!==(i=l.startsWith)&&void 0!==i&&i.call(l,"up.")?s.callback(l,s,[{record:n}]):l||"";if(a){const i=s.callback(a,s,[{index:r,record:n,column:t,tooltip:c,action:e}]);return"string"==typeof i?{tag:"span",dataset:{...ec.encodeConfig(c),index:r},html:i}:(i.dataset=i.dataset||{},i.dataset.index=r,i)}return{tag:"button",dataset:{...ec.encodeConfig(c),index:r},"aria-label":c,className:{"b-tool":1,"b-action-item":1,[e.cls]:e.cls}}}))}}onCellClick({column:e,record:t,target:n}){var r;if(e!==this||!n.classList.contains("b-action-item"))return;let i=n.dataset.index;i||(i=n.parentElement.dataset&&n.parentElement.dataset.index);const o=null===(r=e.actions)||void 0===r?void 0:r[i],s=null==o?void 0:o.onClick;s&&this.callback(s,e,[{record:t,action:o,target:n}])}updateAutoWidth(){const e=this,t=[],{actions:n}=e;if(!e.element)return;const r=e.actions=[];null==n||n.forEach((e=>{const n={...e};delete n.visible,n.showForGroup?(delete n.showForGroup,t.push(n)):r.push(n)})),t.length>r.length&&(e._actions=t);const i=Lr.createElement(e.internalRenderer({column:e,callExternalRenderer:!1})).outerHTML;e.width=Lr.measureText(i,e.element,!0,e.element.parentElement),e.actions=n}}qc.registerColumnType(cm),cm.exposeProperties(),cm._$name="ActionColumn";class dm extends Gc{static type="number";static fieldType="number";static fields=["format","min","max","step","largeStep","unit"];static get defaults(){return{filterType:"number",format:""}}get defaultEditor(){const{format:e,name:t,max:n,min:r,step:i,largeStep:o,align:s}=this;return Yt.cleanupProperties({type:"numberfield",format:e,name:t,max:n,min:r,step:i,largeStep:o,textAlign:s})}get formatter(){const e=this,{format:t}=e;let n=e._formatter;return n&&e._lastFormat===t||(e._formatter=n=Ph.get(e._lastFormat=t)),n}formatValue(e){return null!=e&&(e=this.formatter.format(e),this.unit&&(e=`${e}${this.unit}`)),e??""}defaultRenderer({value:e}){return this.formatValue(e)}}qc.registerColumnType(dm,!0),dm.exposeProperties(),dm._$name="NumberColumn";class um extends dm{static type="aggregate";static fields=["function","includeParentInChangeSet"];static get defaults(){return{function:"sum",includeParentInChangeSet:!1}}construct(e,t){const n=this;n.configuredAlign="align"in e,n.configuredEditor="editor"in e,super.construct(...arguments);const{grid:r}=t;"sum"===n.function&&(n.function="sumChildren"),r&&(n.store=r.store)}set store(e){const t=this,n={update:"onRecordUpdate",thisObj:t,prio:1e3},r=t._store;if(e!==r){r&&r.un(n),t._store=e;const{modelClass:i}=e,o=i.fieldMap[t.field];o&&"number"===o.type&&(t.configuredAlign||(t.align="end"),t.configuredEditor||(t.editor="number")),e.ion(n)}}canEdit(e){return e.isLeaf}get store(){return this._store}sumChildren(...e){let t=0;for(let n=0,{length:r}=e;n<r;n++)t+=parseFloat(e[n]||0,10);return t}avg(...e){let t=0;const{length:n}=e;for(let r=0;r<n;r++)t+=parseFloat(e[r]||0,10);return t/n}onRecordUpdate({record:e,changes:t}){const n=this,{rowManager:r}=n.grid;n.field in t&&e.isLeaf&&e.bubble((e=>{const t=r.getRowFor(e);if(t){const e=t.getCell(n.field);e&&t.renderCell(e)}}),!0)}getRawValue(e){var t;let n;const r=this,{field:i}=r;if(null!==(t=e.children)&&void 0!==t&&t.length){const t=r.function,o="string"==typeof t&&"function"==typeof Math[t],{handler:s,thisObj:l}=o?{handler:Math[t],thisObj:Math}:r.resolveCallback(t);n=s.apply(l,e.children.map((e=>r.getRawValue(e)))),r.includeParentInChangeSet?e.set(i,n,!0):e.setData(i,n)}else n=e.getValue(i);return n}canFillValue(){return!1}}qc.registerColumnType(um,!0),um.exposeProperties(),um._$name="AggregateColumn";class hm extends Gc{static $name="WidgetColumn";static type="widget";static fields=["widgets"];static get defaults(){return{filterable:!1,sortable:!1,editor:!1,searchable:!1,fitMode:!1,alwaysClearCell:!1}}construct(e,t){const n=this;n.widgetMap={},super.construct(...arguments),n.renderer!==n.internalRenderer&&(n.externalRenderer=n.renderer,n.renderer=n.internalRenderer)}doDestroy(){for(const e of Object.values(this.widgetMap))e.destroy&&e.destroy();super.doDestroy()}updateReadOnly(e){for(const t of Object.values(this.widgetMap))t.cellInfo.record.readOnly||(t.readOnly=e)}internalRenderer(e){var t;const n=this,{cellElement:r,column:i,record:o,isExport:s}=e,{widgets:l}=i;!s&&l&&(r.widgets||n.clearCell(r),r.widgets=e.widgets=l.map(((t,s)=>{var l,a;let c,d;if(r.widgets&&(c=r.widgets[s],d=c.element.nextElementSibling,t.recreate&&c&&(delete n.widgetMap[c.id],c.destroy(),r.widgets[s]=null)),c||(n.onBeforeWidgetCreate(t,e),t.recomposeAsync=!1,t.owner=n.grid,c=Td.append(t,d?{insertBefore:d}:r)[0],n.widgetMap[c.id]=c,n.onAfterWidgetCreate(c,e),c.name&&c.ion({change:({value:e,userAction:t})=>{t&&c.cellInfo.record.setValue(c.name,e)}})),c.cellInfo={record:o,column:i},n.grid&&!n.meta.isSelectionColumn&&(c.readOnly=n.grid.readOnly||o.readOnly),!1!==(null===(l=n.onBeforeWidgetSetValue)||void 0===l?void 0:l.call(n,c,e))){const n=t.valueProperty||"value"in c&&"value"||c.defaultBindProperty;if(n){const t=c.name?o.getValue(c.name):e.value;c[n]=t}}return null===(a=n.onAfterWidgetSetValue)||void 0===a||a.call(n,c,e),c})));const a=null===(t=n.externalRenderer)||void 0===t?void 0:t.call(n,e);return s||a||l?a:""}onBeforeWidgetCreate(e,t){}onAfterWidgetCreate(e,t){}clearCell(e){e.widgets&&(e.widgets.forEach((e=>{delete this.widgetMap[e.id],e.destroy()})),e.widgets=null),super.clearCell(e)}resizeToFitContent(){}}qc.registerColumnType(hm),hm.exposeProperties(),hm._$name="WidgetColumn";class gm extends hm{static $name="CheckColumn";static type="check";static fields=["checkCls","showCheckAll","onAfterWidgetSetValue","onBeforeWidgetSetValue","callOnFunctions","onBeforeToggle","onToggle","onToggleAll"];static defaults={align:"center",checkCls:null,showCheckAll:!1,sortable:!0,filterable:!0,widgets:[{type:"checkbox",valueProperty:"checked"}]};construct(e,t){super.construct(...arguments);const n=this;if(Object.assign(n,{externalHeaderRenderer:n.headerRenderer,externalOnBeforeWidgetSetValue:n.onBeforeWidgetSetValue,externalOnAfterWidgetSetValue:n.onAfterWidgetSetValue,onBeforeWidgetSetValue:n.internalOnBeforeWidgetSetValue,onAfterWidgetSetValue:n.internalOnAfterWidgetSetValue,headerRenderer:n.internalHeaderRenderer}),!n.meta.isSelectionColumn){var r;const e=null===(r=n.grid)||void 0===r?void 0:r.store.modelClass;n.field?!e||e.fieldMap[n.field]||n.constructor.suppressNoModelFieldWarning||(console.warn(n.$$name+" is configured with a field, but this is not part of your Model `fields` collection."),e.addField({name:n.field,type:"boolean"})):console.warn("CheckColumn MUST be configured with a field, otherwise the checked state will not be persistent. Widgets are recycled and reused")}}doDestroy(){var e;null===(e=this.headerCheckbox)||void 0===e||e.destroy(),super.doDestroy()}internalHeaderRenderer({headerElement:e,column:t}){let n;return e.classList.add("b-check-header"),t.showCheckAll?(e.classList.add("b-check-header-with-checkbox"),t.headerCheckbox?e.appendChild(t.headerCheckbox.element):t.headerCheckbox=new Vg({appendTo:e,owner:this.grid,ariaLabel:"L{Checkbox.toggleSelection}",internalListeners:{change:"onCheckAllChange",thisObj:t}})):n=t.headerText,n=t.externalHeaderRenderer?t.externalHeaderRenderer.call(this,...arguments):n,t.showCheckAll?i:n}updateCheckAllState(e){this.headerCheckbox&&(this.headerCheckbox.suspendEvents(),this.headerCheckbox.checked=e,this.headerCheckbox.resumeEvents())}onCheckAllChange({checked:e}){const t=this;if(t.field){const{store:n}=t.grid;n.beginBatch(),n.forEach((n=>t.updateRecord(n,t.field,e))),n.endBatch()}t.trigger("toggleAll",{checked:e})}internalRenderer({value:e,isExport:t,record:n,cellElement:r}){const i=super.internalRenderer(...arguments);return t?null!=i?i:null==e?"":e:(n.readOnly&&!this.meta.isSelectionColumn&&(r.widgets[0].readOnly=!0),e?r.widgets[0].input.setAttribute("checked",!0):r.widgets[0].input.removeAttribute("checked"),i)}onBeforeWidgetCreate(e,t){e.cls=this.checkCls}onAfterWidgetCreate(e,t){t.cellElement.widget=e,e.ion({beforeChange:"onBeforeCheckboxChange",change:"onCheckboxChange",thisObj:this})}internalOnBeforeWidgetSetValue(e){var t;e.record=e.cellInfo.record,this.isInitialSet=!0,null===(t=this.externalOnBeforeWidgetSetValue)||void 0===t||t.call(this,...arguments)}internalOnAfterWidgetSetValue(e){var t;this.isInitialSet=!1,null===(t=this.externalOnAfterWidgetSetValue)||void 0===t||t.call(this,...arguments)}onBeforeCheckboxChange({source:e,checked:t,userAction:n}){const r=this,{grid:i}=r,{record:o}=e.cellInfo;return!(n&&r.field&&(!i.features.cellEdit||i.features.cellEdit.disabled)||r.meta.isSelectionColumn&&!i.isSelectable(o)&&t)&&(r.isInitialSet?void 0:r.trigger("beforeToggle",{record:o,checked:t}))}onCheckboxChange({source:e,checked:t}){if(!this.isInitialSet){const n=this,{record:r}=e.cellInfo,{field:i}=n;i&&(n.updateRecord(r,i,t),t?n.updateCheckAllState(n.grid.store.every((e=>e[i]),null,!0)):n.updateCheckAllState(!1)),n.trigger("toggle",{record:r,checked:t,checkbox:e})}}updateRecord(e,t,n){const r=`set${A.capitalize(t)}`;e[r]?e[r](n):e.set(t,n)}onCellKeyDown({event:e,cellElement:t}){if(" "===e.key){const n=t.widget;null==n||n.toggle(),e.preventDefault(),e.handled=!0}}getCurrentConfig(e){const t=super.getCurrentConfig(e);return delete t.onBeforeWidgetSetValue,delete t.onAfterWidgetSetValue,this.externalOnBeforeWidgetSetValue&&(t.onBeforeWidgetSetValue=this.externalOnBeforeWidgetSetValue),this.externalOnAfterWidgetSetValue&&(t.onAfterWidgetSetValue=this.externalOnAfterWidgetSetValue),t}}qc.registerColumnType(gm,!0),gm._$name="CheckColumn";class pm extends Gc{static $name="ColorColumn";static type="color";static fields=[{name:"colorEditorType",defaultValue:"colorpicker"},"colors",{name:"addNoColorItem",defaultValue:!0}];static defaults={align:"center",editor:null};construct(){var e;super.construct(...arguments);const t=this,{grid:n}=t;t.menu=new sh({owner:n,rootElement:n.rootElement,autoShow:!1,align:"t50-b50",anchor:!0,internalListeners:{hide(){t.picker.navigator.activeItem=null,delete t._editingRecord}},items:[Object.assign({type:t.colorEditorType,ref:"list",addNoColorItem:t.addNoColorItem,colorSelected({color:e}){var n;null===(n=t._editingRecord)||void 0===n||n.set(t.field,e),t.menu.hide()}},null!==(e=t.colors)&&void 0!==e&&e.length?{colors:t.colors}:{})]})}applyValue(e,t,n){if(!this.isConstructing){const{picker:e}=this;"colors"===t?e.colors=n:"addNoColorItem"===t&&(e.addNoColorItem=n)}super.applyValue(...arguments)}get picker(){return this.menu.widgetMap.list}renderer({value:e}){let t="b-empty",n=e;if(e){const r=this.picker.getColorClassName(e);r?(t=r,n=null):t=""}return{className:"b-color-cell-inner "+t,style:{backgroundColor:n},"data-btip":e}}onCellClick({grid:e,record:t,target:n}){if(n.classList.contains("b-color-cell-inner")&&!this.readOnly&&!e.readOnly&&!t.isSpecialRow&&!t.readOnly){const{picker:e,menu:r}=this,i=t.get(this.field);this._editingRecord=t,e.deselectAll(),e.select(i),e.refresh(),r.showBy(n)}}}qc.registerColumnType(pm),pm._$name="ColorColumn";class mm extends Gc{static $name="DateColumn";static type="date";static fieldType="date";static fields=["format","pickerFormat","step","min","max"];static get defaults(){return{format:"L",step:1,minWidth:85,filterType:"date"}}defaultRenderer({value:e}){return e?this.formatValue(e):""}groupRenderer({cellElement:e,groupRowFor:t}){e.innerHTML=this.formatValue(t)}formatValue(e){return"string"==typeof e&&(e=Wt.parse(e,this.format||i)),Wt.format(e,this.format||i)}set format(e){const{editor:t}=this.data;this.set("format",e),t&&(t.format=e)}get format(){return this.get("format")}get defaultEditor(){const e=this,{min:t,max:n,step:r,format:i}=e;return{name:e.field,type:"date",calendarContainerCls:"b-grid-cell-editor-related",weekStartDay:e.grid.weekStartDay,format:i,max:n,min:t,step:r}}}qc.registerColumnType(mm,!0),mm.exposeProperties(),mm._$name="DateColumn";class fm extends dm{static type="percent";static fieldType="number";static fields=["showValue","lowThreshold"];static get defaults(){return{min:0,max:100,showValue:!1,lowThreshold:20,htmlEncode:!1,searchable:!1,summaryRenderer:({sum:e})=>`${e}%`,fitMode:!1}}constructor(e,t){super(...arguments),this.internalCellCls="b-percent-bar-cell"}defaultRenderer({value:e}){return{className:"b-percent-bar-outer",role:"progressbar","aria-Valuemin":0,"aria-Valuemax":100,"aria-Valuenow":e=e||0,tabIndex:0,children:[{tag:"div",className:{"b-percent-bar":1,"b-zero":0===e,"b-low":e<this.lowThreshold},style:{width:e+"%"},children:[this.showValue?{tag:"span",text:e+"%"}:i]}]}}resizeToFitContent(){}}fm.sum="average",qc.registerColumnType(fm,!0),fm._$name="PercentColumn";class vm extends dm{static $name="RatingColumn";static type="rating";static fieldType="number";static fields=["emptyIcon","filledIcon","editable"];static get defaults(){return{min:0,max:5,emptyIcon:"b-icon b-icon-star",filledIcon:"b-icon b-icon-star",editable:!0,filterType:"number",searchable:!1,width:"11.2em",htmlEncode:!1,minWidth:"11.2em",editor:!1,fitMode:"value"}}renderer({value:e}){return{className:{"b-rating-cell-inner":1,"b-not-editable":!this.editable},children:H.populate(this.max,(t=>{const n=t<e;return{tag:"i",className:{"b-rating-icon":!0,"b-filled":n,"b-empty":!n,[n?this.filledIcon:this.emptyIcon]:!0}}}))}}onCellClick({grid:e,column:t,record:n,target:r,event:i}){if(r.classList.contains("b-rating-icon")&&!e.readOnly&&t.editable){let e=[].indexOf.call(r.parentNode.childNodes,r);r.classList.contains("b-filled")&&(i.metaKey||i.shiftKey)&&(e-=1),1===n.getValue(t.field)&&0===e&&(e=-1),n.set(t.field,e+1)}}}qc.registerColumnType(vm,!0),vm.exposeProperties(),vm._$name="RatingColumn";class bm extends Gc{static type="template";static fields=["template"];static get defaults(){return{htmlEncode:!1}}constructor(e,t){super(...arguments);if(!this.template)throw new Error("TemplateColumn needs a template");if("function"!=typeof this.template)throw new Error("TemplateColumn.template must be a function")}renderer(e){if(!e.record.isSpecialRow)return this.template({value:e.value,record:e.record,field:this.field})}}qc.registerColumnType(bm,!0),bm.exposeProperties(),bm._$name="TemplateColumn";class ym extends Gc{static type="time";static fieldType="date";static fields=["format"];static get defaults(){return{format:"LT",minWidth:140,filterType:"time"}}defaultRenderer({value:e}){return e?this.formatValue(e):""}groupRenderer({cellElement:e,groupRowFor:t}){e.innerHTML=this.formatValue(t)}formatValue(e){return"string"==typeof e&&(e=Wt.parse(e,this.format)),Wt.format(e,this.format)}set format(e){const{editor:t}=this;this.set("format",e),t&&(t.format=e)}get format(){return this.get("format")}get defaultEditor(){return{name:this.field,type:"time",format:this.format}}}qc.registerColumnType(ym,!0),ym.exposeProperties(),ym._$name="TimeColumn";let Cm=!1;class wm extends Gc{static $name="TreeColumn";static type="tree";static get defaults(){return{tree:!0,hideable:!1,minWidth:150}}static get fields(){return[{name:"expandIconCls",defaultValue:"b-icon b-icon-tree-expand"},{name:"collapseIconCls",defaultValue:"b-icon b-icon-tree-collapse"},{name:"collapsedFolderIconCls"},{name:"expandedFolderIconCls"},{name:"indentSize",defaultValue:1.7},{name:"leafIconCls",defaultValue:"b-icon b-icon-tree-leaf"},{name:"editTargetSelector",defaultValue:".b-tree-cell-value"},"renderer"]}constructor(e,t){super(...arguments);const n=this;n.shouldHtmlEncode=n.htmlEncode,n.setData("htmlEncode",!1),n.renderer&&(n.originalRenderer=n.renderer),n.renderer=n.treeRenderer.bind(n)}treeRenderer(e){const t=this,{grid:n,cellElement:r,row:i,record:o,isExport:s}=e,l=o.instanceMeta(n.store),a=!o.isLeaf&&l.collapsed,c={className:"b-tree-cell-value"},d=[c],u={className:{"b-tree-cell-inner":1},tag:o.href?"a":"div",href:o.href,target:o.target,children:d},h={"b-tree-parent-row":0,"b-tree-collapsed":0,"b-tree-expanded":0,"b-loading-children":0};let g,p,{value:m}=e,f=t;const v=n.isTreeGrouped&&!o.isLeaf&&n.features.treeGroup.parentRenderer;if(t.originalRenderer||v){var b;let i;if(v){var y;if(o.field)f=n.columns.get(o.field),m=f.isWidgetColumn?m:(null===(y=f.renderer||f.defaultRenderer)||void 0===y?void 0:y.call(f,{...e,column:f,value:o.name,isTreeGroup:!0}))??o.name;i=n.features.treeGroup.parentRenderer({field:o.field,value:m,column:f,record:o.firstGroupChild,grid:n})}else i=t.originalRenderer(e);const s=null===(b=n.hasFrameworkRenderer)||void 0===b?void 0:b.call(n,{cellContent:i,renderingColumn:f});g="object"==typeof i&&!s,m=s?"":!1===i?r.innerHTML:i,e.rendererHtml=i}if(g||(m=String(m??"")),s)return m;if(o.isLeaf)r.classList.add("b-tree-leaf-cell"),p=e.iconCls||o.iconCls||t.leafIconCls;else{var C;const i=!o.isExpanded(n.store),s=i?t.expandIconCls:t.collapseIconCls,a=i?t.collapsedFolderIconCls:t.expandedFolderIconCls;h["b-tree-parent-row"]=1,h["b-tree-collapsed"]=i,h["b-tree-expanded"]=!i,h["b-loading-children"]=l.isLoadingChildren,r.classList.add("b-tree-parent-cell"),d.unshift({tag:"i",className:{"b-tree-expander":1,[s]:1,"b-empty-parent":!(l.isLoadingChildren||!0===o.children||null!==(C=o.children)&&void 0!==C&&C.length)}}),Cm=p=e.iconCls||o.iconCls||a}if(p&&d.splice(d.length-1,0,{tag:"i",className:{"b-tree-icon":1,[p]:1}}),i.isRow&&(i.assignCls(h),!o.isLeaf))if(i.setAttribute("aria-expanded",!a),a)i.removeAttribute("aria-owns");else for(const e in n.subGrids){var w,x;const t=i.elements[e];Lr.setAttributes(t,{"aria-owns":null!==(w=o.children)&&void 0!==w&&w.length?null===(x=o.children)||void 0===x?void 0:x.map((t=>`${n.id}-${e}-${t.id}`)).join(" "):null})}Array.isArray(m)?c.children=m:g?Object.assign(c,m):f.shouldHtmlEncode||!m.includes("<")?(u.className["b-text-value"]=1,c.text=m):c.html=m;const S=o.childLevel*t.indentSize+(o.isLeaf?Cm?2:p?.5:.4:0);return u.style=`padding-inline-start:${S}em`,u}getCurrentConfig(e){const t=super.getCurrentConfig(e);return t.renderer=this.originalRenderer,t}}qc.registerColumnType(wm,!0),wm.exposeProperties(),wm._$name="TreeColumn";class xm extends(di.mixin(Nh)){static configurable={copyOnly:null,keyMap:{"Ctrl+C":"copy","Ctrl+X":"cut","Ctrl+V":"paste"},useNativeClipboard:!1,toCopyString:null,toPasteValue:null,emptyValueChar:" ",dateFormat:"lll"};get clipboardRecords(){return this.clipboardData||[]}cellsToString(e){const t=this;let n=0,r=0,o="";e.sort(((e,t)=>e.rowIndex===t.rowIndex?e.columnIndex-t.columnIndex:e.rowIndex-t.rowIndex));for(const c of e){var s,l;const{record:e,column:d,rowIndex:u,columnIndex:h}=c;u>n?(o.length>0&&(o+="\n".repeat(u-n)),n=u,r=h):h>r&&(o.length>0&&(o+="\t".repeat(h-r)),r=h);let g=null===(s=d.toClipboardString)||void 0===s?void 0:s.call(d,c);var a;if(g===i)if(g=e.getValue(d.field),g instanceof Date)g=Wt.format(g,t.dateFormat);else g=null===(a=g)||void 0===a?void 0:a.toString();t.toCopyString&&(g=t.toCopyString({currentValue:g,column:d,record:e})),g=null===(l=g)||void 0===l?void 0:l.replace(/[\n\t]/," "),o+=g||t.emptyValueChar}return o}setFromStringData(e,t=!1,n=this.client.store,r){const i=this,{client:o}=i,{columns:s,_shiftSelectRange:l}=o,a=new Set,c=i.stringAs2dArray(e),d=o.selectedCells[0],u=[],h=[];if(!t&&null!=l&&l.some((e=>e.equals(d)))){const e=i.cellSelectorsAs2dArray(l);if((null==e?void 0:e.length)%c.length==0&&e.columnCount%c.columnCount==0)for(let t=0;t<e.length;t+=c.length)for(let n=0;n<e.columnCount;n+=c.columnCount)u.push(e[t][n])}u.length||u.push(d);for(const e of u)for(let l=0;l<c.length;l++){const d=c[l],u=t?new n.modelClass:n.getAt(e.rowIndex+l);if(u&&!u.readOnly){for(let n=0;n<d.length;n++){const l=r?null:s.visibleColumns[t?n:e.columnIndex+n],a=(null==l?void 0:l.field)||(null==r?void 0:r[n]);let c=d[n];if(a&&c&&(null==l||!l.readOnly)){var g;if(c===i.emptyValueChar&&(c=null),null!=l&&l.fromClipboardString&&(c=l.fromClipboardString({string:c,record:u})),i.toPasteValue&&(c=i.toPasteValue({currentValue:c,record:u,column:l,field:a})),"string"==typeof c&&null!==(g=u.getFieldDefinition(a))&&void 0!==g&&g.isDateDataField){const e=Wt.parse(c,i.dateFormat);isNaN(e.getTime())||(c=e)}u.set(a,c,!1,!1,!1,!0),h.push(o.normalizeCellContext({column:l,record:u}))}}a.add(u)}}return{modifiedRecords:[...a],targetCells:h}}cellSelectorsAs2dArray(e){const t=[];let n,r=null;for(const i of e)i.id!==r&&(r=i.id,n=[],t.push(n)),n.push(i);return t.columnCount=t[0].length,!t.some((e=>e.length!==t.columnCount))&&t}stringAs2dArray(e){const t=[],n=e.split(/\r\n|(?!\r\n)[\n-\r\x85\u2028\u2029]/).filter((e=>e.length));for(const e of n){const n=e.split("\t");if(t.columnCount&&n.length!==t.columnCount)return!1;t.columnCount=n.length,t.push(n)}return t}}xm._$name="CopyPasteBase";class Sm extends xm{static $name="CellCopyPaste";static pluginConfig={chain:["populateCellMenu","afterSelectionModeChange"]};static configurable={useNativeClipboard:!P.isTestEnv,copyText:"L{copy}",cutText:"L{cut}",pasteText:"L{paste}"};afterConstruct(){super.afterConstruct(),this.afterSelectionModeChange()}afterSelectionModeChange(){const e=this;e.client.selectionMode.cell?e._disabledBySelectionMode&&(e.disabled=!1,delete e._disabledBySelectionMode):e.disabled=!0}entityName="cell";set copyOnly(e){this._copyOnly=e}get copyOnly(){var e;return null==this._copyOnly?!(null!==(e=this.client.features.cellEdit)&&void 0!==e&&e.enabled):Boolean(this._copyOnly)}get canCopy(){var e;const{client:t}=this;return Boolean(!this.disabled&&t.selectedCells.length&&(!t._selectedRows.length||(null===(e=t.features.rowCopyPaste)||void 0===e?void 0:e.disabled)||t.focusedCell&&t.isCellSelected(t.focusedCell)))}get canCutPaste(){var e;return this.canCopy&&!this.copyOnly&&!(null!==(e=this.client.features.cellEdit)&&void 0!==e&&e.isEditing)&&!this.client.readOnly}isActionAvailable({actionName:e}){return this.canCopy&&("copy"===e||this.canCutPaste)}async cut(){await this.copy(!0)}async copy(e=!1){"boolean"!=typeof e&&(e=!1);const t=this,{selectedCells:n}=t.client,r=e?n.filter((e=>{var t;return!(null!==(t=e.record)&&void 0!==t&&t.readOnly)})):n;if(r){if(e?!t.canCutPaste:!t.canCopy)return;const n=t.cellsToString(r);if(await t.writeToClipboard(n,e,{cells:r}),!0===e)for(const e of r)e.column.readOnly||e.record.set(e.column.field,null);t.client.trigger("copy",{cells:r,copiedDataString:n,isCut:e,entityName:t.entityName})}}async beforeCopy({data:e,isCut:t,cells:n}){return await this.client.trigger("beforeCopy",{cells:n,data:e,isCut:t,entityName:this.entityName})}async paste(){const e=this,{client:t,entityName:n}=e,r=t.selectedCells[0];if(!e.canCutPaste||!r)return;const i=await e.readFromClipboard({},!0);if(!i)return;const{modifiedRecords:o,targetCells:s}=e.setFromStringData(i);1===t.selectedCells.length&&s.length>1&&t.selectCellRange(s[0],s[s.length-1]),t.trigger("paste",{clipboardData:i,targetCell:r,modifiedRecords:[...o],entityName:n})}async beforePaste({data:e}){return await this.client.trigger("beforePaste",{clipboardData:e,targetCell:this.client.selectedCell,entityName:this.entityName})}populateCellMenu({record:e,items:t}){const n=this;n.canCopy&&(t.cutCell={text:n.cutText,localeClass:n,icon:"b-icon b-icon-cut",weight:115,disabled:e.readOnly||!n.canCutPaste,onItem:()=>n.cut()},t.pasteCell={text:n.pasteText,localeClass:n,icon:"b-icon b-icon-paste",weight:120,disabled:e.readOnly||!n.canCutPaste||!1===n.hasClipboardData(),onItem:()=>n.paste()},t.copyCell={text:n.copyText,localeClass:n,cls:"b-separator",icon:"b-icon b-icon-copy",weight:110,onItem:()=>n.copy()})}}Sm._$name="CellCopyPaste",gd.registerFeature(Sm);const Em={finishAndEditNextRow:1,finishAndEditPrevRow:1,finishEditing:1,cancelEditing:1,finishAndEditNextCell:1,finishAndEditPrevCell:1};class Rm extends(ai(di)){static $name="CellEdit";static get defaultConfig(){return{autoSelect:!0,blurAction:"complete",continueEditingOnCellClick:!0,addNewAtEnd:null,addToCurrentParent:!1,autoEdit:null,editNextOnEnterPress:!0,editorClass:op,triggerEvent:"celldblclick",touchEditDelay:300,focusCellAnimationDuration:!1,multiEdit:!0,keyMap:{Enter:["startEditingFromKeyMap","finishAndEditNextRow"],"Ctrl+Enter":["finishAllSelected","finishEditing"],"Shift+Enter":"finishAndEditPrevRow","Alt+Enter":"finishEditing",F2:["startEditingFromKeyMap","finishEditing"],Escape:"cancelEditing",Tab:{handler:"finishAndEditNextCell",weight:100},"Shift+Tab":{handler:"finishAndEditPrevCell",weight:100}},ignoreCSSSelector:"button,.b-icon,.b-fa,svg"}}static get pluginConfig(){return{assign:["startEditing","finishEditing","cancelEditing"],before:["onElementKeyDown","onElementPointerUp"],chain:["onElementClick","bindStore"]}}construct(e,t){super.construct(e,t);const n=this,r={renderRows:"onGridRefreshed",cellClick:"onCellClick",thisObj:n};n.grid=e,"cellclick"!==n.triggerEvent&&(r[n.triggerEvent]="onTriggerEditEvent"),n.autoEdit&&!("editNextOnEnterPress"in t)&&(n.editNextOnEnterPress=!1),e.ion(r),e.rowManager.ion({changeTotalHeight:"onGridRefreshed",thisObj:n}),n.bindStore(e.store)}bindStore(e){this.detachListeners("store"),e.ion({name:"store",update:"onStoreUpdate",beforeSort:"onStoreBeforeSort",thisObj:this})}async confirm(e){let t=!0;return this.editorContext&&(Cp.owner=this.editorContext.editor.inputField,e.rootElement=this.grid.rootElement,t=await Cp.confirm(e),Cp.owner=null),t===Cp.yesButton}doDestroy(){this.grid.columns.allRecords.forEach((e=>{var t;null===(t=e._cellEditor)||void 0===t||t.destroy()})),super.doDestroy()}doDisable(e){e&&!this.isConfiguring&&this.cancelEditing(!0),super.doDisable(e)}set disabled(e){super.disabled=e}get disabled(){const{grid:e}=this;return Boolean(super.disabled||e.disabled||e.readOnly)}get isEditing(){return Boolean(this.editorContext)}get activeRecord(){var e;return(null===(e=this.editorContext)||void 0===e?void 0:e.record)||null}getEditorForCell({id:e,cell:t,column:n,columnId:r,editor:i}){var o;const s=this,{grid:l,editorClass:a}=s;let c=n.cellEditor,d=0;if(n.editTargetSelector){d=t.querySelector(n.editTargetSelector).offsetLeft}return i.autoSelect=s.autoSelect,null!==(o=c)&&void 0!==o&&o.isEditor||(c=n.data.cellEditor=a.create(a.mergeConfigs({type:a.type,constrainTo:null,cls:"b-cell-editor",inputField:i,blurAction:"none",invalidAction:n.invalidAction,completeKey:!1,cancelKey:!1,owner:l,align:{align:"t0-t0",offset:[d,0]},internalListeners:s.getEditorListeners(),onInternalKeyDown:s.onEditorKeydown.bind(s),allowMouseEvents:i.allowMouseEvents},c))),c.minHeight=l.rowHeight,c.inputField!==i&&(c.remove(c.items[0]),c.add(i)),c.align.offset[0]=d,n.instantUpdate&&!i.cellEditValueSetter&&(Yt.wrapProperty(i,"value",null,(e=>{const{editorContext:t}=s,n=null==t?void 0:t.editor.inputField;null==t||!t.editor.isValid||Yt.isEqual(t.record.getValue(t.column.field),e)||null!=n&&n.isDateField&&!n._isPickerInput||t.record.setValue(t.column.field,e)})),i.cellEditValueSetter=!0),Object.assign(c.element.dataset,{rowId:e,columnId:r,field:n.field}),c.inputField.revertOnEscape=n.revertOnEscape,s.editor=c}getEditorListeners(){return{focusOut:"onEditorFocusOut",focusIn:"onEditorFocusIn",start:"onEditorStart",beforeComplete:"onEditorBeforeComplete",complete:"onEditorComplete",beforeCancel:"onEditorBeforeCancel",cancel:"onEditorCancel",beforeHide:"onBeforeEditorHide",finishEdit:"onEditorFinishEdit",thisObj:this}}onEditorStart({source:e}){const t=this,n=t.editorContext=e.cellEditorContext;if(n){var r;const{grid:e}=t;"cellclick"!==t.triggerEvent&&(t.detachListeners("cellClickWhileEditing"),e.ion({name:"cellClickWhileEditing",cellclick:"onCellClickWhileEditing",thisObj:t})),null===(r=t.removeEditingListeners)||void 0===r||r.call(t),t.removeEditingListeners=Rn.addListener({globaltap:"onTapOut",thisObj:t}),e.trigger("startCellEdit",{grid:e,editorContext:n})}}onEditorBeforeComplete(e){const{grid:t}=this,n=e.source.cellEditorContext;return e.grid=t,e.editorContext=n,t.trigger("beforeFinishCellEdit",e)}onEditorComplete({source:e}){const{grid:t}=this,n=e.cellEditorContext;if(n.value=e.inputField.value,e.dataField.includes(".")){var r;const n=e.dataField.split(".")[0];null!==(r=e.record.constructor.relations)&&void 0!==r&&r[n]&&t.rowManager.refresh()}t.trigger("finishCellEdit",{grid:t,editorContext:n})}onEditorBeforeCancel(){const{editorContext:e}=this;return this.grid.trigger("beforeCancelCellEdit",{editorContext:e})}onEditorCancel({event:e}){const{editorContext:t,muteEvents:n,grid:r}=this;n||r.trigger("cancelCellEdit",{grid:r,editorContext:t,event:e})}onBeforeEditorHide({source:e}){const{row:t,cell:n}=e.cellEditorContext;null==n||n.classList.remove("b-editing"),null==t||t.removeCls("b-editing"),this.detachListeners("cellClickWhileEditing"),this.removeEditingListeners()}onEditorFinishEdit({source:e}){e.cellEditorContext=this.editorContext=null}getAdjacentEditableCell(e,t){const{grid:n}=this,{store:r,columns:i}=n,{visibleColumns:o}=i;let s=e.id,l=i.getAdjacentVisibleLeafColumn(e.columnId,t);for(;s;)if(l){if(l.editor&&l.canEdit(r.getById(s)))return{id:s,columnId:l.id};l=i.getAdjacentVisibleLeafColumn(l,t)}else{const n=r.getAdjacent(e.id,t,!1,!0);s=null==n?void 0:n.id,n&&(l=t?o[0]:o[o.length-1])}return null}doAddNewAtEnd(){const e="object"==typeof this.addNewAtEnd?Yt.clone(this.addNewAtEnd):{},{grid:{store:t,rowManager:n},addToCurrentParent:r}=this;let i;return i=t.tree&&r?t.last.parent.appendChild(e):t.add(e)[0],n.getRowFor(i)||n.displayRecordAtBottom(),i}getEditingContext(e){e=this.grid.normalizeCellContext(e);const{column:t,record:n}=e;if(null!=t&&t.isVisible&&t.editor&&!t.readOnly&&n&&!n.isSpecialRow&&!n.readOnly&&t.canEdit(n)){const r=n?t.getRawValue(n):n;return Object.assign(e,{value:r===i?null:r,editor:t.editor}),e}return!1}startEditingFromKeyMap(){return this.startEditing(this.grid.focusedCell)}async startEditing(e={}){const t=this;if(!t.disabled){var n,r,i;const{grid:o}=t;if(null!==(n=e)&&void 0!==n&&n.fromKeyMap&&(e=t.grid.focusedCell),Yt.isEmpty(e)&&(e.id=o.firstVisibleRow.id),o.store.isTree&&o.features.tree){const t=e.id?o.store.getById(e.id):e.record??o.store.getAt(e.row);if(!t)return!1;await o.expandTo(t)}const s=t.getEditingContext(e);if(!s)return!1;if(t.editorContext&&!1===t.cancelEditing())return!1;if(null!==(r=o.focusedCell)&&void 0!==r&&r.equals(s)||o.focusCell(s),!1===o.trigger("beforeCellEditStart",{grid:o,editorContext:s}))return!1;const l=s.editor=t.getEditorForCell(s),{row:a,cell:c,record:d}=s;return l.inputField.highlightExternalChange=!1,l.cellEditorContext=s,l.render(c),c.classList.add("b-editing"),a.addCls("b-editing"),await l.startEdit({target:c,field:l.inputField.name||s.column.field,value:s.value,record:d})||(c.classList.remove("b-editing"),a.removeCls("b-editing")),null===(i=t.onCellEditStart)||void 0===i||i.call(t),!0}return!1}cancelEditing(e=!1,t){const n=this,{editor:r}=n;if(!n.isEditing)return;e.fromKeyMap&&(t=e,e=!1),n.muteEvents=e;const i=r.cancelEdit(t);var o;(n.muteEvents=!1,!1===i)?r.inputField.focus():(n.finishEditingPromise=!1,null===(o=n.afterCellEdit)||void 0===o||o.call(n));return i}async finishEditing(){const e=this,{editorContext:t,grid:n}=e;let r=!1;if(e.finishEditingPromise)return e.finishEditingPromise;if(t){const{column:o}=t;var i;if(e.finishEditingPromise=t.editor.completeEdit(o.bindCallback(o.finalizeCellEdit)),r=await e.finishEditingPromise,await n.waitForAnimations(),e.finishEditingPromise=null,r)null===(i=e.afterCellEdit)||void 0===i||i.call(e)}return r}async onCellClickWhileEditing({event:e,cellSelector:t}){const n=this;e.target.closest(".b-editor")||(Lr.isTouchEvent||e.target.matches(n.ignoreCSSSelector)?await n.finishEditing():n.finishEditingPromise||n.editorContext&&!n.editorContext.editor.owns(e.target)&&(n.getEditingContext(t)?await n.finishEditing()?n.continueEditingOnCellClick&&await n.startEditing(t):(n.grid.focusCell(n.editorContext),n.editor.inputField.focus()):await n.finishEditing()))}async onCellClick({cellSelector:e,target:t,event:n,column:r}){if(r.onCellClick)return;const i=this,{focusedCell:o}=i.client;if(t.closest(".b-tree-expander"))return!1;Lr.isTouchEvent&&i._lastCellClicked===(null==o?void 0:o.cell)&&n.timeStamp-i.touchEditDelay>i._lastCellClickedTime?await i.startEditing(e):"cellclick"===this.triggerEvent&&await i.onTriggerEditEvent({cellSelector:e,target:t}),i._lastCellClicked=null==o?void 0:o.cell,i._lastCellClickedTime=n.timeStamp}onElementPointerUp(e){e.target.closest(".b-tree-expander")&&this.cancelEditing(i,e)}async onTriggerEditEvent({cellSelector:e,target:t,event:n}){var r;const{editorContext:i,client:o}=this;t.closest(".b-tree-expander")||Lr.isTouchEvent&&"dblclick"===n.type||n&&(null===(r=o.features.cellMenu)||void 0===r?void 0:r.triggerEvent)===n.type||(!i||!i.equals(this.grid.normalizeCellContext(e))&&await this.finishEditing())&&await this.startEditing(e)}onStoreUpdate({changes:e,record:t}){const{editorContext:n}=this;null!=n&&n.editor.isVisible&&t===n.record&&n.editor.dataField in e&&n.editor.refreshEdit()}onStoreBeforeSort(){var e;const t=null===(e=this.editorContext)||void 0===e?void 0:e.editor;if(this.isEditing&&(null==t||!t.isFinishing)&&!t.isValid)return this.cancelEditing()}onGridRefreshed(){const e=this,{grid:t,editorContext:n}=e;if(n&&t.isVisible&&t.focusedCell){const r=t.getCell(t.focusedCell),{editor:i}=n;r&&Lr.isInView(r)&&!i.isFinishing?(n._cell=r,Rn.suspendFocusEvents(),i.render(r),i.showBy(r),i.focus(),Rn.resumeFocusEvents()):e.cancelEditing()}}get gridSelection(){return[...this.grid.selectedRows,...this.grid.selectedCells]}isActionAvailable({actionName:e,event:t}){const n=this;if(!n.disabled&&!t.target.closest(".b-grid-header"))if(n.isEditing){if("finishAllSelected"===e)return n.multiEdit&&n.gridSelection.length>1;if(Em[e])return!0}else if("startEditingFromKeyMap"===e)return n.grid.focusedCell.cell===t.target;return!1}async finishAllSelected(){const e=this,{dataField:t,record:n}=e.editor;if(await e.finishEditing()&&!e.isDestroyed){const r=n.getValue(t);for(const i of e.gridSelection)i.isModel?i!==n&&i.setValue(t,r):i.record.set(i.column.field,r)}}async finishAndEditNextRow(e,t=!1){const n=this,{grid:r}=n,{record:i}=n.editorContext;let o;if(await n.finishEditing()){if(n.isDestroyed)return;n.isEditing||(t?o=r.internalNextPrevRow(!1,!0,!1):(n.addNewAtEnd&&i===r.store.last&&await n.doAddNewAtEnd(),n.isDestroyed||(o=r.internalNextPrevRow(!0,!0))),o&&n.editNextOnEnterPress&&!r.touch&&await n.startEditing(o))}}finishAndEditPrevRow(e){return this.finishAndEditNextRow(e,!0)}async finishAndEditNextCell(e,t=!1){const n=this,{grid:r}=n,{focusedCell:i}=r;if(i){var o,s;let l=n.getAdjacentEditableCell(i,!t);if(!l&&!t&&n.addNewAtEnd){!0===await n.finishEditing()&&(await this.doAddNewAtEnd(),l=!n.isDestroyed&&n.getAdjacentEditableCell(i,!t))}let a=!0;n.isEditing&&(a=await n.finishEditing()),l?!n.isDestroyed&&a&&(r.focusCell(l,{animate:n.focusCellAnimationDuration}),await n.startEditing(l)||await n.finishAndEditNextCell(e,t)):!r.isNested||!r.owner||null!==(o=(s=r.owner).catchFocus)&&void 0!==o&&o.call(s,{source:r,navigationDirection:t?"up":"down",editing:!0})||r.onTab(e)}}finishAndEditPrevCell(e){return this.finishAndEditNextCell(e,!0)}async onElementKeyDown(e){const t=this,{grid:n}=t,{focusedCell:r}=n;if(e.handled||!t.autoEdit||t.isEditing||!r||r.isActionable||e.ctrlKey)return;const{key:i}=e,o="Delete"===e.key||"Backspace"===e.key,{gridSelection:s}=o?t:{},l=t.multiEdit&&(null==s?void 0:s.length)>1;if((i.length<=1||o&&!l)&&await t.startEditing(r)){const{inputField:n}=t.editor,{input:r}=n;r&&(n.internalOnKeyEvent(e),e.defaultPrevented||(r.value=o?"":i,n.internalOnInput(e))),e.preventDefault()}else if(l&&!1!==n.trigger("beforeCellRangeDelete",{grid:n,gridSelection:s}))for(const e of s)e.isModel?n.columns.visibleColumns.forEach((t=>{!t.readOnly&&e.set(t.field,null)})):e.column.readOnly||e.record.set(e.column.field,null)}onEditorKeydown(e){if(1!==e.key.length&&this.grid.matchKeyMapEntry(e)&&!this.grid.matchKeyMapEntry(e,this.keyMap))return e.key.startsWith("Arrow")||"Backspace"!==!e.key||e.preventDefault(),e.handled=!0,e.stopPropagation(),!1}async onEditorFocusOut(e){const t=this,{grid:n,editor:r,editorContext:o}=t,s=new Hc(e.relatedTarget),l=s.grid===n&&t.getEditingContext(s);o&&!r.isFinishing&&r.owns(e._target)&&("cancel"===t.blurAction?t.cancelEditing(i,e):t.finishEditingPromise||"cellclick"!==t.triggerEvent&&("cellclick"===t.triggerEvent||l)||await t.finishEditing())}onEditorFocusIn(e){const t=e.toWidget;t===this.editor.inputField&&this.autoSelect&&t.selectAll&&!t.readOnly&&!t.disabled&&t.selectAll()}async onTapOut({event:e}){const t=this,{target:n}=e;n._shadowRoot||t.editor.owns(n)||t.grid.bodyContainer.contains(n)&&!e.button||(t.editingStoppedByTapOutside=!0,"cancel"===t.blurAction?t.cancelEditing(i,e):await t.finishEditing(),delete t.editingStoppedByTapOutside)}async onElementClick(e){e.target.classList.contains("b-grid-body-container")&&this.editorContext&&await this.finishEditing()}}Rm._$name="CellEdit",gd.registerFeature(Rm,!0);class Tm extends ah{static get $name(){return"CellMenu"}static get defaultConfig(){return{processItems:null,items:null,type:"cell"}}static get pluginConfig(){const e=super.pluginConfig;return e.chain.push("populateCellMenu"),e}showContextMenu(e){const{cellSelector:t,event:n}=e;this.client.focusCell(t,{doSelect:!this.client.isSelected(t),event:n}),super.showContextMenu(e)}shouldShowMenu({column:e}){return e&&!1!==e.enableCellContextMenu}getDataFromEvent(e){const t=this.client.getCellDataFromEvent(e);if(t)return Yt.assign(super.getDataFromEvent(e),t)}beforeContextMenuShow({record:e,items:t,column:n}){if(!1===n.cellMenuItems)return!1;e&&!e.isSpecialRow||(t.removeRow=!1)}populateCellMenu({items:e,column:t,record:n}){const{client:r}=this;null!=t&&t.cellMenuItems&&Yt.merge(e,t.cellMenuItems),r.readOnly||(e.removeRow={text:"L{removeRow}",localeClass:this,icon:"b-fw-icon b-icon-trash",cls:"b-separator",weight:100,disabled:n.readOnly,onItem:()=>r.store.remove(r.selectedRecords.filter((e=>!e.readOnly)))})}get showMenu(){return!0}}Tm.featureClass="",Tm._$name="CellMenu",gd.registerFeature(Tm,!0,["Grid","Scheduler"]),gd.registerFeature(Tm,!1,["Gantt"]);class Dm extends di{static $name="CellTooltip";static configurable={tooltipRenderer:null};construct(e,t){super.construct(e,this.processConfig(t))}initTip(){const e=this;e.tip=ec.new({forElement:e.client.element,forSelector:".b-grid-row:not(.b-group-row) .b-grid-cell, .b-grid-merged-cells",hoverDelay:1e3,trackMouse:!1,cls:"b-celltooltip-tip",getHtml:e.getTooltipContent.bind(e),internalListeners:{pointerOver:"onPointerOver",thisObj:e},listeners:e.configuredListeners},e.initialConfig),e.relayEvents(e.tip,["beforeShow","show"])}onPointerOver({target:e}){const t=this.client.getColumnFromElement(e);return!1!==t.tooltipRenderer&&Boolean(t.tooltipRenderer||this.tooltipRenderer)}processConfig(e){return"function"==typeof e?{tooltipRenderer:e}:e}setConfig(e){super.setConfig(this.processConfig(e))}doDestroy(){this.tip&&this.tip.destroy(),super.doDestroy()}doDisable(e){e?this.tip&&(this.tip.destroy(),this.tip=null):this.initTip(),super.doDisable(e)}getTooltipContent({tip:e,activeTarget:t,event:n}){const r=this,i=r.client.getRecordFromElement(t),o=r.client.getColumnFromElement(t),s={cellElement:t,record:i,column:o,event:n,tip:e,cellTooltip:r};let l;return r.forSelector||i!==r.lastRecord||i.generation!==r.lastRecordGeneration||o!==r.lastColumn?(r.lastRecord=i,r.lastRecordGeneration=i.generation,r.lastColumn=o,o.tooltipRenderer?l=o.tooltipRenderer(s):r.tooltipRenderer&&!1!==o.tooltipRenderer&&(l=r.tooltipRenderer(s)),m.isPromise(l)&&(r.lastRecord=r.lastRecordGeneration=r.lastColumn=null),l||e.hide(),l):r.tip._html}}Dm._$name="CellTooltip",gd.registerFeature(Dm);const Mm="store";class Fm extends(ai(di)){static $name="ColumnAutoWidth";static configurable={default:null,delay:0};static get pluginConfig(){return{after:{bindStore:"bindStore",unbindStore:"unbindStore",renderRows:"syncAutoWidthColumns",onInternalResize:"onInternalResize"},assign:["columnAutoWidthPending","syncAutoWidthColumns"]}}construct(e){super.construct(e);const{store:t}=this.client;t&&this.bindStore(t)}doDestroy(){this.unbindStore(),super.doDestroy()}bindStore(e){this.lastSync=null,e.ion({name:Mm,[`change${this.client.asyncEventSuffix}`]:"onStoreChange",thisObj:this})}unbindStore(){this.detachListeners(Mm)}get columnAutoWidthPending(){return null===this.lastSync||this.hasTimeout("syncAutoWidthColumns")}onStoreChange({action:e}){if("move"!==e){const e=this,{cellEdit:t}=e.client.features;++e.storeGeneration,null!=t&&t.isEditing&&!t.editingStoppedByTapOutside?e.syncAutoWidthColumns():e.hasTimeout("syncAutoWidthColumns")||e.setTimeout("syncAutoWidthColumns",e.delay)}}onInternalResize(e,t,n,r){0===r&&(this.lastSync=null,this.syncAutoWidthColumns())}syncAutoWidthColumns(){const e=this,{client:t,storeGeneration:n}=e;if(!t.splitFrom){if(e.lastSync!==n){let r,i;e.lastSync=n;for(const n of t.columns.visibleColumns)r=n.autoWidth,r&&(!0===r&&(r=e.default),t.resizingColumns=i=!0,n.resizeToFitContent(r));i&&(t.resizingColumns=!1,t.afterColumnsResized())}e.hasTimeout("syncAutoWidthColumns")&&e.clearTimeout("syncAutoWidthColumns")}}}Fm.prototype.storeGeneration=0,Fm._$name="ColumnAutoWidth",gd.registerFeature(Fm,!0);class Im extends(ai(di)){static get $name(){return"ColumnDragToolbar"}static get pluginConfig(){return{after:["render"]}}construct(e,t){e.features.columnReorder&&e.features.columnReorder.ion({beforeDestroy:"onColumnReorderBeforeDestroy",thisObj:this}),this.grid=e,super.construct(e,t)}doDestroy(){const e=this;e.grid.features.columnReorder&&!e.grid.features.columnReorder.isDestroyed&&e.detachFromColumnReorder(),e.element&&e.element.remove(),e.element=null,super.doDestroy()}doDisable(e){this.initialized&&(e?this.detachFromColumnReorder():this.init()),super.doDisable(e)}init(){const e=this,t=e.grid;t.features.columnReorder&&(e.reorderDetacher=t.features.columnReorder.ion({gridheaderdragstart({context:n}){const r=t.columns.getById(n.element.dataset.columnId);e.showToolbar(r)},gridheaderdrag:({context:t})=>e.onDrag(t),gridheaderabort:()=>{e.hideToolbar()},gridHeaderDrop:e.onDrop,thisObj:e}),e.initialized=!0)}onColumnReorderBeforeDestroy(){this.detachFromColumnReorder()}detachFromColumnReorder(){const e=this;e.grid.features.columnReorder.un("beforedestroy",e.onColumnReorderBeforeDestroy,e),e.reorderDetacher&&e.reorderDetacher(),e.reorderDetacher=null}render(){this.initialized||this.init()}showToolbar(e){const t=this,n=t.grid.getColumnDragToolbarItems(e,[]),r=[];t.clearTimeout(t.buttonHideTimer),n.forEach((e=>{e.text=e.localeClass.L(e.text);let t=r.find((t=>t.text===e.group));t||(t={text:e.localeClass.L(e.group),buttons:[]},r.push(t)),t.buttons.push(e)})),t.element=Lr.append(t.grid.element,t.template(r)),t.groups=r,t.buttons=n,t.column=e}async hideToolbar(){const e=this,t=e.element;t&&(t.classList.add("b-remove"),await Gn.waitForTransitionEnd({element:t,mode:"animation",thisObj:e.client}),t.remove(),e.element=null)}onDrag(e){var t;const n=this;if(e.dragProxy.getBoundingClientRect().top-n.grid.element.getBoundingClientRect().top>100?n.element.classList.add("b-closer"):n.element.classList.remove("b-closer"),n.hoveringButton&&(n.hoveringButton.classList.remove("b-hover"),n.hoveringButton=null),null!==(t=e.targetElement)&&void 0!==t&&t.closest(".b-columndragtoolbar")){n.element.classList.add("b-hover");const t=e.targetElement.closest(".b-columndragtoolbar  .b-target-button:not([data-disabled=true])");t&&(t.classList.add("b-hover"),n.hoveringButton=t)}else n.element.classList.remove("b-hover")}onDrop({context:e}){const t=this,{targetElement:n}=e;if(n&&n.matches(".b-columndragtoolbar .b-target-button:not([data-disabled=true])")){const e=t.buttons.find((e=>e.ref===n.dataset.ref));e&&(n.classList.add("b-activate"),t.buttonHideTimer=t.setTimeout((()=>{t.hideToolbar(),e.onDrop({column:t.column})}),100))}else t.hideToolbar()}template(e){return hc.tpl`
            <div class="b-columndragtoolbar">     
            <div class="b-title"></div>          
            ${e.map((e=>hc.tpl`
                <div class="b-group">
                    <div class="b-buttons">
                    ${e.buttons.map((e=>hc.tpl`
                        <div class="b-target-button" data-ref="${e.ref}" data-disabled="${e.disabled}">
                            <i class="${e.icon}"></i>
                            ${e.text}
                        </div>
                    `))}
                    </div>
                    <div class="b-title">${e.text}</div>
                </div>
            `))}
            </div>`}}Im.featureClass="b-hascolumndragtoolbar",Im._$name="ColumnDragToolbar",gd.registerFeature(Im,s.isTouchDevice);class km extends di{static $name="ColumnPicker";static configurable={groupByRegion:!1,groupByTag:!1,createColumnsFromModel:!1,menuCls:"b-column-picker-menu b-sub-menu"};static get pluginConfig(){return{chain:["populateHeaderMenu","getColumnDragToolbarItems"]}}get grid(){return this.client}getColumnPickerItems(e){const t=this,{createColumnsFromModel:n}=t;let r;if(t.groupByRegion)r=t.grid.regions.map((e=>{const n=t.grid.getSubGrid(e).columns.topColumns;return{text:A.capitalize(e),menu:t.buildColumnMenu(n),disabled:0===n.length,region:e}})),n&&r.push({text:t.L("L{newColumns}"),menu:t.createAutoColumnItems()});else if(t.groupByTag){const i={};e.topColumns.forEach((e=>{e.tags&&Array.isArray(e.tags)&&!1!==e.hideable&&e.tags.forEach((e=>{i[e]||(i[e]=1)}))})),r=Object.keys(i).sort().map((e=>({text:A.capitalize(e),menu:t.buildColumnMenu(t.getColumnsForTag(e)),tag:e,onBeforeSubMenu:({item:e,itemEl:n})=>{t.refreshTagMenu(e,n)}}))),n&&r.push({text:t.L("L{newColumns}"),menu:t.createAutoColumnItems()})}else r=t.buildColumnMenu(e.topColumns),n&&r.items.push(...Yt.transformNamedObjectToArray(t.createAutoColumnItems()));return r}createAutoColumnItems(){const e=this,{grid:t}=e,{columns:n,store:r}=t,{modelClass:i}=r,{allFields:o}=i,s={};for(let t=0,{length:r}=o;t<r;t++){const r=o[t],i=r.name;n.get(i)||r.internal||(s[i]={text:r.text||A.separate(r.name),checked:!1,onToggle:t=>{const o=n.get(i);o?o[t.checked?"show":"hide"]():n.add(n.generateColumnForField(r,{region:e.forColumn.region})),t.bubbles=!1}})}return s}getColumnsForTag(e){return this.grid.columns.records.filter((t=>t.tags&&Array.isArray(t.tags)&&t.tags.includes(e)&&!1!==t.hideable))}refreshTagMenu(e,t){this.getColumnsForTag(e.tag).forEach((t=>{const n=e.items.find((e=>e.column===t));n&&(n.checked=!0!==t.hidden)}))}buildColumnMenu(e){let t=e.length>0&&e[0].region;const{grid:n}=this,r=e.reduce(((e,r)=>{const i=n.columns.visibleColumns.filter((e=>e.region===r.region));if(!1!==r.hideable){const o={grid:n,column:r,text:r.headerText,checked:!0!==r.hidden,disabled:!0!==r.hidden&&1===i.length,cls:r.region!==t?"b-separator":""};t=r.region,r.children&&!r.isCollapsible&&(o.menu=this.buildColumnMenu(r.children)),e.push(o)}return e}),[]);return{cls:this.menuCls,items:r}}populateHeaderMenu({column:e,items:t}){const n=this,{columns:r}=n.grid;n.forColumn=e,!1!==e.showColumnPicker&&r.some((e=>e.hideable))&&(t.columnPicker={text:"L{columnsMenu}",localeClass:n,icon:"b-fw-icon b-icon-columns",cls:"b-separator",weight:200,menu:n.getColumnPickerItems(r),onToggle:n.onColumnToggle,disabled:n.disabled}),!1===e.hideable||e.parent.isCollapsible||(t.hideColumn={text:"L{hideColumn}",localeClass:n,icon:"b-fw-icon b-icon-hide-column",weight:210,disabled:!e.allowDrag||n.disabled,onItem:()=>e.hide()})}onColumnToggle({menu:e,item:t,checked:n}){if(Boolean(t.column.hidden)!==!n){var r,i;t.column[n?"show":"hide"]();const{grid:o,column:s}=t,{columns:l,features:a}=o,c=e.items,d=l.visibleColumns.filter((e=>e.region===t.column.region)),u=(null===(r=a.headerMenu)||void 0===r?void 0:r.enabled)&&a.headerMenu.menu.widgetMap.hideColumn;if(1===d.length){const e=c.find((e=>e.column===d[0]));e&&(e.disabled=!0),u&&s.region===t.column.region&&(u.disabled=!0)}else d.forEach((e=>{const t=c.find((t=>t.column===e));t&&(t.disabled=!1)})),u&&s.region===t.column.region&&(u.disabled=!1);null===(i=t.menu)||void 0===i||i.eachWidget((e=>{e.checked=n}));const h=e.owner;h&&h.column===s.parent&&(h.checked=c.some((e=>!0===e.checked)))}}getColumnDragToolbarItems(e,t){const n=this.grid.columns.visibleColumns.filter((t=>t.region===e.region));return!1!==e.hideable&&n.length>1&&t.push({text:"L{hideColumnShort}",ref:"hideColumn",group:"L{column}",localeClass:this,icon:"b-fw-icon b-icon-hide-column",weight:101,onDrop:({column:e})=>e.hide()}),t}}km._$name="ColumnPicker",gd.registerFeature(km,!0);class Om extends di{static $name="ColumnRename";static configurable={keyMap:{F2:"startEdit"}};doDestroy(){var e;null===(e=this.editor)||void 0===e||e.destroy(),super.doDestroy()}static get pluginConfig(){return{after:["populateHeaderMenu"]}}populateHeaderMenu({items:e,column:t}){e.rename={weight:215,icon:"b-fw-icon b-icon-edit",text:this.L("L{rename}"),disabled:t.readOnly,onItem:()=>this.startEdit(t)}}startEdit(e){var t;e instanceof Event&&(e=null===(t=this.client.getHeaderDataFromEvent(e))||void 0===t?void 0:t.column);if(e){if(e.readOnly)return!1;const{textWrapper:t}=e;let{editor:n}=this;n||(this.editor=n=new op({owner:this.client,align:{align:"t0-t0"}})),n.render(t),n.startEdit({target:t,record:e,field:"text"})}}}Om._$name="ColumnRename",gd.registerFeature(Om,!1);class Lm extends(ai(di)){static $name="ColumnReorder";ignoreSelectors=[".b-grid-header-resize-handle",".b-field"];static pluginConfig={after:["onPaint","renderContents"]};init(){const e=this,{grid:t}=e,n=t.element,r=Lr.children(n,".b-grid-headers");r.push(...Lr.children(n,".b-grid-header-children")),e.dragHelper?e.dragHelper.containers=r:t.whenVisible((()=>e.createDragHelper()))}createDragHelper(){const e=this,{grid:t}=e,n=t.element,r=Lr.children(n,".b-grid-headers");return r.push(...Lr.children(n,".b-grid-header-children")),e.dragHelper=new Oc({name:"columnReorder",mode:"container",dragThreshold:10,targetSelector:".b-grid-header",floatRootOwner:t,rtlSource:t,outerElement:t.headerContainer,dropTargetSelector:".b-grid-headers, .b-groupbar, .b-columndragtoolbar",externalDropTargetSelector:".b-groupbar, .b-columndragtoolbar",monitoringConfig:{scrollables:[{element:".b-grid-headers"}]},scrollManager:zc.new({direction:"horizontal",element:t.headerContainer}),containers:r,isElementDraggable(n){if(Boolean(n.closest(e.ignoreSelectors.join(",")))||e.disabled)return!1;const r=n.closest(this.targetSelector),i=r&&t.columns.getById(r.dataset.columnId),o=0===(null==i?void 0:i.childLevel)&&1===t.subGrids[i.region].columns.count;return Boolean(i)&&!1!==i.draggable&&!o},ignoreSelector:".b-filter-icon,.b-grid-header-resize-handle",internalListeners:{beforeDragStart:e.onBeforeDragStart,dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,abort:e.onAbort,thisObj:e}}),e.relayEvents(e.dragHelper,["dragStart","drag","drop","abort"],"gridHeader"),e.dragHelper}doDestroy(){var e,t;null===(e=this.dragHelper)||void 0===e||e.scrollManager.destroy(),null===(t=this.dragHelper)||void 0===t||t.destroy(),super.doDestroy()}get grid(){return this.client}onBeforeDragStart({context:e,event:t}){const n=this,{element:r}=e,i=e.column=n.client.columns.getById(r.dataset.columnId);return n.dragHelper.autoSizeClonedTarget=!n.usingGroupBarWidget,i.allowDrag&&n.client.trigger("beforeColumnDragStart",{column:i,event:t})}onDragStart({context:e,event:t}){const n=this,{grid:r,usingGroupBarWidget:i}=n,{column:o,dragProxy:s}=e;if(!r.features.columnDragToolbar&&!i){const e=r.element.querySelector(".b-grid-header-container").getBoundingClientRect();n.dragHelper.minY=e.top,n.dragHelper.maxY=e.bottom}r.element.classList.add("b-dragging-header"),i&&s.classList.add("b-grid-reordering-columns-with-groupbar"),r.features.filterBar&&r.features.filterBar.compactMode&&s.classList.add("b-filter-bar-compact"),s.style.fontSize=Lr.getStyleValue(e.element,"fontSize"),r.trigger("columnDragStart",{column:o,event:t})}onDrag({context:e,event:t}){const n=this.client,{column:r,insertBefore:i}=e,o=n.columns.getById(null==i?void 0:i.dataset.columnId),s=ul.fromElement(t.target,"gridheader");null!=s&&s.subGrid.sealedColumns&&(e.valid=!1),n.trigger("columnDrag",{column:r,insertBefore:o,event:t,context:e})}onDrop({context:e,event:t}){var n;if(!e.valid)return this.onInvalidDrop({context:e,event:t});const{grid:r}=this,{column:i}=e,o=e.dragging,s=e.target.closest(".b-grid-header"),l=null===(n=e.draggedTo)||void 0===n?void 0:n.dataset.region,a=l||s;let c,d,u,h,g;if(r.element.classList.remove("b-dragging-header"),a){const t=s?r.columns.get(s.dataset.column):r.subGrids[l].columns.last,n=e.insertBefore;if(h=l||t.region,g=i.parent,u=n?r.columns.getById(n.dataset.columnId):r.subGrids[h].columns.last.nextSibling,u)d=u.parent;else{const e=null==s?void 0:s.parentElement.closest(".b-grid-header");d=e?r.columns.getById(e.dataset.columnId):r.columns.rootNode}c=h===i.region&&g===d&&(t===i.previousSibling||u===i.nextSibling),o.remove()}c=c||!1===r.trigger("beforeColumnDropFinalize",{column:i,newParent:d,insertBefore:u,event:t,region:h}),!c&&a&&(c=!d.insertChild(i,u)),e.valid=!c,!c&&a&&(i.region=h,0===g.children.length&&g.parent.removeChild(g)),r.trigger("columnDrop",{column:i,newParent:d,insertBefore:u,valid:e.valid,event:t,region:h})}onAbort({context:e,event:t}){this.onInvalidDrop({context:e,event:t})}onInvalidDrop({context:e,event:t}){const{grid:n}=this,{column:r}=e;n.trigger("columnDrop",{column:r,valid:!1,event:t}),n.element.classList.remove("b-dragging-header")}renderContents(){this.init()}onPaint(){this.init()}get isReordering(){var e;return Boolean(null===(e=this.dragHelper)||void 0===e?void 0:e.isDragging)}}Lm.featureClass="b-column-reorder",Lm._$name="ColumnReorder",gd.registerFeature(Lm,!0);class Am extends di{static get $name(){return"ColumnResize"}static get configurable(){return{liveResize:"auto"}}construct(e,t){const n=this;n.grid=e,super.construct(e,t),n.resizer=new dh({name:"columnResize",targetSelector:".b-grid-header",handleSelector:".b-grid-header-resize-handle",outerElement:e.element,rtlSource:e,internalListeners:{beforeresizestart:n.onBeforeResizeStart,resizestart:n.onResizeStart,resizing:n.onResizing,resize:n.onResize,cancel:n.onCancel,thisObj:n}})}doDestroy(){var e;null===(e=this.resizer)||void 0===e||e.destroy(),super.doDestroy()}changeLiveResize(e){return"auto"===e?!s.isMobileSafari:e}onBeforeResizeStart(){return!this.disabled}onResizeStart({context:e}){const{grid:t,resizer:n}=this,r=e.column=t.columns.getById(e.element.dataset.columnId);n.minWidth=r.minWidth,t.element.classList.add("b-column-resizing")}onResizing({context:e}){e.valid&&this.liveResize&&(this.grid.resizingColumns=!0,e.column.width=e.newWidth)}onResize({context:e}){const{grid:t}=this,{column:n}=e;t.element.classList.remove("b-column-resizing"),e.valid&&(this.liveResize?(t.resizingColumns=!1,t.afterColumnsResized(n)):n.width=e.newWidth)}onCancel({context:e}){const{grid:t}=this;t.element.classList.remove("b-column-resizing"),e.column.width=e.elementWidth,t.resizingColumns=!1}}Am._$name="ColumnResize",gd.registerFeature(Am,!0);class Pm extends(di.mixin(ai)){static $name="FillHandle";static configurable={calculateFillValue:null,allowCropping:!1};static pluginConfig={chain:["afterSelectionChange","onContentChange","afterColumnsChange","fixElementHeights"],override:["getCellDataFromEvent"]};afterConstruct(){super.afterConstruct(),this.client.selectionMode.cell||(this.disabled=!0),this._fillListeners={}}delayable={handleSelection:"raf"};onContentChange(){this.handleSelection()}afterColumnsChange(){this.handleSelection()}fixElementHeights(){this.handleSelection()}getCellDataFromEvent(e,t){return t&&(t=!e.target.classList.contains("b-fill-handle")),this.overridden.getCellDataFromEvent(e,t)}findPatternsIn2dRange(e,t,n){const r={};for(const n of e){const e=t?n.id:n.columnId;let i=n.record.getValue(n.column.field);i&&"string"==typeof i&&!isNaN(i)&&(i=parseFloat(i)),r[e]||(r[e]=[]),r[e].push(i)}for(const e in r)r[e].pattern=this.findPatternsIn1dRange(r[e],n);return r}findPatternsIn1dRange(e,t){const n=e[t?0:e.length-1],r={next:()=>n,lastValue:n};if(e.every((e=>"number"==typeof e))||e.every((e=>e instanceof Date))){const n=e.map(((t,n)=>t-e[n-1]));n.shift(),1===new Set(n).size&&(r.increaseBy=n[0]*(t?-1:1),r.next=()=>(r.lastValue instanceof Date?r.lastValue=new Date(r.lastValue.getTime()+r.increaseBy):r.lastValue+=r.increaseBy,r.lastValue))}else e.length>1&&(r.stringPattern=[...e],r.next=()=>(r.currentIndex===i?r.currentIndex=0:(r.currentIndex+=1,r.currentIndex>=r.stringPattern.length&&(r.currentIndex=0)),r.stringPattern[r.currentIndex]));return r}afterSelectionChange(){const e=this;e.client.readOnly?e.removeElements():Rn.isMouseDown()?(e.client.delayUntilMouseUp((()=>e.handleSelection(!0))),e.removeElements()):e.handleSelection(!0)}handleSelection(){if(!this._isExtending){const e=this.rangeSelection;e?this.drawFillHandleAndBorder(e[0],e[e.length-1]):this.removeElements()}}onMouseDown(e){const{client:t}=this;t.readOnly||(this._fillListeners.mouseMoveOrUp=Gn.on({element:r,mouseover:{handler:"onMouseOver",element:t.selectionDragMouseEventListenerElement},mouseup:"onMouseUp",thisObj:this}),e.preventDefault(),e.stopImmediatePropagation(),e.handled=!0)}onMouseUp(){const e=this,{client:t,currentRange:n,_isCropping:r}=e,o=e.rangeSelection,s=o&&n&&t.internalSelectRange(n.from,n.to),l=(null==s?void 0:s.selectedCells)||[],a=r?e.croppingCells:l.filter((e=>!o.some((t=>t.equals(e,!0)))));if(delete e._isCropping,e._isExtending&&(t.disableScrollingCloseToEdges(t.items),delete e._isExtending),null!=a&&a.length){if(t.suspendRefresh(),r)a.forEach((e=>e.record.set(e.column.field,null,!1,!1,!1,!0)));else{const[t]=a,n=o.some((e=>e.record===t.record)),r=n?t.columnIndex<o[0].columnIndex:t.rowIndex<o[0].rowIndex,s=e.findPatternsIn2dRange(o,n,r),l=new Map;r&&a.reverse();for(const t of a){const{column:r,record:a}=t;if(!r.readOnly&&r.canFillValue({range:o,record:a,cell:t})){var c,d;let u=null===(c=e.calculateFillValue)||void 0===c?void 0:c.call(e,{range:o,column:r,record:a,cell:t}),h=l.get(a);if(h||(h={},l.set(a,h)),u===i){u=s[n?t.id:t.columnId].pattern.next()}h[r.field]=(null===(d=r.calculateFillValue)||void 0===d?void 0:d.call(r,{value:u,record:a,range:o}))||u}}for(const[e,t]of l)e.set(t,null,null,null,null,!0)}t.resumeRefresh(!0),t.performSelection(s),delete e.currentRange,e.handleSelection()}else e.handleSelection()}onMouseOver(e){var t,n;const r=this,{client:i,rangeSelection:o}=r,s=o[0],l=o[o.length-1],a=i.getCellDataFromEvent(e,!0);let c=a&&i.normalizeCellContext(a.cellSelector);if((null===(t=c)||void 0===t||null===(n=t._column)||void 0===n?void 0:n.region)===s._column.region){const e=o.some((e=>e.equals(c,!0)));let t;r._isExtending||i.enableScrollingCloseToEdges(i.items),e?r._isCropping=r.allowCropping&&(c.rowIndex<l.rowIndex||c.columnIndex<l.columnIndex):c.rowIndex>=s.rowIndex&&c.rowIndex<=l.rowIndex?(t=s.columnIndex>c.columnIndex,c=new Hc({grid:i,record:t?s.record:l.record,column:c.column})):(t=s.rowIndex>c.rowIndex,c=new Hc({grid:i,record:c.record,column:t?s.column:l.column}));const n=t?c:s,a=t||e&&!r._isCropping?l:c;r.currentRange={from:n,to:a},r._isExtending=!0,r.drawFillHandleAndBorder(n,a,!0)}}drawFillHandleAndBorder(e,t,n=!1){var r;const i=this,{client:o,currentRange:s,_fillListeners:l}=i,a=o.subGrids[e.column.region].element,{x:c}=bn.from(e.cell||e.column.element,a),{right:d}=bn.from(t.cell||t.column.element,a),{y:u}=o.getRecordCoords(e.record,!0),h=o.getRecordCoords(t.record,!0).bottom-1;let{borderElement:g,handleElement:p}=i;if(i.removeElements(n),g||(i.borderElement=g=Lr.createElement({className:"b-fill-selection-border"}),i.handleElement=p=Lr.createElement({className:"b-fill-handle"})),Lr.setRect(g,{y:u,x:c,width:d-c,height:h-u}),a.appendChild(g),Lr.setTopLeft(p,h,d>=a.scrollWidth?c:d),a.appendChild(p),i.toggleCroppingCls(!1),delete i.croppingCells,i._isCropping&&null!==(r=i.rangeSelection)&&void 0!==r&&r.length){const e=o.getRange(s.from,s.to);i.croppingCells=i.rangeSelection.filter((t=>!e.some((e=>e.equals(t,!0))))),i.toggleCroppingCls()}l.handleClick||(l.handleClick=Gn.on({element:o.rootElement,delegate:".b-fill-handle",mousedown:"onMouseDown",thisObj:i})),i.hasFillElements=!0}toggleCroppingCls(e=!0){var t;null===(t=this.croppingCells)||void 0===t||t.forEach((t=>{var n;return null===(n=this.client.getCell(t))||void 0===n?void 0:n.classList.toggle("b-indicate-crop",e)}))}removeElements(e=!1){var t,n;const r=this;null===(t=r.handleElement)||void 0===t||t.remove(),null===(n=r.borderElement)||void 0===n||n.remove(),e||r.removeListeners(),r.hasFillElements=!1}removeListeners(){const e=this;for(const t in e._fillListeners)e._fillListeners[t]();e._fillListeners={}}get rangeSelection(){const{client:e}=this,{selectedCells:t}=e,n=e._shiftSelectRange??(1===t.length&&t);return!e._selectedRows.length&&null!=n&&n.length&&n.length===t.length&&n.every((r=>t.some((e=>r.equals(e,!0)))&&r._column.parent&&r._column.region===n[0]._column.region&&e.store.isAvailable(r.id)))?n:null}}Pm._$name="FillHandle",gd.registerFeature(Pm);class _m extends up{static get $name(){return"GridFieldFilterPicker"}static get type(){return"gridfieldfilterpicker"}static configurable={grid:null,allowedFieldNames:null};afterConstruct(){const e=this;if(!e.grid)throw new Error(`${e.constructor.$name} requires 'grid' to be configured.`);e.fields=e.fields??{},super.afterConstruct()}updateGrid(e){var t;if(null===(t=e.store)||void 0===t||!t.modelClass)throw new Error("Grid does not have a store with a modelClass defined.");if(!e.columns)throw new Error("Grid does not have a column store.")}static getModelClassFields(e){const t=new Set(e.fields.map((({name:e})=>e)));return(null==e?void 0:e.allFields.filter((e=>!e.internal&&(sp.includes(e.type)||lp(e))&&(e.definedBy!==io||t.has(e.name)))))||[]}static getColumnFields(e,t){const n=H.keyBy(_m.getModelClassFields(t),"name");return Object.fromEntries((null==e?void 0:e.records.filter((({field:e})=>e&&n[e])).map((({field:e,text:t})=>[e,{title:t||e,type:lp(n[e])?"duration":n[e].type}])))??[])}changeFields(e){var t;let n=e;Array.isArray(e)&&(P.deprecate("Core","6.0.0","FieldOption[] deprecated, use Object<String, FieldOption[]> keyed by field name instead"),n=H.keyBy(n,"name"));const r=Yt.merge({},_m.getColumnFields(this.grid.columns,null===(t=this.grid.store)||void 0===t?void 0:t.modelClass),n);return this.allowedFieldNames?Object.fromEntries(this.allowedFieldNames.map((e=>[e,r[e]]))):r}}_m.initClass(),_m._$name="GridFieldFilterPicker";class $m extends gp{static get $name(){return"GridFieldFilterPickerGroup"}static get type(){return"gridfieldfilterpickergroup"}static configurable={grid:null,allowedFieldNames:null};static childPickerType="gridfieldfilterpicker";validateConfig(){if(!this.grid)throw new Error(`${this.constructor.$name} requires the 'grid' config property.`)}getFilterPickerConfig(e){const{grid:t,allowedFieldNames:n,fields:r}=this;return{...super.getFilterPickerConfig(e),fields:r,grid:t,allowedFieldNames:n}}updateGrid(e){this.store=this.grid.store}canManage(e){return super.canManage(e)&&(!this.allowedFieldNames||this.allowedFieldNames.includes(e.property))}}$m.initClass(),$m._$name="GridFieldFilterPickerGroup";const Nm={date:"date",int:"number",integer:"number",number:"number",string:"text",duration:"duration"};class Hm extends di{static get $name(){return"Filter"}static get configurable(){return{prioritizeColumns:!1,keyMap:{f:"showFilterEditorByKey"},isMulti:!1}}construct(e,t){if(e.features.filterBar)throw new Error("Grid.feature.Filter feature may not be used together with Grid.feature.FilterBar. These features are mutually exclusive.");const n=this;if(n.grid=e,n.closeFilterEditor=n.closeFilterEditor.bind(n),super.construct(e,t),n.bindStore(e.store),t&&"object"==typeof t){const n=Yt.clone(t);delete n.prioritizeColumns,delete n.isMulti,delete n.dateFormat,Yt.isEmpty(n)||e.store.filter(n,null,e.isConfiguring)}}doDestroy(){var e,t;null===(e=this.filterTip)||void 0===e||e.destroy(),null===(t=this.filterEditorPopup)||void 0===t||t.destroy(),super.doDestroy()}get store(){return this.grid.store}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeFilter:"onStoreBeforeFilter",filter:"onStoreFilter",thisObj:this}),this.client.isPainted&&this.refreshHeaders(!1)}static get pluginConfig(){return{chain:["renderHeader","populateCellMenu","populateHeaderMenu","onElementClick","bindStore"]}}refreshHeaders(e){const t=this,n=t.grid,r=n.headerContainer;r&&(Lr.children(r,".b-filter-icon.b-latest").forEach((e=>e.classList.remove("b-latest"))),t.filterTip||(t.filterTip=new ec({forElement:r,forSelector:".b-filter-icon",getHtml:({activeTarget:e})=>e.dataset.filterText})),n.store.isFiltered||t.filterTip.hide(),n.columns.visibleColumns.forEach((e=>{if(!1!==e.filterable){const n=t.store.filters.allValues.filter((({property:t,disabled:n,internal:r})=>t===e.field&&!n&&!r)),r=n.length>0,i=e.element;if(i){const o=e.textWrapper;let s,l=null==o?void 0:o.querySelector(".b-filter-icon");if(r){const r="&#x2022 ";s=`${t.L("L{filter}")}: `+(n.length>1?"<br/><br/>":"")+n.map((i=>{var o,s;let l=i.value??"";const a=Array.isArray(l),c=null===(o=t.store)||void 0===o||null===(s=o.modelRelations)||void 0===s?void 0:s.find((({foreignKey:e})=>e===i.property));if(i.displayValue)l=i.displayValue;else{if(t.isMulti&&c){var d;const{relatedDisplayField:e}=null===(d=t.isMulti.fields)||void 0===d?void 0:d[i.property];if(e){const t=t=>{var n;return null===(n=c.foreignStore.getById(t))||void 0===n?void 0:n[e]};l=a?l.map(t).sort(((e,t)=>(e??"").localeCompare(t??""))):t(l)}}else e.formatValue&&l&&(l=a?l.map((t=>e.formatValue(t))):e.formatValue(l));a&&(l=`[ ${l.join(", ")} ]`)}return(n.length>1?r:"")+("string"==typeof i?i:`${i.operator} ${l}`)})).join("<br/><br/>")}else s=t.L("L{applyFilter}");l?l.dataset.filterText=s:l=Lr.createElement({parent:o,tag:"div",className:"b-filter-icon",dataset:{filterText:s}}),e.field===t.store.latestFilterField&&l.classList.add("b-latest"),i.classList.add("b-filterable"),i.classList.toggle("b-filter",r)}e.meta.isFiltered=r}})),e&&n.refreshRows())}applyFilter(e,t){const{store:n}=this,{filterFn:r}=e.filterable;e.$filter=n.addFilter({...e.filterable,...t,property:e.field,[r?"filterBy":"_"]:function(t){return r({value:this.value,record:t,operator:this.operator,property:this.property,column:e})}},!0),n.filter()}removeFilter(e){if(this.isMulti)for(const t of this.getCurrentMultiFilters(e))this.store.removeFilter(t);else this.store.removeFilter(e.field)}disableFilter(e){for(const t of this.getCurrentMultiFilters(e))t.disabled=!0,this.store.filter(t);this.store.filter()}getCurrentMultiFilters(e){return this.store.filters.values.filter((t=>t.property===e.field))}getPopupDateItems(e,t,n,r,i,o,s,l){const a=this,c=o;function d(){a.removeFilter(e)}function u({event:e}){"Enter"===e.key&&o()}function h({source:t,value:n}){null==n?d():(a.clearSiblingsFields(t),a.applyFilter(e,{operator:t.operator,value:n,displayValue:t._value,type:"date"}))}return[Yt.assign({type:"date",ref:"on",placeholder:"L{on}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"sameDay"===(null==n?void 0:n.operator)?n.value:r,operator:"sameDay",onKeydown:u,onChange:h,onClose:c,onClear:d},l),Yt.assign({type:"date",ref:"before",placeholder:"L{before}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-before"></i>',value:"<"===(null==n?void 0:n.operator)?n.value:null,operator:"<",onKeydown:u,onChange:h,onClose:c,onClear:d},l),Yt.assign({type:"date",ref:"after",cls:"b-last-row",placeholder:"L{after}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-after"></i>',value:">"===(null==n?void 0:n.operator)?n.value:null,operator:">",onKeydown:u,onChange:h,onClose:c,onClear:d},l)]}getPopupNumberItems(e,t,n,r,i,o,s,l){const a=this,c=o;function d(){a.removeFilter(e)}function u({event:e}){"Enter"===e.key&&o()}function h({source:t,value:n}){null==n?d():(a.clearSiblingsFields(t),a.applyFilter(e,{operator:t.operator,value:n}))}return[Yt.assign({type:"number",placeholder:"L{Filter.equals}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==n?void 0:n.operator)?n.value:r,operator:"=",onKeydown:u,onChange:h,onEsc:c,onClear:d},l),Yt.assign({type:"number",placeholder:"L{lessThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:"<"===(null==n?void 0:n.operator)?n.value:null,operator:"<",onKeydown:u,onChange:h,onEsc:c,onClear:d},l),Yt.assign({type:"number",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:">"===(null==n?void 0:n.operator)?n.value:null,operator:">",onKeydown:u,onChange:h,onEsc:c,onClear:d},l)]}clearSiblingsFields(e){var t;null===(t=this.filterEditorPopup)||void 0===t||t.items.forEach((t=>{t!==e&&(null==t||t.clear())}))}getPopupDurationItems(e,t,n,r,i,o,s,l){const a=this,c=o,d=()=>a.removeFilter(e);function u({source:t,value:n}){null==n?d():(a.clearSiblingsFields(t),a.applyFilter(e,{operator:t.operator,value:n}))}return[Yt.assign({type:"duration",placeholder:"L{Filter.equals}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==n?void 0:n.operator)?n.value:r,operator:"=",onChange:u,onEsc:c,onClear:d},l),Yt.assign({type:"duration",placeholder:"L{lessThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:"<"===(null==n?void 0:n.operator)?n.value:null,operator:"<",onChange:u,onEsc:c,onClear:d},l),Yt.assign({type:"duration",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:">"===(null==n?void 0:n.operator)?n.value:null,operator:">",onChange:u,onEsc:c,onClear:d},l)]}getPopupStringItems(e,t,n,r,o,s,l,a){const c=this;return[Yt.assign({type:t,cls:"b-last-row",placeholder:"L{filter}",localeClass:c,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:n?n.value||n:r,operator:"*",onChange({source:t,value:n}){""===n?l():(c.applyFilter(e,{operator:t.operator,value:n,displayValue:t.displayField&&t.records?t.records.map((e=>e[t.displayField])).join(", "):i}),t.multiSelect||s())},onClose:s,onClear:l},a)]}getPopupItems(e,t,n,r,i,o,s,l){const a=this;if(a.isMulti)return a.getMultiFilterPopupItems(...arguments);switch(t){case"date":return a.getPopupDateItems(...arguments);case"number":return a.getPopupNumberItems(...arguments);case"duration":return a.getPopupDurationItems(...arguments);default:return a.getPopupStringItems(...arguments)}}getMultiFilterPopupItems(e){var t;const{grid:n,isMulti:r}=this,o=null===(t=n.store)||void 0===t?void 0:t.filters.find((t=>t.property===e.field));return[{..."object"==typeof r?r:i,type:"gridfieldfilterpickergroup",ref:"pickerGroup",limitToProperty:e.field,grid:n,filters:o?[]:[{property:e.field}],propertyFieldCls:"b-transparent property-field",operatorFieldCls:"b-transparent operator-field",valueFieldCls:"b-transparent value-field",width:360}]}showFilterEditor(e,t){e=this.grid.columns.getById(e);const n=this,{store:r,isMulti:i}=n,o=e.element,s=r.filters.getBy("property",e.field),l=n.getFilterType(e);if(!1===e.filterable)return;n.closeFilterEditor();const a=n.getPopupItems(e,l,null!=s&&s.internal?null:s,t,r,n.closeFilterEditor,(()=>{n.removeFilter(e),n.closeFilterEditor()}),e.filterable.filterField,i);a.forEach((e=>e.placeholder=e.placeholder?this.L(e.placeholder):e.placeholder)),n.filterEditorPopup=Td.openPopup(o,{owner:n.grid,cls:"b-filter-popup",scrollAction:"realign",layout:{type:"vbox",align:"stretch"},items:a})}closeFilterEditor(){var e;null===(e=this.filterEditorPopup)||void 0===e||e.setTimeout(this.filterEditorPopup.destroy),this.filterEditorPopup=null}getFilterType(e){const t=e.field,n=this.client.store.modelClass.getFieldDefinition(t),r=e.filterType;return r?Nm[r]:Nm[e.type]||n&&Nm[n.type]||"text"}populateCellMenuWithDateItems({column:e,record:t,items:n}){const r=e.field;if("date"===this.getFilterType(e)){const i=this,o=t.getValue(r),s=t=>{i.applyFilter(e,{operator:t,value:o,displayValue:e.formatValue?e.formatValue(o):o,type:"date"})};n.filterDateEquals={text:"L{on}",localeClass:i,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:i.disabled,onItem:()=>s("=")},n.filterDateBefore={text:"L{before}",localeClass:i,icon:"b-fw-icon b-icon-filter-before",weight:310,disabled:i.disabled,onItem:()=>s("<")},n.filterDateAfter={text:"L{after}",localeClass:i,icon:"b-fw-icon b-icon-filter-after",weight:320,disabled:i.disabled,onItem:()=>s(">")}}}populateCellMenuWithNumberItems({column:e,record:t,items:n}){const r=e.field;if("number"===this.getFilterType(e)){const i=this,o=t.getValue(r),s=t=>{i.applyFilter(e,{operator:t,value:o})};n.filterNumberEquals={text:"L{equals}",localeClass:i,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:i.disabled,onItem:()=>s("=")},n.filterNumberLess={text:"L{lessThan}",localeClass:i,icon:"b-fw-icon b-icon-filter-less",weight:310,disabled:i.disabled,onItem:()=>s("<")},n.filterNumberMore={text:"L{moreThan}",localeClass:i,icon:"b-fw-icon b-icon-filter-more",weight:320,disabled:i.disabled,onItem:()=>s(">")}}}populateCellMenuWithDurationItems({column:e,record:t,items:n}){if("duration"===this.getFilterType(e)){const r=this,i=e.getFilterableValue(t),o=t=>{r.applyFilter(e,{operator:t,value:i})};n.filterDurationEquals={text:"L{equals}",localeClass:r,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:r.disabled,onItem:()=>o("=")},n.filterDurationLess={text:"L{lessThan}",localeClass:r,icon:"b-fw-icon b-icon-filter-less",weight:310,disabled:r.disabled,onItem:()=>o("<")},n.filterDurationMore={text:"L{moreThan}",localeClass:r,icon:"b-fw-icon b-icon-filter-more",weight:320,disabled:r.disabled,onItem:()=>o(">")}}}populateCellMenuWithStringItems({column:e,record:t,items:n}){const r=this.getFilterType(e);if(!/(date|number|duration)/.test(r)){var i;const r=this,o=e.getFilterableValue(t),s=(null===(i=e.filterable.filterField)||void 0===i?void 0:i.operator)??"*";n.filterStringEquals={text:"L{equals}",localeClass:r,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:r.disabled,onItem:()=>r.applyFilter(e,{value:o,operator:s})}}}populateCellMenu({column:e,record:t,items:n}){const r=this;!1===e.filterable||t.isSpecialRow||(r.populateCellMenuWithDateItems(...arguments),r.populateCellMenuWithNumberItems(...arguments),r.populateCellMenuWithDurationItems(...arguments),r.populateCellMenuWithStringItems(...arguments),e.meta.isFiltered&&(n.filterRemove={text:"L{removeFilter}",localeClass:r,icon:"b-fw-icon b-icon-remove",cls:"b-separator",weight:400,disabled:r.disabled||r.isMulti&&!r.columnHasRemovableFilters(e),onItem:()=>r.removeFilter(e)}),r.isMulti&&(n.filterDisable={text:"L{disableFilter}",localeClass:r,icon:"b-fw-icon b-icon-filter-disable",cls:"b-separator",weight:400,disabled:r.disabled||!r.columnHasEnabledFilters(e),onItem:()=>r.disableFilter(e)}))}columnHasRemovableFilters(e){const t=this;return Boolean(t.getCurrentMultiFilters(e).find((e=>!t.canDeleteFilter||!1!==t.callback(t.canDeleteFilter,t,[e]))))}columnHasEnabledFilters(e){return Boolean(this.getCurrentMultiFilters(e).find((e=>!e.disabled)))}populateHeaderMenu({column:e,items:t}){const n=this;e.meta.isFiltered?(t.editFilter={text:"L{editFilter}",localeClass:n,weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:n.disabled,onItem:()=>n.showFilterEditor(e)},t.removeFilter={text:"L{removeFilter}",localeClass:n,weight:110,icon:"b-fw-icon b-icon-remove",disabled:n.disabled||n.isMulti&&!n.columnHasRemovableFilters(e),onItem:()=>n.removeFilter(e)},n.isMulti&&(t.disableFilter={text:"L{disableFilter}",localeClass:n,icon:"b-fw-icon b-icon-filter-disable",weight:115,disabled:n.disabled||!n.columnHasEnabledFilters(e),onItem:()=>n.disableFilter(e)})):!1!==e.filterable&&(t.filter={text:"L{filter}",localeClass:n,weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:n.disabled,onItem:()=>n.showFilterEditor(e)})}onStoreBeforeFilter({filters:e}){const{columns:t}=this.client;for(let r=0;r<e.count;r++){const i=e.getAt(r);if(!i.internal){var n;const o=(i.columnOwned||this.prioritizeColumns)&&t.find((e=>!1!==e.filterable&&e.field===i.property));null!=o&&null!==(n=o.filterable)&&void 0!==n&&n.filterFn&&(o.$filter||(o.$filter=new co({columnOwned:!0,property:i.property,operator:i.operator,value:i.value,filterBy(e){return o.filterable.filterFn({value:this.value,record:e,operator:this.operator,property:this.property,column:o})}})),o.$filter.value=i.value,o.$filter.displayValue=i.displayValue,o.$filter.operator=i.operator,e.splice(r,1,o.$filter))}}}onStoreFilter(){this.refreshHeaders(!1)}renderHeader(){this.refreshHeaders(!1)}onElementClick({target:e}){if(this.filterEditorPopup&&this.closeFilterEditor(),e.classList.contains("b-filter-icon")){const t=e.closest(".b-grid-header");return this.showFilterEditor(t.dataset.columnId),!1}}showFilterEditorByKey({target:e}){const t=e.matches(".b-grid-header")&&e;return t&&this.showFilterEditor(t.dataset.columnId),Boolean(t)}isActionAvailable({event:e}){const t=e.target.closest(".b-grid-header"),n=t&&this.client.columns.find((e=>e.id===t.dataset.columnId));return Boolean(null==n?void 0:n.filterable)}}Hm._$name="Filter",gd.registerFeature(Hm);const Vm={"*":null,isIncludedIn:null,startsWith:null,endsWidth:null};class Bm extends di{static get $name(){return"FilterBar"}static get configurable(){return{prioritizeColumns:!1,keyStrokeFilterDelay:300,compactMode:!1,clearStoreFiltersOnHide:!0,keyMap:{ArrowUp:{handler:"disableGridNavigation",preventDefault:!1},ArrowRight:{handler:"disableGridNavigation",preventDefault:!1},ArrowDown:{handler:"disableGridNavigation",preventDefault:!1},ArrowLeft:{handler:"disableGridNavigation",preventDefault:!1},Enter:{handler:"disableGridNavigation",preventDefault:!1}}}}static get pluginConfig(){return{before:["renderContents"],chain:["afterColumnsChange","renderHeader","populateHeaderMenu","bindStore"]}}static get properties(){return{filterFieldCls:"b-filter-bar-field",filterFieldInputCls:"b-filter-bar-field-input",filterableColumnCls:"b-filter-bar-enabled",filterFieldInputSelector:".b-filter-bar-field-input",filterableColumnSelector:".b-filter-bar-enabled",filterParseRegExp:/^\s*([<>=*])?(.*)$/,storeTrackingSuspended:0}}construct(e,t){if(e.features.filter)throw new Error("Grid.feature.FilterBar feature may not be used together with Grid.feature.Filter, These features are mutually exclusive.");const n=this;n.grid=e,n.onColumnFilterFieldChange=n.onColumnFilterFieldChange.bind(n),super.construct(e,Array.isArray(t)?{filter:t}:t),n.bindStore(e.store),n.filter&&e.store.filter(n.filter),n.gridDetacher=e.ion({beforeElementClick:"onBeforeElementClick",thisObj:n})}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeFilter:"onStoreBeforeFilter",filter:"onStoreFilter",thisObj:this})}doDestroy(){var e;this.destroyFilterBar(),null===(e=this.gridDetacher)||void 0===e||e.call(this),super.doDestroy()}doDisable(e){const{columns:t}=this.grid;null==t||t.forEach((t=>{const n=this.getColumnFilterField(t);n&&(n.disabled=e)})),super.doDisable(e)}updateCompactMode(e){this.client.headerContainer.classList[e?"add":"remove"]("b-filter-bar-compact");for(const t in this._columnFilters){const n=this._columnFilters[t];n.placeholder=e?n.column.headerText:null}}destroyFilterBar(){var e;null===(e=this.grid.columns)||void 0===e||e.forEach(this.destroyColumnFilterField,this)}hideFilterBar(){var e;const t=this;t.clearStoreFiltersOnHide&&t.suspendStoreTracking(),null===(e=t.grid.columns)||void 0===e||e.forEach((e=>t.hideColumnFilterField(e,!0))),t.grid.store.filter(),t.clearStoreFiltersOnHide&&t.resumeStoreTracking(),t.hidden=!0}showFilterBar(){this.suspendStoreTracking(),this.renderFilterBar(this.clearStoreFiltersOnHide),this.resumeStoreTracking(),this.hidden=!1}toggleFilterBar(){this.hidden?this.showFilterBar():this.hideFilterBar()}renderFilterBar(e){this.grid.hideHeaders||(this.grid.columns.visibleColumns.forEach((t=>this.renderColumnFilterField(t,e))),this.rendered=!0)}renderColumnFilterField(e,t){const n=this,{grid:r}=n,i=n.getColumnFilterable(e);if(i&&e.isVisible){const o=e.element,s=r.store.filters.get(e.id)||r.store.filters.getBy("property",e.field);let l=n.getColumnFilterField(e);if(l)t&&n.onColumnFilterFieldChange({source:l,value:l.value}),l.render(o),l.show();else{const t=`${e.filterType||"text"}field`,{filterField:a}=i,c=null==a?void 0:a.cls;c&&delete i.filterField.cls,l=Td.append(Yt.assign({type:t,cls:{[n.filterFieldCls]:1,[c]:c},dataset:{column:e.field},column:e,owner:r,clearable:!0,name:e.field,value:!s||s._filterBy||s.internal?"":n.buildFilterValue(s),inputCls:n.filterFieldInputCls,keyStrokeChangeDelay:n.keyStrokeFilterDelay,onChange:n.onColumnFilterFieldChange,onClear:n.onColumnFilterFieldChange,disabled:n.disabled,placeholder:n.compactMode?e.headerText:null,format:e.format},a),o)[0],null!=a&&a.hasOwnProperty("min")||Object.defineProperty(l,"min",{get:()=>{var t;return null===(t=e.editor)||void 0===t?void 0:t.min},set:()=>null}),null!=a&&a.hasOwnProperty("max")||Object.defineProperty(l,"max",{get:()=>{var t;return null===(t=e.editor)||void 0===t?void 0:t.max},set:()=>null}),null!=a&&a.hasOwnProperty("strictParsing")||Object.defineProperty(l,"strictParsing",{get:()=>{var t;return null===(t=e.editor)||void 0===t?void 0:t.strictParsing},set:()=>null}),l.element.retainElement=!0,n.setColumnFilterField(e,l);const d=(null==a?void 0:a.store)&&(a.store.readUrl||a.store.data||a.store.isChained);if(l.isCombo&&!d&&0===l.store.count){const t=l.value,n=()=>{l.store.readUrl||l.store.isChained||(l.store.data=r.store.getDistinctValues(e.field,!0).map((t=>r.store.modelClass.new({id:t,[e.field]:t}))))};l.value=null,l.store.isSorted||l.store.sort({field:e.field,ascending:!0}),l.picker.ion({beforeShow:n}),n(),l.value=t}!n.filter&&l.value&&!1!==r.store.autoLoad&&n.onColumnFilterFieldChange({source:l,value:l.value})}o.classList.add(n.filterableColumnCls)}}updateColumnFilterFields(){const e=this,{columns:t,store:n}=e.grid;let r,i;e._updatingFields=!0;for(const o of t.visibleColumns)r=e.getColumnFilterField(o),r&&(i=n.filters.get(o.id)||n.filters.getBy("property",o.field),i&&!i.internal?i._filterBy?r.value=i.value:r.value=e.buildFilterValue(i):r.value="");e._updatingFields=!1}getColumnFilterable(e){if(!e.isRoot&&!1!==e.filterable&&e.field&&e.isLeaf)return"function"==typeof e.filterable&&(e.filterable={filterFn:e.filterable}),e.filterable}destroyColumnFilterField(e){const t=this.getColumnFilterField(e);t&&(this.hideColumnFilterField(e,!0),t.destroy(),this.setColumnFilterField(e,i))}hideColumnFilterField(e,t){const n=this,{store:r}=n.grid,i=e.element,o=n.getColumnFilterField(e);if(o){n.isDestroying||o.hide();const{$filter:s}=e;!r.isDestroyed&&n.clearStoreFiltersOnHide&&s&&r.removeFilter(s,t),null==i||i.classList.remove(n.filterableColumnCls)}}getColumnFilterField(e){var t;return null===(t=this._columnFilters)||void 0===t?void 0:t[e.id]}setColumnFilterField(e,t){this._columnFilters=this._columnFilters||{},this._columnFilters[e.data.id]=t}parseFilterValue(e,t,n){var r;if(Array.isArray(t)||t instanceof oo)return{value:t};if(Yt.isDate(t))return{operator:n.isDateField?"sameDay":n.isTimeField?"sameTime":"=",value:t};const i=String(t).match(this.filterParseRegExp);return{operator:i[1]||(null===(r=e.filterable)||void 0===r?void 0:r.operator)||"*",value:i[2]}}buildFilterValue({operator:e,value:t}){return t instanceof Date||Array.isArray(t)?t:(e in Vm?"":e)+t}onStoreBeforeFilter({filters:e}){const{columns:t}=this.client;for(let r=0;r<e.count;r++){var n;const i=e.getAt(r),o=(i.columnOwned||this.prioritizeColumns)&&t.find((e=>!1!==e.filterable&&e.field===i.property));null!=o&&null!==(n=o.filterable)&&void 0!==n&&n.filterFn&&(o.$filter||(o.$filter=new co({columnOwned:!0,property:i.property,id:o.id,filterBy(e){return o.filterable.filterFn({value:this.value,record:e,property:this.property,column:o})}})),o.$filter.value=i.value,e.splice(r,1,o.$filter))}}onStoreFilter(){!this.storeTrackingSuspended&&this.rendered&&this.updateColumnFilterFields()}afterColumnsChange({action:e,changes:t,column:n,columns:r}){if(!this.hidden&&null!=t&&t.hidden){t.hidden.value?this.destroyColumnFilterField(n):this.renderColumnFilterField(n)}"remove"===e&&r.forEach((e=>this.destroyColumnFilterField(e)))}suspendStoreTracking(){this.storeTrackingSuspended++}resumeStoreTracking(){this.storeTrackingSuspended--}renderHeader(){this.hidden||this.renderFilterBar()}renderContents(){if(this._columnFilters)for(const e of Object.values(this._columnFilters))null==e||e.element.remove()}disableGridNavigation(e){return e.target.matches(this.filterFieldInputSelector)}onBeforeElementClick({event:e}){if(e.target.closest(`.${this.filterFieldCls}`))return!1}onColumnFilterFieldChange({source:e,value:t}){const n=this,{column:r}=e,{filterFn:o}=r.filterable,{store:s}=n.grid,l=r.$filter||s.filters.find((e=>(e.id===r.id||e.property===r.field)&&!e.internal));if(n._updatingFields)return;const a=null==t||""===t||Array.isArray(t)&&0===t.length;var c,d;if(s.removeFilter(l,!0),r.$filter=null,a){if(!l)return}else r.$filter=s.addFilter({property:e.name,...n.parseFilterValue(r,t,e),["boolean"==typeof(null===(c=r.filterable)||void 0===c?void 0:c.caseSensitive)?"caseSensitive":i]:null===(d=r.filterable)||void 0===d?void 0:d.caseSensitive,[o?"filterBy":"_"]:function(e){return o({value:this.value,record:e,operator:this.operator,property:this.property,column:r})}},!0);s.filter()}populateHeaderMenu({items:e}){e.toggleFilterBar={text:this.hidden?"L{enableFilterBar}":"L{disableFilterBar}",localeClass:this,weight:120,icon:"b-fw-icon b-icon-filter",cls:"b-separator",onItem:()=>this.toggleFilterBar()}}}Bm.featureClass="b-filter-bar",Bm._$name="FilterBar",gd.registerFeature(Bm);class zm extends di{static get $name(){return"Group"}static get configurable(){return{field:null,groupSortFn:null,renderer:null,keyMap:{" ":"toggleGroup"},toggleOnRowClick:!0}}construct(e,t){const n=this;e.features.tree||(n._thisIsAUsedExpression(e.features.groupSummary),t=n.processConfig(t),n.grid=e,super.construct(e,t),n.bindStore(e.store),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1100,thisObj:n}))}processConfig(e){return"string"==typeof e?{field:e,ascending:null}:e}setConfig(e){null===e?this.store.clearGroupers():super.setConfig(this.processConfig(e))}bindStore(e){this.detachListeners("store"),e.ion({name:"store",group:"onStoreGroup",change:"onStoreChange",toggleGroup:"onStoreToggleGroup",thisObj:this}),this.onStoreGroup({groupers:e.groupers})}updateRenderer(e){this.groupRenderer=e}updateField(e){var t;this.isConfiguring&&null!==(t=this.store.groupers)&&void 0!==t&&t.some((t=>t.field===e))||this.store.group({field:e,ascending:this.ascending,fn:this.groupSortFn})}updateGroupSortFn(e){this.isConfiguring||this.store.group({field:this.field,ascending:this.ascending,fn:e})}doDestroy(){super.doDestroy()}doDisable(e){const{store:t}=this;if(e&&t.isGrouped){const{sorters:e}=t;e.unshift(...t.groupers),this.currentGroupers=t.groupers,t.clearGroupers(),t.sort(e)}else!e&&this.currentGroupers&&(t.group(this.currentGroupers[0]),this.currentGroupers=null);super.doDisable(e)}get store(){return this.grid.store}static get pluginConfig(){return{assign:["collapseAll","expandAll"],chain:["renderHeader","populateHeaderMenu","getColumnDragToolbarItems","onElementTouchStart","onElementClick","bindStore"]}}refreshGrid(e){const{store:t,rowManager:n}=this.grid;n.rowCount>t.count||!n.getRowFor(e)?n.renderFromRow():n.renderFromRecord(e)}toggleCollapse(e,t){this.internalToggleCollapse(e,t)}internalToggleCollapse(e,t,n=!1,r){const o=this,{store:s,grid:l}=o,a=s.getById(e);a.isGroupHeader&&(t=t===i?!a.meta.collapsed:t,!1!==l.trigger("beforeToggleGroup",{groupRecord:a,collapse:t,domEvent:r})&&(o.isToggling=!0,t?s.collapse(a):s.expand(a),o.isToggling=!1,n||o.refreshGrid(a),l.trigger("toggleGroup",{groupRecord:a,collapse:t}),l.afterToggleGroup()))}collapseAll(){const e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((t=>e.internalToggleCollapse(t,!0,!0))),e.grid.refreshRows(!0))}expandAll(){const e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((t=>e.internalToggleCollapse(t,!1,!0))),e.grid.refreshRows())}onBeforeRenderRow({row:e}){const t=e.grid.store.getById(e.id);e.forceInnerHTML=e.forceInnerHTML||(null==t?void 0:t.isGroupHeader)}renderCell(e){const t=this,{cellElement:n,row:r,column:i,grid:o}=e,{meta:s}=e.record,l={"b-group-row":0,"b-grid-group-collapsed":0};if(!t.disabled&&t.store.isGrouped&&"groupRowFor"in s){if("action"===i.type)return;i.clearCell(n),l["b-grid-group-collapsed"]=s.collapsed,l["b-group-row"]=1,o.buildGroupHeader?o.buildGroupHeader(e):t.buildGroupHeader(e),i===t.groupHeaderColumn&&(Lr.createElement({parent:n,tag:"i",className:"b-group-state-icon",nextSibling:n.firstChild}),n.classList.add("b-group-title"),n.$groupHeader=n._hasHtml=!0)}else if(n.$groupHeader){var a;null===(a=n.querySelector(".b-group-state-icon"))||void 0===a||a.remove(),n.classList.remove("b-group-title"),n.$groupHeader=!1}r.assignCls(l)}buildGroupHeader(e){const t=this,{record:n,cellElement:r,column:i,persist:o}=e,{grid:s}=t,l=n.meta,{groupRowFor:a}=l,{groupSummary:c}=s.features,d=l.childCount-(c&&"header"!==c.target?1:0);let u=null,h=!0;if(o||i){const o=s.columns.get(l.groupField),c=e.isFirstColumn=i===t.groupHeaderColumn;null!=o&&o.groupRenderer?c&&(u=o.groupRenderer({...e,groupRowFor:a,groupRecords:n.groupChildren,groupColumn:o,count:d}),h=!1):t.groupRenderer&&(u=t.groupRenderer({...e,groupRowFor:a,groupRecords:n.groupChildren,groupColumn:o,count:d,isFirstColumn:c})),c&&null==u&&h&&0===Lr.getChildElementCount(r)&&(u=A.encodeHtml(`${"__novalue__"===a?"":a} (${d})`))}else t.groupRenderer&&(u=t.groupRenderer(e));return"string"==typeof u?r.innerHTML=u:"object"==typeof u&&Cs.sync({targetElement:r,domConfig:{onlyChildren:!0,children:H.asArray(u)}}),Lr.getChildElementCount(r)>0&&(r._hasHtml=!0),r.innerHTML}get groupHeaderColumn(){return this.grid.columns.visibleColumns.find((e=>!e.groupHeaderReserved))}renderHeader(e=this.grid.headerContainer){const{store:t,grid:n}=this;if(e&&t.isGrouped)for(const e of t.groupers){const t=n.columns.get(e.field),r=t&&n.getHeaderElement(t.id);if(null==r||r.classList.add("b-group",e.ascending?"b-asc":"b-desc"),r&&(!n.features.sort||n.features.sort.disabled)){const e=t.textWrapper;null!=e&&e.querySelector(".b-sort-icon")||Lr.createElement({parent:e,className:"b-sort-icon"})}}}populateHeaderMenu({column:e,items:t}){const n=this;!1!==e.groupable&&(t.groupAsc={text:"L{groupAscending}",localeClass:n,icon:"b-fw-icon b-icon-group-asc",cls:"b-separator",weight:400,disabled:n.disabled,onItem:()=>n.store.group(e.field,!0)},t.groupDesc={text:"L{groupDescending}",localeClass:n,icon:"b-fw-icon b-icon-group-desc",weight:410,disabled:n.disabled,onItem:()=>n.store.group(e.field,!1)}),n.store.isGrouped&&(t.groupRemove={text:"L{stopGrouping}",localeClass:n,icon:"b-fw-icon b-icon-clear",cls:e.groupable?"":"b-separator",weight:420,disabled:n.disabled,onItem:()=>n.store.clearGroupers()})}getColumnDragToolbarItems(e,t){var n;const r=this,{store:i,disabled:o}=r;t.push({text:"L{groupAscendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-asc",ref:"groupAsc",cls:"b-separator",weight:110,disabled:o,onDrop:({column:e})=>i.group(e.field,!0)}),t.push({text:"L{groupDescendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-desc",ref:"groupDesc",weight:110,disabled:o,onDrop:({column:e})=>i.group(e.field,!1)});const s=(null===(n=i.groupers)||void 0===n?void 0:n.some((t=>t.field===e.field)))&&!o;return t.push({text:"L{stopGroupingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-clear",ref:"groupRemove",disabled:!s,weight:110,onDrop:({column:e})=>i.removeGrouper(e.field)}),t}onStoreGroup({groupers:e}){const{grid:t}=this,{element:n}=t,r=n&&Lr.children(n,".b-grid-header.b-group");if(n){for(const e of r)e.classList.remove("b-group","b-asc","b-desc");e&&this.renderHeader()}}onStoreChange({action:e,records:t}){const{client:n}=this,{rowManager:r,store:i}=n;if(i.isGrouped&&"move"===e){const{field:e}=i.groupers[0],n=Math.min(...t.reduce(((t,n)=>{if(t.push(i.indexOf(n.instanceMeta(i).groupParent)),e in n.meta.modified){const r=i.groupRecords.find((t=>t.meta.groupRowFor===n.meta.modified[e]));r&&t.push(i.indexOf(r))}return t}),[]));r.renderFromRow(r.getRow(n))}}onStoreToggleGroup({groupRecord:e}){this.isToggling||this.refreshGrid(e)}onElementTouchStart(e){const t=this,{target:n}=e,r=n.closest(".b-grid-header"),i=r&&t.grid.getColumnFromElement(r);e.touches.length>1&&i&&!1!==i.groupable&&!t.disabled&&t.store.group(i.field)}onElementClick(e){const t=this,{store:n}=t,{target:r}=e,o=r.closest(".b-group-row"),s=r.closest(".b-grid-header"),l=null==s?void 0:s.dataset.column;if(!(r.classList.contains("b-resizer")||t.disabled||r.classList.contains("b-action-item")||e.handled)){if(s&&l){var a;const r=null===(a=n.groupers)||void 0===a?void 0:a.find((e=>e.field===l));if(r&&!e.shiftKey)return r.ascending=!r.ascending,n.group(),!1;if(e.shiftKey){!1!==t.grid.columns.get(l).groupable&&(e.altKey?n.removeGrouper(l):n.group(l))}}return o&&(t.toggleOnRowClick||e.target.classList.contains("b-group-state-icon"))?(t.internalToggleCollapse(Nc.get(o).id,i,i,e),!1):void 0}}toggleGroup(e){var t;const{grid:n}=this,{focusedCell:r}=n;return!(this.disabled||r.isActionable||null===(t=r.record)||void 0===t||!t.isGroupHeader)&&(this.internalToggleCollapse(r.id),!0)}}zm._$name="Group",gd.registerFeature(zm,!0,["Grid","Scheduler"]),gd.registerFeature(zm,!1,["TreeGrid"]);var Wm=e=>class extends(e||fe){static get $name(){return"SummaryFormatter"}generateHtml(e,t,n,r,i,o){const s=this.store,l=e.summaries||(e.sum?[{sum:e.sum,renderer:e.summaryRenderer}]:[]);let a=`<table class="${n}">`;return l.forEach((n=>{let r=n.sum,i=null;switch(!0===r&&(r="sum"),r){case"sum":case"add":i=s.sum(e.field,t);break;case"max":i=s.max(e.field,t);break;case"min":i=s.min(e.field,t);break;case"average":case"avg":i=s.average(e.field,t);break;case"count":i=t.length;break;case"countNotEmpty":i=t.reduce(((t,n)=>t+(null!=n.getValue(e.field)?1:0)),0)}if("function"==typeof r&&(i=t.reduce(r,"seed"in n?n.seed:0)),null!==i){const e="b-grid-summary-value",t=n.label?`<td class="b-grid-summary-label">${n.label}</td>`:"";let r,o=n.renderer?n.renderer({config:n,sum:i}):i;null==o&&(o=""),r=String(o).includes("<td>")?o:t?`${t}<td class="${e}">${o}</td>`:`<td colspan="2" class="${e}">${o}</td>`,a+=`<tr>${r}</tr>`}})),a+"</table>"}};class jm extends(Wm(di)){static get $name(){return"GroupSummary"}static get configurable(){return{collapseToHeader:null,target:"footer"}}construct(e,t){if(this.grid=e,super.construct(e,t),!e.features.group)throw new Error("Requires Group feature to work, please enable");this.bindStore(e.store),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1e3,thisObj:this})}bindStore(e){this.detachListeners("store"),e.ion({name:"store",update:"onStoreUpdate",prio:1,thisObj:this})}get store(){return this.grid.store}doDisable(e){this.updateTarget(this.target),super.doDisable(e)}changeTarget(e){return Yt.assertString(e,"target"),e}updateTarget(e){this.store.useGroupFooters=!this.disabled&&"footer"===e,this.isConfiguring||this.store.group()}changeCollapseToHeader(e){return Yt.assertBoolean(e,"collapseToHeader"),e}updateCollapseToHeader(){this.isConfiguring||this.store.group()}static get pluginConfig(){return{chain:["bindStore"]}}onBeforeRenderRow({row:e,record:t}){e.isGroupFooter&&!("groupFooterFor"in t.meta)?(e.isGroupFooter=!1,e.forceInnerHTML=!0):e.isGroupHeader&&!t.meta.collapsed&&e.eachElement(this.removeSummaryElements)}removeSummaryElements(e){}renderCell({column:e,cellElement:t,row:n,record:r,size:i,isFirstColumn:o}){const s=this,{meta:l}=r,{rowHeight:a}=s.grid,c="groupRowFor"in l,d="groupFooterFor"in l,u="header"===s.target,h={"b-group-footer":0,"b-header-summary":0},g=c&&(u||s.collapseToHeader&&l.collapsed)&&!o||d&&!u;if((c||d)&&(i.height=c&&i.height||a),s.store.isGrouped&&g&&!s.disabled){e.clearCell(t);const o=c?r:l.groupRecord;n.isGroupFooter=d,n.isGroupHeader=c,d?h["b-group-footer"]=1:h["b-header-summary"]=1;const g=s.updateSummaryHtml(t,e,o),p="number"==typeof g?g:g.count;p>1&&(i.height+=l.collapsed&&!u?0:p*a*.1),g.height&&(i.height+=g.height)}n.assignCls(h)}updateSummaryHtml(e,t,n){const r=n.groupChildren.slice();r[r.length-1].isGroupFooter&&r.pop();const i=this.generateHtml(t,r,"b-grid-group-summary",n,n.meta.groupField,n.meta.groupRowFor);return e.children.length?Lr.sync(i,e.firstElementChild):e.innerHTML=i,t.summaries?t.summaries.length:t.sum?1:0}onStoreUpdate({source:e,changes:t}){if(!this.disabled&&e.isGrouped){if(t&&e.groupers.find((e=>e.field in t)))return;Object.keys(t).some((e=>{const t=this.grid.columns.get(e);return Boolean(t)&&(Boolean(t.sum)||Boolean(t.summaries))}))&&(this.grid.forceFullRefresh=!0)}}refresh(){this.grid.columns.visibleColumns.forEach((e=>{this.hasSummary(e)&&this.grid.refreshColumn(e)}))}hasSummary(e){return e.sum||e.summaries}}jm.featureClass="b-group-summary",jm._$name="GroupSummary",gd.registerFeature(jm);class Gm extends ah{static get $name(){return"HeaderMenu"}static get configurable(){return{type:"header",items:null,moveColumns:null}}static get defaultConfig(){return{processItems:null}}static get pluginConfig(){const e=super.pluginConfig;return e.chain.push("populateHeaderMenu"),e}shouldShowMenu(e){const{column:t}=e;return t&&!1!==t.enableHeaderContextMenu&&t!==this.client.timeAxisColumn}getDataFromEvent(e){return Yt.assign(super.getDataFromEvent(e),this.client.getHeaderDataFromEvent(e))}populateHeaderMenu({items:e,column:t}){const n=this;if(t){if(t.headerMenuItems&&Yt.merge(e,t.headerMenuItems),t.isCollapsible){const{collapsed:r}=t,i=r?n.client.rtl?"left":"right":n.client.rtl?"right":"left";e.toggleCollapse={weight:215,icon:`b-fw-icon b-icon-collapse-${i}`,text:n.L(r?"L{expandColumn}":"L{collapseColumn}"),onItem:()=>t.collapsed=!r}}if(n.moveColumns){const r=n.getColumnToMoveBefore(t),i=n.getColumnToMoveAfter(t);r&&(e.movePrev={weight:220,icon:"b-fw-icon b-icon-column-move-left",text:n.L("L{moveBefore}",A.encodeHtml(r.text)),onItem:()=>{const{parent:e}=t;var n;r.parent.insertChild(t,r)&&(t.region=r.region,null!==(n=e.children)&&void 0!==n&&n.length||e.remove())}}),i&&(e.moveNext={weight:230,icon:"b-fw-icon b-icon-column-move-right",text:n.L("L{moveAfter}",A.encodeHtml(i.text)),onItem:()=>{const{parent:e}=t;var n;i.parent.insertChild(t,i.nextSibling)&&(t.region=i.region,null!==(n=e.children)&&void 0!==n&&n.length||e.remove())}})}}return e}getColumnToMoveBefore(e){const{previousSibling:t,parent:n}=e;return t?t.children&&!e.children?t.children[t.children.length-1]:t:n.isRoot?void 0:n}getColumnToMoveAfter(e){const{nextSibling:t,parent:n}=e;return t||(n.isRoot?void 0:n)}}Gm.featureClass="",Gm._$name="HeaderMenu",gd.registerFeature(Gm,!0);const Um={mousedown:"mouseDown",mousemove:"mouseMove",mouseup:"mouseUp",touchdown:"touchDown",touchmove:"touchMove",touchup:"touchUp",pointerover:"mouseOver",mouseout:"mouseOut",dblclick:"dblClick",keydown:"keyDown",keypress:"keyPress",keyup:"keyUp",contextmenu:"contextMenu"};class Ym extends di{static $name="MergeCells";static configurable={passthrough:!0,sortedOnly:!0};mergedRanges=[];mergedMap={};static get pluginConfig(){return{chain:["beforeRenderCell","afterRenderRow","bindStore","afterColumnsChange","afterRemove","afterToggleGroup","afterToggleSubGrid","handleEvent","populateHeaderMenu","afterSelectionChange"],before:["onInternalResize"],override:["getColumnFromElement","getRecordFromElement"]}}afterConstruct(){const e=this,{client:t}=e;t.eachSubGrid((t=>e.setupSubGrid(t))),t.rowManager.ion({renderDone:"onRenderDone",thisObj:e}),e.bindStore(t.store)}setupSubGrid(e){e.$mergedCellsElement=Lr.createElement({parent:e.element,className:{"b-grid-merged-cells-container":1}}),e.ion({beforeInternalResize:"refreshBounds",thisObj:this})}doDisable(e){this.isConfiguring||(this.isDisabling=!0,this.reset(),this.isDisabling=!1),super.doDisable(e)}updatePassthrough(e){this.client.element.classList.toggle("b-mergecells-passthrough",e)}updateSortedOnly(e){this.isConfiguring||this.reset(!0,e)}bindStore(e){this.detachListeners("store"),e.ion({name:"store",change:"onStoreChange",refresh:{prio:1,fn:"onStoreRefresh"},thisObj:this})}onInternalResize(){this.refreshBounds()}beforeRenderCell(e){const t=this,{column:n,record:r,cellElement:i}=e,o=t.client.subGrids[n.region];if(!t.disabled&&n.mergeCells&&(n.isSorted||!t.sortedOnly)&&!r.isSpecialRow&&!o.collapsed){const o=t.getMergeRange(r,n);null!=o&&o.use&&(i.classList.add("b-merged-cell"),i.innerHTML="",e.cellElement=o.cellElement)}}afterRenderRow({row:e,oldId:t,oldHeight:n}){t===e.id&&n!==e.height&&(this.heightChanged=!0)}afterColumnsChange({action:e,changes:t,column:n}){if(!this.disabled)if("update"!==e||!t.mergeCells||n.mergeCells)this.refreshBounds();else{for(const e of this.mergedRanges.slice())e.column===n&&this.removeRange(e);this.syncDom()}}afterRemove(){!this.disabled&&this.reset()}afterToggleGroup(){!this.disabled&&this.reset()}afterToggleSubGrid(){!this.disabled&&this.reset()}afterSelectionChange(){if(!this.passthrough){const{client:e}=this,t=e.selectedRecords.map((t=>e.store.indexOf(t)));let n=!1;for(const e of this.mergedRanges){let r=!0;for(let n=e.fromIndex;n<=e.toIndex&&r;n++)r=t.includes(n);e.isSelected!==r&&(e.isSelected=r,n=!0)}n&&this.syncDom()}}getRecordFromElement(e){var t;return null!==(t=e.elementData)&&void 0!==t&&t.range?this.client.store.getAt(e.elementData.range.fromIndex):this.overridden.getRecordFromElement(e)}getColumnFromElement(e){var t;return null!==(t=e.elementData)&&void 0!==t&&t.range?e.elementData.range.column:this.overridden.getColumnFromElement(e)}populateHeaderMenu({column:e,items:t}){!1!==e.mergeable&&(t.mergeCells={text:"L{MergeCells.mergeCells}",icon:"b-fw-icon "+(e.mergeCells?"b-icon-checked":"b-icon-unchecked"),tooltip:"L{MergeCells.menuTooltip}",cls:"b-separator",weight:500,disabled:this.disabled,onItem:()=>e.mergeCells=!e.mergeCells})}async handleEvent(e){if(!this.passthrough){const t=e.target.closest(".b-grid-merged-cells");if(t){const{client:n}=this,{range:r}=t.elementData,{cellEdit:i}=n.features,{column:o}=r,s=A.capitalize(Um[e.type]??e.type),l={grid:n,records:[],column:o,cellElement:t.firstElementChild,target:e.target,event:e};for(let e=r.fromIndex;e<=r.toIndex;e++)l.records.push(n.store.getAt(e));if(n.trigger(`mergedCell${s}`,l),(null==i?void 0:i.triggerEvent.toLowerCase())===`cell${s}`.toLowerCase()){const t=n.rowManager.getRowAt(e.clientY);await i.startEditing({id:t.id,columnId:o.id})}else"click"===e.type&&this.onRangeClick({range:r})}}}onRangeClick({range:e}){const t=[];for(let n=e.fromIndex;n<=e.toIndex;n++)t.push(this.client.store.getAt(n));this.client.selectedRecords=t}onStoreChange(){!this.disabled&&this.reset()}onStoreRefresh({action:e}){"filter"!==e&&"dataset"!==e&&!this.disabled&&this.reset(!1)}createRangeElement(e){var t,n;const r=this.client.getSubGridFromColumn(e.column).$mergedCellsElement,i=`${e.fromIndex}-@-${e.column.id}`;let o=(null===(t=r.syncIdMap)||void 0===t?void 0:t[i])??(null===(n=r.releasedIdMap)||void 0===n?void 0:n[i]);return r.releasedIdMap&&delete r.releasedIdMap[i],o||(o=Lr.createElement(this.createRangeDomConfig(e))),Cs.addChild(r,o,i),e.element=o,e.cellElement=o.firstElementChild,o}createRangeDomConfig(e){var t;const{column:n,fromIndex:r,toIndex:i,top:o,left:s,width:l,height:a}=e,{type:c}=n,d=this.client.store.getAt(r),u={className:{"b-grid-merged-cells":1,"b-selected":e.isSelected},elementData:{range:e},style:{top:o,left:s,height:a,width:l},dataset:{syncId:`${r}-@-${n.id}`,fromIndex:r,toIndex:i,column:n.field,columnId:n.id},children:[{className:new wn(this.client.cellCls).assign({[`b-${null==c?void 0:c.toLowerCase()}-cell`]:c,[n.cellCls]:n.cellCls,[n.internalCellCls]:n.internalCellCls}).assign(n.autoCls),keepChildren:!0,elementData:{range:e},dataset:{column:n.field,columnId:n.id},style:{height:this.client.rowManager.rowHeight}}]};return null===(t=n.mergedRenderer)||void 0===t||t.call(n,{domConfig:u,value:n.getRawValue(d),record:d,column:n,fromIndex:r,toIndex:i}),u}buildMergedCellsConfig(e,t,n){var r,i;const o=this,{client:s}=o,{rowManager:l}=s;e=e??(null===(r=l.topRow)||void 0===r?void 0:r.dataIndex),t=t??(null===(i=l.bottomRow)||void 0===i?void 0:i.dataIndex);const a=s.regions.reduce(((e,t)=>(e[t]={className:{"b-grid-merged-cells-container":1},children:[]},e)),{});for(const r of o.mergedRanges)r.use&&r.fromIndex<=t&&r.toIndex>=e&&(o.updateRange(r,o.heightChanged,n),a[r.column.region].children.push(o.createRangeDomConfig(r)));return a}syncDom(e=!1){const t=this,{client:n}=t,{rowManager:r}=n;if(!e&&!r.topRow||t.disabled&&!t.isDisabling)return;const i=this.buildMergedCellsConfig();n.eachSubGrid((e=>{Cs.sync({targetElement:e.$mergedCellsElement,syncIdField:"syncId",domConfig:i[e.region]})})),t.heightChanged=!1}onRenderDone(){this.syncDom()}removeRange(e){H.remove(this.mergedRanges,e);for(let t=e.fromIndex;t<=e.toIndex;t++)delete this.mergedMap[`${t}-@-${e.column.id}`]}reset(e=!0,t=!1){const n=this,r=n.client.columns.visibleColumns.filter((e=>e.mergeCells&&(e.isSorted||!n.sortedOnly||t)),!0),i=n.mergedRanges.length;if(n.mergedRanges=[],n.mergedMap={},e&&!n.client.refreshSuspended){for(const e of n.client.rowManager.rows)for(const t of r)e.renderCell(e.getCell(t.id));n.syncDom(i&&!n.client.rowManager.rowCount)}}refreshBounds(){const{mergedRanges:e}=this,t=this.client.rowManager.topRow,n=new Map;for(const r of e.slice()){const{column:e}=r,i=t.getCell(e.id);if(i){let t=n.get(e);t||n.set(e,t=bn.from(i,i.parentElement)),r.left=t.left,r.width=t.width}else this.removeRange(r)}this.syncDom()}updateRange(e,t,n=null){const{store:r,rowManager:i}=this.client,{topRendered:o,bottomRendered:s}=e,{rowOffsetHeight:l}=i;let a,c,{fromIndex:d,toIndex:u}=e;if((t=n?n.length>0:t)||!o||!s){if(!o||t){if(n){const e=n.findIndex((e=>e.dataIndex>=d));a=n[e],d=a.dataIndex}else do{a=i.getRowById(r.getAt(d))}while(!a&&d++<u);e.topRendered=d===e.fromIndex;const t=d-e.fromIndex;e.top=a.top-t*(n?a.offsetHeight:l)}if(!s||t){if(n){const e=n.findIndex((e=>e.dataIndex===u));c=n[-1===e?n.length-1:e],d=c.dataIndex}else do{c=i.getRowById(r.getAt(u))}while(!c&&u-- >d);e.bottomRendered=u===e.toIndex;const t=e.toIndex-u;e.bottom=c.bottom+t*(n?c.offsetHeight:l)}e.height=e.bottom-e.top}}getMergeRange(e,t){if(e.isSpecialRow)return;const n=this,{mergedMap:r}=n,{store:i}=n.client,o=n.client.rowManager.topRow,s=t.id,l=i.indexOf(e),a=`${l}-@-${s}`;let c=r[a];if(!c){const d=t.getRawValue(e);c=r[a]={column:t},n.mergedRanges.push(c);let u,h,g=l;do{u=i.getAt(--g),h=u&&t.getRawValue(u),h===d&&(r[`${g}-@-${s}`]=c)}while(u&&h===d);let p,m,f=l;do{p=i.getAt(++f),m=p&&t.getRawValue(p),m===d&&(r[`${f}-@-${s}`]=c)}while(p&&m===d);if(c.fromIndex=g+1,c.toIndex=f-1,c.toIndex-c.fromIndex>0){const e=o.getCell(s),t=bn.from(e,e.parentElement);c.left=t.left,c.width=t.width,c.use=!0}}return!c.element&&c.use&&n.createRangeElement(c),c}}Ym._$name="MergeCells",gd.registerFeature(Ym);class qm extends di{static $name="QuickFind";static configurable={mode:"header",find:"",keyMap:{F3:"gotoNextHit","Shift+F3":"gotoPrevHit","Ctrl+g":"gotoNextHit","Ctrl+Shift+g":"gotoPrevHit","Ctrl+Shift+f":"showFilterEditor",Escape:"clearSearch",Backspace:"onBackspace"}};static get pluginConfig(){return{chain:["onElementKeyPress","onCellNavigate"]}}static get properties(){return{hitCls:"b-quick-hit",hitCellCls:"b-quick-hit-cell",hitCellBadgeCls:"b-quick-hit-cell-badge",hitTextCls:"b-quick-hit-text"}}construct(e,t){super.construct(e,t),Object.assign(this,{grid:e,treeWalker:e.setupTreeWalker(e.element,Lr.NodeFilter.SHOW_TEXT,(()=>Lr.NodeFilter.FILTER_ACCEPT))})}isActionAvailable(){const{focusedCell:e}=this.grid;return!this.disabled&&(null==e?void 0:e.record)&&!e.isActionable&&this.find.length>0}doDisable(e){e&&this.clear(),super.doDisable(e)}get store(){return this.grid.store}showQuickFind(){const e=this,{grid:t}=e,n=t.getHeaderElement(e.columnId);if(n){if(!e.headerField){const[r,i,o]=Lr.createElement({tag:"div",className:"b-quick-hit-header",children:[{tag:"div",className:"b-quick-hit-field"},{tag:"div",className:"b-quick-hit-badge"}]},{returnAll:!0});"header"===e.mode?n.appendChild(r):(r.className+=" b-quick-hit-mode-grid",t.element.appendChild(r)),e.headerField={header:r,field:i,badge:o,colHeader:n}}e.headerField.field.innerHTML=e.find,e.headerField.badge.innerHTML=e.found.length,n.classList.add("b-quick-find-header")}!n&&!t.hideHeaders||e.renderListenerInitialized||(t.rowManager.ion({rendercell:e.renderCell,thisObj:e}),e.renderListenerInitialized=!0)}hideQuickFind(){const e=this,{grid:t,headerField:n}=e;for(const n of e.prevFound||e.found){const r=t.getRowById(n.id);if(r){r.forceInnerHTML=!0;const t=r.getCell(e.columnId);t._content=null,r.renderCell(t),r.forceInnerHTML=!1}}n&&(n.header.parentNode.removeChild(n.header),n.colHeader.classList.remove("b-quick-find-header"),e.headerField=null),e.renderListenerInitialized&&(t.rowManager.un({rendercell:e.renderCell},e),e.renderListenerInitialized=!1),t.trigger("hideQuickFind")}search(e,t=this.columnId,n=!1){var r;const i=this,{grid:o}=i,s=o.columns.getById(t)||o.columns.get(t),l=i.store.findByField(s.field,e,s.mergeCells&&s.isSorted);let a=1;Object.assign(i,{foundMap:{},prevFound:i.found,found:l,find:e,columnId:s.id,findRe:new RegExp(`(\\s+)?(${A.escapeRegExp(String(e))})(\\s+)?`,"ig")}),e?i.showQuickFind():i.hideQuickFind();for(const e of Lr.children(o.element,`.${i.hitCls}`))e.classList.remove(i.hitCls,i.hitCellCls),e._originalContent&&(e.innerHTML=e._originalContent,e._originalContent=null);if(l){l.length>0&&!n&&i.gotoClosestHit(o.focusedCell,l);for(const e of l){i.foundMap[e.id]=a++;const t=o.getRowById(e.data.id);if(null==t||t.renderCell(t.getCell(s.id)),a>1e3)break}null===(r=o.syncSplits)||void 0===r||r.call(o,(n=>n.features.quickFind.search(e,t,!0))),o.trigger("quickFind",{find:e,found:l})}}clear(){var e;(this.find||null!==(e=this.found)&&void 0!==e&&e.length)&&this.search("")}get foundCount(){var e;return(null===(e=this.found)||void 0===e?void 0:e.length)??0}gotoHit(e){const t=this.found[e];return t&&this.grid.focusCell({columnId:this.columnId,id:t.id},{doSelect:!0}),!!t}gotoClosestHit(e,t){const n=e?this.grid.store.indexOf(e.id):0,r=t.slice().sort(((e,t)=>Math.abs(e.index-n)-Math.abs(t.index-n)));this.gotoHit(t.indexOf(r[0]))}gotoFirstHit(){this.gotoHit(0)}gotoLastHit(){this.gotoHit(this.found.length-1)}gotoNextHit(){var e,t;const n=this,{grid:r}=n,i=(null===(e=r._focusedCell)||void 0===e?void 0:e.id)??(null===(t=r.lastFocusedCell)||void 0===t?void 0:t.id),o=r.store.indexOf(i)||0,s=n.found.find((e=>e.index>o));s?r.focusCell({columnId:n.columnId,id:s.id},{doSelect:!0}):n.gotoFirstHit()}gotoPrevHit(){var e,t;const n=this,{grid:r,found:i}=n,o=(null===(e=r._focusedCell)||void 0===e?void 0:e.id)??(null===(t=r.lastFocusedCell)||void 0===t?void 0:t.id),s=r.store.indexOf(o)||0;let l;if(i.length){for(let e=i.length-1;e--;e>=0)if(i[e].index<s){l=i[e];break}l?r.focusCell({columnId:n.columnId,id:l.id},{doSelect:!0}):n.gotoLastHit()}}renderCell({cellElement:e,column:t,record:n}){var r;const i=this,{classList:o}=e,{treeWalker:s,findRe:l,hitTextCls:a}=i,c=i.columnId===t.id&&(null===(r=i.foundMap)||void 0===r?void 0:r[n.id]);if(c){o.add(i.hitCls),e.isQuickHit=!0,e._originalContent=e.innerHTML;const t=s.currentNode=Lr.down(e,".b-grid-cell-value,.b-tree-cell-value")||e;for(let e=s.nextNode();e&&t.contains(e);){const t=e,n=e.nodeValue,r=["<span>"];e=s.nextNode();let i=l.lastIndex;for(let e=l.exec(n);e;e=l.exec(n)){const t=n.substring(i,e.index),o=e[1]?" ":"",s=e[2],c=e[3]?" ":"";r.push(`${A.encodeHtml(t)}${o}<span class="${a}">${s}</span>${c}`),i=l.lastIndex}r.push(A.encodeHtml(n.substring(i)),"</span>"),t.parentNode.insertBefore(Lr.createElementFromTemplate(r.join(""),{fragment:!0}),t),t.remove()}Lr.createElement({parent:e,className:i.hitCellBadgeCls,text:c})}}onBackspace(e){const t=this;return!!t.find&&(t.find=t.find.substr(0,t.find.length-1),t.search(t.find),!0)}clearSearch(){return!!this.find&&(this.find="",this.search(this.find),!0)}showFilterEditor(){const e=this,{filter:t}=e.client.features;t&&e.columnId&&e.foundCount&&(e.clear(),t.showFilterEditor(e.client.columns.getById(e.columnId),e.find))}onElementKeyPress(e){var t;const n=this,{grid:r}=n,{focusedCell:i}=r;if(!e.handled&&!n.disabled&&null!=i&&i.record&&!i.isActionable&&1===(null===(t=e.key)||void 0===t?void 0:t.length)){const t=r.columns.getById(r._focusedCell.columnId);t&&!1!==t.searchable&&(n.columnId=r._focusedCell.columnId,n.find+=e.key,n.search(n.find))}}onCellNavigate(e,t,n){const r=this;!r.find||n&&n.columnId===r.columnId||r.clear()}}qm._$name="QuickFind",gd.registerFeature(qm);class Km extends di{static $name="RegionResize";static get pluginConfig(){return{chain:["onElementPointerDown","onElementDblClick","onElementTouchMove","onSubGridCollapse","onSubGridExpand","render"]}}static configurable={showSplitterButtons:!0,enableDragging:!0};updateShowSplitterButtons(e){this.client.element.classList.toggle("b-hide-splitter-buttons",!e)}onElementDblClick(e){const t=this,{client:n}=t,r=e.target.closest(".b-grid-splitter-collapsed");if(r&&!t.expanding){t.expanding=!0;let e=r.dataset.region,i=n.getSubGrid(e);i.collapsed||(e=n.getLastRegions()[1],i=n.getSubGrid(e)),i.expand().then((()=>t.expanding=!1))}}startMove(e,t){const n=this,{clientX:r}=t,{client:i}=n,o=e.dataset.region,s=i.element,l=i.regions[i.regions.indexOf(o)+1],a=i.getSubGrid(l),c=i.getSubGrid(o);let d=c,u=1;if(null!=d.flex&&null==a.flex&&(d=a,u=-1),i.rtl&&(u*=-1),e.classList.contains("b-grid-splitter-collapsed"))return;const h=Object.values(i.subGrids).reduce(((e,t)=>t.width+e),0);i.trigger("splitterDragStart",{subGrid:d,domEvent:t}),n.dragContext={element:e,headerEl:d.header.element,subGridEl:d.element,subGrid:d,splitterSubGrid:c,originalWidth:d.element.offsetWidth,originalX:r,minWidth:d.minWidth||0,maxWidth:Math.min(h,d.maxWidth||h),flip:u},s.classList.add("b-moving-splitter"),c.toggleSplitterCls("b-moving"),n.pointerDetacher=Gn.on({element:document,pointermove:"onPointerMove",pointerup:"onPointerUp",thisObj:n})}endMove(e){const t=this,{dragContext:n,client:r}=t;if(n){const{subGrid:i}=n;e.preventDefault(),t.pointerDetacher(),r.element.classList.remove("b-moving-splitter"),n.splitterSubGrid.toggleSplitterCls("b-moving",!1),t.dragContext=null,r.trigger("splitterDragEnd",{subGrid:i,domEvent:e})}}onCollapseClick(e,t,n){const{client:r}=this,i=t.dataset.region,o=r.getLastRegions();if(!1!==r.trigger("splitterCollapseClick",{subGrid:e,domEvent:n})){if(o[0]===i){const e=r.getSubGrid(o[1]);if(e.collapsed)return void e.expand()}e.collapse()}}onExpandClick(e,t,n){const{client:r}=this,i=t.dataset.region,o=r.getLastRegions();if(!1!==r.trigger("splitterExpandClick",{subGrid:e,domEvent:n}))if(o[0]!==i||e.collapsed)e.expand();else{r.getSubGrid(o[1]).collapse()}}updateMove(e){const{dragContext:t}=this;if(t){const n=e-t.originalX,r=Math.max(Math.min(t.maxWidth,t.originalWidth+n*t.flip),0);t.subGrid.width=Math.max(r,t.minWidth)}}onElementPointerDown(e){const t=this,{target:n}=e,r=0===e.button&&n.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),i=r&&t.client.getSubGrid(r.dataset.region);let o;r&&(n.closest(".b-grid-splitter-button-collapse")?t.onCollapseClick(i,r,e):n.closest(".b-grid-splitter-button-expand")?t.onExpandClick(i,r,e):t.enableDragging&&(t.startMove(r,e),o=r)),"touch"===e.pointerType&&t.toggleTouchSplitter(o)}onPointerMove(e){this.dragContext&&(this.updateMove(e.clientX),e.preventDefault())}onElementTouchMove(e){this.dragContext&&e.preventDefault()}onPointerUp(e){this.enableDragging&&this.endMove(e)}onSubGridCollapse({subGrid:e}){const t=this.client.resolveSplitter(e);this.client.getLastRegions()[1]===e.region&&t.classList.add("b-grid-splitter-allow-collapse")}onSubGridExpand({subGrid:e}){this.client.resolveSplitter(e).classList.remove("b-grid-splitter-allow-collapse")}toggleTouchSplitter(e){const t=this,{touchedSplitter:n}=t;e&&n&&e.dataset.region!==n.dataset.region&&t.toggleTouchSplitter();const r=t.client.getSubGrid(e?e.dataset.region:null==n?void 0:n.dataset.region);r&&(r.toggleSplitterCls("b-touching",Boolean(e)),e?r.startSplitterButtonSyncing():r.stopSplitterButtonSyncing()),t.touchedSplitter=e}render(){const{regions:e,subGrids:t}=this.client;e.length>2&&(t[e[0]].splitterElement.classList.add("b-left-only"),t[e[1]].splitterElement.classList.add("b-right-only"))}updateEnableDragging(e){this.client.element.classList.toggle("b-grid-splitter-no-drag",!e)}}Km.featureClass="b-split",Km._$name="RegionResize",gd.registerFeature(Km);class Xm extends xm{static $name="RowCopyPaste";static type="rowCopyPaste";static pluginConfig={assign:["copyRows","pasteRows"],chain:["populateCellMenu"]};static configurable={nameField:"name",keyMap:{"Ctrl+C":{weight:10,handler:"copy"},"Ctrl+X":{weight:10,handler:"cut"},"Ctrl+V":{weight:10,handler:"paste"}},copyRecordText:"L{copyRecord}",cutRecordText:"L{cutRecord}",pasteRecordText:"L{pasteRecord}",rowSpecifierText:"L{row}",rowSpecifierTextPlural:"L{rows}",localizableProperties:["copyRecordText","cutRecordText","pasteRecordText","rowSpecifierText","rowSpecifierTextPlural"],rowOptionsOnCellContextMenu:!1};construct(e,t){super.construct(e,t),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",thisObj:this}),this.grid=e}entityName="row";onBeforeRenderRow({row:e,record:t}){var n;e.cls["b-cut-row"]=this.isCut&&(null===(n=this.cutData)||void 0===n?void 0:n.includes(t))}isActionAvailable({key:e,action:t,event:n}){var i;const{grid:o}=this,{cellEdit:s}=o.features,{target:l}=n;return!this.disabled&&0===r.getSelection().toString().length&&(!s||!s.isEditing)&&("copy"===t||!this.copyOnly)&&(null===(i=o.selectedRecords)||void 0===i?void 0:i.length)>0&&(!l||Boolean(l.closest(".b-gridbase:not(.b-schedulerbase) .b-grid-subgrid,.b-grid-subgrid:not(.b-timeaxissubgrid)")))}async copy(){await this.copyRows()}async cut(){await this.copyRows(!0)}paste(e){return this.pasteRows(null!=e&&e.isModel?e:null)}async copyRows(e=!1){const{client:t,entityName:n}=this,r=this.selectedRecords.filter((t=>!t.readOnly||!e));r.length&&!t.readOnly&&(await this.writeToClipboard(r,e),t.trigger("copy",{records:r,isCut:e,entityName:n}))}setIsCut(e,t){var n;null===(n=this.grid.rowManager.getRowById(e))||void 0===n||n.toggleCls("b-cut-row",t),e.meta.isCut=t}handleCutData({source:e}){var t;e!==this&&null!==(t=this.cutData)&&void 0!==t&&t.length&&this.grid.store.remove(this.cutData)}stringConverter(e){return this.cellsToString(e.flatMap((e=>{var t;return null===(t=this.grid.rowManager.getRowById(e))||void 0===t?void 0:t.cells.map((e=>new Hc(e)))})))}async beforeCopy({data:e,isCut:t}){return await this.client.trigger("beforeCopy",{records:e,isCut:t,entityName:this.entityName})}async pasteRows(e){var t,n,r;const i=this,{client:o,isCut:s,entityName:l}=i,a=e||o.selectedRecord;if(o.readOnly||o.isTreeGrouped)return[];const c=await i.readFromClipboard({referenceRecord:a},!0),d=i.clipboardData===c;if(!Array.isArray(c)||null==c||!c.length||o.store.tree&&s&&c.some((e=>e.contains(a,!0))))return[];i.sortByIndex(c);const u=i.extractParents(c,{},d);return await i.insertCopiedRecords(u,a),o.isDestroying?void 0:(s?await i.clearClipboard():o.selectedRecords=u,o.trigger("paste",{records:u,originalRecords:c,referenceRecord:a,isCut:s,entityName:l}),i.clipboard.triggerPaste(i),null===(t=o.getRowFor(u[u.length-1]))||void 0===t||null===(n=t.cells)||void 0===n||null===(r=n[0])||void 0===r||r.focus(),u)}async beforePaste({referenceRecord:e,data:t,text:n,isCut:r}){const i=t!==n?t:[];return await this.client.trigger("beforePaste",{records:i,referenceRecord:e,isCut:r,entityName:this.entityName,data:t})}stringParser(e){return this.setFromStringData(e,!0).modifiedRecords}generateNewName(e){const t=e.getValue(this.nameField);let n=2;for(;this.client.store.findRecord(this.nameField,`${t} - ${n}`);)n++;return`${t} - ${n}`}insertCopiedRecords(e,t){const{store:n}=this.client,r=n.indexOf(t)+1;return n.tree?t.parent.insertChild(e,t.nextSibling,!1,{orderedBeforeNode:t.nextOrderedSibling}):n.insert(r,e)}get selectedRecords(){const e=[...this.client.selectedRecords];return this.client.selectedCells.forEach((t=>{e.includes(t.record)||e.push(t.record)})),e}getMenuItemText(e,t=!1){const n=this;let r=n[e+"RecordText"];return t&&(r+=` (${n.selectedRecords.length>1?n.rowSpecifierTextPlural:n.rowSpecifierText})`),r}populateCellMenu({record:e,items:t,cellSelector:n}){var r;const i=this,{client:o,rowOptionsOnCellContextMenu:s}=i,l=!0===(null===(r=o.features.cellCopyPaste)||void 0===r?void 0:r.enabled),a=l&&o.isCellSelected(n);o.readOnly||o.isTreeGrouped||!1!==(null==e?void 0:e.isSpecialRow)||!(l?o.selectedRows.length:o.selectedRecords.length)||a&&!i.rowOptionsOnCellContextMenu||(i.copyOnly||(t.cut={text:i.getMenuItemText("cut",a&&s),localeClass:i,icon:"b-icon b-icon-cut",weight:135,disabled:e.readOnly,onItem:()=>i.cut()},t.paste={text:i.getMenuItemText("paste",a&&s),localeClass:i,icon:"b-icon b-icon-paste",weight:140,onItem:()=>i.paste(e),disabled:!1===i.hasClipboardData()}),t.copy={text:i.getMenuItemText("copy",a&&s),localeClass:i,cls:"b-separator",icon:"b-icon b-icon-copy",weight:120,onItem:()=>i.copy()})}sortByIndex(e){const{store:t}=this.client;return e.sort(((n,r)=>{const i=n.indexPath,o=r.indexPath;if(!e.includes(n.parent)&&!e.includes(r.parent))return t.indexOf(n)-t.indexOf(r);if(i.length===o.length){for(let e=0;e<i.length;e++){if(i[e]<o[e])return-1;if(i[e]>o[e])return 1}return 0}return i.length-o.length}))}extractParents(e,t,n=!0){const r=this,{store:i}=r.client;i.tree&&e.forEach((t=>{t.traverse((t=>{const n=t.getTopParent(!0);e.includes(t)||r.isCut&&e.some((e=>n.includes(e)))||e.push(t)}))}));const o=e.reduce(((e,o)=>{let s;const l=o.parentId||o.meta.modified;return r.isCut?(s=o,s.meta.isCut=!1):(s=o.copy(),n&&(s[r.nameField]=r.generateNewName(s)),s.data.expanded=o.isExpanded(r.client.store)),t[o.id]=s,o.parent===i.rootNode?e.push(s):l in t?t[l].appendChild(s,!0):e.push(s),e}),[]);return o.forEach((e=>{e.sortOrderedChildren(!0,!0)})),o}}Xm.featureClass="b-row-copypaste",Xm._$name="RowCopyPaste",gd.registerFeature(Xm,!0,"Grid"),gd.registerFeature(Xm,!1,"Gantt"),gd.registerFeature(Xm,!1,"SchedulerPro"),gd.registerFeature(Xm,!1,"ResourceHistogram");const Jm={remove:1,filter:1,dataset:1,replace:1};class Qm extends(di.mixin(ai)){static $name="RowExpander";static get properties(){return{expanderBodyClass:"b-rowexpander-body",expandedRowClass:"b-rowexpander-row-expanded",shadowRootContainerClass:"b-rowexpander-shadowroot-container",recordStateMap:new Map,collapsingStateMap:new Map}}static configurable={renderer:null,triggerEvent:null,column:{},columnPosition:"first",refreshOnRecordChange:!1,loadingIndicatorHeight:100,loadingIndicatorText:"L{loading}",enableAnimations:!0,widget:null,dataField:null,keyMap:{Tab:{handler:"onTab",weight:50},"Shift+Tab":{handler:"onShiftTab",weight:50}},autoScroll:!1};static get pluginConfig(){return{chain:["afterColumnsChange","beforeRenderRow","processRowHeight","bindStore","navigateUp"],override:["onGridBodyFocusIn","navigateDown","catchFocus","keyMapOnKeyDown"]}}afterConstruct(){const e=this,{client:t}=e;e.renderer||e.widget?(t.isGanttBase&&!1!==t.fixedRowHeight&&console.warn("When using RowExpander on a Gantt, the Gantt`s fixedRowHeight config must be set to false."),e.widget&&Rn.ion({theme:e.onThemeChange,thisObj:e}),e.bindStore(t.store),e.triggerEvent&&t.ion({[e.triggerEvent]:"onTriggerEvent",thisObj:e}),e.addColumn(),e.resizeObserver=new ResizeObserver((t=>e.onExpanderBodyResize(t)))):console.warn("RowExpander requires either a widget config or implementing the renderer function.")}bindStore(e){const t=this;t.recordStateMap.clear(),t.collapsingStateMap.clear(),t.detachListeners("clientStoreChange"),e.ion({name:"clientStoreChange",change:t.onStoreChange,thisObj:t})}doDisable(e){const{client:t}=this;e&&(this.recordStateMap.clear(),this.collapsingStateMap.clear()),t.isConfiguring||t.rowManager.renderFromRow(),super.doDisable(e)}changeLoadingIndicatorText(e){return e?this.L(e):e}onGridBodyFocusIn(e){var t,n;const r=this;(r.widget?e.target.matches(`.${r.expanderBodyClass}, .${r.shadowRootContainerClass}`):null!==(t=r.client.lastMousedownEvent)&&void 0!==t&&null!==(n=t.target)&&void 0!==n&&n.closest("."+r.expanderBodyClass))||r.overridden.onGridBodyFocusIn(e)}keyMapOnKeyDown({target:e}){var t;this.widget&&null!==(t=e.classList)&&void 0!==t&&t.contains(this.shadowRootContainerClass)||this.overridden.keyMapOnKeyDown(...arguments)}get isAnimating(){return this.client.isAnimating}set isAnimating(e){const{client:t}=this,n=t.isAnimating;t.isAnimating=e,t.isAnimating!==n&&t.element.classList.toggle("b-rowexpander-animating")}afterColumnsChange(){this.addColumn()}changeColumn(e){return null==e?e:{type:"action",actions:[{cls:"b-icon b-icon-collapse-down",tooltip:({record:e})=>this.L(this.recordStateMap.has(e)?"L{RowExpander.collapse}":"L{RowExpander.expand}"),onClick:({record:e})=>this.toggleExpand(e)}],width:40,hideable:!1,align:"center",region:this.client.regions[0],...e,field:"expanderActionColumn"}}addColumn(){const e=this,{column:t}=e,{columns:n}=e.client;e._isAddingExpanderColumn||!t||e._expander&&n.includes(e._expander)||(e._isAddingExpanderColumn=!0,"last"===e.columnPosition?[e._expander]=n.add(t):[e._expander]=n.insert(0,t),e._isAddingExpanderColumn=!1)}onTriggerEvent({target:e}){this.disabled||null!=e&&e.closest(".b-action-cell")||!e.closest(".b-grid-cell")||this.toggleExpand(this.client.getRecordFromElement(e))}toggleExpand(e){e&&(this.recordStateMap.has(e)?this.collapse(e):this.expand(e))}onExpanderBodyResize(e){const{client:t}=this,{store:n}=t;for(const t of e){var r,i;const e=n.getById(null===(r=t.target.parentElement)||void 0===r||null===(i=r._domData)||void 0===i?void 0:i.id),o=e&&this.recordStateMap.get(e);if(o&&!o.ignoreResize){const t=o.expanderBodyHeight;o.expanderBodyHeight=null,this.processRowHeight(e,0)!==t&&this.bufferedRenderer(e)}}}onStoreChange({action:e,source:t,records:n,changes:r}){var i;const o=this,{recordStateMap:s,collapsingStateMap:l}=o,a=r&&Object.keys(r);if((1!==(null==a?void 0:a.length)||"store"!==(null===(i=t.modelClass.fieldMap[a[0]])||void 0===i?void 0:i.type))&&!o.disabled)if("removeAll"===e)s.clear(),l.clear();else if(Jm[e])for(const[e,n]of s){var c;if(!t.includes(e))null===(c=n.widget)||void 0===c||c.destroy(),s.delete(e),l.delete(e)}else if(o.refreshOnRecordChange&&null!=n&&n.length)if("update"===e){const e=s.get(n[0]);null!=e&&e.isCreated&&(e.isCreated=!1,o.client.rowManager.renderFromRecord(n[0]))}else if("updatemultiple"===e){let e,r;for(const i of n){const n=s.get(i);if(null!=n&&n.isCreated){const o=t.records.indexOf(i);n.isCreated=!1,(!r||e>o)&&(e=o,r=i)}}r&&o.client.rowManager.renderFromRecord(r)}}processRowHeight(e,t){const n=this.recordStateMap.get(e);if(n){if(!n.isCreated&&n.isRenderingAsync)return this.loadingIndicatorHeight+t;if(!n.expanderBodyHeight)for(const e of this.client.regions){const t=n.expandedBodyElements[e].offsetHeight;t>n.expanderBodyHeight&&(n.expanderBodyHeight=t)}}return((null==n?void 0:n.expanderBodyHeight)??0)+t}beforeRenderRow({row:e,record:t}){const n=this,{regions:r}=n.client,{expandedRowClass:i,collapsingStateMap:o}=n,s=n.recordStateMap.get(t);if(e.cls.toggle("b-rowexpander-disabled",n.disabled),e.cls[i]?n.enableAnimations&&n.isAnimating&&o.has(t)?n.waitForTransition(e,(()=>{const r=o.get(t);var i;r&&(o.delete(t),n.removeExpander(e),null===(i=r.widget)||void 0===i||i.destroy())})):s||n.removeExpander(e):o.delete(t),!n.disabled&&s){s.isCreated||(s.ignoreResize=!0,n.renderExpander(t,e,s)),e.cls.add(i);for(const t of r){const r=e.getElement(t);if(s.isCreated){const e=s.expandedBodyElements[t];e.parentElement!==r&&(Lr.removeEachSelector(r,"."+n.expanderBodyClass),r.appendChild(e),n.resizeObserver.observe(e)),s.ignoreResize=!1,s.renderPromiseResolver&&(n.delay(s.renderPromiseResolver),s.renderPromiseResolver=null)}else n.renderLoadingIndicator(r,s);n.lockCellHeight(r,s.cellHeight,!1)}n._shouldScrollIntoView&&n.autoScroll&&(n._shouldScrollIntoView=!1,Lr.isInView(s.expandedBodyElements[r[0]],!0)||n.client.rowManager.ion({once:!0,thisObj:n,renderDone:()=>n.scrollRowIntoView(e,t)}))}}scrollRowIntoView(e,t){this.isAnimating?this.waitForTransition(e,(()=>this.client.scrollRowIntoView(t))):this.client.scrollRowIntoView(t)}waitForTransition(e,t){Gn.onTransitionEnd({element:e.element,property:"height",handler:t,thisObj:this,duration:Lr.getPropertyTransitionDuration(e.element,"height")??1})}removeExpander(e,t){e.cls.remove(this.expandedRowClass);for(const r of this.client.regions){const i=e.getElement(r);for(const e of i.querySelectorAll("."+this.expanderBodyClass)){var n;t&&(null===(n=e.widget)||void 0===n||n.destroy()),this.resizeObserver.unobserve(e),e.remove()}i.classList.remove(this.expandedRowClass),this.lockCellHeight(i,null,!1)}}renderLoadingIndicator(e,t){t.loadingIndicators.push(Lr.createElement({parent:e,className:this.expanderBodyClass+" b-rowexpander-loading",style:{top:t.cellHeight,height:this.loadingIndicatorHeight},children:[{tag:"i",className:"b-icon b-icon-spinner"},this.loadingIndicatorText]}))}renderExpander(e,t,n){var r;const i=this,{client:o,widget:s,dataField:l}=i,a=null===(r=t.cells[0])||void 0===r?void 0:r.offsetHeight,{expandedBodyElements:c={}}=n,d=[],u=(e,t,n)=>{null!=e&&("string"==typeof e?t.innerHTML=e:e.type&&!e.tag?h(e,t):(e=Lr.createElement(e),t.appendChild(e))),c[n]=t},h=(r,s)=>{var a;const c=null===(a=Lr.getThemeInfo())||void 0===a?void 0:a.name,u=Lr.createElement({parent:s,className:i.shadowRootContainerClass,style:"flex : 1"}),h=u._shadowRoot=u.attachShadow({mode:"closed"});d.push(Lr.cloneStylesIntoShadowRoot(h).then((()=>{if(!o.isDestroyed){if(l){const t=e.getValue(l);if(null!=t&&t.isStore)r.store=t;else if(o.store[`${l}Store`]){const t=o.store[`${l}Store`];r.store=t.chain((t=>e.getValue(l).includes(t)))}else r.data=t}if(c){const{cls:e}=r,t=`b-theme-${c.toLowerCase()}`;r.cls=e?e+" "+t:t}n.widget=s.widget=ul.create(Yt.assign({appendTo:h,owner:o,flex:1,minHeight:"5em",isNested:!0},r)),l&&n.widget.store.ion({change:()=>!t.isDestroyed&&t.render(),thisObj:i})}})).catch((e=>{throw new Error("Could not load stylesheet "+e)})))};if(!n.isRenderingAsync){Object.assign(n,{cellHeight:a,expandedBodyElements:c,expanderBodyHeight:0,loadingIndicators:[]});for(const n of o.regions){const r=t.getElement(n);let l,g=c[n];t.addCls(i.expandedRowClass),g||(g=Lr.createElement({parent:r,tabIndex:-1,className:i.expanderBodyClass,style:{top:a+"px"}}),i.resizeObserver.observe(g)),s?h(s,g):l=i.renderer({record:e,expanderElement:g,rowElement:r,region:n,grid:o}),m.isPromise(l)?d.push(l.then((e=>u(e,g,n)))):u(l,g,n)}d.length?(n.isRenderingAsync=!0,Promise.all(d).then((()=>{Promise.all(d).then((()=>{var t,r;if(!o.isDestroyed){n.isCreated=!0,null===(t=n.loadingIndicators)||void 0===t||t.forEach((e=>e.remove())),n.loadingIndicators.length=0,n.ignoreResize=!1,n.isRenderingAsync=!1;for(const[,e]of i.recordStateMap)if(!e.isCreated)return;null===(r=i.renderRowsWithAnimation)||void 0===r||r.call(i,e,!0)}}))}))):n.isCreated=!0}}renderRowsWithAnimation(e){const t=this;if(t.enableAnimations){const n=t.client.rowManager.getRowById(e);n&&(t.isAnimating=!0,t.collapsingStateMap.has(e)&&n.addCls("b-row-is-collapsing"),t.waitForTransition(n,(()=>{var e;(t.isAnimating=!1,n.isDestroyed)||(null===(e=n.removeCls)||void 0===e||e.call(n,"b-row-is-collapsing"))})))}return t.bufferedRenderer(e)}bufferedRenderer(e){return(this._bufferedRecords??(this._bufferedRecords=[])).push(e),this._rafPromise||(this._rafPromise=new Promise((e=>{requestAnimationFrame((()=>{var t;null===(t=this.internalRender)||void 0===t||t.call(this,e),this._rafPromise=null}))}))),this._rafPromise}internalRender(e){const t=this,{_bufferedRecords:n}=t,{store:r}=t.client;t.recordStateMap.forEach(((e,t)=>{e.renderPromiseResolver&&e.isCreated&&!n.includes(t)&&n.push(t)}));const[i]=n.sort(((e,t)=>r.indexOf(e)-r.indexOf(t)));t.client.rowManager.renderFromRecord(i),n.length=0,t.delay(e)}lockCellHeight(e,t,n){for(let r=0;r<e.children.length;r++){const i=e.children[r];i.classList.contains(this.expanderBodyClass)||(i.style.height=n?"":t+"px")}}async expand(e,t=!1){const n=this;if(n.disabled||n.recordStateMap.has(e)||!1===await n.trigger("beforeExpand",{record:e}))return;let r;return new Promise((i=>{var o,s;(r={isCreated:!1,renderPromiseResolver:i},n.recordStateMap.set(e,r),n.collapsingStateMap.delete(e),n._shouldScrollIntoView=!0,n.renderRowsWithAnimation(e),t)||(null===(o=(s=n.client).syncSplits)||void 0===o||o.call(s,(t=>t.features.rowExpander.expand(e,!0))))})).then((()=>{var t;null===(t=n.trigger)||void 0===t||t.call(n,"expand",{record:e,expandedElements:r.expandedBodyElements,widget:r.widget})}))}async collapse(e,t=!1){const n=this,r=n.recordStateMap.get(e);if(!n.disabled&&!1!==await n.trigger("beforeCollapse",{record:e})){if(null!=r&&r.expandedBodyElements)for(const e in r.expandedBodyElements)n.resizeObserver.unobserve(r.expandedBodyElements[e]);var i,o;if(n.recordStateMap.delete(e),n.collapsingStateMap.set(e,r),await n.renderRowsWithAnimation(e),n.trigger("collapse",{record:e}),!t)null===(i=(o=n.client).syncSplits)||void 0===i||i.call(o,(t=>t.features.rowExpander.collapse(e,!0)))}}navigateDown(){if(!this.onKeyboardIn())return this.overridden.navigateDown(...arguments)}navigateUp(){this.onKeyboardIn(!0)}catchFocus({navigationDirection:e,source:t,editing:n}){if(this.widget){const{client:r}=this,{focusedCell:o}=r;for(let[s,l]of this.recordStateMap.entries())for(const a in l.expandedBodyElements)if(l.expandedBodyElements[a].widget===t){let t;"down"===e&&(s=r.store.getNext(s,i,!0)),t=n||!o||o._isDefaultFocus?this.getNavigateableColumn(r,!0,n&&"up"===e):o.column,r._focusedCell=null;const l=r.normalizeCellContext({record:s,column:t});return r.focusCell(l),n&&r.startEditing(l),!0}}}onKeyboardIn(e){if(this.widget){var t,n,r;const{focusedCell:i}=this.client,o=i&&this.recordStateMap.get(i.record),s=null==o||null===(t=o.expandedBodyElements)||void 0===t||null===(n=t[null==i||null===(r=i.column)||void 0===r?void 0:r.region])||void 0===n?void 0:n.widget;if(null!=s&&s.isGrid){let t;return t=s.focusedCell&&!s.focusedCell._isDefaultFocus?s.focusedCell.column:this.getNavigateableColumn(s),s._focusedCell=null,s.focusCell(s.normalizeCellContext({record:s[(e?"last":"first")+"VisibleRow"],column:t})),!0}}return!1}getNavigateableColumn(e,t=!0,n=!1){const r=n?[...e.columns.visibleColumns].reverse():e.columns.visibleColumns;return r.find((n=>{var r;return n!==e.checkboxSelectionColumn&&n!==(null===(r=e.features.rowExpander)||void 0===r?void 0:r._expander)&&(!t||n.editor)}))??r[0]}isActionAvailable({action:e}){return!this.isDisabled&&(!["rowExpander.onTab","rowExpander.onShiftTab"].includes(e)||(null===(t=this.client.features.cellEdit)||void 0===t?void 0:t.isEditing));var t}onTab(e){const{client:t}=this,{cellEdit:n}=t.features;if(null!=n&&n.enabled){var r,i;const o=!0!==e,{activeRecord:s}=n,l=n.getAdjacentEditableCell(t.focusedCell,o),a=o?s:l?t.store.getById(l.id):null,c=a&&(null===(r=this.recordStateMap.get(a))||void 0===r?void 0:r.widget);if((null==s?void 0:s.id)!==(null==l?void 0:l.id)&&null!=c&&null!==(i=c.features.cellEdit)&&void 0!==i&&i.enabled)return n.finishEditing().then((()=>{const e=c[(o?"first":"last")+"VisibleRow"],t=this.getNavigateableColumn(c,!0,!o);c.startEditing(c.normalizeCellContext({record:e,column:t}))})),!0}return!1}onShiftTab(){return this.onTab(!0)}doDestroy(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect(),delete this.resizeObserver;for(const[,e]of this.recordStateMap){var t;null===(t=e.widget)||void 0===t||t.destroy()}super.doDestroy()}onThemeChange({prev:e,theme:t}){for(const[,n]of this.recordStateMap)Object.values(n.expandedBodyElements).forEach((n=>{const r=n.querySelector("."+this.shadowRootContainerClass);var i,o,s,l;null!=r&&r._shadowRoot&&(Lr.cloneStylesIntoShadowRoot(null==r?void 0:r._shadowRoot,!0),null===(i=n.widget)||void 0===i||null===(o=i.element)||void 0===o||o.classList.remove(`b-theme-${e}`),null===(s=n.widget)||void 0===s||null===(l=s.element)||void 0===l||l.classList.add(`b-theme-${t}`))}))}getExpandedRecord(e){for(const[t,n]of this.recordStateMap.entries())if(e.isWidget&&n.widget){if(n.widget===e)return t}else{const{expandedBodyElements:r}=n;for(const n in r){const i=r[n];if(i===e||i.contains(e))return t}}return null}}Qm._$name="RowExpander",gd.registerFeature(Qm);class Zm extends(ai(di)){static $name="RowReorder";static configurable={showGrip:null,gripOnly:null,hoverExpandTimeout:1e3,touchStartDelay:300,dropOnLeaf:!1,dragHelperConfig:null};static get deprecatedEvents(){return{gridRowBeforeDragStart:{product:"Grid",invalidAsOfVersion:"6.0.0",message:"`gridRowBeforeDragStart` event is deprecated, listen on this event on the Grid instead."},gridRowDragStart:{product:"Grid",invalidAsOfVersion:"6.0.0",message:"`gridRowDragStart` event is deprecated, listen on this event on the Grid instead."},gridRowDrag:{product:"Grid",invalidAsOfVersion:"6.0.0",message:"`gridRowDrag` event is deprecated, listen on this event on the Grid instead."},gridRowBeforeDropFinalize:{product:"Grid",invalidAsOfVersion:"6.0.0",message:"`gridRowBeforeDropFinalize` event is deprecated, listen on this event on the Grid instead."},gridRowDrop:{product:"Grid",invalidAsOfVersion:"6.0.0",message:"`gridRowDrop` event is deprecated, listen on this event on the Grid instead."},gridRowAbort:{product:"Grid",invalidAsOfVersion:"6.0.0",message:"`gridRowAbort` event is deprecated, listen on this event on the Grid instead."}}}construct(e,t){this.grid=e,super.construct(...arguments)}doDestroy(){var e;null===(e=this.dragHelper)||void 0===e||e.destroy(),super.doDestroy()}init(){const e=this,{grid:t}=e;e.dragHelper=Oc.new({name:"rowReorder",cloneTarget:!0,dragThreshold:10,proxyTopOffset:10,targetSelector:".b-grid-row",lockX:!0,dragWithin:t.bodyContainer,allowDropOutside:!0,scrollManager:t.scrollManager,outerElement:e.targetSubGridElement,touchStartDelay:e.touchStartDelay,isElementDraggable:e.isElementDraggable.bind(e),monitoringConfig:{scrollables:[{element:t.scrollable.element,direction:"vertical"}]},setXY(e,t,n){const{context:i}=this;if(!i.started){const e=bn.from(i.element,this.dragWithin),t=i.startPageY-r.pageYOffset-i.element.getBoundingClientRect().top;n=e.top+t+this.proxyTopOffset}Lr.setTranslateXY(e,t,n)},ignoreSamePositionDrop:!1,createProxy(e){const n=e.cloneNode(!0),r=document.createElement("div");if(r.classList.add("b-row-reorder-proxy"),n.removeAttribute("id"),n.style.transform="",n.style.width="",r.appendChild(n),t.selectedRecords.length>1){const e=n.cloneNode(!0);e.classList.add("b-row-dragging-multiple"),r.appendChild(e)}return Lr.removeClsGlobally(r,"b-selected","b-hover","b-focused"),r},internalListeners:{beforedragstart:"onBeforeDragStart",dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onAbort",reset:"onReset",prio:1e4,thisObj:e}},e.dragHelperConfig),e.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","abort"],"gridRow"),t.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","abort"],"gridRow"),e.dropIndicator=Lr.createElement({className:"b-row-drop-indicator"}),e.dropOverTargetCls=["b-row-reordering-target","b-hover"]}static pluginConfig={after:["onPaint"]};get targetSubGridElement(){const e=this.grid.regions[0];return this.grid.subGrids[e].element}isElementDraggable(e,t){if(!e.closest(".b-grid-cell .b-widget")){if(!this.gripOnly)return!0;{const n=e.closest(".b-grid-cell:first-child");if(n){const e=getComputedStyle(n,":before"),r=this.grid.rtl?n.getBoundingClientRect().width-t.borderOffsetX:t.borderOffsetX,i=Lr.roundPx(r)<=Lr.roundPx(parseFloat(e.width));return i&&(this.client.preventDragSelect=!0),i}}}}onBeforeDragStart({event:e,source:t,context:n}){const r=this,{grid:i}=r,o=r.targetSubGridElement;if(e.target.classList.contains("b-rowexpander-shadowroot-container")||r.disabled||i.readOnly||i.isTreeGrouped||!o.contains(n.element))return!1;const s=n.startRecord=i.getRecordFromElement(n.element);if(s.readOnly||s.isSpecialRow)return!1;n.originalRowTop=i.rowManager.getRowFor(s).top,i.selectionMode.checkboxOnly||("touch"===t.startEvent.pointerType?i.isSelected(s)||i.selectRow({record:s,addToSelection:!1}):i.isSelected(s)||e.shiftKey||e.ctrlKey||i.selectRow({record:s}));const l=i.selectedRecords.filter((e=>!e.readOnly));return n.records=[s],l.includes(s)&&(n.records.push(...l.filter((e=>e!==s))),n.records.sort(((e,t)=>i.store.indexOf(e)-i.store.indexOf(t)))),!0}onDragStart({context:e}){var t,n;const r=this,{grid:i}=r,{cellEdit:o,cellMenu:s,headerMenu:l}=i.features;o&&(r.cellEditDisabledState=o.disabled,o.disabled=!0),null==s||null===(t=s.hideContextMenu)||void 0===t||t.call(s,!1),null==l||null===(n=l.hideContextMenu)||void 0===n||n.call(l,!1),i.element.classList.add("b-row-reordering");const a=e.element.querySelector(".b-focused");null==a||a.classList.remove("b-focused"),e.element.firstElementChild.classList.remove("b-selected","b-hover"),i.bodyContainer.appendChild(r.dropIndicator)}onDrag({context:e,event:t}){const n=this,{grid:r}=n,{store:i,rowManager:o}=r,{clientY:s}=t;let l,a,c,d,u,h=!0,g=o.getRowAt(s);if(g){const e=g.top+r.scrollable.element.getBoundingClientRect().top-r.scrollable.y,o=g.height/4,u=e+o,h=e+g.height/2,p=e+3*o;a=g.dataIndex,l=i.getAt(a),i.tree?d=(l.isParent||n.dropOnLeaf)&&s>u&&s<p:i.isGrouped&&(d=l.isGroupHeader&&l.meta.collapsed),c=!d&&t.clientY>=h}else t.pageY<r._bodyRectangle.y?(a=0,l=i.first,c=!1):(a=i.count-1,l=i.last,c=!0),g=r.rowManager.getRow(a);if(l!==n.overRecord||n.after!==c||n.over!==d){var p;if(n.overRecord!==l)null===(p=o.getRowById(n.overRecord))||void 0===p||p.removeCls(n.dropOverTargetCls);n.overRecord=l,n.after=c,n.over=d,(l===e.startRecord||!c&&!d&&0===a&&i.isGrouped||c&&l.isGroupHeader&&l.meta.collapsed&&i.indexOf(l)===i.count-1)&&(h=!1),i.tree?(u=c?l.nextSibling:l,e.records.some((e=>e.contains(l)))&&(h=!1),e.parent=h&&d?l:l.parent,n.clearTimeout(n.hoverTimer),l&&l.isParent&&!l.isExpanded(i)&&(n.hoverTimer=n.setTimeout((()=>r.expand(l)),n.hoverExpandTimeout))):u=c?i.getAt(a+1):l,g.toggleCls(n.dropOverTargetCls,h&&d),!d&&a===i.indexOf(e.startRecord)+(c?-1:1)&&e.parent&&e.startRecord.parent===e.parent&&(h=!1),g&&Lr.setTranslateY(n.dropIndicator,Math.max(g.top+(c?g.element.getBoundingClientRect().height:0),1)),n.dropIndicator.style.visibility=d?"hidden":"visible",n.dropIndicator.classList.toggle("b-drag-invalid",!h),e.insertBefore=u,e.valid=n.reorderValid=h}else e.valid=n.reorderValid}async onDrop(e){const t=this,{client:n}=t,{context:r}=e;if(r.valid=r.valid&&t.reorderValid,r.valid){r.async=!0,n.store.tree&&(r.oldPositionContext=r.records.map((e=>{var t;return{record:e,parentId:null===(t=e.parent)||void 0===t?void 0:t.id,parentIndex:e.parentIndex}})));let i=await t.trigger("gridRowBeforeDropFinalize",e);!1===i&&(r.valid=!1),i=await n.trigger("gridRowBeforeDropFinalize",e),!1===i&&(r.valid=!1),await t.dragHelper.animateProxyTo(t.dropIndicator,{align:"l0-l0"}),await t.finalizeReorder(r)}t.clearTimeout(t.hoverTimer),t.overRecord=t.after=t.over=null,t.trigger("gridRowDrop",e),n.trigger("gridRowDrop",e)}onAbort(e){this.client.trigger("gridRowDragAbort",e)}async finalizeReorder(e){const t=this,{grid:n}=t,{store:r,focusedCell:i}=n;let{records:o}=e;if(e.valid=e.valid&&!o.some((e=>!r.includes(e))),e.valid){let a;var s,l;if(r.tree)o=o.filter((e=>!e.parent||e.bubbleWhile((e=>!o.includes(e)),!0))),a=await e.parent.tryInsertChild(o,t.over?null===(s=e.parent.children)||void 0===s?void 0:s[0]:e.insertBefore),n.rowManager.forEach((e=>e.removeCls(t.dropOverTargetCls))),!e.parent.isExpanded()&&null!==(l=e.parent.children)&&void 0!==l&&l.length&&n.expand(e.parent),e.valid=!1!==a;else if(r.isGrouped&&t.over)r.move(o,r.getAt(r.indexOf(e.insertBefore)+1));else{if(o.length>1)for(;e.insertBefore&&o.includes(e.insertBefore);)e.insertBefore=r.getNext(e.insertBefore,!1,!0);r.move(o,e.insertBefore)}(null==i?void 0:i._rowIndex)>=0&&(n._focusedCell=null,n.focusCell({grid:n,record:i.record,columnId:i.columnId})),r.clearSorters()}e.finalize(e.valid),n.element.classList.remove("b-row-reordering")}onReset(){const e=this,{grid:t}=e,n=t.features.cellEdit;t.element.classList.remove("b-row-reordering"),n&&(n.disabled=e.cellEditDisabledState),e.dropIndicator.remove(),Lr.removeClsGlobally(t.element,...e.dropOverTargetCls)}onPaint({firstPaint:e}){e&&this.init()}updateShowGrip(e){this.grid.element.classList.toggle("b-row-reorder-with-grip",e)}get isDragging(){return this.dragHelper.isDragging}}Zm.featureClass="",Zm._$name="RowReorder",gd.registerFeature(Zm,!1);class ef extends(ai(di)){static $name="Search";static configurable={limit:1e3,showHitIndex:!0,keyMap:{F3:"gotoNextHit","Ctrl+g":"gotoNextHit","Shift+F3":"gotoPrevHit","Ctrl+Shift+g":"gotoPrevHit"}};static get properties(){return{hitCls:"b-search-hit",hitCellCls:"b-search-hit-cell",hitCellBadgeCls:"b-search-hit-cell-badge",hitTextCls:"b-search-hit-text"}}construct(e,t){super.construct(e,t),Object.assign(this,{grid:e,text:"",hitEls:[],treeWalker:e.setupTreeWalker(e.element,Lr.NodeFilter.SHOW_TEXT,(()=>Lr.NodeFilter.FILTER_ACCEPT))}),e.ion({expandNode:"onTreeNodeExpand",thisObj:this})}isActionAvailable(){return Boolean(this.text)}onTreeNodeExpand(){this.text&&this.requestAnimationFrame(this.search,[this.text,!1,!0])}doDestroy(){this.clear(!0),super.doDestroy()}doDisable(e){e&&this.clear(),super.doDisable(e)}get store(){return this.grid.store}static get pluginConfig(){return{chain:["populateCellMenu"]}}async search(e,t=!0,n=!1,r,i=!1){var o;const s=this;if(!e)return s.clear();if(!n&&e===s.text||s.disabled)return;const{grid:l,store:a}=s,c=l.columns.visibleColumns.filter((e=>!1!==e.searchable)),d=[];r=r||c.map((e=>{var t;return d.push(null===(t=e.formatValue)||void 0===t?void 0:t.bind(e)),e.field}));const u=a.search(e,r,d);a.isTree&&u.length&&await l.expandTo(u.map((e=>e.id)));for(const e of c)if(e.mergeCells&&e.isSorted){let t=null,n=null;for(const r of u)if(r.field===e.field){const e=r.data[r.field];e===t&&(r.belongsTo=n),t=e,n=`${r.field}-${r.id}`}}let h=1;if(Object.assign(s,{foundMap:{},prevFound:s.found,found:u,text:e,findRe:new RegExp(`(\\s+)?(${A.escapeRegExp(String(e))})(\\s+)?`,"ig")}),s.clearHits(),u){for(const e of u)if(s.foundMap[`${e.field}-${e.id}`]=e.belongsTo?s.foundMap[e.belongsTo]:h++,h>s.limit)break;return s.listenersInitialized||(l.rowManager.ion({name:"renderCell",renderCell:"renderCell",thisObj:s}),a.ion({name:"storeRefresh",[`refresh${l.asyncEventSuffix}`]:"onStoreRefresh",thisObj:s}),s.listenersInitialized=!0),l.refreshRows(),l.trigger("search",{grid:l,find:e,found:u}),!t||s.isHitFocused||i||s.gotoNextHit(!0),null===(o=l.syncSplits)||void 0===o||o.call(l,(i=>i.features.search.search(e,t,n,r,!0))),u}}clearHits(){for(const e of Lr.children(this.grid.element,"."+this.hitCls)){e.classList.remove(this.hitCls,this.hitCellCls);const t=Nc.get(e).row;t&&(t.forceInnerHTML=!0,t.renderCell(e),t.forceInnerHTML=!1)}}clear(e=!1){const t=this,{grid:n}=t;var r;(t.foundMap&&delete t.foundMap,t.text=null,t.clearHits(),t.listenersInitialized&&(t.detachListeners("renderCell"),t.detachListeners("storeRefresh"),t.listenersInitialized=!1),e)||(n.trigger("clearSearch",{grid:n}),null===(r=n.syncSplits)||void 0===r||r.call(n,(e=>e.features.search.clear())))}get foundCount(){var e;return(null===(e=this.found)||void 0===e?void 0:e.length)??0}get isHitFocused(){var e;const t=this,{grid:n}=t,{focusedCell:r}=n;if(null!=r&&null!==(e=r.cell)&&void 0!==e&&e.contains(Lr.getActiveElement(n.element))){const{rowIndex:e,column:n}=r;return-1!==e&&t.found.some((t=>t.index===e&&n&&t.field===n.field))}}gotoNextHit(e=!1){var t;const n=this;if(null===(t=n.found)||void 0===t||!t.length)return;const{grid:r,store:o}=n,s=r.focusedCell||r.lastFocusedCell,l=s&&!0!==e?o.indexOf(s.record,i,!0):-1,a=n.found.findIndex((e=>e.index>l));-1!==a&&n.gotoHit(a)}gotoPrevHit(){var e;const t=this,{store:n}=t;if(null===(e=t.found)||void 0===e||!e.length)return;const{grid:r,found:o}=t,s=r.focusedCell||r.lastFocusedCell,l=s?n.indexOf(s.record,i,!0):0;for(let e=o.length-1;e--;e>=0){if(o[e].index<l){t.gotoHit(e);break}}}gotoHit(e){const{grid:t}=this,n=this.found[e];return n&&t.focusCell({field:n.field,id:n.id}),Boolean(n)}gotoFirstHit(){this.gotoHit(0)}gotoLastHit(){this.gotoHit(this.found.length-1)}renderCell({cellElement:e,column:t,record:n,value:r}){var i;const o=this,{treeWalker:s,findRe:l,hitTextCls:a,showHitIndex:c}=o,d=null===(i=o.foundMap)||void 0===i?void 0:i[t.field+"-"+n.id];if(d){var u;e.classList.add(o.hitCls),c&&(null===(u=e.querySelector(`.${o.hitCellBadgeCls}`))||void 0===u||u.remove());const t=Lr.down(e,".b-grid-cell-value,.b-tree-cell-value")||e;if(String(r).toLowerCase()===String(o.text).toLowerCase())t.innerHTML=`<span class="${o.hitTextCls}">${t.innerHTML}</span>${c?`<div class="${o.hitCellBadgeCls}">${d}</div>`:""}`;else{s.currentNode=t;for(let e=s.nextNode();e&&t.contains(e);){const t=e,n=e.nodeValue,r=["<span>"];e=s.nextNode();let i=l.lastIndex;for(let e=l.exec(n);e;e=l.exec(n)){const t=n.substring(i,e.index),o=e[1]?" ":"",s=e[2],c=e[3]?" ":"";r.push(`${A.encodeHtml(t)}${o}<span class="${a}">${A.encodeHtml(s)}</span>${c}`),i=l.lastIndex}r.push(A.encodeHtml(n.substring(i)),"<span>"),t.parentNode.insertBefore(Lr.createElementFromTemplate(r.join(""),{fragment:!0}),t),t.remove()}c&&Lr.createElement({parent:e,className:o.hitCellBadgeCls,text:d})}o.hitEls.push(e)}}populateCellMenu({column:e,record:t,items:n,cellElement:i}){const o=this;e.searchable&&(n.search={text:"L{searchForValue}",localeClass:o,icon:"b-fw-icon b-icon-search",cls:"b-separator",weight:200,disabled:o.disabled,onItem:()=>{let e=r.getSelection().toString();e||(e=i.innerText),o.search(e)}})}onStoreRefresh(){this.search(this.text,!1,!0)}}ef.featureClass="b-search",ef._$name="Search",gd.registerFeature(ef);class tf extends di{static $name="Sort";static configurable={multiSort:!0,prioritizeColumns:!1,toggleOnHeaderClick:!0};static get properties(){return{ignoreRe:new RegExp(["b-grid-header-resize-handle","b-filter-icon"].join("|")),sortableCls:"b-sortable",sortedCls:"b-sort",sortedAscCls:"b-asc",sortedDescCls:"b-desc"}}construct(e,t){t=this.processConfig(t),this.grid=e,this.bindStore(this.store),super.construct(e,t)}processConfig(e){return"string"==typeof e||Array.isArray(e)?{field:e,ascending:null}:e}setConfig(e){super.setConfig(this.processConfig(e))}bindStore(e){var t;this.detachListeners("store"),e.ion({name:"store",beforeSort:"onStoreBeforeSort",sort:"syncHeaderSortState",thisObj:this}),null!==(t=this.client)&&void 0!==t&&t.isPainted&&this.syncHeaderSortState()}set field(e){var t;const n=this.grid.columns.get(e);n&&"object"==typeof n.sortable&&(n.sortable.field=n.sortable.property||e,e=n.sortable),null!==(t=this.store.sorters)&&void 0!==t&&t.some((t=>t.field===e))||this.store.sort(e,this.ascending)}get store(){return this.grid[this.grid.sortFeatureStore]}static get pluginConfig(){return{chain:["onElementClick","populateHeaderMenu","getColumnDragToolbarItems","renderHeader","onPaint","bindStore"]}}syncHeaderSortState(){const e=this,{grid:t}=e;if(!t.hideHeaders&&t.isPainted){const r=e.store.sorters,i=r.length,o=new wn;let s;for(const l of t.columns.visibleColumns){if(!l.sortable)continue;const t=l.element,a=l.textWrapper,c=null==a?void 0:a.dataset;let d="none";var n;if((null==c?void 0:c.sortIndex)&&delete c.sortIndex,o.value=t.classList,!1===l.sortable)o.remove(e.sortableCls),null==a||null===(n=a.querySelector(".b-sort-icon"))||void 0===n||n.remove();else null!=a&&a.querySelector(".b-sort-icon")||Lr.createElement({parent:a,className:"b-sort-icon"}),o.add(e.sortableCls),s=r.find((e=>e.field===l.field||e.sortFn&&e.sortFn===l.sortable.sortFn)),s?(i>1&&c&&(c.sortIndex=r.indexOf(s)+1),o.add(e.sortedCls),s.ascending?(o.add(e.sortedAscCls),o.remove(e.sortedDescCls),d="ascending"):(o.add(e.sortedDescCls),o.remove(e.sortedAscCls),d="descending")):(o.remove(e.sortedCls),o["b-group"]||(o.remove(e.sortedAscCls),o.remove(e.sortedDescCls)));Lr.syncClassList(t,o),Lr.setAttributes(t,{"aria-sort":d})}}}populateHeaderMenu({column:e,items:t}){const n=this,{store:r}=n,i={...e.sortable,field:e.field,columnOwned:!0};if(!1!==e.sortable&&(t.sortAsc={text:"L{sortAscending}",localeClass:n,icon:"b-fw-icon b-icon-sort-asc",cls:"b-separator",weight:300,disabled:n.disabled,onItem:()=>r.sort(i,!0)},t.sortDesc={text:"L{sortDescending}",localeClass:n,icon:"b-fw-icon b-icon-sort-desc",weight:310,disabled:n.disabled,onItem:()=>r.sort(i,!1)},n.multiSort&&n.grid.columns.records.some((e=>e.sortable)))){const o=r.sorters.find((t=>t.field===e.field||e.sortable.sortFn&&e.sortable.sortFn===t.sortFn));t.multiSort={text:"L{multiSort}",localeClass:n,icon:"b-fw-icon b-icon-sort",weight:320,disabled:n.disabled,menu:{addSortAsc:{text:o?"L{toggleSortAscending}":"L{addSortAscending}",localeClass:n,icon:"b-fw-icon b-icon-sort-asc",disabled:o&&(null==o?void 0:o.ascending),weight:330,onItem:()=>r.addSorter(i,!0)},addSortDesc:{text:o?"L{toggleSortDescending}":"L{addSortDescending}",localeClass:n,icon:"b-fw-icon b-icon-sort-desc",disabled:o&&!o.ascending,weight:340,onItem:()=>r.addSorter(i,!1)},removeSorter:{text:"L{removeSorter}",localeClass:n,icon:"b-fw-icon b-icon-remove",weight:350,disabled:!o,onItem:()=>{r.removeSorter(i.field)}}}}}}getColumnDragToolbarItems(e,t){const n=this,{store:r,disabled:i}=n;if(!1!==e.sortable){const o=r.sorters.find((t=>t.field===e.field));t.push({text:"L{sortAscendingShort}",group:"L{sort}",localeClass:n,icon:"b-icon b-icon-sort-asc",ref:"sortAsc",cls:"b-separator",weight:105,disabled:i,onDrop:({column:e})=>r.sort(e.field,!0)},{text:"L{sortDescendingShort}",group:"L{sort}",localeClass:n,icon:"b-icon b-icon-sort-desc",ref:"sortDesc",weight:105,disabled:i,onDrop:({column:e})=>r.sort(e.field,!1)},{text:"L{addSortAscendingShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-sort-asc",ref:"multisortAddAsc",disabled:i||o&&o.ascending,weight:105,onDrop:({column:e})=>r.addSorter(e.field,!0)},{text:"L{addSortDescendingShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-sort-desc",ref:"multisortAddDesc",disabled:i||o&&!o.ascending,weight:105,onDrop:({column:e})=>r.addSorter(e.field,!1)},{text:"L{removeSorterShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-remove",ref:"multisortRemove",weight:105,disabled:i||!o,onDrop:({column:e})=>r.removeSorter(e.field)})}return t}onStoreBeforeSort({sorters:e}){const{columns:t}=this.client;for(let r=0;r<e.length;r++){var n;const i=e[r],o=(i.columnOwned||this.prioritizeColumns)&&t.get(i.field);null!=o&&null!==(n=o.sortable)&&void 0!==n&&n.sortFn&&(e[r]={...i,...o.sortable,columnOwned:!0})}}onElementClick(e){const t=this,{store:n}=t,{target:r}=e,i=r.closest(".b-grid-header.b-sortable"),o=null==i?void 0:i.dataset.column;if(!(t.ignoreRe.test(r.className)||t.disabled||e.handled)&&i&&o&&(t.toggleOnHeaderClick||r.closest(".b-sort-icon"))){const r=t.grid.columns.getById(i.dataset.columnId);if(n.isGrouped&&n.groupers.find((e=>e.field===o))&&!e.shiftKey)return;if(r.sortable&&!e.shiftKey)if(e.ctrlKey&&e.altKey)n.removeSorter(r.field);else{const i={columnOwned:!0,field:r.field};"object"==typeof r.sortable&&Yt.assign(i,r.sortable),n.sort(i,null,e.ctrlKey&&t.multiSort)}}}renderHeader(){this.syncHeaderSortState()}onPaint(){this.syncHeaderSortState()}}tf.featureClass="b-sort",tf._$name="Sort",gd.registerFeature(tf,!0);class nf extends di{static get $name(){return"StickyCells"}static get defaultConfig(){return{contentSelector:null,currentTopRowCls:"b-sticky-cells-current-top-row"}}static get pluginConfig(){return{before:["renderRows"]}}construct(e,t){super.construct(e,t),e.ion({scroll:"onGridScroll",thisObj:this}),Object.assign(this,Lr.createElement({reference:"element",parent:e.element,className:"b-grid-sticky-row",children:[{reference:"contentElement",className:"b-grid-cell"}]})),this.removeClasses={"b-focused":!1,"b-hover":!1,"b-selected":!1,[this.currentTopRowCls]:!1}}renderRows(){this.element.classList.add("b-hide-visibility")}onGridScroll(){const e=this,{client:t,element:n,contentElement:r}=e,i=bn.client(t.bodyContainer).roundPx(),o=t.rowManager.getRowAt(i.y),s=o!==e.currentTopRow;if(o){s&&(e.currentTopRow&&(e.currentTopRow.removeCls(e.currentTopRowCls),e.currentTopRow.removeCls("b-not-enough-height")),e.currentTopRow=o,o.addCls(e.currentTopRowCls),r.innerHTML="",r.appendChild(e.updateStickyContent()));const t=e.currentTopRow.bottom-e.client.scrollable.y<=e.stickyContentHeight;e.element.classList[t?"add":"remove"]("b-hide-visibility"),e.currentTopRow[t?"addCls":"removeCls"]("b-not-enough-height"),i.y+=e.stickyContentTop,Lr.alignTo(n,e.stickyEls[0],{align:"t0-t0",constrainTo:i},!0)}e.lastProcessedTopRow=o}updateStickyContent(){const e=this,{currentTopRow:t,removeClasses:n}=e,r={"b-grid-sticky-row":1},i={},o=e.stickyContent||(e.stickyContent=document.createDocumentFragment()),s=e.stickyEls||(e.stickyEls=[]);for(s.forEach((e=>{e.classList.remove("b-sticky-content-el")})),s.length=0,t.eachElement((t=>{s.push(...t.querySelectorAll(e.contentSelector))}));o.firstChild;)o.remove(o.firstChild);return e.stickyContentHeight=0,e.stickyContentTop=0,s.map((t=>{t.closest(".b-grid-cell").classList.forEach((e=>i[e]=1)),t.closest(".b-grid-row").classList.forEach((e=>r[e]=1)),Object.assign(i,n),Object.assign(r,n);const s=t.offsetTop;e.stickyContentTop=Math.max(e.stickyContentTop,s),t.style.alignSelf="flex-end",e.stickyContentHeight=Math.max(e.stickyContentHeight,e.currentTopRow.height-t.offsetTop+s),t.style.alignSelf="";const l=t.cloneNode(!0);return t.classList.add("b-sticky-content-el"),o.appendChild(l),l})),i["b-focused"]=!1,Lr.syncClassList(e.contentElement,i),Lr.syncClassList(e.element,r),o}}nf._$name="StickyCells",gd.registerFeature(nf,!1);class rf extends di{static get $name(){return"Stripe"}construct(e,t){super.construct(e,t),e.ion({renderrow:"onRenderRow",thisObj:this})}doDisable(e){this.isConfiguring||this.client.refreshRows(),super.doDisable(e)}onRenderRow({row:e}){const{disabled:t}=this,n=e.dataIndex%2==0;e.assignCls({"b-even":!t&&n,"b-odd":!t&&!n})}}rf._$name="Stripe",gd.registerFeature(rf);const of=Object.freeze({animate:!1,block:"start"}),sf=Object.freeze({animate:!1,block:"end"}),lf={split:1,unsplit:1};class af extends di{static $name="Split";static featureClass="";static configurable={subViews:[],relayProperties:{value:{readOnly:1,rowHeight:1},$config:{merge:"merge"}}};static pluginConfig={chain:["populateCellMenu","afterConfigChange","afterAddListener","afterRemoveListener"],assign:["split","unsplit","subViews","syncSplits"]};#e=!1;restorers=[];doDestroy(){this.unsplit(!0),super.doDestroy()}doDisable(e){const t=this;t.isConfiguring||(e?(t._disabledSplitOptions=t._splitOptions,t.unsplit()):t._disabledSplitOptions&&(t.split(t._disabledSplitOptions),t._disabledSplitOptions=null))}get isSplit(){var e;return Boolean(null===(e=this.widgets)||void 0===e?void 0:e.length)}getClientConfig(e,t,n,r={}){const{client:i}=this,{subGrids:o,regions:s}=i,l=i.columns.records.slice(),a=Yt.assign({},i.subGridConfigs);if(i.eachSubGrid((e=>{const t=a[e.region];e.flex?t.flex=e.flex:t.width=e.element.style.width})),n.atColumn&&s.length>1&&t>0){const e=s.indexOf(n.atColumn.region);for(let t=0;t<e;t++){const e=o[s[t]];H.remove(l,...e.columns.records),delete a[s[t]]}}const c=Yt.assign({},i.initialConfig,{appendTo:e,insertFirst:null,insertBefore:null,splitFrom:i,owner:i.owner,tbar:i.initialConfig.tbar&&1===t?{height:i.tbar.height,items:[" "]}:null,store:i.store,selectedRecordCollection:i.selectedRecordCollection,subGridConfigs:a,columns:this.cloneColumns(l),minHeight:0,minWidth:0},r);for(const e of Yt.keys(this.relayProperties))c[e]=i[e];const d={};for(const e in i.listeners)if(!lf[e]){const t=i.listeners[e].filter((e=>!e.$internal));t.length&&(d[e]=t)}return c.listeners=d,("horizontal"===n.direction||"both"===n.direction&&1!==t)&&(c.hideHeaders=!0),delete c.data,delete c.adopt,c}cloneColumns(e){return e.flatMap((e=>{if(e.meta.isSelectionColumn||"expanderActionColumn"===e.field)return[];const t={...e.data};return e.children&&(t.children=e.children.map((e=>({...e.data})))),delete t.headerRenderer,delete t.parentId,t}))}cloneClient(e,t,n,r){const i=this.getClientConfig(e,t,n,r),o=new this.client.constructor(i);return o.element.classList.add("b-split-clone"),o}processOptions(e){const{client:t}=this,{atRecord:n,atColumn:r,direction:i}=e;if(i){if("vertical"!==i&&!n&&t.store.count){const n=t._bodyRectangle.height/2+t.scrollable.y,r=t.rowManager.getRowAt(n,!0)??t.rowManager.rows[Math.ceil(t.rowManager.rows.length/2)];e.atRecord=t.store.getById(r.id)}if("horizontal"!==i&&!r){const n=bn.from(t.element);let r=n.center.x-n.x,i=t.subGrids[t.regions[0]],o=0,s=null;for(;r>i.width;)r-=i.width,i=t.subGrids[t.regions[++o]];r+=i.scrollable.x;const{visibleColumns:l}=i.columns;let a=0,c=0;for(;a<r&&c<l.length;)s=l[c++],a+=s.element.offsetWidth;e.atColumn=s}}else e.direction=n&&r?"both":r?"vertical":"horizontal";return e}createSplitContainer({direction:e}){const{client:t}=this,{element:n}=t;return this.splitContainer=Lr.createElement({parent:n.parentElement,className:{"b-split-container":1,[`b-split-${e}`]:1,"b-rtl":t.rtl},style:{width:n.style.width,height:n.style.height},children:["both"!==e&&n,"both"===e&&{className:"b-split-top",children:[n]},"both"===e&&{className:"b-split-bottom"}]})}syncHeaderHeights(){let e=0;for(const t of this.subViews)t.eachSubGrid((t=>{t.header.height>e&&(e=t.header.height)}));for(const t of this.subViews)t.eachSubGrid((t=>{t.header.height=e}))}toggleOriginalSubGrids(e){const t=this,{client:n}=t,{regions:r}=n;if(e.atColumn&&r.length>1){const i=r.indexOf(e.atColumn.region),o=[n];"both"===e.direction&&o.push(t.subViews[2]);for(const e of o)if(i+1<r.length){const o=e===n,s=e.subGrids[r[i]];s.hideSplitter(),o&&t.restorers.push((()=>s.showSplitter())),s.flex||(n.inForEachOther=!0,s.flex=1,n.inForEachOther=!1,o&&t.restorers.push((()=>{s.flex=null,s.width=s._initialWidth})));for(let n=i+1;n<r.length;n++){const i=e.subGrids[r[n]];i.hide(),o&&t.restorers.push((()=>{i.show()}))}2===r.length&&(e._initialWidth=e.element.style.width,e._initialFlex=e.flex,e.width=s._initialWidth,o&&t.restorers.push((()=>{null!==e._initialFlex?e.flex=e._initialFlex:null!==e._initialWidth&&(e.width=e._initialWidth)})))}}}async split(e={}){const t=this,{client:n}=t;if(n.splitFrom)return;t.isSplit&&await t.unsplit(!0);const{rtl:r}=n,{atRecord:i,atColumn:o,direction:s}=t.processOptions(e);let{splitX:l,remainingWidth:a}=e,c=null,d=null;if(i){await n.scrollRowIntoView(i);const e=n.getRowFor(i);if(!e)throw new Error(`Could not find row for record ${i.id}`);c=bn.from(e.cells[0],n.element).bottom,d=bn.from(n.element).height-c}if(o&&!l&&(l=bn.from(o.element,n.element).getEnd(r),a=bn.from(n.element).width-l-Lr.scrollBarWidth,r)){const e=l;l=a+Lr.scrollBarWidth,a=e-Lr.scrollBarWidth}const u=[],h=t.createSplitContainer(e),{visibleColumns:g}=n.columns,p=o?g[g.indexOf(o)+1]:null,m=i?n.store.getNext(i):null;if(n.eachSubGrid((e=>e._initialWidth=e.width)),n.columns.commit(),"both"!==s){const r={flex:`0 0 ${(null!=c?d:a)-7}px`,height:null},[,i]=t.widgets=[new Pp({appendTo:h}),t.cloneClient(h,"vertical"===s?1:0,e,r)];null!=l&&(n.renderRows(),e.atDate||(u.push(n.scrollColumnIntoView(o,sf)),p&&u.push(i.scrollColumnIntoView(p,of)))),null!=c&&u.push(i.scrollRowIntoView(m,of)),n.element.classList.add("b-split-start"),i.element.classList.add("b-split-end"),n.scrollable.addPartner(i.scrollable,{x:"horizontal"===s,y:"horizontal"!==s})}else{const r={flex:`0 0 ${a-7}px`};h.lastElementChild.style.flex=`0 0 ${d-7}px`,t.widgets=[new Pp({insertBefore:h.lastElementChild}),t.topSplitter=new Pp({appendTo:h.firstElementChild}),t.cloneClient(h.firstElementChild,1,e,r),t.cloneClient(h.lastElementChild,0,e),t.bottomSplitter=new Pp({appendTo:h.lastElementChild}),t.cloneClient(h.lastElementChild,2,e,r)];const i=n,s=t.widgets[2],g=t.widgets[3],f=t.widgets[5];i.element.classList.add("b-split-top-start"),s.element.classList.add("b-split-top-end"),g.element.classList.add("b-split-bottom-start"),f.element.classList.add("b-split-bottom-end"),null!=l&&(i.renderRows(),g.renderRows(),o&&!e.atDate&&(u.push(n.scrollColumnIntoView(o,sf)),p&&u.push(s.scrollColumnIntoView(p,of)))),null!=c&&u.push(g.scrollRowIntoView(m,of),f.scrollRowIntoView(m,of)),i.scrollable.addPartner(s.scrollable,"y"),i.scrollable.addPartner(g.scrollable,"x"),s.scrollable.addPartner(f.scrollable,"x"),g.scrollable.addPartner(f.scrollable,"y"),t.topSplitter.ion({splitterMouseDown:"onSplitterMouseDown",drag:"onSplitterDrag",drop:"onSplitterDrop",thisObj:t}),t.bottomSplitter.ion({splitterMouseDown:"onSplitterMouseDown",drag:"onSplitterDrag",drop:"onSplitterDrop",thisObj:t})}t.subViews=[n,...t.widgets.filter((e=>e.isGridBase))],t.toggleOriginalSubGrids(e),t.syncHeaderHeights(),t._splitOptions=e,await Promise.all(u);const f=bn.from(n.element);return n.onInternalResize(n.element,f.width,f.height),n.eachSubGrid((e=>{const t=bn.from(e.element);e.onInternalResize(e.element,t.width,t.height)})),n.scrollable.x+=.5,n.scrollable.y+=.5,t.startSyncingColumns(),n.trigger("split",{subViews:t.subViews,options:e}),t.subViews}async unsplit(e=!1){const t=this,{client:n}=t,{element:r}=n;var i;if(t.isSplit&&(t.stopSyncingColumns(),null===(i=t.widgets)||void 0===i||i.forEach((e=>e.destroy())),t.widgets=null,n.eachSubGrid((e=>e.scrollable.x)),n.scrollable.y,t.splitContainer.parentElement.appendChild(r),t.splitContainer.remove(),t.splitContainer=null,r.style.flexBasis=r.style.flexGrow="",r.classList.remove("b-split-top-start","b-split-start"),t.subViews.length=0,!t.isDestroying)){n.renderRows(),t.unsplitCleanup();for(const e of t.restorers)e();if(t.restorers.length=0,await V.animationFrame(),await V.animationFrame(),t.isDestroyed)return;!e&&n.trigger("unsplit"),t._splitOptions=null}}unsplitCleanup(){}populateCellMenu({record:e,column:t,items:n}){const r=this,{isSplit:i}=r,{splitFrom:o}=r.client;r.disabled||(n.splitGrid={text:"L{split}",localeClass:r,icon:"b-icon b-icon-split-vertical",weight:500,separator:!0,hidden:i||o,menu:{splitHorizontally:{text:"L{horizontally}",icon:"b-icon b-icon-split-horizontal",localeClass:r,weight:100,onItem(){r.split({atRecord:e})}},splitVertically:{text:"L{vertically}",icon:"b-icon b-icon-split-vertical",localeClass:r,weight:200,onItem(){r.split({atColumn:t})}},splitBoth:{text:"L{both}",icon:"b-icon b-icon-split-both",localeClass:r,weight:300,onItem(){r.split({atColumn:t,atRecord:e})}}}},n.unsplitGrid={text:"L{unsplit}",localeClass:r,icon:"b-icon b-icon-clear",hidden:!(i||o),weight:400,separator:!0,onItem(){(o||r).unsplit()}})}startSyncingColumns(){for(const e of this.subViews)e.columns.ion({name:"columns",change:"onColumnsChange",thisObj:this})}stopSyncingColumns(){this.detachListeners("columns")}onColumnsChange({source:e,isMove:t,action:n,parent:r,records:i,changes:o}){const s=this;if(!s.#e){s.#e=!0;for(const l of s.subViews){const{columns:a}=l;if(e!==a){if("update"===n&&o.region&&1===Object.keys(o).length){if(a.getById(i[0].id))a.remove(i[0].id);else{const[e]=i,t=a.getById(s.$before.parent.id)??a.rootNode,n=null!==s.$before.id&&a.getById(s.$before.id);t.insertChild(e.data,n)}s.$before=null}else if(null!=t&&t[i[0].id]||!0===t){if("add"===n){const e=i[0],t=e.nextSibling,n=a.getById(e.id);if(!n){s.$before={id:null==t?void 0:t.id,parent:r},s.#e=!1;continue}if(e.meta.isSelectionColumn){s.#e=!1;continue}const o=a.getById(r.id)??a.rootNode,l=t&&a.getById(t.id);o.insertChild(n,l)}}else if("add"===n){const e=i.filter((e=>l.getSubGridFromColumn(e)));a.add(s.cloneColumns(e))}else a.applyChangesFromStore(e);a.commit()}}e.commit(),s.#e=!1}}getOtherSplitter(e){return e===this.topSplitter?this.bottomSplitter:this.topSplitter}onSplitterMouseDown({source:e,event:t}){t.handled||(t.handled=!0,this.getOtherSplitter(e).onMouseDown(t))}onSplitterDrag({source:e,event:t}){t.handled||(t.handled=!0,this.getOtherSplitter(e).onMouseMove(t))}onSplitterDrop({source:e,event:t}){t.handled||(t.handled=!0,this.getOtherSplitter(e).onMouseUp(t))}afterConfigChange({name:e,value:t}){this.isSplit&&this.relayProperties[e]&&this.syncSplits((n=>{n[e]=t}))}afterAddListener(e,t){!this.isSplit||t.$internal||lf[e]||this.syncSplits((n=>n.on(e,t)))}afterRemoveListener(e,t){t.$internal||this.syncSplits((n=>n.un(e,t)))}forEachOther(e){const t=this.client.splitFrom||this.client;if(t.features.split.enabled&&!t.inForEachOther){t.inForEachOther=!0;for(const n of t.subViews)n!==this.client&&e(n);t.inForEachOther=!1}}syncSplits(e){this.forEachOther(e)}}af._$name="Split",gd.registerFeature(af,!1);class cf extends(Wm(di)){static get configurable(){return{selectedOnly:null,hideFooters:!1}}static get pluginConfig(){return{chain:["renderRows","bindStore"]}}static get $name(){return"Summary"}construct(e,t){this.grid=e,super.construct(e,t),this.bindStore(e.store),e.hideFooters=this.hideFooters}bindStore(e){this.detachListeners("store"),e.ion({name:"store",change:"onStoreChange",thisObj:this})}get store(){return this.grid.store}doDestroy(){super.doDestroy()}doDisable(e){super.doDisable(e);const{client:t}=this;e?t.element.classList.add("b-summary-disabled"):(this.updateSummaries(),t.element.classList.remove("b-summary-disabled"),t.eachSubGrid((e=>e.scrollable.syncPartners())))}renderRows(){this.updateSummaries()}updateSummaries(){const e=this,{grid:t,store:n}=e,r=Lr.children(t.element,".b-grid-footer"),i=e.selectedOnly&&t.selectedRecords.length>0,o=(n.isFiltered?n.storage.values:n.allRecords).filter((e=>!e.isSpecialRow&&(!i||t.isSelected(e))));t.columns.forEach((e=>{var t;null===(t=e.summaries)||void 0===t||t.forEach((e=>{"seed"in e&&("initialSeed"in e||(e.initialSeed=e.seed),["number","string","date"].includes(typeof e.initialSeed)?e.seed=e.initialSeed:e.seed=Object.assign({},e.initialSeed))}))})),r.forEach((n=>{if(!n.dataset.column)return;const r=t.columns.get(n.dataset.column),i=e.generateHtml(r,o,"b-grid-footer-summary");(r.summaries?r.summaries.length:!!r.sum)&&(n.children.length?Lr.sync(i,n.firstElementChild):n.innerHTML=i)}))}onStoreChange({action:e,changes:t}){let n=!0;this.disabled||("update"===e&&(n=Object.keys(t).some((e=>{const t=this.grid.columns.get(e);return Boolean(t)&&(Boolean(t.sum)||Boolean(t.summaries))}))),n&&this.updateSummaries())}updateSelectedOnly(e){const t=this;t.detachListeners("selectionChange"),e&&t.grid.ion({name:"selectionChange",selectionChange:t.refresh,thisObj:t}),t.refresh()}refresh(){this.updateSummaries()}}cf.featureClass="b-summary",cf._$name="Summary",gd.registerFeature(cf);const df=Promise.resolve();class uf extends(di.mixin(ai)){static $name="Tree";static configurable={expandOnCellClick:!1,keyMap:{" ":"toggleCollapseByKey",ArrowRight:"expandIfSingleColumn","Shift+ArrowRight":"expandByKey",ArrowLeft:"collapseIfSingleColumn","Shift+ArrowLeft":"collapseByKey"}};static get pluginConfig(){return{assign:["collapseAll","expandAll","collapse","expand","expandTo","toggleCollapse"],chain:["onElementPointerUp","onElementClick","bindStore"]}}construct(e,t){super.construct(e,t),this.treeColumn||console.info("To use the tree feature, one column should be configured with `type: 'tree'`"),e.store&&this.bindStore(e.store)}doDisable(e){if(e)throw new Error("Tree feature cannot be disabled")}get store(){return this.client.store}get treeColumn(){const e=this,{columns:t}=e.client;return e._treeColumn&&t.includes(e._treeColumn)||(e._treeColumn=t.find((e=>e.isTreeColumn))),e._treeColumn}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeLoadChildren:"onBeforeLoadChildren",loadChildren:"onLoadChildren",loadChildrenException:"onLoadChildrenException",beforeToggleNode:"onBeforeToggleNode",thisObj:this})}async toggleCollapse(e,t){if(null==e)throw new Error("Tree#toggleCollapse must be passed a record");const n=this,{store:r,client:i}=n,{rowManager:o}=i,s=r.getById(e),l=s.instanceMeta(r);if(s.generation++,await r.toggleCollapse(s,t)){const e=o.getRowFor(s);if(e&&s.ancestorsExpanded()){const t=n.treeColumn&&!n.treeColumn.subGrid.collapsed&&e.getCell(n.treeColumn.id);t&&e.renderCell(t)}n.isTogglingNode||(i.element.classList.add("b-toggling-node"),n.isTogglingNode=!0,n.requestAnimationFrame((()=>{i.element.classList.remove("b-toggling-node"),n.isTogglingNode=!1}))),i.trigger(l.collapsed?"collapseNode":"expandNode",{record:s}),i.trigger("toggleNode",{record:s,collapse:l.collapsed})}}async collapse(e){return this.toggleCollapse(e,!0)}async expand(e){return this.toggleCollapse(e,!1)}onBeforeToggleNode({record:e,collapse:t}){this.client.trigger("beforeToggleNode",{record:e,collapse:t})}onBeforeLoadChildren({source:e,params:t}){const n=e.getById(t[e.modelClass.idField]),r=this.client.rowManager.getRowFor(n);null==r||r.addCls("b-loading-children")}onLoadChildren({source:e,params:t}){const n=e.getById(t[e.modelClass.idField]),r=this.client.rowManager.getRowFor(n);null==r||r.removeCls("b-loading-children")}onLoadChildrenException({record:e}){const t=this.client.rowManager.getRowFor(e);null==t||t.removeCls("b-loading-children")}async expandOrCollapseAll(e=!0,t=this.store.rootNode){const{client:n,store:r}=this,i=[],o=[];return n.trigger("beforeToggleAllNodes",{collapse:e}),r.suspendEvents(),r.traverse((t=>{const n=t.instanceMeta(r);t.isLeaf||(e&&!n.collapsed?(this.toggleCollapse(t,!0),o.push(...t.children)):!e&&n.collapsed&&(Array.isArray(t.children)&&o.push(...t.children),i.push(this.toggleCollapse(t,!1))))}),t,t===r.rootNode),r.resumeEvents(),(e?df:Promise.all(i)).then((()=>{n.refreshRows(e),o.length&&(e?r.trigger("remove",{records:o,isCollapse:!0,isCollapseAll:!0}):r.trigger("add",{records:o,isExpand:!0,isExpandAll:!0})),n.trigger("toggleAllNodes",{collapse:e})}))}async collapseAll(){return this.expandOrCollapseAll(!0)}async expandAll(){return this.expandOrCollapseAll(!1)}async expandTo(e,t=!0){const n=this,{store:r,client:i}=n;if(Array.isArray(e)){if(e.length>0){i.suspendRefresh();for(let t=e.length-1;t>=0;t--){var o;const l=r.getById(e[t]);var s;if(0===t)null===(s=i.resumeRefresh)||void 0===s||s.call(i),i.rowManager.refresh();await(null===(o=n.expandTo)||void 0===o?void 0:o.call(n,l,0===t))}}return}const l=r.getById(e);if(!1!==l.instanceMeta(n.store).hiddenByCollapse){if(!l.ancestorsExpanded()){var a,c;const e=[];for(let t=l.parent;t&&!t.isRoot;t=t.parent)t.isExpanded(r)||e.unshift(t);i.suspendRefresh();for(const t of e)n.isDestroyed||await n.toggleCollapse(t,!1);null===(a=i.resumeRefresh)||void 0===a||a.call(i),null===(c=i.refreshRows)||void 0===c||c.call(i)}!n.isDestroyed&&t&&await i.scrollRowIntoView(l)}}onElementPointerUp(e){const t=this,n=e.target,r=t.client.getCellDataFromEvent(e);(n.closest(".b-tree-expander")||t.expandOnCellClick&&null!=r&&r.record.isParent)&&t.toggleCollapse(r.record)}onElementClick(e){e.target.closest(".b-tree-expander")&&e.preventDefault()}toggleCollapseByKey(){const{focusedCell:e}=this.client;return(null==e?void 0:e.rowIndex)>-1&&!e.isActionable&&(this.toggleCollapse(e.id),!0)}expandIfSingleColumn(){return 1===this.client.columns.count&&this.expandByKey()}expandByKey(){const e=this,{client:t}=e,{focusedCell:n}=t,r=null==n?void 0:n.record;return!!(r&&null!=n&&n.column.tree&&r.isParent&&r.instanceMeta(t.store).collapsed)&&(e.expand(r),!0)}collapseIfSingleColumn(){return 1===this.client.columns.count&&this.collapseByKey()}collapseByKey(){const e=this,{client:t}=e,{focusedCell:n}=t,r=null==n?void 0:n.record;if(null!=n&&n.column.tree&&r){if(r.isParent&&!r.instanceMeta(t.store).collapsed)return e.collapse(r),!0;if(r.parent&&!r.parent.isRoot)return t.deselectAll(),t.focusCell({record:r.parent,column:n.column}),!0}return!1}}uf.featureClass="b-tree",uf._$name="Tree",gd.registerFeature(uf,!1,"Grid"),gd.registerFeature(uf,!0,"TreeGrid");class hf extends di{static $name="TreeGroup";static configurable={levels:[],parentCls:"b-generated-parent",parentRenderer:null,hideGroupedColumns:null,refreshGroupsTimeout:100};static pluginConfig={chain:["populateHeaderMenu"],assign:["group","clearGroups","refreshGroups"]};static properties={isApplying:0,originalStore:null};construct(e,t){if(this.treeColumn=e.columns.find((e=>e.isTreeColumn)),super.construct(e,t),this._levels=this._levels||[],!e.hasFeature("tree"))throw new Error("The TreeGroup feature requires the Tree feature to be enabled")}applyPluginConfig(){return this.scheduleRefreshGroups=Te.createBuffered(this.refreshGroups,this.refreshGroupsTimeout,this),super.applyPluginConfig(...arguments)}processParentData(e){const t=this;t.parentCls&&(e.cls=t.parentCls)}processTransformedData(e){}async waitForReadiness(){const e=this;if(e.originalStore.isLoading&&(await e.originalStore.await("load",!1),e.isDestroyed))return;const{crudManager:t}=this.client;if(t){var n;if((t.isLoadingOrSyncing||t._autoLoadPromise)&&await t.await("requestDone"),e.isDestroyed)return;await(null===(n=e.client.project)||void 0===n?void 0:n.commitAsync())}}async applyLevels(e){const t=this,{client:n,treeColumn:r}=t;let i,{store:o}=n,s=null;const{modelClass:l}=o;if(null!=r&&r.field&&l.getFieldDefinition(r.field)&&(i=l.getFieldDataSource(r.field)),0!==(e=e||[]).length||!this.isConfiguring){var a;if(t._levels=e,t.isApplying++,n.suspendRefresh(),!t.originalStore)t.originalStore=o,o=new o.constructor({reapplyFilterOnAdd:!0,reapplyFilterOnUpdate:!0,tree:!0,modelClass:o.modelClass,load:null===(a=o.load)||void 0===a?void 0:a.bind(o),commit:o.commit.bind(o),filter:o.filter.bind(o),clearFilters:o.clearFilters.bind(o)}),n.store=o,t.originalStore.ion({name:"originalStore",refresh:t.onOriginalStoreRefresh,add:t.onOriginalStoreChanged,remove:t.onOriginalStoreChanged,removeAll:t.onOriginalStoreChanged,thisObj:t});if(await t.waitForReadiness(),!t.isDestroyed){if(e.length>0){const n=t.originalStore.getAllDataRecords(!1).flatMap((e=>e.isLeaf?e.link():[]));n.forEach((e=>e.setInstanceMeta(o.id,{collapsed:!1}))),o.data=n,s=o.treeify(e,(e=>{i&&Yt.setPath(e,i,e.key),t.processParentData(e)})),t.processTransformedData(s),await t.trigger("beforeDataLoad",{store:o,data:s.children}),o.data=s.children}else n.store=t.originalStore,t.detachListeners("originalStore"),t.originalStore=null;t.isApplying--,n.resumeRefresh(),n.isPainted&&n.renderRows(!1),n.trigger("treeGroupChange",{levels:e})}}}doDisable(e){e&&this.clearGroups(),super.doDisable(e)}onOriginalStoreChanged(){this.scheduleRefreshGroups()}onOriginalStoreRefresh({action:e}){"dataset"!==e&&"filter"!==e||this.scheduleRefreshGroups()}updateLevels(e,t){const n=this,{client:r}=n;n.hideGroupedColumns&&(null==t||t.forEach((t=>{t=t.fieldName||t,e.some((e=>(e.fieldName||e)===t))||r.columns.get(t).show()})),null==e||e.forEach((e=>{e=e.fieldName||e,t&&t.some((t=>t.fieldName===e))||(r._suspendRenderContentsOnColumnsChanged=!0,r.columns.get(e).hide(),r._suspendRenderContentsOnColumnsChanged=!1)}))),!e&&n.isConfiguring||(n.updatePromise=n.applyLevels(e),r.renderContents())}async group(e){Yt.assertArray(e,"group()"),await this.applyLevels(e)}async clearGroups(){this.isGrouped&&(this.levels=[],await this.updatePromise)}refreshGroups(){var e;return null===(e=this.applyLevels)||void 0===e?void 0:e.call(this,this._levels)}get isGrouped(){return this._levels.length>0}populateHeaderMenu({column:e,items:t}){const n=this;let r=!1;!1!==e.groupable&&!e.isTreeColumn&&!n.isGroupedByField(e.field)&&(t.groupAsc={text:"L{group}",localeClass:n,icon:"b-fw-icon b-icon-group-asc",separator:!0,weight:400,disabled:n.disabled,onItem:()=>n.addGrouper(e)},r=!0),n.isGrouped&&(n.isGroupedByField(e.field)&&(t.groupRemove={text:"L{stopGroupingThisColumn}",localeClass:n,icon:"b-fw-icon b-icon-clear",separator:!r,weight:420,disabled:n.disabled,onItem:()=>n.removeGrouper(e)},r=!0),t.groupRemoveAll={text:"L{stopGrouping}",localeClass:n,icon:"b-fw-icon b-icon-clear",separator:!r,weight:420,disabled:n.disabled,onItem:()=>n.clearGroups()})}addGrouper(e){this.levels=this.levels.concat(e.field)}isGroupedByField(e){return this.levels.find((t=>t.fieldName===e))}removeGrouper(e){this.levels.splice(this.levels.findIndex((t=>t.fieldName===e.field)),1),this.levels=this.levels.slice()}}hf._$name="TreeGroup",gd.registerFeature(hf);const gf={all:"all",visible:"visible"},pf={A6:{width:4.11,height:5.81},A5:{width:5.81,height:8.25},A4:{width:8.25,height:11.69},A3:{width:11.69,height:16.49},Legal:{width:8.5,height:14},Letter:{width:8.5,height:11}},mf={portrait:"portrait",landscape:"landscape"},ff={pdf:"pdf",png:"png"},vf={pdf:"application/pdf",png:"image/png"};class bf extends yc{static get $name(){return"ExportRowsCombo"}static get type(){return"exportrowscombo"}static get defaultConfig(){return{editable:!1}}buildItems(){return[{id:gf.all,text:this.L("L{all}")},{id:gf.visible,text:this.L("L{visible}")}]}}bf.initClass(),bf._$name="ExportRowsCombo";class yf extends yc{static get $name(){return"ExportOrientationCombo"}static get type(){return"exportorientationcombo"}static get defaultConfig(){return{editable:!1}}buildItems(){return[{id:mf.portrait,text:this.L("L{portrait}")},{id:mf.landscape,text:this.L("L{landscape}")}]}}function Cf(e,t=(e=>e)){return Object.keys(e).map((e=>({id:e,text:t(e)})))}yf.initClass(),yf._$name="ExportOrientationCombo";class wf extends Xa{static get $name(){return"ExportDialog"}static get type(){return"exportdialog"}static get configurable(){return{autoShow:!1,autoClose:!1,closable:!0,centered:!0,client:null,autoSelectVisibleColumns:!0,hidePNGMultipageOption:!0,title:"L{exportSettings}",maxHeight:"80%",scrollable:{overflowY:!0},defaults:{localeClass:this},items:{columnsField:{type:"combo",label:"L{ExportDialog.columns}",store:{},valueField:"id",displayField:"text",multiSelect:!0,weight:100,maxHeight:100},rowsRangeField:{type:"exportrowscombo",label:"L{ExportDialog.rows}",value:"all",weight:200},exporterTypeField:{type:"combo",label:"L{ExportDialog.exporterType}",editable:!1,value:"singlepage",displayField:"text",buildItems(){const e=this.parent;return e.exporters.map((t=>({id:t.type,text:e.optionalL(t.title,this)})))},onChange({value:e}){this.owner.widgetMap.alignRowsField.hidden="singlepage"===e,this.owner.widgetMap.repeatHeaderField.hidden="multipagevertical"!==e},weight:300},alignRowsField:{type:"checkbox",label:"L{ExportDialog.alignRows}",checked:!1,hidden:!0,weight:400},repeatHeaderField:{type:"checkbox",label:"L{ExportDialog.repeatHeader}",localeClass:this,hidden:!0,weight:500},fileFormatField:{type:"combo",label:"L{ExportDialog.fileFormat}",localeClass:this,editable:!1,value:"pdf",items:[],onChange({value:e,oldValue:t}){const n=this.parent;if(n.hidePNGMultipageOption){const r=n.widgetMap.exporterTypeField,i=r.store.find((e=>"singlepage"===e.id));e===ff.png&&i?(this._previousDisabled=r.disabled,r.disabled=!0,this._previousValue=r.value,r.value="singlepage"):t===ff.png&&this._previousValue&&(r.disabled=this._previousDisabled,r.value=this._previousValue)}},weight:600},paperFormatField:{type:"combo",label:"L{ExportDialog.paperFormat}",editable:!1,value:"A4",items:[],weight:700},orientationField:{type:"exportorientationcombo",label:"L{ExportDialog.orientation}",value:"portrait",weight:800}},bbar:{defaults:{localeClass:this},items:{exportButton:{color:"b-green",text:"L{ExportDialog.export}",weight:100,onClick:"up.onExportClick"},cancelButton:{color:"b-gray",text:"L{ExportDialog.cancel}",weight:200,onClick:"up.onCancelClick"}}}}}construct(e={}){const t=this,{client:n}=e;if(!n)throw new Error("`client` config is required");t.columnsStore=n.columns.chain((e=>e.isLeaf&&e.exportable),null,{excludeCollapsedRecords:!1}),t.applyInitialValues(e),super.construct(e),Ye.ion({locale:"onLocaleChange",prio:-1,thisObj:t})}applyInitialValues(e){const t=this,n=e.items=e.items||{};e.width=e.width||t.L("L{width}"),e.defaults=e.defaults||{},e.defaults.labelWidth=e.defaults.labelWidth||t.L("L{ExportDialog.labelWidth}"),n.columnsField=n.columnsField||{},n.fileFormatField=n.fileFormatField||{},n.paperFormatField=n.paperFormatField||{},n.fileFormatField.items=Cf(ff,(e=>e.toUpperCase())),n.paperFormatField.items=Cf(pf),n.columnsField.store=t.columnsStore}onBeforeShow(){var e;const{columnsField:t,alignRowsField:n,exporterTypeField:r,repeatHeaderField:i}=this.widgetMap;this.autoSelectVisibleColumns&&(t.value=this.columnsStore.query((e=>!e.hidden))),n.hidden="singlepage"===r.value,i.hidden="multipagevertical"!==r.value,null===(e=super.onBeforeShow)||void 0===e||e.call(this,...arguments)}onLocaleChange(){const e=this.L("L{labelWidth}");this.width=this.L("L{width}"),this.eachWidget((t=>{t instanceof lc&&(t.labelWidth=e)}))}onExportClick(){const e=this.values;this.trigger("export",{values:e})}onCancelClick(){this.trigger("cancel"),this.hide()}get values(){const e=/field/i,t={};return this.eachWidget((n=>{e.test(n.ref)&&(t[n.ref.replace(e,"")]=n instanceof Vg?n.checked:n.value)})),t}}wf.initClass(),wf._$name="ExportDialog";class xf extends(ai(je(et(fe)))){static get defaultConfig(){return{translateURLsToAbsolute:!0,keepPathName:!0,filterStyles:e=>e}}pageTpl(e){const{title:t,header:n,footer:r,styles:i,htmlClasses:o,bodyStyle:l,bodyClasses:a=[],paperHeight:c,paperWidth:d,html:u}=e;return a.push(`b-${this.constructor.type}`),Lr.scrollBarWidth?a.push("b-visible-scrollbar"):a.push("b-overlay-scrollbar"),s.isChrome?a.push("b-chrome"):s.isSafari?a.push("b-safari"):s.isFirefox&&a.push("b-firefox"),hc.tpl`
            <!DOCTYPE html>
            <html class="${o}" style="width: ${d}in; height: ${c}in;">
                <head>
                    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
                    <title>${t}</title>
                    ${i.join("")}
                </head>
                <body class="b-export ${a.join(" ")}" style="width: ${d}in; height: ${c}in; ${l}">
                    <div class="b-export-content">
                        ${n&&`<div class="b-export-header" style="width: 100%">${n}</div>`}
                        <div class="b-export-body"><div class="b-export-viewport">${u}</div></div>
                        ${r&&`<div class="b-export-footer" style="width: 100%">${r}</div>`}
                    </div>
                </body>
            </html>`}get stylesheets(){const e=this;if(e._stylesheets)return e._stylesheets;const t=e.translateURLsToAbsolute,n=r.origin,i=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),o=[];return i.forEach((r=>{if(r=r.cloneNode(!0),t&&r.href){let e;e=!0===t?r.href:this.keepPathName?r.href.replace(n,t):new URL(r.getAttribute("href"),t),r.setAttribute("href",e)}let i=r.outerHTML;if(t&&/style/i.test(r.tagName)){const n=e.getStyleTagURLConverter(t);i=i.replace(/url\(['"]?(.+?)['"]?\)/g,n)}o.push(i)})),o.push("<style>\n                body, html {\n                    overflow: auto;\n                }\n                body {\n                    position: relative;\n                    margin: 0;\n                }\n            </style>"),e._stylesheets=e.filterStyles(o)}set stylesheets(e){this._stylesheets=e?this.filterStyles(e):e}getStyleTagURLConverter(e){return function(t,n){let i;try{let o;/^#/.test(n)?i=t:(o=!0===e?r.location.href:this.keepPathName?r.location.href.replace(r.location.origin,e):e,i=`url('${new URL(n,o).href}')`)}catch(e){i=t}return i}.bind(this)}saveState({client:e}){this.state=e.state}async restoreState({client:e}){const t=[],n=new Set;n.add(e.scrollable.ion({scroll(){t.push(e.scrollable.await("scrollEnd"))}})),e.eachSubGrid((({header:e,scrollable:r})=>{n.add(r.ion({scroll(){t.push(r.await("scrollEnd"))}})),n.add(e.scrollable.ion({scroll(){t.push(e.scrollable.await("scrollEnd"))}}))})),e.state=this.state,await Promise.all(t),n.forEach((e=>e()))}beforeExport(){this.element=document.createElement("div")}cloneElement(e,t=this.element,n=!0){n&&(t.innerHTML=""),t.appendChild(e.cloneNode(!0)),Lr.removeEachSelector(t,".b-grid-row,.b-grid-merged-cells-container");const r=t.querySelector(".b-gridbase > .b-mask");r&&r.remove()}createPlaceholder(e,t=!0,n={}){return t&&(e.innerHTML=""),Lr.createElement(Object.assign({parent:e,id:ho.generateId("export")},n))}prepareElement({client:e}){const{tbar:t,bbar:n}=e;t&&this.element.querySelector(`#${t.id}`).remove(),n&&this.element.querySelector(`#${n.id}`).remove()}measureElement(e=""){e instanceof HTMLElement&&(e=e.outerHTML);const t=Lr.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:`<div style="height: 1px"></div>${e}<div style="height: 1px"></div>`}),n=t.offsetHeight-2;return t.remove(),n}prepareHTML(e){e instanceof HTMLElement&&(e=e.outerHTML);const t=Lr.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:e}),n=t.querySelectorAll("img");for(let e=0,t=n.length;e<t;e++)n[e].setAttribute("src",n[e].src);const r=t.innerHTML;return t.remove(),r}getVirtualScrollerHeight(e){let t=0;return e.eachSubGrid((e=>{e.overflowingHorizontally&&(t=Lr.scrollBarWidth)})),0===t?t:t+1}inchToPx(e){return 96*e}getScaleValue(e,t){return Math.floor(1e4*e/t)/1e4}getVisibleRowsCount(e){const t=e.rowManager,n=t.rows.indexOf(t.firstVisibleRow),r=t.rows.indexOf(t.lastVisibleRow);let i;return i=-1!==n?-1===r?e.store.count-n:r-n+1:e.store.count,i}async export(e){const t=this;let n;t.beforeExport(),t.saveState(e),await t.prepareComponent(e);try{n=await t.getPages(e)}finally{await t.restoreComponent(e),t.stylesheets=null,await new Promise((e=>t.requestAnimationFrame(e))),await t.restoreState(e)}return n}async getPages(e){const t=this.pagesExtractor(e),n=[];let r;for(;(r=await t.next())&&!r.done;)n.push(r.value);return n}adjustRowBuffer(e){const{contentHeight:t}=this.exportMeta,{rowManager:n}=e;this.oldRowManagerConfig={prependRowBuffer:n.prependRowBuffer,appendRowBuffer:n.appendRowBuffer};const r=Math.ceil(t/n.rowOffsetHeight);n.prependRowBuffer=r,n.appendRowBuffer=r,e.renderRows(),e.rowManager.jumpToPosition(e.scrollable.y)}restoreRowBuffer(e){e.rowManager.prependRowBuffer=this.oldRowManagerConfig.prependRowBuffer,e.rowManager.appendRowBuffer=this.oldRowManagerConfig.appendRowBuffer}async prepareComponent(e){const t=this,{client:n,columns:r,rowsRange:i,keepRegionSizes:o,enableDirectRendering:s}=e,{rowManager:l}=n,a=t.exportMeta={enableDirectRendering:s,totalWidth:0,totalHeight:0-(s?0:t.getVirtualScrollerHeight(n)),subGrids:{}};n.columns.forEach((e=>{r.includes(e.id)?e.show():e.hide()})),await new Promise((e=>n.requestAnimationFrame(e))),n.rowManager.rowCount>0&&(i===gf.all?a.firstVisibleDataIndex=l.rows[0].dataIndex:(a.firstVisibleDataIndex=l.firstVisibleRow.dataIndex,e.alignRows=!0),s||await n.scrollRowIntoView(n.store.getAt(a.firstVisibleDataIndex),{block:"start"}));const{element:c}=t;let d;t.cloneElement(n.element),t.prepareElement(e),s&&(a.fakeRow=d=n.rowManager.rowClass.new({cls:n.rowCls,rowManager:n.rowManager,grid:n,index:-10,dataIndex:-10})),n.eachSubGrid((e=>{var r,i,s;d&&(e.onAddRow({rows:[d],isExport:!0}),d.element.dataset.ownerCmp=n.id);const l=t.createPlaceholder(c.querySelector(`[id="${e.id}"]`),!1);let u;u=null!=o&&o[e.region]?e.element.offsetWidth:e.columns.visibleColumns.reduce(((e,t)=>("number"==typeof t.width?e+=t.width:e+=(n.hideHeaders?n.rowManager.rows[0].getCell(t.id):t.element).offsetWidth,e)),0),a.totalWidth+=u;const h=(null===(r=e.splitterElement)||void 0===r?void 0:r.offsetWidth)||0;a.totalWidth+=h,a.subGrids[e.region]={id:e.id,headerId:(null===(i=e.header)||void 0===i?void 0:i.id)||null,footerId:(null===(s=e.footer)||void 0===s?void 0:s.id)||null,rows:[],splitterWidth:h,placeHolder:l,width:u}}))}prepareExportElement(){const{element:e,exportMeta:t}=this;return Object.values(t.subGrids).forEach((({width:t,id:n,headerId:r,footerId:i})=>{[n,r,i].forEach((n=>{if(n){const r=e.querySelector(`[id="${n}"]`);r&&(r.style.width=`${t}px`,r.style.flex="")}}))})),e.innerHTML}async restoreComponent(e){this.exportMeta.fakeRow&&(this.exportMeta.fakeRow.destroy(),delete this.exportMeta.fakeRow)}async scrollRowIntoView(e,t){await e.scrollRowIntoView(e.store.getAt(t),{block:"start"}),await new Promise((e=>this.requestAnimationFrame(e)))}collectRow(e){const t=this.exportMeta.subGrids,n=/data-owner-cmp=".+?"/;Object.entries(e.elements).forEach((([r,i])=>{t[r].rows.push([i.outerHTML.replace(n,""),e.top,e.offsetHeight,new Map])}))}renderMergedCells(e,t,n,r){const{client:i}=e,{subGrids:o}=this.exportMeta,s=i.features.mergeCells.buildMergedCellsConfig(t,n,r);for(const e in o){const t=o[e],n=document.createElement("div");Cs.sync({targetElement:n,domConfig:{children:s[e].children}}),n.childNodes.length&&(n.childNodes.forEach((e=>{const{syncId:t}=e.dataset,n=i.features.mergeCells.mergedRanges.find((e=>{var n;return(null===(n=e.cellElement)||void 0===n?void 0:n.parentNode.dataset.syncId)===t}));n&&(e.innerHTML=n.cellElement.outerHTML)})),t.mergedCellsHtml=[n.innerHTML])}}}xf.prototype.pagesExtractor=async function*(){throw new Error("Implement this method in a subclass")},xf._$name="Exporter";class Sf extends xf{static get $name(){return"MultiPageExporter"}static get type(){return"multipage"}static get title(){return this.L("L{multipage}")}static get exportingPageText(){return"L{exportingPage}"}async stateNextPage({client:e,rowsRange:t,enableDirectRendering:n}){const{exportMeta:r}=this;++r.currentPage,++r.verticalPosition,delete r.lastExportedRowBottom,r.verticalPosition>=r.verticalPages&&(Object.assign(r,{verticalPosition:0,horizontalPosition:r.horizontalPosition+1,currentPageTopMargin:0,lastTop:0,lastRowIndex:t===gf.visible?e.rowManager.firstVisibleRow.dataIndex:0}),delete r.lastRowDataIndex,n||await this.scrollRowIntoView(e,r.firstVisibleDataIndex,{block:"start"}))}async prepareComponent(e){await super.prepareComponent(e);const t=this,{exportMeta:n}=t,{client:r,headerTpl:i,footerTpl:o,alignRows:s,rowsRange:l,enableDirectRendering:a}=e,c=pf[e.paperFormat],d=e.orientation===mf.portrait,u=d?c.width:c.height,h=d?c.height:c.width,g=t.inchToPx(u),p=t.inchToPx(h),m=l===gf.visible,f=Math.ceil(n.totalWidth/g);let v=p;i&&(v-=t.measureElement(i({totalWidth:n.totalWidth,totalPages:-1,currentPage:-1}))),o&&(v-=t.measureElement(o({totalWidth:n.totalWidth,totalPages:-1,currentPage:-1})));let b,y,C=r.store.count;if(m?(C=t.getVisibleRowsCount(r),b=n.totalHeight+r.headerHeight+r.footerHeight+r.bodyHeight):b=n.totalHeight+r.headerHeight+r.footerHeight+r.scrollable.scrollHeight,s&&!m){const e=r.rowManager.rowOffsetHeight,t=Math.floor((v-r.headerHeight)/e),n=Math.floor(v/e),i=C-t;y=1+Math.ceil(i/n)}else y=Math.ceil(b/v);Object.assign(n,{paperWidth:u,paperHeight:h,pageWidth:g,pageHeight:p,horizontalPages:f,verticalPages:y,totalHeight:b,contentHeight:v,totalRows:C,totalPages:f*y,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0,lastTop:0,lastRowIndex:m?r.rowManager.firstVisibleRow.dataIndex:0}),a||this.adjustRowBuffer(r)}async restoreComponent(e){await super.restoreComponent(e),e.enableDirectRendering||this.restoreRowBuffer(e.client)}async collectRows(e){const t=this,{exportMeta:n}=t,{client:r,alignRows:i,rowsRange:o}=e,{subGrids:s,currentPageTopMargin:l,verticalPosition:a,contentHeight:c,totalRows:d,lastRowDataIndex:u}=n,{rowManager:h}=r,{rows:g}=h,p=o===gf.visible,m=r.hasActiveFeature("mergeCells");let f,v;v=p&&null!=u?u===g[g.length-1].dataIndex?g.length-1:g.findIndex((e=>e.dataIndex===u)):p?g.findIndex((e=>e.bottom>Math.ceil(r.scrollable.y))):g.findIndex((e=>e.bottom+l+r.headerHeight>0));const b=v;f=c-(p||0===a?0:g[v].top+l+r.headerHeight),0===a&&(f-=r.headerHeight);let y,C=0;for(;f>0;){const e=g[v];i&&f<e.offsetHeight?(C=-f,f=0,t.exportMeta.lastExportedRowBottom=g[v-1].bottom):(t.collectRow(e),f-=e.offsetHeight,y=e.dataIndex,(++v===g.length&&f>0||p&&v-b===d)&&(f=0))}if(m)for(const e in s){const t=s[e],n=r.subGrids[e].element.querySelectorAll(".b-grid-merged-cells");t.mergedCellsHtml=[];for(const e of n)t.mergedCellsHtml.push(e.outerHTML)}const w=g[v-1];if(w&&(n.exactGridHeight=w.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight,n.lastRowDataIndex=w.dataIndex+1),await t.onRowsCollected(g.slice(b,v),e),p)n.exactGridHeight-=n.scrollableTopMargin=r.scrollable.y;else{const e=h.ion({offsetRows:({offset:e})=>C+=e});await t.scrollRowIntoView(r,y+1),e()}return C}async renderRows(e){const t=this,{exportMeta:n}=t,{client:r,alignRows:i,rowsRange:o}=e,{currentPageTopMargin:s,verticalPosition:l,contentHeight:a,totalRows:c,lastRowIndex:d,fakeRow:u}=n,{store:h}=r,g=r.hasActiveFeature("mergeCells"),p=o===gf.visible;let m,f=d,{lastTop:v}=n;const b=f,y=[];m=a-(p||0===l?0:v+s+r.headerHeight),0===l&&(m-=r.headerHeight);let C,w,x=0;for(;m>0;)u.render(f,h.getAt(f),!0,!1,!0),i&&m<u.offsetHeight?(x=-m,m=0,t.exportMeta.lastExportedRowBottom=v):(w=v,C=f,v=u.translate(v),m-=u.offsetHeight,t.collectRow(u),y.push({top:u.top,bottom:u.bottom,offsetHeight:u.offsetHeight,dataIndex:u.dataIndex}),(++f===h.count&&m>0||p&&f-b===c)&&(m=0));return g&&t.renderMergedCells(e,b,f,y),n.lastRowIndex=i?f:C,n.lastTop=i?v:w,u&&(n.exactGridHeight=u.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight),await t.onRowsCollected(y,e),x}async buildPage(e){const t=this,{exportMeta:n}=t,{client:r,headerTpl:i,footerTpl:o,enableDirectRendering:s}=e,{totalWidth:l,totalPages:a,currentPage:c,subGrids:d}=n;let u,h,g;Object.values(d).forEach((e=>e.rows=[])),e.rowsRange===gf.all&&(n.totalHeight=r.height-r.bodyHeight+r.scrollable.scrollHeight-t.getVirtualScrollerHeight(r)),i&&(u=t.prepareHTML(i({totalWidth:l,totalPages:a,currentPage:c}))),o&&(h=t.prepareHTML(o({totalWidth:l,totalPages:a,currentPage:c}))),g=s?await t.renderRows(e):await t.collectRows(e);return{html:t.buildPageHtml(e),header:u,footer:h,offset:g}}async onRowsCollected(){}buildPageHtml(){const{subGrids:e}=this.exportMeta;let t=this.prepareExportElement();return Object.values(e).forEach((({placeHolder:e,rows:n,mergedCellsHtml:r})=>{const i=e.outerHTML;let o=n.reduce(((e,t)=>e+=t[0]),"");null!=r&&r.length&&(o+=`<div class="b-grid-merged-cells-container">${r.join("")}</div>`),t=t.replace(i,o)})),t}prepareExportElement(){const{element:e,exportMeta:t}=this;return t.scrollableTopMargin&&(e.querySelector(".b-grid-vertical-scroller").style.marginTop=`-${t.scrollableTopMargin}px`),super.prepareExportElement()}}Sf.prototype.pagesExtractor=async function*(e){const t=this,{exportMeta:n,stylesheets:r}=t,{totalWidth:i,totalPages:o,paperWidth:s,paperHeight:l,contentHeight:a}=n;let c;for(;(c=n.currentPage)<o;){t.trigger("exportStep",{text:t.L(Sf.exportingPageText,{currentPage:c,totalPages:o}),progress:Math.round((c+1)/o*90)});const{html:d,header:u,footer:h,offset:g}=await t.buildPage(e),p=[...r,`\n                <style>\n                    #${e.client.id} {\n                        height: ${n.exactGridHeight}px !important;\n                        width: ${i}px !important;\n                    }\n                    .b-export-body .b-export-viewport {\n                        margin-inline-start : ${-s*n.horizontalPosition}in;\n                        margin-top  : ${n.currentPageTopMargin}px;\n                    }\n                </style>\n            `];n.currentPageTopMargin-=a+g,await t.stateNextPage(e),yield{html:t.pageTpl({html:d,header:u,footer:h,styles:p,paperWidth:s,paperHeight:l})}}},Sf._$name="MultiPageExporter";class Ef extends xf{static get $name(){return"MultiPageVerticalExporter"}static get type(){return"multipagevertical"}static get title(){return this.L("L{multipagevertical}")}static get exportingPageText(){return"L{exportingPage}"}async stateNextPage({client:e}){const{exportMeta:t}=this,{totalRows:n,processedRows:r,totalPages:i}=t;++t.currentPage,++t.verticalPosition,t.currentPage===i&&r.size!==n&&(++t.totalPages,++t.verticalPages)}estimateTotalPages(e){const t=this,{exportMeta:n}=t,{client:r,headerTpl:i,footerTpl:o,alignRows:s,rowsRange:l,repeatHeader:a,enableDirectRendering:c}=e,{pageWidth:d,pageHeight:u,totalWidth:h}=n,g=t.getScaleValue(d,h);let p,m=0-t.getVirtualScrollerHeight(r)+r.height-r.bodyElement.offsetHeight+r.scrollable.scrollHeight,f=u/g,v=r.store.count,b=0,y=m;if(i&&(f-=t.measureElement(i({totalWidth:h,totalPages:-1,currentPage:-1}))),o&&(f-=t.measureElement(o({totalWidth:h,totalPages:-1,currentPage:-1}))),a&&(f-=r.headerHeight+r.footerHeight,m-=r.headerHeight+r.footerHeight),l===gf.visible){const e=r.rowManager,i=e.firstVisibleRow,o=e.lastVisibleRow;c||(b=i.top),v=t.getVisibleRowsCount(r),c?(m=r.headerHeight+r.footerHeight+o.bottom-i.top,y=o.bottom-i.top):y=m=m-r.scrollable.scrollHeight+o.bottom-i.top,n.lastRowIndex=i.dataIndex,n.finishRowIndex=o.dataIndex}else n.finishRowIndex=r.store.count-1;if(s&&!a&&l!==gf.visible){const e=r.rowManager.rowOffsetHeight,t=Math.floor((f-r.headerHeight)/e),n=Math.floor(f/e),i=v-t;p=1+Math.ceil(i/n)}else p=Math.ceil(y/f);Object.assign(n,{scale:g,contentHeight:f,totalRows:v,totalHeight:m,verticalPages:p,initialScroll:b,horizontalPages:1,totalPages:p})}async prepareComponent(e){await super.prepareComponent(e);const t=this,{exportMeta:n}=t,{client:r}=e,i=pf[e.paperFormat],o=e.orientation===mf.portrait,s=o?i.width:i.height,l=o?i.height:i.width,a=t.inchToPx(s),c=t.inchToPx(l);Object.assign(n,{paperWidth:s,paperHeight:l,pageWidth:a,pageHeight:c,horizontalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0,lastTop:0,lastRowIndex:0,processedRows:new Set}),t.estimateTotalPages(e),e.enableDirectRendering||t.adjustRowBuffer(r)}async restoreComponent(e){await super.restoreComponent(e),e.enableDirectRendering||this.restoreRowBuffer(e.client)}async collectRows(e){const t=this,{exportMeta:n}=t,{client:r,alignRows:i,repeatHeader:o}=e,{subGrids:s,currentPageTopMargin:l,verticalPosition:a,totalRows:c,contentHeight:d}=n,u=o?0:r.headerHeight,{rowManager:h}=r,{rows:g}=h,p=e.rowsRange===gf.visible,m=r.hasActiveFeature("mergeCells");let f,v=p?g.findIndex((e=>e.bottom>r.scrollable.y)):g.findIndex((e=>e.bottom+l+u>0));const b=v;f=d-(0===a?0:g[v].top+l+u),0===a&&(f-=u);let y,C=0;for(;f>0;){const e=g[v];i&&f<e.offsetHeight?(C=-f,f=0):(t.collectRow(e),f-=e.offsetHeight,f>0&&n.processedRows.add(e.dataIndex),y=e.dataIndex,(++v===g.length&&f>0||p&&v-b===c)&&(f=0))}if(m)for(const e in s){const t=s[e],n=r.subGrids[e].element.querySelectorAll(".b-grid-merged-cells");t.mergedCellsHtml=[];for(const e of n)t.mergedCellsHtml.push(e.outerHTML)}const w=g[v-1];if(w&&(n.exactGridHeight=w.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight),await t.onRowsCollected(g.slice(b,v),e),p)n.scrollableTopMargin=r.scrollable.y;else{const e=h.ion({offsetRows:({offset:e})=>C+=e});await t.scrollRowIntoView(r,y+1),e()}return C}async renderRows(e){const t=this,{exportMeta:n}=t,{client:r,alignRows:i,repeatHeader:o}=e,{currentPageTopMargin:s,verticalPosition:l,totalRows:a,contentHeight:c,lastRowIndex:d,finishRowIndex:u,fakeRow:h}=n,g=o?0:r.headerHeight,{store:p}=r,m=r.hasActiveFeature("mergeCells"),f=e.rowsRange===gf.visible;let v,b=d,{lastTop:y}=n;const C=b,w=[];v=c-(0===l?0:y+s+g),0===l&&(v-=g);let x,S,E=0;for(;v>0;)h.render(b,p.getAt(b),!0,!1,!0),i&&v<h.offsetHeight?(E=-v,v=0):(S=y,x=b,y=h.translate(y),v-=h.offsetHeight,t.collectRow(h),w.push({top:h.top,bottom:h.bottom,offsetHeight:h.offsetHeight,dataIndex:h.dataIndex}),v>0&&n.processedRows.add(b),(b===u||++b-C===a&&f)&&(v=0));return m&&t.renderMergedCells(e,C,b,w),n.lastRowIndex=x,n.lastTop=S,h&&(n.exactGridHeight=h.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight),await t.onRowsCollected(w,e),E}async buildPage(e){const t=this,{exportMeta:n}=t,{client:r,headerTpl:i,footerTpl:o,enableDirectRendering:s}=e,{totalWidth:l,totalPages:a,currentPage:c,subGrids:d}=n;let u,h,g;Object.values(d).forEach((e=>e.rows=[])),e.rowsRange===gf.all&&(n.totalHeight=r.headerHeight+r.footerHeight+r.scrollable.scrollHeight,s||(n.totalHeight-=t.getVirtualScrollerHeight(r))),i&&(u=t.prepareHTML(i({totalWidth:l,totalPages:a,currentPage:c}))),o&&(h=t.prepareHTML(o({totalWidth:l,totalPages:a,currentPage:c}))),g=s?await t.renderRows(e):await t.collectRows(e);return{html:t.buildPageHtml(e),header:u,footer:h,offset:g}}async onRowsCollected(){}buildPageHtml(){const{subGrids:e}=this.exportMeta;let t=this.prepareExportElement();return Object.values(e).forEach((({placeHolder:e,rows:n,mergedCellsHtml:r})=>{const i=e.outerHTML;let o=n.reduce(((e,t)=>e+=t[0]),"");null!=r&&r.length&&(o+=`<div class="b-grid-merged-cells-container">${r.join("")}</div>`),t=t.replace(i,o)})),t}}Ef.prototype.pagesExtractor=async function*(e){const t=this,{exportMeta:n,stylesheets:r}=t,{totalWidth:i,paperWidth:o,paperHeight:s,contentHeight:l,scale:a,initialScroll:c}=n;let d,{totalPages:u}=n;for(;(d=n.currentPage)<u;){t.trigger("exportStep",{text:t.L(Ef.exportingPageText,{currentPage:d,totalPages:u}),progress:Math.round((d+1)/u*90)});const{html:h,header:g,footer:p,offset:m}=await t.buildPage(e),f=[...r,`\n                <style>\n                    #${e.client.id} {\n                        width: ${i}px !important;\n                    }\n                    .b-export .b-export-content {\n                        transform: scale(${a});\n                        transform-origin: top left;\n                        height: auto;\n                    }\n                </style>\n            `];if(e.repeatHeader){const t=n.exactGridHeight?`${n.exactGridHeight+n.currentPageTopMargin}px`:"100%";f.push(`\n                <style>\n                    #${e.client.id} {\n                        height: ${t} !important;\n                    }\n                    .b-export .b-export-content {\n                        height: ${100/a}%;\n                    }\n                    .b-export-body {\n                        height: 100%;\n                        display: flex;\n                    }\n                    .b-export-viewport {\n                        height: 100%;\n                    }\n                    .b-grid-vertical-scroller {\n                        margin-top: ${n.currentPageTopMargin-c}px;\n                    }\n                </style>\n                `)}else{const t=n.exactGridHeight||l-n.currentPageTopMargin;f.push(`\n                <style>\n                    #${e.client.id} {\n                        height: ${t}px !important;\n                    }\n                    .b-export-body {\n                        overflow: hidden;\n                    }\n                    .b-export .b-export-content {\n                        height: ${100/a}%;\n                    }\n                    .b-export-body .b-export-viewport {\n                        margin-top: ${n.currentPageTopMargin}px;\n                    }\n                    .b-grid-vertical-scroller {\n                        margin-top: -${c}px;\n                    }\n                </style>\n                `)}n.currentPageTopMargin-=l+m,await t.stateNextPage(e),({totalPages:u}=n),yield{html:t.pageTpl({html:h,header:g,footer:p,styles:f,paperWidth:o,paperHeight:s})}}},Ef._$name="MultiPageVerticalExporter";class Rf extends xf{static get $name(){return"SinglePageExporter"}static get type(){return"singlepage"}static get title(){return this.localize("L{singlepage}")}static get defaultConfig(){return{centerContentHorizontally:!1}}async prepareComponent(e){await super.prepareComponent(e),Object.assign(this.exportMeta,{verticalPages:1,horizontalPages:1,totalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0})}async onRowsCollected(){}positionRows(e,t){if(t.enableDirectRendering)return e.map((e=>e[0]));{let t=0;return e.map((([e,,n])=>{const r=e.replace(/translate\(\d+px, \d+px\)/,`translate(0px, ${t}px)`);return t+=n,r}))}}async collectRows(e){const t=this,{client:n}=e,{rowManager:r,store:i}=n,o=n.hasActiveFeature("mergeCells"),{subGrids:s}=t.exportMeta,l=e.rowsRange===gf.visible&&i.count?t.getVisibleRowsCount(n):i.count;let{totalHeight:a}=t.exportMeta,c=0,d=-1;if(r.rows.length>0){if(e.rowsRange===gf.visible&&(d=r.firstVisibleRow.dataIndex-1),o)for(const e of Object.values(s))e.mergedCellsHtml=[];for(;c<l;){const i=r.rows,u=i[i.length-1],h=c;if(i.forEach((e=>{e.dataIndex>d&&c<l&&(++c,a+=e.offsetHeight,t.collectRow(e))})),o)for(const e in s){const t=s[e],r=n.subGrids[e].element.querySelectorAll(".b-grid-merged-cells");for(const e of r)t.mergedCellsHtml.push(e.outerHTML)}const g=i.findIndex((e=>e.dataIndex===d+1)),p=g+(c-h);await t.onRowsCollected(i.slice(g,p),e),c<l&&(d=u.dataIndex,await t.scrollRowIntoView(n,d+1))}}return a}async renderRows(e){const t=this,{client:n,rowsRange:r}=e,{rowManager:i,store:o}=n,s=n.hasActiveFeature("mergeCells"),l=r===gf.visible;let{totalHeight:a}=t.exportMeta;if(o.count){const{fakeRow:n}=t.exportMeta,{firstVisibleRow:r}=i,c=l?r.dataIndex:0,d=l?i.lastVisibleRow.dataIndex:o.count-1,u=[];let h=0;if(n.cells.length){for(let e=c;e<=d;e++)n.render(e,o.getAt(e),!0,!1,!0),h=n.translate(h),t.collectRow(n),u.push({top:n.top,bottom:n.bottom,offsetHeight:n.offsetHeight,dataIndex:n.dataIndex});await t.onRowsCollected(u,e)}a+=h,s&&t.renderMergedCells(e,c,d,u)}return a}buildPageHtml(e){const t=this,{subGrids:n}=t.exportMeta;let r=t.prepareExportElement();return Object.values(n).forEach((({placeHolder:n,rows:i,mergedCellsHtml:o})=>{const s=n.outerHTML;let l=t.positionRows(i,e).join("");null!=o&&o.length&&(l+=`<div class="b-grid-merged-cells-container">${o.join("")}</div>`),r=r.replace(s,l)})),r}}Rf.prototype.pagesExtractor=async function*(e){const t=this,{client:n}=e,{totalWidth:r}=t.exportMeta,i=t.stylesheets,o=e.orientation===mf.portrait,l=pf[e.paperFormat],a=o?l.width:l.height,c=o?l.height:l.width;let d,u,h;e.enableDirectRendering?(d=await t.renderRows(e),d+=n.headerHeight+n.footerHeight):(d=await t.collectRows(e),d+=n.height-n.bodyHeight);const g=t.buildPageHtml(e),p=d;if(e.headerTpl){u=t.prepareHTML(e.headerTpl({totalWidth:r}));d+=t.measureElement(u)}if(e.footerTpl){h=t.prepareHTML(e.footerTpl({totalWidth:r}));d+=t.measureElement(h)}const m=Math.min(1,t.getScaleValue(t.inchToPx(a),r)),f=Math.min(1,t.getScaleValue(t.inchToPx(c),d)),v=Math.min(m,f);i.push(`<style>\n                #${n.id} {\n                    height: ${p}px !important;\n                    width: ${r}px !important;\n                }\n                .b-export-content {\n                    ${t.centerContentHorizontally?"left: 50%;":""}\n                    transform: scale(${v}) ${t.centerContentHorizontally?"translateX(-50%)":""};\n                    transform-origin: top left;\n                    height: ${1===v?"inherit":"auto !important"};\n                }\n            </style>`),s.isIE11&&i.push(`<style>\n                .b-export-body {\n                   min-height: ${p}px !important;\n                }\n         </style>`),yield{html:t.pageTpl({html:g,header:u,footer:h,styles:i,paperWidth:a,paperHeight:c})}},Rf._$name="SinglePageExporter";class Tf extends di{static get $name(){return"PdfExport"}static get configurable(){return{dialogClass:wf,exportServer:i,exportDialog:{value:!0,$config:["lazy"]},fileName:null,fileFormat:"pdf",clientURL:null,paperFormat:"A4",orientation:"portrait",rowsRange:"all",alignRows:!1,repeatHeader:!1,keepRegionSizes:null,pagesPerRequest:0,exporterConfig:null,exporterType:"singlepage",exporters:[Rf,Sf,Ef],translateURLsToAbsolute:!0,keepPathName:!0,openAfterExport:!0,sendAsBinary:!1,openInNewTab:!1,headerTpl:null,footerTpl:null,fetchOptions:null,exportMask:"L{Generating pages}",exportProgressMask:"L{Waiting for response from server}",showErrorToast:!0,localizableProperties:["exportMask","exportProgressMask"],filterStyles:e=>e,enableDirectRendering:!0}}updateEnableDirectRendering(e){e||P.deprecate("Grid","6.0.0","Indirect rendering is deprecated")}doDestroy(){var e;null===(e=this.exportDialog)||void 0===e||e.destroy(),this.exportersMap.forEach((e=>e.destroy())),super.doDestroy()}get currentExportPromise(){return this._currentExportPromise}set currentExportPromise(e){this._currentExportPromise=e}get exportersMap(){return this._exportersMap||(this._exportersMap=new Map)}getExporter(e={}){const t=this,{exportersMap:n}=t,{type:r}=e;let i;if(n.has(r))i=n.get(r),Object.assign(i,e);else{const o=this.exporters.find((e=>e.type===r));if(!o)throw new Error(`Exporter type ${r} is not found. Make sure you've configured it`);delete(e=Yt.clone(e)).type,i=new o(e),i.relayAll(t),n.set(r,i)}return i}buildExportConfig(e={}){const{client:t,exportServer:n,clientURL:r,fileFormat:i,fileName:o,paperFormat:s,rowsRange:l,alignRows:a,repeatHeader:c,keepRegionSizes:d,orientation:u,translateURLsToAbsolute:h,keepPathName:g,sendAsBinary:p,headerTpl:m,footerTpl:f,filterStyles:v,enableDirectRendering:b}=this;e.columns||(e.columns=t.columns.visibleColumns.filter((e=>e.exportable)).map((e=>e.id)));const y=Yt.assign({client:t,exportServer:n,clientURL:r,fileFormat:i,paperFormat:s,rowsRange:l,alignRows:a,repeatHeader:c,keepRegionSizes:d,orientation:u,translateURLsToAbsolute:h,keepPathName:g,sendAsBinary:p,headerTpl:m,footerTpl:f,enableDirectRendering:b,exporterType:this.exporterType,fileName:o||t.$$name},e);return y.columns=e.columns.slice(),"multipagevertical"!==y.exporterType&&(y.repeatHeader=!1),!("alignRows"in e)&&e.repeatHeader&&(y.alignRows=!0),y.exporterConfig=Yt.assign({type:y.exporterType,translateURLsToAbsolute:y.translateURLsToAbsolute,keepPathName:y.keepPathName,filterStyles:v},y.exporterConfig||{}),delete y.exporterType,delete y.translateURLsToAbsolute,delete y.keepPathName,y}async export(e={}){const t=this,{client:n,pagesPerRequest:r}=t;let i;if(e=t.buildExportConfig(e),!1!==n.trigger("beforePdfExport",{config:e})){n.isExporting=!0,n.mask(t.exportMask);try{const s=t.getExporter(e.exporterConfig);if(0===r){var o;const r=await s.export(e);if(t.isDestroying)return;null===(o=t.exportDialog)||void 0===o||o.close(),n.unmask(),t.trigger("exportStep",{progress:90,text:t.exportProgressMask,contentGenerated:!0});const l=t.receiveExportContent(r,e);t.toast=t.showLoadingToast(l);const a=await l;i={response:a},await t.processExportContent(a,e)}}catch(e){throw i=e instanceof Response?{response:e}:{error:e},e}finally{var s;if(t.toast&&!t.toast.isDestroying&&t.toast.hide(),!t.isDestroying)null===(s=t.exportDialog)||void 0===s||s.close(),n.unmask(),t.showErrorToast&&(i.error?"AbortError"!==i.error.name&&Rd.show({html:t.L("L{Export failed}"),rootElement:t.rootElement}):i.response.ok||Rd.show({html:t.L("L{Server error}"),rootElement:t.rootElement})),n.trigger("pdfExport",i),n.isExporting=!1}}return i}receiveExportContent(e,t){return ye.fetch(t.exportServer,Object.assign({method:"POST",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:e,orientation:t.orientation,format:t.paperFormat,fileFormat:t.fileFormat,fileName:t.fileName,clientURL:t.clientURL,sendAsBinary:t.sendAsBinary})},this.fetchOptions))}async processExportContent(e,t){const n=this;if(e.ok&&n.openAfterExport){const r=(e=e.clone()).headers.get("content-type");if(r.match(/application\/octet-stream/)){const r=vf[t.fileFormat],i=await n.responseBlobToObjectURL(e,r);n.getDownloadLink(t.fileName,i).click()}else if(r.match(/application\/json/)){const r=await e.json();if(r.success){n.getDownloadLink(t.fileName,r.url).click()}else Rd.show({html:r.msg,rootElement:this.rootElement})}}}async responseBlobToObjectURL(e,t){const n=await e.blob();return URL.createObjectURL(n.slice(0,n.size,t))}getDownloadLink(e,t){const n=document.createElement("a");return n.download=e,n.href=t,this.openInNewTab&&(n.target="_blank"),n}get defaultExportDialogConfig(){return Yt.copyProperties({},this,["client","exporters","exporterType","orientation","fileFormat","paperFormat","alignRows","rowsRange","repeatHeader"])}changeExportDialog(e,t){const n=this;if(null==t||t.destroy(),e){const t=n.dialogClass.mergeConfigs({rootElement:n.rootElement,client:n.client,items:{rowsRangeField:{value:n.rowsRange},exporterTypeField:{value:n.exporterType},orientationField:{value:n.orientation},paperFormatField:{value:n.paperFormat},repeatHeaderField:{value:n.repeatHeader},fileFormatField:{value:n.fileFormat},alignRowsField:{checked:n.alignRows}}},n.defaultExportDialogConfig,e);(e=n.dialogClass.new(t)).ion({export:n.onExportButtonClick,thisObj:n})}return e}async showExportDialog(){return this.exportDialog.show()}onExportButtonClick({values:e}){const t=this,n=t.exportDialog.mask({progress:0,maxProgress:100,text:t.exportMask}),r=t.ion({exportstep({progress:e,text:i,contentGenerated:o}){o?(t.exportDialog.unmask(),r()):(n.progress=e,null!=i&&(n.text=i))}});t.currentExportPromise=t.export(e),t.currentExportPromise.catch((()=>{})).finally((()=>{var e;r(),null===(e=t.exportDialog)||void 0===e||e.unmask(),t.currentExportPromise=null}))}showLoadingToast(e){const t=Rd.show({timeout:0,showProgress:!1,rootElement:this.rootElement,html:`\n    <span class="b-mask-icon b-icon b-icon-spinner"></span>\n    <span>${this.exportProgressMask}</span>\n    <button class="b-button">${this.L("L{Click to abort}")}</button>`});return Gn.on({element:t.element,click(){var t;null===(t=e.abort)||void 0===t||t.call(e)}}),t}}Tf._$name="PdfExport",gd.registerFeature(Tf,!1,"Grid");class Df extends fe{static get defaultConfig(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:"    "}}export(e={}){const t=this;return e=Yt.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}generateExportData(e){const t=this.generateColumns(e);return{rows:this.generateRows(e),columns:t}}normalizeColumns(e){const t=e.columns||this.target.columns.visibleColumns.filter((e=>!1!==e.exportable));e.columns=t.map((e=>"string"==typeof e?this.target.columns.find((t=>t.field===e))||{field:e}:e))}generateColumns(e){return e.columns.map((t=>this.processColumn(t,e)))}generateRows(e){const{columns:t,rows:n}=e;if(0===t.length||0===(null==n?void 0:n.length))return[];const r=this,{target:i}=r;return(n||i.store).map((n=>r.processRecord(n,t,e))).filter((e=>null==e?void 0:e.length))}getColumnType(e,t=this.target.store){let n=e.exportedType||"object";if(e.exportedType===i&&e.field){const r=t.modelClass.getFieldDefinition(e.field);r&&"auto"!==r.type&&(n=r.type)}return n}processColumn(e,t){const{target:n}=this,{defaultColumnWidth:r}=t;let{field:i,text:o,width:s,minWidth:l}=e;if(i in n.store.modelClass.fieldMap||(i=""),!o||!s){const e=n.columns.find((e=>e.field===i));o||(o=e&&e.text||i),null==s&&(s=e&&e.width||r)}return s=Math.max(s||r,l||r),{field:i,value:o,width:s,type:this.getColumnType(e)}}processRecord(e,t,n){const{target:r}=this,{showGroupHeader:i,indent:o,indentationSymbol:s}=n;let l;return e?e.isSpecialRow?i&&e.meta.groupRowFor&&(l=t.map((t=>r.features.group.buildGroupHeader({cellElement:Lr.createElement(),grid:r,record:e,column:t})))):l=t.map((t=>{let i=e.getValue(t.field);const l=t.renderer||t.defaultRenderer;return!l||i&&t.isDateColumn&&n.exportDateAsInstance||(i=l.call(t,{value:i,record:e,column:t,grid:r,isExport:!0})),o&&t.tree&&(i=`${s.repeat(e.childLevel)}${i}`),i})):l=t.map((()=>"")),l}}Df._$name="TableExporter";class Mf{constructor(e){this._value=e}get value(){return this._value}toString(){return Boolean(this.value)?"✓":""}}Mf._$name="BooleanUnicodeSymbol";class Ff extends di{static get $name(){return"ExcelExporter"}static get defaultConfig(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:Df,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}processValue(e){return e===i||null===e||Number.isNaN(e)||"function"==typeof e||"object"==typeof e&&"[object Object]"===String(e)?"":e}generateExportData(e){const t=this,{rows:n,columns:r}=t.exporter.export(e.exporterConfig);return{rows:n.map((n=>n.map(((n,i)=>{var o;n instanceof Date?n=Wt.format(n,e.dateFormat):"boolean"==typeof n&&(n=new Mf(n)),t.convertEmptyValueToEmptyString&&(n=t.processValue(n));return{value:n,type:"number"===(null===(o=r[i])||void 0===o?void 0:o.type)?"number":"string"}})))),columns:r.map((e=>{let{field:t,value:n,width:r,type:i}=e;return i="string",{field:t,value:n,width:r,type:i}}))}}export(e={}){const t=this,n=t.zipcelx||r.zipcelx;if(!n)throw new Error('ExcelExporter: "zipcelx" library is required');if(t.disabled)return;(e=Yt.assign({},t.config,e)).filename||(e.filename=t.client.$$name);const{filename:i}=e,{rows:o,columns:s}=t.generateExportData(e);return n({filename:i,sheet:{data:[s].concat(o),cols:s}})}construct(e,t){super.construct(e,t),this.zipcelx||"undefined"!=typeof zipcelx&&(this.zipcelx=r.zipcelx)}get exporter(){const e=this;return e._exporter||(e._exporter=e.exporterClass.new({target:e.client},e.exporterConfig))}}Ff._$name="ExcelExporter",gd.registerFeature(Ff,!1,"Grid");class If extends di{static $name="FileDrop";construct(e,t){const n=this;super.construct(e,t),Gn.on({element:e.element,thisObj:n,drop:n.onFileDrop,dragover:n.onFileDragOver,dragenter:n.onFileDragEnter,dragleave:n.onFileDragLeave})}onFileLoad(e){this.client.trigger("fileDrop",{file:this.file,domEvent:e})}onFileDragEnter(){this.client.element.classList.add("b-dragging-file")}onFileDragOver(e){e.preventDefault()}onFileDragLeave(e){const{element:t}=this.client;e.relatedTarget&&!t.contains(e.relatedTarget)&&this.client.element.classList.remove("b-dragging-file")}onFileDrop(e){e.preventDefault();const t=e.dataTransfer.items[0].getAsFile();this.client.trigger("fileDrop",{file:t,domEvent:e}),this.onFileDragLeave(e)}}If._$name="FileDrop",gd.registerFeature(If,!1,"Grid");class kf extends jd{static get $name(){return"Grid"}static get type(){return"grid"}}kf.initClass(),kf._$name="Grid";class Of extends kf{static get $name(){return"TreeGrid"}static get type(){return"treegrid"}static get configurable(){return{store:{tree:!0}}}updateStore(e,t){if(e&&!e.tree)throw new Error("TreeGrid requires a Store configured with tree : true");super.updateStore(e,t)}}Of.initClass(),Of._$name="TreeGrid";class Lf extends fc{static type="groupbar";static $name="GroupBar";static configurable={selectedCls:"not-used",itemTpl(e){return A.encodeHtml(A.capitalize(e.getValue(this.displayField)))}};construct(){super.construct(...arguments);const e=this.treeGrid=this.up("gridbase",!0);if(!e)throw new Error("GroupBar must be used inside a Grid component");e.ion({paint:this.onTreePaint,once:!0,thisObj:this})}onTreePaint(){const e=this,{treeGrid:t}=e,{treeGroup:n,columnReorder:r}=t.features;if(!n)throw new Error("GroupBar widget requires the TreeGroup feature to be present");r.usingGroupBarWidget=!0,e.store=new ts({fields:["cls","ascending"],internalListeners:{add:e.onStoreChanged,remove:e.onStoreChanged,thisObj:e}}),t.ion({treeGroupChange:e.onTreeGroupChanged,beforeColumnDropFinalize:e.onBeforeColumnDropFinalize,columnDrag:e.onColumnDrag,columnDragStart:e.onColumnDragStart,columnDrop:e.onColumnDrop,thisObj:e}),e.onTreeGroupChanged({levels:n.levels})}onStoreChanged({records:e}){var t;const n=this,{treeGrid:r}=n;n.treeGrid.isConstructing||"b-drop-target"===(null==e||null===(t=e[0])||void 0===t?void 0:t.cls)||(n.ignoreGroupChange=!0,r.features.treeGroup.levels=n.store.map((({field:e})=>e)),n.ignoreGroupChange=!1)}onTreeGroupChanged({levels:e}){if(!this.ignoreGroupChange){if(e.some((e=>e instanceof Function&&!e.fieldName)))throw new Error("GroupBar only supports column grouping");this.store.data=(e||[]).map((e=>(e=e.fieldName||e,this.treeGrid.columns.get(e))))}}onColumnDragStart(){this.store.add({id:"placeholder",cls:"b-drop-target"})}onColumnDrag({context:e,column:t,event:n}){n.target.closest(".b-groupbar")&&(e.valid=!0)}onBeforeColumnDropFinalize({column:e,event:t}){t.target.closest(".b-groupbar")&&(e.isTreeColumn||(this.store.getById("placeholder").remove(),this.store.add(e)))}onColumnDrop(){var e;null===(e=this.store.getById("placeholder"))||void 0===e||e.remove()}}Lf.initClass(),Lf._$name="GroupBar";class Af extends yc{static $name="TreeCombo";static type="treecombo";static configurable={multiSelect:!0,picker:{type:"treegrid",minWidth:"35em",disableGridRowModelWarning:!0,selectionMode:{row:!0,rowCheckboxSelection:!0}},chipView:{itemTpl:e=>A.xss`${e.name}`,scrollable:{overflowX:"hidden-scroll"}}};changePicker(e,t){var n;return null===(n=e=super.changePicker(e,t))||void 0===n||n.ion({selectionChange:"onPickerSelectionChange",thisObj:this}),e}updateMultiSelect(e){super.updateMultiSelect(...arguments),this.picker.selectionMode.multiSelect=e}updateReadOnly(e){super.updateReadOnly(...arguments),this.picker.readOnly=e}get value(){return super.value}set value(e){var t;this._settingValue=!0,super.value=e,this.picker.selectedRecords=(null===(t=e.map)||void 0===t?void 0:t.call(e,(e=>this.store.getById(e))))||[],this._settingValue=!1}onPickerSelectionChange({selection:e}){this._settingValue||(this.value=e)}}Af.initClass(),Af._$name="TreeCombo",e.ActionBase=Ud,e.ActionColumn=cm,e.AggregateColumn=um,e.AjaxHelper=ye,e.AjaxStore=os,e.Animator=Pl,e.ArrayDataField=Hi,e.ArrayHelper=H,e.AsyncHelper=V,e.AvatarRendering=am,e.Badge=xa,e.Bag=To,e.Bar=ed,e.Base=fe,e.BooleanCombo=_g,e.BooleanDataField=Vi,e.BrowserHelper=s,e.Button=Ma,e.ButtonGroup=$g,e.CSSHelper=ss,e.CalendarPanel=Ng,e.CellCopyPaste=Sm,e.CellEdit=Rm,e.CellMenu=Tm,e.CellTooltip=Dm,e.CheckColumn=gm,e.Checkbox=Vg,e.ChipView=fc,e.ClickRepeater=ci,e.Clipboardable=Nh,e.CollapseTool=Wl,e.Collection=So,e.CollectionFilter=co,e.CollectionSorter=go,e.ColorColumn=pm,e.ColorField=zg,e.ColorPicker=Bg,e.Column=Gc,e.ColumnAutoWidth=Fm,e.ColumnDragToolbar=Im,e.ColumnPicker=km,e.ColumnRename=Om,e.ColumnReorder=Lm,e.ColumnResize=Am,e.ColumnStore=qc,e.Combo=yc,e.Config=J,e.Container=El,e.ContextMenuBase=ah,e.CopyPasteBase=xm,e.DataField=Ni,e.DataGenerator=Eh,e.DateColumn=mm,e.DateDataField=Bi,e.DateField=Xg,e.DateHelper=Wt,e.DatePicker=qg,e.DateTimeField=np,e.DayTime=hg,e.Delayable=ai,e.DemoBot=Th,e.DisplayField=jg,e.DomClassList=wn,e.DomDataStore=Nc,e.DomHelper=Lr,e.DomSync=Cs,e.DragContext=Gh,e.DragHelper=Oc,e.DragProxy=Uh,e.DragTipProxy=Ag,e.Draggable=e=>class extends(e||fe){static get $name(){return"Draggable"}static get configurable(){return{dragging:{$config:"nullify",value:null},draggingClsSelector:null,dragDocumentListeners:{element:document,keydown:"onDragKeyDown",keyup:"onDragKeyUp",contextmenu:"onDragContextMenu",mousemove:"onDragPointerMove",mouseup:"onDragPointerUp",pointerup:"onDragPointerUp",touchend:"onDragPointerUp",touchmove:{handler:"onDragPointerMove",passive:!1}},dragItemSelector:null,dragItemOverCls:null,dragLock:null,dragMinDistance:1,dragProxy:{$config:["lazy","nullify"],value:null},dragRootElement:{$config:"nullify",value:null},dragSameTargetDrop:!1,dragSelector:null,ignoreSelector:null,dragSwallowClickTime:50,dragThreshold:5,dragTouchStartDelay:300,dropTargetSelector:null,overItem:null,testConfig:{dragSwallowClickTime:50}}}static get properties(){return{draggingCls:"b-draggable-active",draggingBodyCls:"b-draghelper-active",draggingItemCls:"b-dragging-item",draggingStartedCls:"b-draggable-started",draggableCls:"b-draggable"}}beforeDrag(e){const{dragRootElement:t,dragSelector:n,ignoreSelector:r}=this,i=n&&e.element.closest(n);return!n||Boolean(i&&i===t||t.contains(i)&&(!r||!e.element.matches(r)))}dragStart(e){}dragOver(e){}dragEnterTarget(e){}dragLeaveTarget(e,t){}dragDrop(e){}dragEnd(e){}get activeDrag(){const{dragging:e}=this;return null!=e&&e.started&&!e.completed?e:null}get dragEventer(){return this.trigger?this:null}get draggingClassElement(){const{draggingClsSelector:e,dragRootElement:t}=this;return e?null==t?void 0:t.closest(e):t}beginDrag(e){const{draggingCls:t,draggingClassElement:n}=this;t&&n&&(n.classList.add(t),e.cleaners.push((()=>n.classList.remove(t))))}async endDrag(e){const t=this,{dragEventer:n,dragProxy:r}=t;e.valid&&await t.dragDrop(e),t.isDestroyed||(e.pending?e.destroy():(t.dragEnd(e),null==r||r.dragEnd(e),null==n||n.trigger(e.valid?"drop":"dragCancel",{drag:e,event:e.event}),t.finalizeDrag(e)))}async finalizeDrag(e){var t;await(null===(t=e.finalize)||void 0===t?void 0:t.call(e))}moveDrag(e){if(!1!==this.dragOver(e)){const{dragEventer:t,dragProxy:n}=this;null==n||n.dragMove(e),null==t||t.trigger("drag",{drag:e,event:e.event})}}setupDragContext(e){const t=this,{dragItemSelector:n,id:r}=t,{target:i}=e;return{event:e,id:r?`${r}-drag-${t._nextDragId=(t._nextDragId||0)+1}`:null,itemElement:n?i.closest(n):i,touchStartDelay:t.dragTouchStartDelay,source:t,threshold:t.dragThreshold}}startDrag(e){const{draggingStartedCls:t,draggingClassElement:n,draggingItemCls:r,dragEventer:i,dragProxy:o}=this,{itemElement:s}=e;if(!1===(null==i?void 0:i.trigger("beforeDragStart",{drag:e,event:e.event})))return!1;t&&n&&(n.classList.add(t),e.cleaners.push((()=>n.classList.remove(t)))),r&&s&&(s.classList.add(r),e.cleaners.push((()=>s.classList.remove(r)))),null==o||o.dragStart(e);const l=this.dragStart(e);return!1!==l&&(null==i||i.trigger("dragStart",{drag:e,event:e.event})),l}trackDrag(e){var t;const{dropTargetSelector:n}=this;e.valid=!(n&&(null===(t=e.targetElement)||void 0===t||!t.closest(n))),this.moveDrag(e)}configureListeners(e){const t=Yt.assign({thisObj:this},this.dragDocumentListeners);return"touches"in e.startEvent?(delete t.mousemove,delete t.mouseup):(delete t.contextmenu,delete t.touchmove,delete t.touchend,delete t.pointerup),t}updateDragging(e,t){const n=this;if(e){const t=n.configureListeners(e);e.cleaners.push(Gn.on(t)),n.beginDrag(e)}else t&&t.destroy()}changeDragProxy(e,t){return Uh.reconfigure(t,e,{owner:this,defaults:{owner:this}})}updateDragRootElement(e,t){var n;const r=this,{draggableCls:i,dragItemSelector:o,onDragItemMouseMove:s}=r;if(null==t||t.classList.remove(i),null===(n=r._dragRootDetacher)||void 0===n||n.call(r),e){const t={thisObj:r,element:e,mousedown:"onDragMouseDown",touchstart:"onDragTouchStart",pointerdown:e=>{var t,n;return e.pointerId&&(null===(t=(n=e.target).releasePointerCapture)||void 0===t?void 0:t.call(n,e.pointerId))}};s&&(t.mousemove={delegate:o,handler:"onDragItemMouseMove"}),(r.dragItemOverCls||s||r.onDragItemMouseEnter||r.onDragItemMouseLeave)&&Object.assign(t,{mouseover:{delegate:o,handler:"onDragItemMouseOver"},mouseout:{delegate:o,handler:"onDragItemMouseOut"}}),e.classList.add(i),r._dragRootDetacher=Gn.on(t)}}onDragItemMouseOver(e){this.overItem=e}onDragItemMouseOut(e){this.dragging||(this.overItem=e)}changeOverItem(e){var t;return this.enterLeaveEvent=e,"mouseout"===e.type?(null===(t=e.relatedTarget)||void 0===t?void 0:t.closest(this.dragItemSelector))||null:e.target.closest(this.dragItemSelector)}updateOverItem(e,t){const n=this,{dragItemOverCls:r}=n;var i,o;t&&(r&&t.classList.remove(r),null===(i=n.onDragItemMouseLeave)||void 0===i||i.call(n,n.enterLeaveEvent,t));e&&(r&&e.classList.add(r),null===(o=n.onDragItemMouseEnter)||void 0===o||o.call(n,n.enterLeaveEvent,e))}onDragContextMenu(e){e.preventDefault()}onDragKeyDown(e){this.dragging.keyDown(e)}onDragKeyUp(e){this.dragging.keyUp(e)}onDragMouseDown(e){0===e.button&&this.onDragPointerDown(e)}onDragPointerDown(e){let{dragging:t}=this;t?t.isFinalizing||t.abort():(t=this.setupDragContext(e),t&&(t=new Gh(t),!1===t.begin()&&t.destroy()))}changeDragging(e,t){return null==t||t.destroy(),e}onDragPointerMove(e){const{dragging:t}=this;t&&!t.completed&&(null==t||t.move(e))}onDragPointerUp(e){const{dragging:t}=this;t&&!t.completed&&(t.end(e),this.endDrag(t))}onDragTouchStart(e){1===e.touches.length&&this.onDragPointerDown(e)}},e.Droppable=e=>class extends(e||fe){static get $name(){return"Droppable"}static get configurable(){return{droppableSelector:null,dropping:null,dropRootElement:{$config:"nullify",value:null}}}get dropEventer(){return this.trigger?this:null}get droppableCls(){return"b-droppable"}dragEnter(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("dragEnter",{drag:e,event:e.event})}dragMove(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("dragMove",{drag:e,event:e.event})}dragDrop(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("drop",{drag:e,event:e.event})}dragLeave(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("dragLeave",{drag:e,event:e.event})}changeDropping(e,t){if(e!==t){const n=this;t&&(!t.aborted&&t.completed||n.dragLeave(t)),e&&(n._dropping=e,!1===n.dragEnter(e)&&(e=null),n._dropping=t)}return e}updateDropRootElement(e,t){const n=this,{droppableCls:r}=n;let i,o,s;t&&(i=Nc.get(t,"droppables"),s=!0,Array.isArray(i)&&(o=i.indexOf(n))>-1&&(i.length<2?Nc.remove(t,"droppables"):(i.splice(o,1),i.forEach((e=>{r===e.droppableCls&&(s=!1)})))),s&&t.classList.remove(r)),e&&(i=Nc.get(e,"droppables"),i?i.push(n):Nc.set(e,"droppables",[n]),e.classList.add(r))}},e.Duration=oo,e.DurationField=rp,e.DynamicObject=ca,e.Editor=op,e.EventHelper=Gn,e.Events=je,e.ExcelExporter=Ff,e.ExportDialog=wf,e.ExportOrientationCombo=yf,e.ExportRowsCombo=bf,e.Exporter=xf,e.Factoryable=_i,e.Featureable=e=>class extends(e||fe){static get $name(){return"Featureable"}static get configurable(){return{features:null}}static get declarable(){return["featureable"]}static setupFeatureable(e){const t={ownerName:"client",...e.featureable};t.factory.initClass(),Reflect.defineProperty(e,"featureable",{get:()=>t})}doDestroy(){const e=this.features;super.doDestroy();for(const n in e){var t;const r=e[n];null===(t=r.destroy)||void 0===t||t.call(r)}}hasFeature(e){var t;return Boolean(null===(t=this.features)||void 0===t?void 0:t[e])}changeFeatures(e,t){if(this.isDestroying)return;const n=this,{featureable:r}=n.constructor,i=n.$features||(n.$features=new ca({configName:"features",factory:r.factory,owner:n,ownerName:r.ownerName}));return i.update(e),t?void 0:i.target}get widgetClass(){}getCurrentConfig(e){const t=super.getCurrentConfig(e),{features:n}=t;if(n)for(const e in n)0===Object.keys(n[e]).length&&(n[e]=!0);return t}},e.Fencible=lg,e.Field=lc,e.FieldContainer=nc,e.FieldFilterPicker=up,e.FieldFilterPickerGroup=gp,e.FieldSet=pp,e.FileDrop=If,e.FileField=mp,e.FileFormat=ff,e.FilePicker=fp,e.FillHandle=Pm,e.Filter=Hm,e.FilterBar=Bm,e.FilterField=vp,e.Finalizable=Hh,e.Footer=nd,e.Formatter=Ih,e.Fullscreen=ws,e.FunctionHelper=Te,e.GlobalEvents=Rn,e.Grid=kf,e.GridBase=jd,e.GridElementEvents=ld,e.GridFeatureManager=gd,e.GridFeatures=md,e.GridFieldFilterPicker=_m,e.GridFieldFilterPickerGroup=$m,e.GridResponsive=Cd,e.GridRowModel=Kc,e.GridSelection=Ed,e.GridState=kd,e.GridSubGrids=$d,e.Group=zm,e.GroupBar=Lf,e.GroupSummary=jm,e.Header=td,e.HeaderMenu=Gm,e.Histogram=om,e.Hoverable=e=>class extends(e.mixin(ai)){static get $name(){return"Hoverable"}static get configurable(){return{hoverCls:null,hoverAnimationCls:null,hoverRootCls:null,hoverRootActiveCls:null,hoverDelay:null,hoverElement:null,hoverIgnoreElement:null,hoverEdges:null,hoverEdgeSize:10,hoverRootElement:{$config:"nullify",value:null},hoverSelector:null,hoverTarget:{$config:"nullify",value:null},hoverTrack:null,hoverZone:null}}static get delayable(){return{setHoverTarget:0}}hoverEnter(e){}hoverIgnore(e){var t;return null===(t=this.hoverIgnoreElement)||void 0===t?void 0:t.contains(e)}hoverLeave(e){}hoverMove(e){}onHoverMouseMove(e){const t=this,{hoverEdges:n,hoverEdgeSize:r,hoverTarget:i}=t;if(i){if(n){const{top:o,left:s,width:l,height:a,right:c,bottom:d}=i.getBoundingClientRect(),{clientX:u,clientY:h}=e,g=s+l/2,p=o+a/2,m=h<(r?o+r:p),f=u>=(r?c-r:g),v=m||h>=(r?d-r:p)?m?"t":"b":"",b=f||u<(r?s+r:g)?f?"r":"l":"";t.hoverZone=(n.includes(v)?v:"")+(n.includes(b)?b:"")}t.hoverEvent=e,t.hoverTrack&&t.hoverMove(e)}}onHoverMouseOver(e){this.hoverEvent=e,this.hoverElement=e.target}onHoverMouseOut(e){this.hoverEvent=e,this.hoverElement=e.relatedTarget}updateHoverDelay(e){this.setHoverTarget.delay=e}changeHoverEdges(e){return!0===e?"trbl":(e||"").replace("v","tb").replace("h","lr")}updateHoverEdges(){this.syncHoverListeners()}changeHoverElement(e){if(!this.hoverIgnore(e))return e}updateHoverElement(e){const{hoverSelector:t}=this;var n;t&&(e=null===(n=e)||void 0===n?void 0:n.closest(t));this.setHoverTarget(e)}updateHoverRootElement(e,t){const{hoverRootCls:n}=this;n&&(null==t||t.classList.remove(n),null==e||e.classList.add(n)),this.syncHoverListeners()}changeHoverTarget(e,t){return t&&(this.hoverZone=null),e}updateHoverTarget(e,t){const n=this,{hoverCls:r,hoverAnimationCls:i,hoverRootActiveCls:o,hoverRootElement:s}=n;o&&(null==s||s.classList[e?"add":"remove"](o)),t&&(r&&t.classList.remove(r),i&&t.classList.remove(i),n.hoverLeave(t)),e&&(r&&e.classList.add(r),n.hoverEnter(t),n.hoverTrack&&n.hoverMove(n.hoverEvent),i&&(e.getBoundingClientRect(),e.classList.add(i)))}updateHoverTrack(){this.syncHoverListeners()}updateHoverZone(e){const{hoverAnimationCls:t,hoverTarget:n}=this;if(n){const{className:r}=n,i=wn.change(r,e?Zh[e]:null,Qh);r!==i&&(n.className=i,e&&t&&(n.classList.remove(t),n.getBoundingClientRect(),n.classList.add(t)))}}setHoverTarget(e){this.hoverTarget=e}syncHoverListeners(){var e;const t=this,n=t.hoverRootElement,r={element:n,thisObj:t,mouseover:"onHoverMouseOver",mouseout:"onHoverMouseOut"};(t.hoverTrack||t.hoverEdges)&&(r.mousemove="onHoverMouseMove"),null===(e=t._hoverRootDetacher)||void 0===e||e.call(t),t._hoverRootDetacher=n&&Gn.on(r)}},e.IdHelper=ho,e.Identifiable=Si,e.InstancePlugin=di,e.IntegerDataField=ji,e.KeyMap=Vs,e.Label=hp,e.Labelable=tc,e.Layout=gl,e.List=mc,e.LoadMaskable=Nd,e.LocaleHelper=Ge,e.LocaleManager=Ye,e.Localizable=et,e.Location=Hc,e.Mask=Hs,e.Menu=sh,e.MenuItem=ih,e.MergeCells=Ym,e.MessageDialog=Cp,e.Minifiable=e=>class extends(e||fe){static $name="Minifiable";static configurable={minifiable:!0,minified:null};compose(){const{minified:e}=this;return{class:{"b-minified":e}}}get widgetClass(){}},e.Model=io,e.ModelDataField=Gi,e.ModelLink=Oi,e.ModelStm=Ti,e.Month=gg,e.MultiPageExporter=Sf,e.MultiPageVerticalExporter=Ef,e.Navigator=gc,e.NumberColumn=dm,e.NumberDataField=Ui,e.NumberField=Qg,e.NumberFormat=Ph,e.ObjectDataField=Yi,e.ObjectHelper=Yt,e.Objects=m,e.Orientation=mf,e.Override=N,e.PagingToolbar=wp,e.Panel=Ka,e.PanelCollapser=la,e.PanelCollapserOverlay=Rp,e.PaperFormat=pf,e.Parser=Lg,e.PasswordField=Tp,e.PdfExport=Tf,e.PercentColumn=fm,e.PickerField=cc,e.Pluggable=ui,e.Point=_n,e.Popup=Xa,e.Promissory=_s,e.QuickFind=qm,e.RTL=Bs,e.Radio=Dp,e.RadioGroup=Mp,e.RandomGenerator=xh,e.RatingColumn=vm,e.Rectangle=bn,e.RegionResize=Km,e.Renderable=Ns,e.ResizeHelper=dh,e.ResizeMonitor=Rs,e.Responsive=e=>class extends((e||fe).mixin(ai,lg)){static $name="Responsive";static configurable={responsive:{$config:{lazy:"paint"},value:null},responsiveDefaults:{small:{when:400},medium:{when:800},large:{when:()=>1/0},"*":{}},responsiveRoot:null,responsiveState:null,responsiveTarget:{value:null,$config:{lazy:"paint"}},responsiveWidget:{value:null,$config:{nullify:!0}},breakpoints:null};static delayable={responsiveUpdate:"raf"};static fenced={syncResponsiveWidget:!0};static prototypeProperties={responsiveStateChanges:0,responsiveUpdateCount:0};get isResponsivePending(){return 0===this.responsiveUpdateCount&&this.hasConfig("responsive")}get isResponsiveUpdating(){var e;return this._responsiveUpdating||(null===(e=this.responsiveWidget)||void 0===e?void 0:e._responsiveUpdating)}updateResponsive(e){const t=this,n=t.constructor,{responsiveDefaults:r}=t,i=Array.from(new Set(Yt.keys(e).concat(Yt.keys(r)))).filter(Up);let o,s,l,a,c=null;if(e)for(s of(c={"*":Jp(n,r["*"],e["*"])},i)){var d;if(l=e[s],null!==l&&!1!==l)o=o||l&&"when"in l,c[s]=Jp(n,r["*"],r[s],e["*"],l),a=c[s].when,c[s].when=(null===(d=Kp[typeof a])||void 0===d?void 0:d.call(Kp,a))||a}t.$responsiveStates=c,t.$responsiveWhen=o,t.syncResponsiveWidget()}updateResponsiveState(e,t){var n;const r=this,{$responsiveStates:i}=r,o=1==++r.responsiveStateChanges,s=null===(n=r.element)||void 0===n?void 0:n.classList,l=i["*"],a=i[e]||l,c=o&&(a.once||l.once),d=o&&r.isStateful,u=r.responsiveWidget;let h=a.configs,g=null==c?void 0:c.configs;g&&(h=h?r.constructor.mergeConfigs(h,g):g),t&&(null==s||s.remove(`b-responsive-${t.toLowerCase()}`)),e&&(null==s||s.add(`b-responsive-${e.toLowerCase()}`)),d&&(g=r.loadStatefulData(),g&&(h=h?r.constructor.mergeConfigs(h,g):g),r.suspendStateful()),r._responsiveUpdating=!0;try{var p,m,f,v;null===(p=r.trigger)||void 0===p||p.call(r,"beforeResponsiveStateChange",{state:e,oldState:t,target:u}),h&&r.setConfig(h),null===(m=a.callback)||void 0===m||m.call(a,{source:r,state:e,oldState:t,target:u,initial:o}),null==c||null===(f=c.callback)||void 0===f||f.call(c,{source:r,state:e,oldState:t,target:u,initial:o}),null===(v=r.trigger)||void 0===v||v.call(r,"responsiveStateChange",{state:e,oldState:t,target:u})}finally{r._responsiveUpdating=!1,d&&r.resumeStateful()}}get responsiveTarget(){return this.responsiveWidget||this._responsiveTarget}updateResponsiveTarget(){this.syncResponsiveWidget()}updateResponsiveWidget(e){var t;const n=this,r=e&&n.responsiveUpdate;null===(t=n.$responsiveWrapper)||void 0===t||t.destroy(),n.$responsiveWrapper=e&&((e,t)=>{let n,r=Proxy.revocable(e,{get:(t,r)=>(n&&(n[r]=!0),e[r])}),i=Te.after(e,"onConfigChange",((e,{name:r})=>{var i;null!==(i=n)&&void 0!==i&&i[r]&&t()})),o=e.ion({resize:()=>{t()}});return e.monitorResize=!0,{widget:e,get object(){var e;return null===(e=r)||void 0===e?void 0:e.proxy},destroy(){r&&(r.revoke(),i(),o(),r=i=o=null)},reset(){n=Object.create(null)}}})(e,r),null==r||r.now()}responsiveUpdate(){const e=this,{$responsiveStates:t,$responsiveWrapper:n}=e,r=null==n?void 0:n.widget;if(t&&n){let i,o,l=null,a=0,c=t;for(o in r&&r!==e&&!e.$responsiveWhen&&(r.getConfig("responsive"),c=r.$responsiveStates||c),n.reset(),t)"*"!==o&&(i=c[o].when(n.object,s),null!=i&&!1!==i&&(!l||i<a)&&(l=o,a=i));++e.responsiveUpdateCount,e.responsiveState=l}}syncResponsiveWidget(){const e=this;let t,n=null;if(!e.isDestroying&&e.responsive){var r;if(t=e.responsiveTarget,n=t){if("string"==typeof t&&(n="@"===t?e:"@"===t[0]?e[t.substring(1)]:e.up(t),!n))throw new Error(`No match for responsiveTarget="${t}"`)}else n=!e.responsiveRoot&&(null===(r=e.up)||void 0===r?void 0:r.call(e,qp))||e;if(!n.isWidget)throw new Error(`${n.constructor.$$name} is not a widget and cannot be a responsiveTarget`)}return e.responsiveWidget=n,n}changeBreakpoints(e){return Yt.assertObject(e,"breakpoints"),null!=e&&e.width&&Object.keys(e.width).forEach((t=>{e.width[t].maxWidth=t})),null!=e&&e.height&&Object.keys(e.height).forEach((t=>{e.height[t].maxHeight=t})),e}updateBreakpoints(e){e&&(this.monitorResize=!0)}getBreakpoint(e,t){return e[Object.keys(e).map((e=>parseInt(e))).sort().find((e=>t<=e))??(e["*"]&&"*")]}activateBreakpoint(e,t){const n=this,r=n[`current${e}Breakpoint`];var i,o;t!==r&&(n[`current${e}Breakpoint`]=t,n.setConfig(t.configs),r&&n.element.classList.remove(`b-breakpoint-${r.name.toLowerCase()}`),n.element.classList.add(`b-breakpoint-${t.name.toLowerCase()}`),n.trigger(`responsive${e}Change`,{breakpoint:t,prevBreakpoint:r}),null===(i=t.callback)||void 0===i||i.call(t,{source:n,breakpoint:t,prevBreakpoint:r}),null===(o=n.recompose)||void 0===o||o.call(n))}applyResponsiveBreakpoints(e,t){const n=this,{width:r,height:i}=n.breakpoints??{};if(r){const t=n.getBreakpoint(r,e);n.activateBreakpoint("Width",t)}if(i){const e=n.getBreakpoint(i,t);n.activateBreakpoint("Height",e)}}onInternalResize(e,t,n,r,i){super.onInternalResize(e,t,n,r,i),this.applyResponsiveBreakpoints(t,n)}},e.Ripple=fl,e.Rotatable=Hl,e.Row=Bc,e.RowCopyPaste=Xm,e.RowExpander=Qm,e.RowManager=Xc,e.RowNumberColumn=wd,e.RowReorder=Zm,e.RowsRange=gf,e.Scale=lm,e.ScrollManager=zc,e.Scroller=Ps,e.Search=ef,e.SinglePageExporter=Rf,e.SlideToggle=kp,e.Slider=Ip,e.Sort=tf,e.Split=af,e.Splitter=Pp,e.State=Ci,e.StateBase=Kd,e.StateProvider=vi,e.StateStorage=hi,e.StateTrackingManager=th,e.StickyCells=nf,e.Store=ts,e.StoreCRUD=Mo,e.StoreChained=Bo,e.StoreChanges=Fo,e.StoreDataField=qi,e.StoreFilter=Io,e.StoreGroup=Oo,e.StoreProxy=Lo,e.StoreRelation=Ao,e.StoreSearch=No,e.StoreSort=Ho,e.StoreState=zo,e.StoreStm=Jo,e.StoreSum=Po,e.StoreSync=Ko,e.StoreTree=Yo,e.StringDataField=zi,e.StringHelper=A,e.Stripe=rf,e.Styleable=e=>class extends(e||fe){static $name="Styleable";static configurable={cssVarPrefix:"",css:{}};changeCssVarPrefix(e){return Yt.assertString(e,"prefix"),e&&!e.endsWith("-")&&(e+="-"),e||""}changeCss(e){Yt.assertObject(e,"css");const t=this;if(!r.Proxy)throw new Error("Proxy not supported");const n=new Proxy({},{get(e,n){var r;return null===(r=getComputedStyle(t.element||document.documentElement).getPropertyValue(`--${t.cssVarPrefix}${A.hyphenate(n)}`))||void 0===r?void 0:r.trim()},set:(e,n,r)=>((t.element||document.documentElement).style.setProperty(`--${t.cssVarPrefix}${A.hyphenate(n)}`,r),!0)});return e&&(t._element?Yt.assign(n,e):t.$initialCSS=e),n}updateElement(e,...t){super.updateElement(e,...t),this.$initialCSS&&Yt.assign(this.css,this.$initialCSS)}get widgetClass(){}},e.SubGrid=_d,e.Summary=cf,e.Tab=_p,e.TabBar=Np,e.TabPanel=zp,e.TableExporter=Df,e.TemplateColumn=bm,e.TemplateHelper=hc,e.TextAreaField=Wp,e.TextAreaPickerField=jp,e.TextField=ac,e.TimeColumn=ym,e.TimeField=ep,e.TimePicker=Zg,e.TimeZoneHelper=Ch,e.Toast=Rd,e.Tool=Vl,e.Toolable=ga,e.Toolbar=Na,e.Tooltip=ec,e.Transaction=du,e.Tree=uf,e.TreeColumn=wm,e.TreeCombo=Af,e.TreeGrid=Of,e.TreeGroup=hf,e.TreeNode=Fi,e.UndoRedoBase=Pg,e.UpdateAction=xu,e.VersionHelper=P,e.WalkHelper=qo,e.Wbs=jo,e.WebSocketManager=_h,e.Widget=ul,e.WidgetColumn=hm,e.WidgetHelper=Td,e.XMLHelper=wh,e.YearPicker=Wg,e.unitMagnitudes=Vt,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=grid.lwc.module.min.js.map