<template>
    <c-custom-toast auto-close-time="3000"></c-custom-toast>
    <div style="min-height: calc(100vh - 376px)" class="component-container">
        <div class="header-container">
            <h1 class="title">{labels.collectionTitle}</h1>
            <lightning-button label={labels.newCollectionBtn} variant="brand" onclick={handleButtonClick}>
            </lightning-button>
        </div>
        <div if:true={data} class="pagination-container">
            <lightning-combobox name="resultsPerPage" label="" value={resultsPerPage} placeholder="Select"
                options={resultsOptions} onchange={handleResultsPerPageChange}>
            </lightning-combobox>
            <span>Page {currentPage} {labels.resultOf} {totalPages}</span>
            <lightning-button-icon icon-name="utility:chevronleft" alternative-text="Previous"
                onclick={handlePreviousPage} disabled={isFirstPage}></lightning-button-icon>
            <span> {currentPage} </span>
            <lightning-button-icon icon-name="utility:chevronright" alternative-text="Next" onclick={handleNextPage}
                disabled={isLastPage}></lightning-button-icon>
        </div>
        <template if:true={data}>
            <div class="grid-container">
                <div class="grid-header">
                    <div></div>
                    <div>{labels.createdDate}</div>
                    <div>{labels.headerName}</div>
                    <div>{labels.collectionItems}</div>
                    <div>{labels.sharedWith}</div>
                    <div>{labels.actions}</div>
                </div>
                    <template for:each={displayedData} for:item="row">
                        <div key={row.id} class="grid-row">
                            <div>
                                <template if:true={row.ThumbnailUrl}>
                                    <img src={row.ThumbnailUrl} alt="image" class="image-preview" />
                                </template>
                            </div>
                            <div>{row.createdDate}</div>
                            <div class="cl-link" data-id={row.id} onclick={handleCollectionClick}>{row.name}</div>
                            <div>{row.Items}</div>
                            <div>{row.SharedWith}</div>
                            <div>
                                <template if:true={isAccountExeProfile}>
                                    <div class="icon-container">
                                        <lightning-icon icon-name="utility:edit" size="x-small" alternative-text="Edit"
                                            class="icon-border" data-id={row.id} data-name={row.name} onclick={handleEdit}>
                                        </lightning-icon>
                                        <lightning-icon icon-name="utility:delete" size="x-small" alternative-text="Delete"
                                            class="icon-border" data-id={row.id} onclick={handleDeleteClick}>
                                        </lightning-icon>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
            </div>
        </template>
        <template if:false={data}>
            <div class="no-collection">{labels.noCollectionFound}</div>
        </template>
        <template if:true={showSpinner}>
            <c-h-e-q-spinner></c-h-e-q-spinner>
        </template>
        <template if:true={showConfirmationModal}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                    title="Close" onclick={closeConfirmationModal}>
                    <lightning-icon icon-name="utility:close" alternative-text="close" size="small"></lightning-icon>
                    <span class="slds-assistive-text">Close</span>
                </button>
                        <h2 class="slds-text-heading_medium">Confirm Deletion</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <p>Are you sure you want to delete this collection?</p>
                    </div>

                    <footer class="slds-modal__footer">
                        <lightning-button label="Cancel" style="padding-right: 5px;" onclick={closeConfirmationModal}></lightning-button>
                        <lightning-button variant="destructive" label="Delete" onclick={handleDeleteConfirm}>
                        </lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
    </div>
</template>