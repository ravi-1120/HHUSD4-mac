<template>
  <template if:true={isLoading}>
    <div class="overlay">
      <lightning-spinner alternative-text="Loading" size="medium" variant="brand"></lightning-spinner>
    </div>
  </template>
    <div>
      <span class="information">Click on any Icon section to edit information if needed.</span>
    </div>
    <!-- <div class="q-container"> -->
    <span class=" headingCls slds-m-top_medium slds-m-left_medium slds-text-heading_small">
      Please review details of the Competitive Information reported below:</span>
    <!-- <div class="scrollable"> -->
    <lightning-accordion active-section-name={activeSections} allow-multiple-sections-open>
      <lightning-accordion-section name="1" label="Representatives Information">
        <lightning-layout multiple-rows="true">
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="4">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Representative First Name</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage1.RepFName}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="4">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Representative Last Name</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage1.RepLName}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="4">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Representative's Manager First Name</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage1.RepManagerFName}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="4">
            <div style="font-weight: bold;" class="slds-form-element">
              <span class="slds-form-element__label" style="font-weight: bold; ">Representative's Manager Last Name</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage1.RepManagerLName}</span>
              </div>
            </div>
          </lightning-layout-item>
        </lightning-layout>
      </lightning-accordion-section>
      <lightning-accordion-section name="2" label="Product & Competitive Source">
        <lightning-layout multiple-rows="true">
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Select Product</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage2.Product}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={ProductCatalog} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Product Indication</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage2.ProductCatalog}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Select Original Competitive
                Source</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage2.CompetitiveSource}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={showOtherDetails} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Other Details</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage2.OtherDetails}</span>
              </div>
            </div>
          </lightning-layout-item>
        </lightning-layout>
      </lightning-accordion-section>
      <lightning-accordion-section name="3" label="Type of Information received">
        <lightning-layout multiple-rows="true">
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Provide a summary of the Competitive
                information</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.summary}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="12"
            medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Type of Information Received</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.typeOfInformation}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVerbal} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">When and how did you hear this
                information?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.InfoTiming}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVerbal} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="12" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">{label.MainMessage}</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.MainMessage}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isDetailPiece} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Where and when did you hear about the
                item or how did you receive the item?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.ItemTiming}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isDetailPiece} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Did you get permission to copy,
                photograph, or take any hardcopy item or forward any electronic item?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.VPermissionGranted}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={showPermissionFields} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Who gave permission?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.WhoGavePermission}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={showPermissionFields} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">What is their role?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.RoleOfPermissionGiver}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={showPermissionFields} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">What is the name/title or theme of the
                item?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.titleOfItem}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isEducational} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="12" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Where and when did (will) the program
                take place?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.ProgramTiming}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isEducational} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Who sponsored the program?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.ProgramSponsor}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isEducational} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">What is the name of the Company?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.CompanyName}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isEducational} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Who is invited and/or attending the
                program?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.ProgramAttendees}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isEducational} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">What is the main topic of the
                program?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.ProgramTopic}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isSalesforce} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">How many employees are/were
                involved?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.EmployeeCount}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isSalesforce} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">In what region is it
                concentrated?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.Region}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVaccines} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="12" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">How did you obtain the
                information?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.VaccineInfo}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVaccines} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Is there a specific competitor or
                competitor product involved?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.VaccineCompetitor}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVaccines} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Was a specific customer or practice
                named or named?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.VaccineCustomer}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVaccines} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="8" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">What is the main message of the
                item?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.mainMessage}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isVaccines} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Did you get permission to copy,
                photograph, or take any hardcopy item or forward any electronic item?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.VpermissionGranted}</span>
              </div>
            </div>
          </lightning-layout-item>
          <lightning-layout-item lwc:if={isOther} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Other Type of Information Received.</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.OtherInfo}</span>
              </div>
            </div>
          </lightning-layout-item>
          <!-- <template if:true={fieldVisibility.isUpload}> -->
          <lightning-layout-item lwc:if={isUpload} flexibility="auto" padding="horizontal-medium" size="12"
            small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">If not able to upload document, then please choose other options
                to send document.</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.otherSendOptions}</span>
              </div>
            </div>
          </lightning-layout-item>
          <!-- </template> -->
          <lightning-layout-item lwc:if={showCompetitiveInfoQuestion} flexibility="auto" padding="horizontal-medium"
            size="12" small-device-size="6" medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">{label.uploadFile}</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage3.uploadFile}</span>
              </div>
            </div>
          </lightning-layout-item>
          <template if:true={hasUploadedFiles}>
            <table
              class="slds-table slds-table_bordered slds-table_cell-buffer slds-table_fixed-layout slds-no-row-hover">
              <thead>
                <tr class="slds-line-height_reset">
                  <th class="" scope="col" style="width: 70%;">
                    <div class="slds-truncate" title="File Name">{label.FILENAME}</div>
                  </th>
                  <th class="" scope="col" style="width: 15%;">
                    <div class="slds-truncate" title="File Size">{label.FILESIZE}</div>
                  </th>
                  <th class="" scope="col" style="width: 15%;">
                    <div class="slds-truncate" title="Download">{label.DOWNLOAD}</div>
                  </th>
                </tr>
              </thead>
              <tbody>
                <template for:each={uploadedFilesList} for:item="file">
                  <tr key={file.id} class="slds-hint-parent">
                    <td data-label="File Name">
                      <div class="slds-truncate">{file.filename}</div>
                    </td>
                    <td data-label="File Size">
                      <div class="slds-truncate">{file.size} MB</div>
                    </td>
                    <td data-label="Download">
                      <button data-id={file.id} data-file-name={file.filename} onclick={handleFileDownload}
                        title="Download" class="slds-button slds-button_icon">
                        <lightning-icon icon-name="utility:download" size="x-small"
                          title="Download this file"></lightning-icon>
                      </button>
                    </td>
                  </tr>
                </template>
              </tbody>
            </table>
          </template>
        </lightning-layout>
      </lightning-accordion-section>
      <lightning-accordion-section name="4" label="Adverse Event Check">
        <lightning-layout multiple-rows="true">
          <lightning-layout-item flexibility="auto" padding="horizontal-medium" size="12" small-device-size="6"
            medium-device-size="6" large-device-size="6">
            <div class="slds-form-element">
              <span style="font-weight: bold;" class="slds-form-element__label ">Was a patient involved in a potential Adverse Event?</span>
              <div class="slds-form-element__control">
                <span class="slds-form-element__static">{stage4.adverse}</span>
              </div>
            </div>
          </lightning-layout-item>
        </lightning-layout>
      </lightning-accordion-section>
    </lightning-accordion>
    <!-- </div> -->
    <lightning-layout multiple-rows="true" class="slds-p-around_medium">
      <lightning-layout-item alignment-bump="left">
        <button class="slds-button slds-button_brand btnHover submitBtn" onclick={handleSubmit}
          name="Submit">Submit</button>
      </lightning-layout-item>
    </lightning-layout>

  <!-- </div> -->
</template>